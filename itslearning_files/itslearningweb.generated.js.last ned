var __extends=this&&this.__extends||function(f,e){function k(){this.constructor=f}for(var d in e)e.hasOwnProperty(d)&&(f[d]=e[d]);f.prototype=null===e?Object.create(e):(k.prototype=e.prototype,new k)},ItslearningWeb;
(function(f){(function(e){var f=function(){return function(d){this.context=d;this.selectedItemsCount=function(){var a=$("td [id^='"+e.courseManagerInstance.context.Controls.SelectedItemsClientId+"']:not([id='"+e.courseManagerInstance.context.Controls.SelectAllItemsCheckboxClientId+"'])");if(!a||0===a.length)return 0;if(e.courseManagerInstance.context.Controls.PerformAllCheckbox.is(":checked"))return e.courseManagerInstance.context.Settings.CoursesVirtualCount;var b=0,c=0;for(a=a.get();c<a.length;c++)a[c].checked&&
b++;return b};this.hideArchiveFilter=function(a){var b=$("."+e.courseManagerInstance.context.Settings.ArchiveDateCssClass).parent();$("#"+e.courseManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").first().attr("id")===a.target.id?b.hide():b.show()};this.clickOnAction=function(a){if($(a.currentTarget).parent().hasClass(e.courseManagerInstance.context.Settings.ToolbarItemDisabledCssClass))return!1;var b=e.courseManagerInstance.selectedItemsCount();return 0!==b&&confirm(CCL.CommonFunctions.formatString(a.data.text,
b))};this.context=d;e.courseManagerInstance=this;$("#"+e.courseManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").first().is(":checked")&&$("."+e.courseManagerInstance.context.Settings.ArchiveDateCssClass).parent().hide();$("#"+e.courseManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").click(this.hideArchiveFilter);e.courseManagerInstance.context.Controls.DeleteAction.on("click",null,{text:e.courseManagerInstance.context.LanguageTerms.DeleteConfirmText},
this.clickOnAction);e.courseManagerInstance.context.Controls.ArchiveAction.on("click",null,{text:e.courseManagerInstance.context.LanguageTerms.ArchiveConfirmText},this.clickOnAction);e.courseManagerInstance.context.Controls.UnarchiveAction.on("click",null,{text:e.courseManagerInstance.context.LanguageTerms.UnarchiveConfirmText},this.clickOnAction);if(e.courseManagerInstance.context.Controls.EnrolAction.length)e.courseManagerInstance.context.Controls.EnrolAction.on("click",null,{text:e.courseManagerInstance.context.LanguageTerms.EnrolConfirmText},
this.clickOnAction);if(e.courseManagerInstance.context.Controls.WithdrawAction.length)e.courseManagerInstance.context.Controls.WithdrawAction.on("click",null,{text:e.courseManagerInstance.context.LanguageTerms.WithdrawConfirmText},this.clickOnAction)}}();e.CourseManager=f})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){var a=this;this.settings=this.settings=d;$(function(){function b(){g.is(":checked")?(h.removeProp("readonly"),h.off("click",c)):(h.prop("readonly","readonly"),h.on("click",c))}function c(){return!1}var g=$("#"+a.settings.PlannerCheckboxClientId),h=$("#"+a.settings.TopicsInPlannerCheckboxClientId);b();g.on("change",function(){b()})})}}();e.EditDefaultCourseSettings=f})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){var f=function(){function d(a){this.context=a;e.editPolicyInstance=this}d.prototype.checkEsafetyChanged=function(){if(e.editPolicyInstance.context.Settings.IsInstantMessageSystemEnabled&&e.editPolicyInstance.context.Settings.IsEditMode){var a=[];CCL.CommonFunctions.checkAndAddRole(e.editPolicyInstance.context.Settings.EsafetyStaffChecked,e.editPolicyInstance.context.Controls.StaffCheckboxClientId,e.editPolicyInstance.context.LanguageTerms.Staff,a);CCL.CommonFunctions.checkAndAddRole(e.editPolicyInstance.context.Settings.EsafetyStudentChecked,e.editPolicyInstance.context.Controls.StudentCheckboxClientId,
e.editPolicyInstance.context.LanguageTerms.Student,a);CCL.CommonFunctions.checkAndAddRole(e.editPolicyInstance.context.Settings.EsafetyGuestChecked,e.editPolicyInstance.context.Controls.GuestCheckboxClientId,e.editPolicyInstance.context.LanguageTerms.Guest,a);var b="";$("#"+e.editPolicyInstance.context.Controls.InitiateCommunicationCheckBoxClientId).is(":checked")&&(b="\n"+e.editPolicyInstance.context.LanguageTerms.AdditionEsafetyText);switch(a.length){case 1:alert(CCL.CommonFunctions.formatString(e.editPolicyInstance.context.LanguageTerms.UncheckedOneEsafetyRoleText,
a[0])+b);break;case 2:alert(CCL.CommonFunctions.formatString(e.editPolicyInstance.context.LanguageTerms.UncheckedTwoEsafetyRolesText,a[0],a[1])+b);break;case 3:alert(CCL.CommonFunctions.formatString(e.editPolicyInstance.context.LanguageTerms.UncheckedThreeEsafetyRolesText)+b)}}};d.prototype.toogleEsafetyDropDown=function(a,b){document.getElementById(a).style.visibility=document.getElementById(b).checked?"visible":"hidden"};return d}();e.EditPolicy=f})(f.Administration||(f.Administration={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(a){var b=this;this.controls={checkbox:null,newActionButton:null,radioButtons:null,textArea:null,confirmButton:null};this.sections={recentActions:null,newAction:null,reason:null,confirmation:null};this.initialize=function(a){b.initializeSections(a);b.initializeControls(a);setTimeout(b.revealElements,0)};this.initializeSections=function(a){b.sections.recentActions=$("#"+a.RecentActionsSectionId);b.sections.newAction=$("#"+a.NewActionSectionId);
b.sections.reason=$("#"+a.ReasonSectionId);b.sections.confirmation=$("#"+a.ConfirmationSectionId)};this.initializeControls=function(a){b.controls.checkbox=$("#"+a.CheckboxId);b.controls.newActionButton=$("#"+a.NewActionButtonId);b.controls.radioButtons=$("#"+a.NewActionSectionId+" input");b.controls.textArea=$("#"+a.TextAreaId);b.controls.confirmButton=$("#"+a.ConfirmButtonId);b.controls.checkbox.change(b.onCheckboxClick);b.controls.newActionButton.on("click",b.onNewActionButtonClick);b.controls.radioButtons.on("change",
b.onRadioButtonClick);CCL.TextAreaExtensions.setMaxLength(b.controls.textArea,a.ReasonMaxLength);b.controls.textArea.on("input change",b.onTextAreaUpdate)};this.onCheckboxClick=function(a){a.target.checked||(b.hasNewActionButtonBeenPressed=!1);b.revealElements()};this.onNewActionButtonClick=function(){b.hasNewActionButtonBeenPressed=!0;b.revealElements()};this.onRadioButtonClick=function(){b.revealElements()};this.onTextAreaUpdate=function(){b.revealElements()};this.revealElements=function(){var a=
!1,g=!0,h=!1,d=!1,e=!1,f=!1;b.isUserConfirmed()&&(a=!0,b.hasNewActionButtonBeenPressed&&(g=!1,h=!0,b.isActionSelected()&&(e=d=!0,b.isReasonProvided()&&(f=!0))));b.showOrHideElement(b.sections.recentActions,a);b.showOrHideElement(b.controls.newActionButton,g);b.showOrHideElement(b.sections.newAction,h,function(){b.controls.radioButtons.each(function(){$(this).prop("checked",!1)})});b.showOrHideElement(b.sections.reason,d,function(){b.controls.textArea.val("")});b.showOrHideElement(b.sections.confirmation,
e);b.controls.confirmButton.prop("disabled",!f)};this.showOrHideElement=function(a,b,h){void 0===h&&(h=function(){});b?a.show():(a.hide(),h())};this.isUserConfirmed=function(){return b.controls.checkbox.is(":checked")};this.isActionSelected=function(){return b.controls.radioButtons.is(":checked")};this.isReasonProvided=function(){return""!=b.controls.textArea.val().trim()};$(function(){return b.initialize(a)})}}();e.Default=d})(e.Gdpr||(e.Gdpr={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){var b=this;this.context=a;this.onDialogAddButtonClick=function(a){var c=[];a.forEach(function(a,b){a!==f.CheckboxStateMachine.State.Saved&&a!==f.CheckboxStateMachine.State.AttachedByUser||c.push(b)});b.selectedHierarchyIds.val(c.join());b.isHierarchySelectionChanged=!0};this.onDialogClosed=function(){b.isHierarchySelectionChanged&&b.context.Scripts.SelectHierarchyScript()};this.setupHierarchyLinkClickHandler()}Object.defineProperty(a.prototype,
"selectedHierarchyIds",{get:function(){return $("#"+this.context.Controls.SelectedHierarchyIds)},enumerable:!0,configurable:!0});a.prototype.setupHierarchyLinkClickHandler=function(){var a=this,c=f.Controls.HierarchyDialog.hierarchyDialogManagerInstance,g=this.selectedHierarchyIds.val()?this.selectedHierarchyIds.val().split(","):[];if(c)$("#"+this.context.Controls.AddHierarchyLinkId).on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",function(){a.isHierarchySelectionChanged=!1;var b=new Map;
g.forEach(function(a){b.set(parseInt(a),f.CheckboxStateMachine.State.Saved)});c.openDialog({itemStates:b,disabledItemIds:[],header:a.context.Resources.HierarchyDialogHeader,afterOkClickCallback:a.onDialogAddButtonClick,afterCloseDialogCallback:a.onDialogClosed,allowFolderSelection:!0},{})})};return a}();e.AddEditModuleApps=d})(e.ManageApps||(e.ManageApps={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(a,b,h,d){this.utility=a;this.editorCallbacks=b;this.cssClasses=h;this.terms=d}a.prototype.buildCommonMarkup=function(a,b,h,d,e,f,k,n,q,v,w){void 0===n&&(n=null);void 0===q&&(q=!1);void 0===v&&(v=!0);h&&this.buildSectionTitle(a,d,e);n&&n();this.buildContentMarkup(a,b.editable&&k,f,q,v,w)};a.prototype.buildSectionTitle=function(a,b,h){$("<div>").addClass(b).text(h).appendTo(a)};a.prototype.getEditorBinding=function(a){var b=
this;return{event:a,watermarkText:this.getTextContainerWatermark(a),cachedText:this.getCachedText(a),cachedPlainText:this.getCachedPlainText(a),isPlainText:this.isPlainText(a),sendTextAjax:function(c){return b.sendTextAjax(a,c)}}};a.prototype.buildContentMarkup=function(a,b,h,d,l,k){var c=this,g=$("<div>");k&&g.addClass(this.utility.settings.cssClasses.ModernInputTextEditor).addClass(this.utility.settings.cssClasses.ModernInputTextIsValid).appendTo(a);var m=$("<div>").addClass(this.cssClasses.inlineEditContainer).appendTo(k?
g:a);a=$("<div>");d?a.text(h.cachedText):a.html(h.cachedText);a.addClass(this.utility.settings.cssClasses.UserInput).appendTo(m);b&&(h.isPlainText?(m.addClass(this.utility.settings.cssClasses.TextContainerEditable),a.css("cursor","pointer"),h.cachedText.trim()||a.addClass(this.utility.settings.cssClasses.TextContainerWatermark).text(h.watermarkText),a.one("click",function(){(new f.InlineEdit.InlineEditContent(m,c.utility,c.editorCallbacks,h,d,l,k?k.inputValidationFunction:null)).makeTextContentInlineEditable();
if(k){var a=new e.InputValidator(c.utility,g,k);a.createValidationMessageContainer();c.editorCallbacks.onEditFinished=function(){a.resetValidation()}}})):a.prop("title",this.terms.isNotEditableTooltip));d||CCL.CommonFunctions.executeScripts(h.cachedText)};return a}();d.MarkupBuilderBase=a})(f.EventTextContent||(f.EventTextContent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a){this.utility=a}a.prototype.buildMarkup=function(a,b){(b.editable||b.PreviousEventExtraDescription&&b.PreviousEventExtraDescription.length)&&$("<div>").addClass(this.utility.settings.cssClasses.DescriptionApiLabel).text(this.utility.settings.terms.ApiDescriptionLabel).appendTo(a);$("<div>").addClass(this.utility.settings.cssClasses.UserInput).addClass(this.utility.settings.cssClasses.DescriptionApi).html(b.apiDescription).appendTo($(a))};
return a}();d.ApiDescriptionMarkupBuilder=a})(e.EventTextContent||(e.EventTextContent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.settings=a;this.controls=c;this.defaultTitleHeight=20;this.defaultDescriptionHeight=86;this.cssClasses=this.settings.cssClasses;this.utility=new e.Utility(a,c)}a.prototype.getContentAreaIdWithColorClass=function(a,c){var b=this,h={},d=0;for(a=this.getFilterItemsList(a);d<a.length;d++){var e=a[d],f=e.getElementsByClassName(this.cssClasses.ColorItem)[0];h[c+e.dataset.itemid]=Object.assign([],f.classList).filter(function(a){return a!==
b.cssClasses.ColorItem}).join()}return h};a.prototype.getFilterItemIds=function(a,c){var b=[],h=0;for(a=this.getFilterItemsList(a);h<a.length;h++){var d=a[h];!c===!this.filterItemChecked(d)&&b.push(+d.dataset.itemid)}return b};a.prototype.getFilterItemIdsWithColors=function(a,c){var b=[],h=[],d=0;for(a=this.getFilterItemsList(a);d<a.length;d++){var e=a[d];!c===!this.filterItemChecked(e)&&(b.push(+e.dataset.itemid),h.push(+e.dataset.itemcolor))}return{persons:b.join(),colors:h.join()}};a.prototype.getAllCourseIds=
function(){for(var a=[],c=0,g=this.getFilterItemsList(this.controls.myCalendars.courseList[0]);c<g.length;c++)a.push(+g[c].dataset.itemid);return a};a.prototype.getContentAreaIdsWithColorClasses=function(){var a=this.getContentAreaIdWithColorClass(this.controls.myCalendars.courseList[0],this.utility.settings.locationPrefixes.courseValuePrefix),c=this.getContentAreaIdWithColorClass(this.controls.myCalendars.projectList[0],this.utility.settings.locationPrefixes.projectValuePrefix);return Object.assign({0:"person-color"},
a,c)};a.prototype.toggleDescriptionInlineEditorModes=function(a,c){var b=c&&!a.isPlainTextInExtraDescription;c&&!a.isPlainTextInDescription?(this.controls.AddEventReadOnlyDescriptionContainer.innerHTML=a.description,this.controls.AddEventReadOnlyDescriptionContainer.style.display="block",this.controls.AddEventEditableDescriptionContainer.style.display="none"):(this.controls.AddEventReadOnlyDescriptionContainer.innerHTML="",this.controls.AddEventReadOnlyDescriptionContainer.style.display="none",this.controls.AddEventEditableDescriptionContainer.style.display=
"block",this.controls.addEventDescriptionBox[0].value=c&&a.descriptionPlainText||"");b?(this.controls.AddEventReadOnlyExtraDescriptionContainer.innerHTML=a.extraDescription,this.controls.AddEventReadOnlyExtraDescriptionContainer.style.display="block",this.controls.AddEventEditableExtraDescriptionContainer.style.display="none"):(this.controls.AddEventReadOnlyExtraDescriptionContainer.innerHTML="",this.controls.AddEventReadOnlyExtraDescriptionContainer.style.display="none",this.controls.AddEventEditableExtraDescriptionContainer.style.display=
"block",this.controls.addEventExtraDescriptionBox[0].value=c&&a.extraDescriptionPlainText||"")};a.prototype.resetInputFieldsToDefault=function(a){this.controls.addEventChooseCategoryErrorMessageLabel[0].style.display="none";this.controls.addEventResponseErrorMessageLabel[0].style.display="none";this.controls.AddEventTitleTextBox[0].value=a;this.controls.addEventDescriptionBox[0].value="";this.controls.addEventExtraDescriptionBox[0]&&(this.controls.addEventExtraDescriptionBox[0].value="");this.controls.AddEventTitleTextBox[0].style.height=
this.defaultTitleHeight+"px";this.controls.addEventDescriptionBox[0].style.height=this.defaultDescriptionHeight+"px";this.controls.addEventExtraDescriptionBox[0]&&(this.controls.addEventExtraDescriptionBox[0].style.height=this.defaultDescriptionHeight+"px")};a.prototype.adjustHeights=function(){this.controls.AddEventTitleTextBox[0].style.height=this.controls.AddEventTitleTextBox[0].scrollHeight+"px";this.controls.addEventDescriptionBox[0].style.height=this.controls.addEventDescriptionBox[0].scrollHeight+
"px";this.controls.addEventExtraDescriptionBox[0]&&(this.controls.addEventExtraDescriptionBox[0].style.height=this.controls.addEventExtraDescriptionBox[0].scrollHeight+"px")};a.prototype.setUserInputsIfNeeded=function(a){if(a){var b=this.controls.eventDetailsMainContainer.querySelector("."+this.cssClasses.Title+" > ."+this.cssClasses.UserInput);a.EventTitle=b&&!b.classList.contains(this.cssClasses.TextContainerWatermark)&&b.innerText||"";a.isPlainTextInDescription&&(b=this.controls.eventDetailsMainContainer.querySelector("."+
this.cssClasses.Description+" > ."+this.cssClasses.UserInput),a.description=b&&!b.classList.contains(this.cssClasses.TextContainerWatermark)&&b.innerHTML||"");this.settings.customerSettings.enableFrenchCalendarLayout&&a.showExtraDescription&&a.isPlainTextInExtraDescription&&(b=this.controls.eventDetailsMainContainer.querySelector("."+this.cssClasses.DescriptionExtra+" > ."+this.cssClasses.UserInput),a.extraDescription=b&&!b.classList.contains(this.cssClasses.TextContainerWatermark)&&b.innerHTML||
"")}};a.prototype.getFilterItemsList=function(a){return a&&Object.assign([],a.getElementsByClassName(this.cssClasses.FilterItem))||[]};a.prototype.filterItemChecked=function(a){return a.querySelector("input").checked};return a}();e.Schedule=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(b){this.settings=b;window[a.instanceName]=this}a.prototype.countDown=function(a,c){var b=this,h=document.querySelector("[id$='"+this.settings.TimerPrefix+a+"']"),d=document.querySelector("[id$='"+this.settings.EditLinkPrefix+a+"']");d&&h&&(0<c?(h.innerHTML=this.settings.EditMessagePart1+" "+c+" "+this.settings.EditMessagePart2,--c,setTimeout(function(){b.countDown(a,c)},6E4)):(h.style.display="none",d.style.display="none"))};a.getInstance=
function(){return window[a.instanceName]};a.instanceName="ThreadViewTableClientInstance";return a}();e.ThreadViewTable=d})(e.Discussion||(e.Discussion={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.controls=a;this.settings=c;this.modalDialog=window[this.getDialogId()];this.setupOkButtonClickHandler();this.modalDialog.setCustomScripts({afterOpenDialogAjaxDynamicallySuccess:function(){var a=window[b.settings.TreeViewSelectorContainerId];a.init({allowFolderSelection:!0,itemStates:b.currentParams.itemStates,disabledItemIds:b.currentParams.disabledItemIds});var c=0<a.countCheckedItems();b.controls.OkButton.prop("disabled",
!c);b.controls.Container.on(a.settings.StateChangedEventName,function(a,c){b.controls.OkButton.prop("disabled",0===c)});a.onFolderContentLoaded();c=b.controls.Container.find(CCL.CommonFunctions.getDataSelector(a.settings.DataAttributes.ItemId)).first();a.expandFolder(c)},afterCloseDialog:function(){void 0!==b.currentParams.afterCloseDialogCallback&&b.currentParams.afterCloseDialogCallback()}})}a.prototype.openDialog=function(a,c){this.currentParams=a;$.extend(c,{treeViewContainerId:this.settings.TreeViewSelectorContainerId});
this.ajaxParams=c;this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,c,!1);this.modalDialog.setTitle(this.currentParams.header);this.modalDialog.openDialog(!1)};a.prototype.closeDialog=function(){CssModal.closeDialog()};a.prototype.getDialogId=function(){return this.controls.Container.prop("id")};a.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.on("click",function(b){a.currentParams.afterOkClickCallback(a.currentParams.itemStates);a.closeDialog();b.preventDefault()})};
return a}();e.HierarchyDialogManager=d})(e.HierarchyDialog||(e.HierarchyDialog={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.options=new Map;this.optionsGroup=a;this.options=new Map;b.forEach(function(a){return c.options.set(a[0],a[1])});this.optionsGroup.on("keydown","label",function(a){if(a.keyCode===CCL.CommonConstants.keyCodes.enter||a.keyCode===CCL.CommonConstants.keyCodes.space)return $(a.target).click(),a.preventDefault(),!1})}d.prototype.isSelected=function(a){return this.isOptionSelected(this.options.get(a))};d.prototype.addOnChangeHandler=
function(a){this.optionsGroup.on("change","input:radio",a)};d.prototype.isOptionSelected=function(a){return a.is(":checked")};return d}();e.OptionRadioButtonManagerBase=f})(f.OptionRadioButton||(f.OptionRadioButton={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.controls=a;this.settings=c;this.optionRadioManager=new f.OptionRadioButton.OptionRadioButtonManagerBase(this.controls.RadioButtonGroup,[[e.PrivacyChangedDialogActionType.MakeReadOnly,this.controls.RadioButtonReadOnly],[e.PrivacyChangedDialogActionType.LeaveOpen,this.controls.RadioButtonLeaveOpen]]);this.optionRadioManager.addOnChangeHandler(function(){b.switchState()});e.privacyChangedDialogManagerInstance.toggleOkButton(0===
this.getSelectedProfilesIds().length);this.controls.ProfileCheckboxesByCss.off("change").on("change",function(a){e.privacyChangedDialogManagerInstance.toggleOkButton(0===b.getSelectedProfilesIds().length)})}a.prototype.getCurrentProfileId=function(){return this.settings.CurrentProfileId};a.prototype.selectedActionType=function(){return this.optionRadioManager.isSelected(e.PrivacyChangedDialogActionType.MakeReadOnly)?e.PrivacyChangedDialogActionType.MakeReadOnly:e.PrivacyChangedDialogActionType.LeaveOpen};
a.prototype.getSelectedProfilesIds=function(){for(var a=this,c=[],g=function(b){if(b.is(":checked")){var g=h.settings.PersonProfiles.find(function(c){return c.PersonProfileId.toString()===b.attr("id").replace(a.settings.ProfileCheckboxPrefix,"")});c.push(g.PersonProfileId)}},h=this,d=0,e=this.controls.ProfileCheckboxes;d<e.length;d++)g(e[d]);return c};a.prototype.getSelectedProfileNames=function(){for(var a=this,c=[],g=function(b){if(b.is(":checked")){var g=h.settings.PersonProfiles.find(function(c){return c.PersonProfileId.toString()===
b.attr("id").replace(a.settings.ProfileCheckboxPrefix,"")});c.push(g.PersonProfileName)}},h=this,d=0,e=this.controls.ProfileCheckboxes;d<e.length;d++)g(e[d]);return c};a.prototype.areGroupConversationsIncludedChecked=function(){return this.controls.IncludeGroupConversationsCheckbox.is(":checked")};a.prototype.switchState=function(){this.optionRadioManager.isSelected(e.PrivacyChangedDialogActionType.MakeReadOnly)?(this.controls.ReadOnlySection.show(),e.privacyChangedDialogManagerInstance.toggleOkButton(0===
this.getSelectedProfilesIds().length)):(this.controls.ReadOnlySection.hide(),e.privacyChangedDialogManagerInstance.toggleOkButton(!1))};return a}();e.PrivacyChangedDialogContentManager=d})(e.PersonProfile||(e.PersonProfile={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.controls=a;this.settings=c;this.modalDialog=window[this.getDialogId()]}a.prototype.toggleOkButton=function(a){this.controls.OkButton.prop("disabled",a)};a.prototype.openDialog=function(a,c){this.params=a;this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,c,!1);this.modalDialog.setTitle(this.settings.HeaderText);this.setupOkButtonClickHandler();this.modalDialog.openDialog(!1)};a.prototype.closeDialog=function(){CssModal.closeDialog()};
a.prototype.getDialogId=function(){return this.controls.Container.prop("id")};a.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.off("click").on("click",function(b){f.WebComponents.personProfileSiteInstance.showConfirmEsafetyChanges(e.privacyChangedDialogContentManagerInstance.getSelectedProfileNames(),e.privacyChangedDialogContentManagerInstance.areGroupConversationsIncludedChecked(),e.privacyChangedDialogContentManagerInstance.selectedActionType())?(a.startJob(),
a.closeDialog(),b.preventDefault(),(new Function(a.params.submitFormMethod))()):b.preventDefault()})};a.prototype.startJob=function(){var a={selectedAction:e.privacyChangedDialogContentManagerInstance.selectedActionType(),selectedProfileIds:e.privacyChangedDialogContentManagerInstance.getSelectedProfilesIds(),currentProfileId:e.privacyChangedDialogContentManagerInstance.getCurrentProfileId(),areGroupConversationsIncluded:e.privacyChangedDialogContentManagerInstance.areGroupConversationsIncludedChecked()};
CCL.CommonFunctions.safeAjaxPost({url:this.settings.StartPrivacyChangedJob,data:a,dataType:"html"})};return a}();e.PrivacyChangedDialogManager=d})(e.PersonProfile||(e.PersonProfile={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){this.context=d;this.selectedItemsCount=function(){return e.projectManagerInstance.context.Controls.PerformOnAllCheckbox.is(":checked")?e.projectManagerInstance.context.Settings.ProjectsVirtualCount:e.projectManagerInstance.context.Controls.TableItem.find("tr.selected").length};this.hideArchiveFilter=function(a){var b=$("."+e.projectManagerInstance.context.Settings.ArchiveDateCssClass).parent();$("#"+e.projectManagerInstance.context.Controls.StatusClientId+
" input[type = 'radio']").first().attr("id")===a.target.id?b.hide():b.show()};this.clickOnAction=function(a){if($(a.currentTarget).is("[disabled=disabled]"))return!1;var b=e.projectManagerInstance.selectedItemsCount();return 0!==b&&confirm(CCL.CommonFunctions.formatString(a.data.text,b))};this.context=d;e.projectManagerInstance=this;$("."+e.projectManagerInstance.context.Settings.ArchiveDateCssClass).children().addClass(e.projectManagerInstance.context.Settings.InlineCssClass);$("#"+e.projectManagerInstance.context.Controls.StatusClientId+
" input[type = 'radio']").first().is(":checked")&&$("."+e.projectManagerInstance.context.Settings.ArchiveDateCssClass).parent().hide();$("#"+e.projectManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").click(this.hideArchiveFilter);e.projectManagerInstance.context.Controls.DeleteAction.on("click",null,{text:e.projectManagerInstance.context.LanguageTerms.DeleteConfirmText},this.clickOnAction)}}();e.ProjectManager=f})(f.Administration||(f.Administration={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.context=a;e.finalAssessmentInstance=this}d.prototype.toggleView=function(a){$(a).closest(this.context.Controls.ItemRootCssSelector).find("> li").toggle()};d.prototype.alertAjaxError=function(a){CCL.CommonFunctions.alertAjaxError(a,null,null)};d.prototype.updateViewScore=function(a){var b=a.val();b==this.context.Settings.NotAssessmentStringPattern&&(b=this.context.Settings.NotAssessmentReplaceValue);$(a).closest(this.context.Controls.ItemRootCssSelector).find(this.context.Controls.ScoreCssSelector).text(b)};d.prototype.assessPerson=
function(a,b,c,g,h){a={personId:a,assessmentId:c,assessmentItemId:b.getValue(),courseId:g,gradeBookItemId:h};CCL.CommonFunctions.safeAjaxPost({url:this.context.WebMethods.AssessWithScaleUrl,data:a}).fail(this.alertAjaxError).done(this.updateViewScore(b))};return d}();e.FinalAssessment=f})(f.AssessmentRecord||(f.AssessmentRecord={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){e.termAssessmentOverviewInstance=this;this.context=a}a.prototype.init=function(){var a=this;$("#"+this.context.Controls.CompleteCourseButtonId).click(function(){return a.completeSelectedCourses()});$("#"+this.context.Controls.RevertCourseButtonId).click(function(){return a.revertSelectedCourses()})};a.prototype.getSelectedCourses=function(){for(var a=[],c=0,g=$("#"+this.context.Controls.GridId).find("tbody > tr.selected").toArray();c<
g.length;c++){var h=$("span["+this.context.Settings.DataSerializedInfoAttribute+"]",g[c]).first();h=$.parseJSON(h.attr(this.context.Settings.DataSerializedInfoAttribute));a.push(h)}return a};a.prototype.getRevertConfirmationMessage=function(a){var b="";switch(a.length){case 0:break;case 1:b=this.context.Settings.RevertConfirmOneCourseMessagePattern.replace(this.context.Settings.CourseAPattern,a[0].Title);break;case 2:b=this.context.Settings.RevertConfirmTwoCoursesMessagePattern.replace(this.context.Settings.CourseAPattern,
a[0].Title).replace(this.context.Settings.CourseBPattern,a[1].Title);break;case 3:b=this.context.Settings.RevertConfirmThreeCoursesMessagePattern.replace(this.context.Settings.CourseAPattern,a[0].Title).replace(this.context.Settings.CourseBPattern,a[1].Title).replace(this.context.Settings.CourseCPattern,a[2].Title);break;default:b=this.context.Settings.RevertConfirmFourOrMoreCoursesMessagesPattern.replace(this.context.Settings.CourseAPattern,a[0].Title).replace(this.context.Settings.CourseBPattern,
a[1].Title).replace(this.context.Settings.NumberOfCoursesPattern,(a.length-2).toString())}return b};a.prototype.checkSelectionExists=function(a){return 0==a.length?(jAlert(this.context.Settings.PleaseMakeSelectionMessage),!1):!0};a.prototype.completeSelectedCourses=function(){var a=this,c=this.getSelectedCourses();this.checkSelectionExists(c)&&jConfirm(this.context.Settings.CompleteConfirmMessage,this.context.Settings.ConfirmDialogTitle,function(b){b&&a.context.Scripts.PostbackComplete()})};a.prototype.revertSelectedCourses=
function(){var a=this,c=this.getSelectedCourses();this.checkSelectionExists(c)&&(c=this.getRevertConfirmationMessage(c),jConfirm(c,this.context.Settings.ConfirmDialogTitle,function(b){b&&a.context.Scripts.PostbackRevert()}))};return a}();e.TermAssessmentOverview=d})(e.Headteacher||(e.Headteacher={}))})(f.Assessment||(f.Assessment={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.settings=a;this.crumbs=window.parent.document.getElementById("crumbs");this.textItemBuilder=new e.BreadcrumbTextItemBuilder(a.CssClasses);this.linkItemBuilder=new e.BreadcrumbLinkItemBuilder(a.CssClasses,a.KpiSettings)}d.prototype.buildBreadcrumbs=function(a){var b=this;window.parent!==window&&this.crumbs&&(Array.prototype.slice.call(this.crumbs.querySelectorAll("li:not(:first-child)")).forEach(function(a){a.parentNode.removeChild(a)}),
a.forEach(function(c,g){b.crumbs.appendChild((g===a.length-1?b.textItemBuilder:b.linkItemBuilder).buildItem(c))}))};return d}();e.BreadcrumbBuilder=f})(f.Breadcrumbs||(f.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.cssClasses=a}d.prototype.buildListItem=function(a){var b=document.createElement("li");b.appendChild(this.getSeparator());b.appendChild(a);return b};d.prototype.getSeparator=function(){var a=document.createElement("span");a.innerText="/";a.className=this.cssClasses.Separator;return a};return d}();e.BreadcrumbItemBuilderBase=f})(f.Breadcrumbs||(f.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c){d.call(this,a);this.kpiSettings=c}__extends(a,d);a.prototype.buildItem=function(a){var b=this,g=document.createElement("a");g.innerText=a.Text;g.setAttribute("title",a.Title&&a.Title.length?a.Title:a.Text);g.setAttribute("href",a.Href);g.setAttribute("target",a.Target);g.onclick=function(){return b.measureKpi()};a=document.createElement("span");a.appendChild(g);return this.buildListItem(a)};a.prototype.measureKpi=function(){fetch(this.kpiSettings.MeasureKpiUrl,
{credentials:"same-origin",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({measureSection:this.kpiSettings.MeasureSection,measurement:this.kpiSettings.Measurement,measureContext:this.kpiSettings.MeasureContext})})};return a}(e.BreadcrumbItemBuilderBase);e.BreadcrumbLinkItemBuilder=f})(f.Breadcrumbs||(f.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a){d.call(this,a)}__extends(a,d);a.prototype.buildItem=function(a){var b=document.createElement("span");b.className=this.cssClasses.SelectedCrumb;b.innerText=a.Text;return this.buildListItem(b)};return a}(e.BreadcrumbItemBuilderBase);e.BreadcrumbTextItemBuilder=f})(f.Breadcrumbs||(f.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.AddResourceMenu||(f.AddResourceMenu={});f=f.ElementExternalSourceType||(f.ElementExternalSourceType={});f[f.Library=0]="Library";f[f.Course=1]="Course";f[f.CreateNew=2]="CreateNew";f[f.Computer=3]="Computer"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.Administration||(f.Administration={});f=f.PersonProfile||(f.PersonProfile={});f=f.PrivacyChangedDialogActionType||(f.PrivacyChangedDialogActionType={});f[f.MakeReadOnly=0]="MakeReadOnly";f[f.LeaveOpen=1]="LeaveOpen"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d[d.Other=0]="Other";d[d.Resource=1]="Resource";d[d.Child=2]="Child"})(e.CalendarTypes||(e.CalendarTypes={}));(function(d){d[d.Month=0]="Month";d[d.Week=1]="Week";d[d.Day=2]="Day";d[d.List=3]="List"})(e.CalendarView||(e.CalendarView={}));(function(d){d[d.ReportError=0]="ReportError";d[d.PerformUpdate=1]="PerformUpdate";d[d.AskConfirmation=2]="AskConfirmation"})(e.EventCheckDecision||(e.EventCheckDecision={}));(function(d){d[d.Unspecified=0]="Unspecified";
d[d.RecurringEventInSingleMode=1]="RecurringEventInSingleMode";d[d.RecurringEventInUpcomingMode=2]="RecurringEventInUpcomingMode"})(e.EventScopeMode||(e.EventScopeMode={}));(function(d){d[d.CheckOnly=0]="CheckOnly";d[d.CheckOrUpdate=1]="CheckOrUpdate";d[d.UpdateOnly=2]="UpdateOnly"})(e.EventScopeOperation||(e.EventScopeOperation={}));(function(d){d[d.Course=1]="Course";d[d.Person=2]="Person";d[d.Project=3]="Project";d[d.All=4]="All"})(e.EventType||(e.EventType={}));(function(d){d[d.None=0]="None";
d[d.Default=1]="Default";d[d.CourseApproval=2]="CourseApproval";d[d.BookingsAvailability=4]="BookingsAvailability"})(e.EventValidationScope||(e.EventValidationScope={}))})(e.CalendarControllerModels||(e.CalendarControllerModels={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d[d.Available=1]="Available";d[d.PartlyBooked=2]="PartlyBooked";d[d.Booked=3]="Booked"})(e.BookableResourceStatuses||(e.BookableResourceStatuses={}));(function(d){d[d.Monday=1]="Monday";d[d.Tuesday=2]="Tuesday";d[d.Wednesday=4]="Wednesday";d[d.Thursday=8]="Thursday";d[d.Friday=16]="Friday";d[d.Saturday=32]="Saturday";d[d.Sunday=64]="Sunday"})(e.WeekDays||(e.WeekDays={}))})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));(function(f){f=f.CheckboxStateMachine||(f.CheckboxStateMachine={});f=f.State||(f.State={});f[f.Empty=0]="Empty";f[f.Saved=1]="Saved";f[f.AttachedByUser=2]="AttachedByUser";f[f.DetachedByUser=3]="DetachedByUser"})(ItslearningWeb||(ItslearningWeb={}));(function(f){f=f.Controls||(f.Controls={});f=f.DatePeriod||(f.DatePeriod={});f[f.Day=0]="Day";f[f.Week=1]="Week"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.CopyMoveElementDialog||(f.CopyMoveElementDialog={});f=f.CopyMoveElementDialogMode||(f.CopyMoveElementDialogMode={});f[f.Copy=0]="Copy";f[f.Move=1]="Move"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.ElementLinkDialog||(f.ElementLinkDialog={});f=f.ContentElementType||(f.ContentElementType={});f[f.All=0]="All";f[f.Resources=1]="Resources";f[f.Activities=2]="Activities";f[f.LearningObjectives=3]="LearningObjectives";f[f.Homework=4]="Homework";f[f.Files=5]="Files"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.ElementParticipantPicker||(f.ElementParticipantPicker={});f=f.ItemType||(f.ItemType={});f[f.Participant=0]="Participant";f[f.Group=1]="Group"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d[d.NextStep=0]="NextStep";d[d.NoNewSteps=-1]="NoNewSteps";d[d.Finish=-2]="Finish"})(e.TriggerResult||(e.TriggerResult={}));(function(d){d[d.Score=1]="Score";d[d.StatusViewed=2]="StatusViewed";d[d.StatusSubmitted=3]="StatusSubmitted";d[d.StatusCompleted=4]="StatusCompleted"})(e.TriggerCondition||(e.TriggerCondition={}));(function(d){d[d.LinearTransitionWithSingleElement=0]="LinearTransitionWithSingleElement";d[d.LinearTransitionWithMultipleElements=
1]="LinearTransitionWithMultipleElements";d[d.BranchingWithSingleElement=2]="BranchingWithSingleElement"})(e.StepType||(e.StepType={}));(function(d){d[d.StudentView=0]="StudentView";d[d.TeacherView=1]="TeacherView";d[d.TeacherEdit=2]="TeacherEdit"})(e.LearningPathStepViewMode||(e.LearningPathStepViewMode={}))})(e.Builder||(e.Builder={}))})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d[d.First="First"]="First";d[d.Last="Last"]="Last";d[d.Best="Best"]="Best"})(e.WhichAttemptCounts||(e.WhichAttemptCounts={}));(function(d){d[d.Never="Never"]="Never";d[d.AfterEachAttempt="AfterEachAttempt"]="AfterEachAttempt";d[d.AfterDeadline="AfterDeadline"]="AfterDeadline";d[d.AfterAllAttempts="AfterAllAttempts"]="AfterAllAttempts";d[d.WhenTeacherDecides="WhenTeacherDecides"]="WhenTeacherDecides"})(e.WhenToShowResult||(e.WhenToShowResult={}));
(function(d){d[d.Never="Never"]="Never";d[d.AfterEachAttempt="AfterEachAttempt"]="AfterEachAttempt";d[d.AfterAllAttempts="AfterAllAttempts"]="AfterAllAttempts";d[d.WithResults="WithResults"]="WithResults";d[d.AfterDeadline="AfterDeadline"]="AfterDeadline"})(e.WhenToShowQuestionListAndAnswer||(e.WhenToShowQuestionListAndAnswer={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.LearningToolElement||(f.LearningToolElement={});f=f.Settings||(f.Settings={});f=f.SettingType||(f.SettingType={});f[f.ActivationControl=1]="ActivationControl";f[f.Results=2]="Results";f[f.SubmissionStatusForStudent=3]="SubmissionStatusForStudent";f[f.CollaborationSelector=4]="CollaborationSelector";f[f.Deadline=5]="Deadline";f[f.Homework=6]="Homework";f[f.LearningObjectiveList=7]="LearningObjectiveList";f[f.AssessmentScale=8]="AssessmentScale";f[f.Attempts=9]="Attempts";f[f.ResultsAndFeedback=
10]="ResultsAndFeedback";f[f.SubmissionStatusForTeacher=11]="SubmissionStatusForTeacher";f[f.GroupSubmission=12]="GroupSubmission";f[f.AnonymousSubmission=13]="AnonymousSubmission";f[f.PlagiarismControl=14]="PlagiarismControl";f[f.Mandatory=15]="Mandatory";f[f.PeerAssessment=16]="PeerAssessment";f[f.TestMode=17]="TestMode";f[f.WorkloadSetting=18]="WorkloadSetting"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){e[e.ShowCurrent=0]="ShowCurrent";e[e.ShowScheduled=1]="ShowScheduled";e[e.ShowExpired=2]="ShowExpired"})(e.BulletinsDisplayMode||(e.BulletinsDisplayMode={}));(function(e){e[e.Success=0]="Success";e[e.LightBulletinNotFound=1]="LightBulletinNotFound"})(e.GenericResponseCode||(e.GenericResponseCode={}));(function(e){e[e.Edit=0]="Edit";e[e.SetCommentsAvailability=1]="SetCommentsAvailability";e[e.ScheduleBulletin=2]="ScheduleBulletin";e[e.Delete=3]="Delete";e[e.ToggleSubscription=
4]="ToggleSubscription"})(e.LightBulletinDropDownMenuActionType||(e.LightBulletinDropDownMenuActionType={}));(function(e){e[e.UnsubscribedManually=0]="UnsubscribedManually";e[e.Subscribed=1]="Subscribed";e[e.WasNotSubscribed=2]="WasNotSubscribed"})(e.PersonSubscriptionStatus||(e.PersonSubscriptionStatus={}))})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.Planner||(f.Planner={});f=f.ClientColumnType||(f.ClientColumnType={});f[f.RichText=0]="RichText";f[f.TopicTitle=1]="TopicTitle";f[f.TopicDescription=2]="TopicDescription";f[f.PlanDescription=3]="PlanDescription";f[f.PlanTitle=4]="PlanTitle";f[f.ClassHours=5]="ClassHours"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.Planner||(f.Planner={});f=f.Dialogs||(f.Dialogs={});f=f.CopyDialogOverwriteAssessmentCriteriaState||(f.CopyDialogOverwriteAssessmentCriteriaState={});f[f.Show=0]="Show";f[f.Hide=1]="Hide";f[f.Disable=2]="Disable"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=e.CalendarControllerModels.EventValidationScope,a=function(){function a(a){var b=this;this.utility=a;this.currentChangesScope=d.None;this.changesDebouncer=new CCL.CallbackDebouncer(function(){return b.callChangesHandler()});this.setupStartEndDateTimeHandlers();this.setupRecurringHandlers()}a.prototype.setChangesHandler=function(a){this.changesHandler=a};a.prototype.callChangesHandler=function(){var a=this.currentChangesScope;this.currentChangesScope=d.None;
this.changesHandler(a)};a.prototype.setupStartEndDateTimeHandlers=function(){var a=this;this.utility.controls.startDateInput.add(this.utility.controls.startTimeInput).change(function(){a.onChanged(d.Default|a.getCourseApprovalScopeIfNeeded()|a.getBookingsAvailabilityScopeIfNeeded())});this.utility.controls.endDateInput.add(this.utility.controls.endTimeInput).change(function(){a.onChanged(d.Default|a.getBookingsAvailabilityScopeIfNeeded())})};a.prototype.setupRecurringHandlers=function(){var a=this;
this.utility.controls.recurringCheckbox.add(this.utility.controls.recurrenceEndDateInput).change(function(){a.onChanged(d.Default|a.getBookingsAvailabilityScopeIfNeeded())});this.utility.controls.repeatWeekCountSelect.add(this.utility.controls.repeatWeekDaysList).change(function(){return a.onChanged(a.getBookingsAvailabilityScopeIfNeeded())})};a.prototype.onChanged=function(a){this.changesHandler&&(this.currentChangesScope|=a,this.currentChangesScope!==d.None&&this.changesDebouncer.invokeCallback(void 0,
f.Utility.timeoutForValidationAfterDateShiftedMilliseconds))};a.prototype.getCourseApprovalScopeIfNeeded=function(){return this.utility.settings.AvailableFeatures.IsCalendarApprovalEnabled?d.CourseApproval:0};a.prototype.getBookingsAvailabilityScopeIfNeeded=function(){return this.utility.hasAnyBookingsSelected()?d.BookingsAvailability:0};return a}();f.ChangesAdapter=a})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d;(function(a){a[a.Empty=0]="Empty";a[a.Single=1]="Single";a[a.Multiple=2]="Multiple"})(d||(d={}));var a=function(){function a(a){this.container=a.controls.FeedbackContainer;this.cssClasses=a.settings.CssClasses}a.prototype.addErrorMessage=function(a){switch(this.detectFeedbackType()){case d.Empty:this.createSingleError(a);break;case d.Single:var b=this.findSingleError(),c=b.text();c!==a&&b.replaceWith(this.createMultiErrorList([c,a]));break;case d.Multiple:0===
this.filterMultiErrors(a,this.findMultiErrors()).length&&this.findFeedbackError().find("ol").append($("<li>").text(a));break;default:throw Error("Unknown feedback type");}};a.prototype.removeErrorMessages=function(){this.findFeedbackError().remove()};a.prototype.createSingleError=function(a){this.createFeedbackError().append($("<div>").addClass(this.cssClasses.FeedbackText).text(a))};a.prototype.createMultiErrorList=function(a){for(var b=$("<ol>").addClass(this.cssClasses.NoBullet+" "+this.cssClasses.Margin0+
" "+this.cssClasses.Padding0),c=0;c<a.length;c++)b.append($("<li>").text(a[c]));return b};a.prototype.createFeedbackError=function(){return $("<div>").addClass(this.cssClasses.Feedback+" "+this.cssClasses.FeedbackError+" "+this.cssClasses.ClearFloat).append($("<i>").addClass(this.cssClasses.ImageContainer+" "+this.cssClasses.ExclamationCircle)).prependTo(this.container)};a.prototype.detectFeedbackType=function(){var a=this.findFeedbackError(),b=d.Empty;0<a.length&&(0<a.find("."+this.cssClasses.FeedbackText).length?
b=d.Single:0<a.find("ol").length&&(b=d.Multiple));return b};a.prototype.findFeedbackError=function(){return this.container.find("."+this.cssClasses.Feedback+"."+this.cssClasses.FeedbackError)};a.prototype.findSingleError=function(){return this.findFeedbackError().find("."+this.cssClasses.FeedbackText)};a.prototype.findMultiErrors=function(){return this.findFeedbackError().find("ol > li")};a.prototype.filterMultiErrors=function(a,b){return b.filter(function(b,c){return $(c).text()===a})};return a}();
e.FeedbackBuilder=a})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function a(a,c){this.utility=a;this.ajaxClient=c;this.setEventHandlersForBookings();this.updateBookingsAvailability();this.toggleBookingSection()}a.prototype.onDeleteBookingClick=function(a,c){c.IsNotAvailable?this.deleteBookingWithConfirmation(a,c):this.deleteBooking(a,c.BookableResourceId)};a.prototype.checkBookingsAvailability=function(a,c){var b=this;if(this.utility.controls.BookingsHolder.has("."+this.utility.settings.CssClasses.Statuses.Unknown).length)a();
else{var h=this.utility.getEventDateValidationInputModel(e.CalendarControllerModels.EventValidationScope.BookingsAvailability);0===h.SelectedBookingIds.length?a():this.ajaxClient.validateDateRelatedContent(h).done(this.createBookingsAvailabilityValidatedBeforeSubmitConfirmationHandler(h,a,c)).fail(function(){b.setBookingsAvailabilityUnknown();c()})}};a.prototype.setEventHandlersForBookings=function(){var a=this,c=function(){var b;a.utility.controls.allDateAndTimePickers.each(function(a,c){$(c).val()||
(b=!0)});return b};this.utility.controls.allDateAndTimePickers.blur(function(){c()&&a.setBookingsAvailabilityUnknown()});this.utility.controls.OpenBookDialogButton.click(function(){window[a.utility.settings.ClientInstanceNames.ResourceBookerDialog].openDialog()});$(this.utility.controls.AddBookingsButton).click(function(){a.bookingDialogAfterOkClick()});$(this.utility.controls.CancelBookingDialogButton).click(function(){CssModal.closeDialog()})};a.prototype.handleBookingsAvailabilityValidated=function(a){var b=
this;this.utility.controls.BookingsHolder.find("span."+this.utility.settings.CssClasses.TooltipLink).remove();if(a&&a.BookingAvailabilityMessageTooltipTemplates.length){var g=function(a){var c=h.utility.controls.BookingsHolder.find(CCL.CommonFunctions.getDataSelector(h.utility.settings.DataAttributes.BookingForEvent)).filter(function(c,g){return(c=$(g).data(b.utility.settings.DataAttributes.BookingForEvent))&&c.BookableResourceId===a.BookableResourceId});c.find("span."+h.utility.settings.CssClasses.StatusColor).removeClass().addClass(h.utility.settings.CssClasses.StatusColor).addClass(h.getStatusCssClass(a.Status)).prop("title",
h.getStatusToolTip(a.Status,c.hasClass(h.utility.settings.CssClasses.BookingItemReserved)));if(a.MessageTooltipTemplate&&h.utility.settings.InitToolTipFunctionName&&h.utility.settings.ToolTipAddDatasourceItemMethod){var g=$("<span/>").text(h.utility.settings.Terms.IsNotAvailableForAllDays),d=a.BookableResourceId.toString();c.append(g);window[h.utility.settings.ToolTipAddDatasourceItemMethod](d,"",CCL.CommonFunctions.formatString(a.MessageTooltipTemplate,c.find("span."+h.utility.settings.CssClasses.StatusText).html()));
window[h.utility.settings.InitToolTipFunctionName](g,d)}},h=this,d=0;for(a=a.BookingAvailabilityMessageTooltipTemplates;d<a.length;d++)g(a[d])}else this.setBookingsAvailabilityUnknown()};a.prototype.createBookingsAvailabilityValidatedBeforeSubmitConfirmationHandler=function(a,c,g){var b=this;return function(h){if(h&&h.EventBookingAvailabilityResponse)if(h=h.EventBookingAvailabilityResponse,h.Result)c();else{var d=h.Text;a&&a.IsRecurring&&(d+="<br />"+h.ResourceDetails);b.utility.openConfirmSubmitDialog(d,
function(a){return a?c():g()})}}};a.prototype.bookingDialogAfterOkClick=function(){var a=JSON.parse(this.utility.controls.EventBookingsBookedIdsHidden.val());this.utility.controls.EventBookingsReservedIdsHidden.val(JSON.stringify(window[this.utility.settings.ClientInstanceNames.ResourceBookerGrid].getSelectedIds().map(Number).filter(function(b){return-1===a.indexOf(b)})));this.toggleBookingSection();CssModal.closeDialog();this.refreshReservedBookingList()};a.prototype.updateBookingsAvailability=function(){var a=
this,c=this.utility.getEventDateValidationInputModel(e.CalendarControllerModels.EventValidationScope.BookingsAvailability);0<c.SelectedBookingIds.length&&this.ajaxClient.validateDateRelatedContent(c).done(function(b){b&&b.EventBookingAvailabilityResponse&&a.handleBookingsAvailabilityValidated(b.EventBookingAvailabilityResponse)})};a.prototype.getStatusCssClass=function(a){switch(a){case f.BookableResourceStatuses.Available:return this.utility.settings.CssClasses.Statuses.Available;case f.BookableResourceStatuses.PartlyBooked:return this.utility.settings.CssClasses.Statuses.PartlyBooked;
case f.BookableResourceStatuses.Booked:return this.utility.settings.CssClasses.Statuses.Booked;default:return this.utility.settings.CssClasses.Statuses.Unknown}};a.prototype.getStatusToolTip=function(a,c){var b=this.utility.settings.Terms.Tooltips;switch(a){case f.BookableResourceStatuses.Available:return c?b.ReservedButNotBooked:b.ResourceIsBookedByYou;case f.BookableResourceStatuses.PartlyBooked:return this.utility.settings.IsRecurring?b.ResourceIsNotAvailableForAllDays:b.ResourceIsAlreadyBookedForAPartOfEventTime;
case f.BookableResourceStatuses.Booked:return b.ResourceIsAlreadyBookedByOtherPerson;default:return""}};a.prototype.refreshReservedBookingList=function(){var a=this;this.ajaxClient.getBookingMarkups({reservedBookingIds:JSON.parse(this.utility.controls.EventBookingsReservedIdsHidden.val()),clientInstanceName:this.utility.settings.ClientInstanceNames.Page}).done(function(b){a.utility.controls.BookingsHolder.find("> span."+a.utility.settings.CssClasses.BookingItemReserved).remove();a.utility.controls.BookingsHolder.append(b.markups);
a.updateBookingsAvailability()})};a.prototype.toggleBookingSection=function(){this.utility.controls.BookingsPanel.toggle(0<JSON.parse(this.utility.controls.EventBookingsBookedIdsHidden.val()).length||0<JSON.parse(this.utility.controls.EventBookingsReservedIdsHidden.val()).length)};a.prototype.deleteBookingWithConfirmation=function(a,c){var b=this;CCL.CommonFunctions.jAjaxConfirm(CCL.CommonFunctions.formatString(this.utility.settings.Terms.DeleteBookingConfirmationTextTemplate,CCL.CommonFunctions.htmlEncode(c.NameForConfirmation)),
CCL.CommonFunctions.formatString(this.utility.settings.Terms.RemoveTooltipTemplate,c.NameForConfirmation),this.utility.settings.Terms.Ok,this.utility.settings.Terms.CancelButton,function(g){g&&b.deleteBooking(a,c.BookableResourceId)})};a.prototype.deleteBooking=function(a,c){this.removeBookingIdFromHiddenField(this.utility.controls.EventBookingsBookedIdsHidden,c);this.removeBookingIdFromHiddenField(this.utility.controls.EventBookingsReservedIdsHidden,c);a.parent().remove();this.toggleBookingSection()};
a.prototype.removeBookingIdFromHiddenField=function(a,c){if(a.val()){var b=JSON.parse(a.val());-1!==b.indexOf(c)&&(b.splice(b.indexOf(c),1),a.val(JSON.stringify(b)))}};a.prototype.setBookingsAvailabilityUnknown=function(){this.utility.controls.BookingsHolder.find("span."+this.utility.settings.CssClasses.StatusColor).addClass(this.utility.settings.CssClasses.Statuses.Unknown).prop("title","")};return a}();f.BookingWorker=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.fullCalendarWrapper=a;this.timeFormats=c;this.getIsoDateTime=function(a){return b.formatDate(a,b.timeFormats.LocalIsoFormat)};this.getFormattedDate=function(a,c){return b.formatDate(a,c)}}a.prototype.getEventFormattedDates=function(a,c){var b=a.getDate()!==c.getDate()||a.getMonth()!==c.getMonth()?this.timeFormats.twoDaysFormat:this.timeFormats.timeRangeFormat;return this.formatDates(a,c,b)};a.prototype.getEventFormattedDateAndTime=
function(a,c){var b=a.getDate()!==c.getDate()||a.getMonth()!==c.getMonth()?this.timeFormats.twoDaysFormat:this.timeFormats.DateAndTimeRangeFormat;return this.formatDates(a,c,b)};a.prototype.getShortDateTime=function(a){return this.formatDate(a,this.timeFormats.ShortDateAndTimeFormat)};a.prototype.getShortDate=function(a){return this.formatDate(a,this.timeFormats.shortDatePattern)};a.prototype.formatDate=function(a,c){return this.fullCalendarWrapper.formatDate(a,c)};a.prototype.formatDates=function(a,
c,g){return this.fullCalendarWrapper.formatDates(a,c,g)};return a}();e.DateFormatter=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b,c,g){var h=this;this.utilityBase=a;this.ajaxClientBase=b;this.datePickerClientInstanceName=c;this.timeSlotPickerClientInstanceName=g;$(function(){return h.getNextEventDatePicker().onDateSelectedFunction=function(a){return h.getNextEventTimeSlotPicker().updateFilteredTimeForDate(a.dateText,a.dateFilterId)}})}Object.defineProperty(d.prototype,"hasNextEvent",{get:function(){return 0<this.getNextEventId()},enumerable:!0,configurable:!0});d.prototype.getNextEventId=
function(){return parseInt(this.getNextEventTimeSlotPicker().getSelectedTimeSlotId(),10)||0};d.prototype.getNextEventDatePicker=function(){return window[this.datePickerClientInstanceName]};d.prototype.getNextEventTimeSlotPicker=function(){return window[this.timeSlotPickerClientInstanceName]};return d}();e.NextEventDateWorkerBase=f})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(a){function b(b,g){var c=this;a.call(this,b,g,b.settings.ClientInstanceNames.NextEventPicker,b.settings.ClientInstanceNames.NextEventTimeSlotPicker);this.utility=b;this.ajaxClient=g;$(function(){c.getNextEventDatePicker().getAvailableDatesFunction=function(a){return c.getAvailableDates(a)};c.getNextEventTimeSlotPicker().getAvailableTimeSlotsForDateFunction=function(a){return c.getAvailableTimeSlotsForDate(a)}})}__extends(b,a);b.prototype.setDefaultDate=
function(a){this.getNextEventDatePicker().setDefaultDate(a)};b.prototype.getAvailableDates=function(a){this.ajaxClient.getDatesOfEventsToBePickedAsNextEventForEditEventPage({courseId:this.utility.settings.LocationId,eventId:this.utility.settings.SingleActivityId,startDate:a.startDate,endDate:a.endDate,eventStopDateAsUserInputString:this.utility.controls.endDateInput.val(),eventStopTimeAsUserInputString:this.utility.controls.endTimeInput.val()}).done(function(b){return a.allowedDates=b})};b.prototype.getAvailableTimeSlotsForDate=
function(a){this.ajaxClient.getTimeSlotsOfEventsToBePickedAsNextEventForEditEventPage({courseId:this.utility.settings.LocationId,eventId:this.utility.settings.SingleActivityId,date:a.date,eventStopDateAsUserInputString:this.utility.controls.endDateInput.val(),eventStopTimeAsUserInputString:this.utility.controls.endTimeInput.val()}).done(function(b){return a.availableTimeSlots=b})};return b}(e.NextEventDateWorkerBase);f.NextEventDateWorker=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b,h,e,f,k){this.utility=a;var c=new d.ElementLinkAlternativeChoiceManager(a,b);this.addEventElementLinkManager=new d.AddEventElementLinkManager(a,b,h,e,{onUploadFromComputer:k.onUploadFromComputer},c);this.editEventElementLinkManager=new d.EditEventElementLinkManager(a,b,h,f,k,c);this.initEventHandlers()}a.prototype.initEventHandlers=function(){$(document).on("click","."+this.utility.settings.cssClasses.AddResourceMenuLink,function(a){d.ElementLinkManagerDialogBase.currentManager.onAddResourceMenuItemLinkClick(a)})};
return a}();d.ElementLinkManagerFactory=a})(e.ElementLink||(e.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(a){function b(b,c,d){a.call(this,b,c,{inlineEditContainer:b.settings.cssClasses.Title},{isNotEditableTooltip:""});this.ajaxClient=d}__extends(b,a);b.prototype.buildMarkup=function(b,c,d,e){a.prototype.buildCommonMarkup.call(this,b,c,c.editable&&(d||0<c.EventTitle.length),this.utility.settings.cssClasses.TitleLabel,this.utility.settings.terms.Title,this.getEditorBinding(c),d,null,!0,!1,e)};b.prototype.getTextContainerWatermark=function(a){return this.utility.settings.terms.Title};
b.prototype.getCachedText=function(a){return a.EventTitle};b.prototype.getCachedPlainText=function(a){return a.EventTitle};b.prototype.isPlainText=function(a){return!0};b.prototype.sendTextAjax=function(a,b){return this.ajaxClient.editEventTitle({EventId:a.activityId,Text:b,HasResources:a.bookedResources&&0<a.bookedResources.length||0<a.plansCount||a.hasAnyHomeworkElementConnected})};return b}(d.MarkupBuilderBase);d.TitleMarkupBuilder=a})(e.EventTextContent||(e.EventTextContent={}))})(e.Schedule||
(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c,g){var b=this;this.getFullCalendar=a;this.getCalendar=c;this.eventSourceNames=g;this.handleChildrensCalendarsChange=function(){b.refetchSourceByName(b.eventSourceNames.childrensCalendars)};this.handleOtherCalendarsChange=function(){b.refetchSourceByName(b.eventSourceNames.otherCalendars)};this.handleResourcesCalendarsChange=function(){b.refetchSourceByName(b.eventSourceNames.resourceCalendars)}}a.prototype.addEventForSource=function(a,
c){this.getFullCalendar().fullCalendar("renderEventForSource",a,c)};a.prototype.addEventForSourceByName=function(a,c){c in this.getCalendar().eventSources&&(c=this.getCalendar().eventSources[c],this.addEventForSource(a,c));this.refetchSourceByName(this.eventSourceNames.otherCalendars);this.refetchSourceByName(this.eventSourceNames.childrensCalendars)};a.prototype.changeView=function(a){this.getFullCalendar().fullCalendar("changeView",a)};a.prototype.getDate=function(){return this.getFullCalendar().fullCalendar("getDate")};
a.prototype.getFirstDay=function(){return this.getFullCalendar().fullCalendar("option","firstDay")};a.prototype.getView=function(){return this.getFullCalendar().fullCalendar("getView")};a.prototype.getViewName=function(){return this.getView().name};a.prototype.refetchAll=function(){this.getFullCalendar().fullCalendar("refetchEvents")};a.prototype.refetchEvents=function(a,c){this.handleOtherCalendarsChange();this.handleChildrensCalendarsChange();a=this.getFullCalendar().fullCalendar("clientEvents",
a);0<a.length&&this.getCalendar().refetchEvents(a,c)};a.prototype.refetchSourceByName=function(a){a in this.getCalendar().eventSources&&(a=this.getCalendar().eventSources[a],this.getFullCalendar().fullCalendar("refetchSource",a))};a.prototype.removeEvent=function(a){this.getFullCalendar().fullCalendar("removeEvents",a)};a.prototype.removeEvents=function(a){this.getFullCalendar().fullCalendar("removeEvents",a)};a.prototype.render=function(){this.getFullCalendar().fullCalendar("render")};a.prototype.select=
function(a,c,g){this.getFullCalendar().fullCalendar("select",a,c,g)};a.prototype.unselect=function(){this.getFullCalendar().fullCalendar("unselect")};a.prototype.formatDate=function(a,c){return this.getFullCalendar().fullCalendar("formatDate",a,c)};a.prototype.formatDates=function(a,c,g){return this.getFullCalendar().fullCalendar("formatDates",a,c,g)};return a}();e.FullCalendarWrapper=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){this.utility=a}a.prototype.buildBookingsIcon=function(a,c){$("<span>").addClass(this.utility.settings.cssClasses.FcEventInlineIcon).prop("title",CCL.CommonFunctions.formatString(this.utility.settings.terms.bookingsFormat,c)).append(this.utility.settings.InlineIcons.Bookings).appendTo(a)};a.prototype.buildHideButtonIcon=function(a,c,g){var b=document.createElement("button");b.type="button";b.setAttribute("aria-label",this.utility.settings.terms.Hide);
b.onclick=g;b.appendChild(this.createImageNode(this.utility.settings.urls.informationFeedbackCloseImage,c,this.utility.settings.terms.Hide));a.appendChild(b)};a.prototype.buildAttendanceEventButton=function(a,c,g,h,d,e){void 0===d&&(d="");void 0===e&&(e=!1);g=$("<button>").prop("type","button").prop("disabled",c).addClass(this.utility.settings.cssClasses.EventInlineButton).attr({title:g,"aria-label":g});d&&0<d.length&&(d=$("<span>").addClass(this.utility.settings.cssClasses.EventAttendanceButtonText).append(d),
g.append(d));g.append(this.utility.settings.InlineIcons.RegisterAttendance);!c&&h&&g.click(h);e?$("<span>").addClass(this.utility.settings.cssClasses.FcEventInlineButton).append(g).appendTo(a):g.appendTo(a)};a.prototype.buildColorIcon=function(a,c,g){c=$("<span>").addClass(c).addClass(this.utility.settings.cssClasses.EventItemColor);g?c.prependTo(a):c.appendTo(a)};a.prototype.replaceColorIcon=function(a,c){a.className=this.utility.settings.cssClasses.EventItemColor+" "+c};a.prototype.buildDeleteEventButton=
function(a){var b=$("<button>").prop("type","button").addClass(a?this.utility.settings.cssClasses.MarginRight10:this.utility.settings.cssClasses.MarginRight15).attr({title:this.utility.settings.terms.deleteEventTooltip,"aria-label":this.utility.settings.terms.deleteEventTooltip}).append(this.utility.settings.InlineIcons.Trashcan);a&&b.attr("data-eventdetails-delete","");return b};a.prototype.buildCopyIcon=function(a){a.innerHTML=this.utility.settings.InlineIcons.Copy;a.title=this.utility.settings.terms.CopyEvent;
a.setAttribute("aria-label",this.utility.settings.terms.CopyEvent);return a};a.prototype.buildEditEventIcon=function(a,c,g,h){a=$("<a>").append(this.utility.settings.InlineIcons.Edit).addClass(c).prop("href",g).attr({title:this.utility.settings.terms.editEventTooltip,"aria-label":this.utility.settings.terms.editEventTooltip}).appendTo(a);h&&a.click(h)};a.prototype.buildGroupIcon=function(a,c,g){$("<span>").addClass(this.utility.settings.cssClasses.FcEventInlineIcon).append(this.utility.settings.InlineIcons.Users).prop("alt",
this.utility.settings.terms.group).prop("title",c?this.utility.settings.terms.group:this.utility.settings.terms.group+": ("+g+")").appendTo(a);c&&$("<span>").addClass(this.utility.settings.cssClasses.ColorGrey).addClass(this.utility.settings.cssClasses.EventItemIconText).text(g).appendTo(a)};a.prototype.buildHomeworkIcon=function(a){$("<span>").addClass(this.utility.settings.cssClasses.FcEventInlineIcon).prop("title",this.utility.settings.terms.homeworkIconToolTip).append(this.utility.settings.InlineIcons.Homework).appendTo(a)};
a.prototype.buildLockIcon=function(a,c,g){var b=$("<span>").addClass(this.utility.settings.cssClasses.LockIcon).append(this.utility.settings.InlineIcons.Lock);c?$("<div>").addClass(this.utility.settings.cssClasses.LockInformationContainer).append(b).append($("<span>").text(g)).prependTo(a):b.prependTo(a)};a.prototype.buildPlannerButtonIcon=function(a,c,g){c=$("<button>").prop("type","button").prop("title",c).addClass(this.utility.settings.cssClasses.EventInlineButton).click(g).append(this.utility.settings.InlineIcons.Plans);
$("<span>").addClass(this.utility.settings.cssClasses.FcEventInlineButton).append(c).appendTo(a)};a.prototype.buildRecurringIcon=function(a){var b=this.createImageNode(this.utility.settings.urls.recurringImageUrl,this.utility.settings.constants.IconSize,this.utility.settings.terms.recurringTooltip);b.classList.add(this.utility.settings.cssClasses.VerticalAlignMiddle);b.classList.add(this.utility.settings.cssClasses.MarginLeft5);a.append($(b))};a.prototype.createImageNode=function(a,c,g){var b=document.createElement("img");
b.src=a;b.width=c;b.height=c;b.alt="";b.title=g;return b};return a}();e.IconBuilder=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b,h,e,f,k,p,n,q,v){this.utility=a;this.dateFormatter=b;this.showInformationFeedbackForContextDialog=h;this.toggleEventSettings=e;this.extraDescriptionMarkupBuilder=f;this.nextEventMarkupBuilder=new d.NextEventMarkupBuilder(this.utility,this.dateFormatter);this.addEventDialogNextEventDateWorker=new d.AddEventDialogNextEventDateWorker(this.utility,k,p,q);this.editEventDialogNextEventDateWorker=new d.EditEventDialogNextEventDateWorker(this.utility,
k,v)}a.prototype.initNextEventForAddDialog=function(){var a=this;this.setOnChangeDatePickerEvent(this.utility.controls.NextEvent.AddEventDatePickerContainer,this.addEventDialogNextEventDateWorker);this.utility.controls.NextEvent.AddEventDatePickerButton.one("click",function(){$(a.addEventDialogNextEventDateWorker.getNextEventDatePicker()).on(a.utility.settings.constants.NextEventDateSetEventName,function(){a.utility.controls.addEventCalendarsDropdown.is(":disabled")||a.toggleEventSettings(!0)});$(a.addEventDialogNextEventDateWorker.getNextEventDatePicker()).on(a.utility.settings.constants.NextEventDateClearedEventName,
function(){a.utility.controls.addEventCalendarsDropdown.is(":disabled")&&a.toggleEventSettings(!1)})})};a.prototype.buildContainerForEditEvent=function(a,b,h){var c=this,g=a.editable&&!h,d=a.showExtraDescription&&(0<a.NextEventId||g);(a.showExtraDescription&&(a.extraDescription||g)||d)&&this.extraDescriptionMarkupBuilder.buildMarkup(b,a,!h,function(){d&&(c.nextEventMarkupBuilder.buildMarkup(b,g,a),g&&c.initializeNextEventHandlers(a))})};a.prototype.isEditDialogEditMode=function(){return this.editEventDialogNextEventDateWorker.isInEditMode()};
a.prototype.initializeNextEventHandlers=function(a){this.editEventDialogNextEventDateWorker.nextEventQueryArgs={nextEvent:{eventId:a.NextEventId,eventStart:a.NextEventStart},courseId:a.courseId,eventId:a.activityId,eventStopDateTimeAsIsoString:JSON.stringify(this.dateFormatter.getIsoDateTime(a.end))};var b=this.utility.controls.NextEvent.EditEventDatePickerContainer.find("."+this.utility.settings.cssClasses.DatePickerInput),c=this.editEventDialogNextEventDateWorker.getNextEventDatePicker();this.utility.controls.NextEvent.EditEventDatePickerContainer.find(".ui-datepicker-trigger").remove();
b.removeClass("hasDatepicker");c.initialize();this.editEventDialogNextEventDateWorker.getNextEventTimeSlotPicker().initialize();0<a.NextEventId&&this.editEventDialogNextEventDateWorker.setDateTimePickerValues();this.setOnChangeDatePickerEvent(this.utility.controls.NextEvent.EditEventDatePickerContainer,this.editEventDialogNextEventDateWorker);if(a.recurring)this.utility.controls.NextEvent.EditEventDatePickerButton.on("click",this.showInformationFeedbackForContextDialog)};a.prototype.setOnChangeDatePickerEvent=
function(a,b){var c=this;a.on("change","input, select",function(){return c.updateDateTimeLabel(b)})};a.prototype.updateDateTimeLabel=function(a){var b=a.getNextEventTimeSlotPicker().getSelectedTimeSlot();a.getDatePickerButton().find("."+this.utility.settings.cssClasses.NextEventButtonText).text(b?this.dateFormatter.getEventFormattedDateAndTime(CCL.SerializableDateTimeConverter.toDateWithSeconds(b.EventStartLocal),CCL.SerializableDateTimeConverter.toDateWithSeconds(b.EventStopLocal)):this.utility.settings.terms.PickDate)};
return a}();d.NextEventManager=a})(e.NextEvent||(e.NextEvent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b,c){var g=this;this.utility=a;this.container=b;this.inputValidatorParameters=c;this.modernInput=new CCL.ModernInput({EditorTextarea:this.utility.cssClassesBase.ModernInputTextEditor,TextIsValid:this.utility.cssClassesBase.ModernInputTextIsValid},{TextValidationErrorMessage:this.utility.dataAttributeNames.InputValidationMessage});var h=b.find("textarea, input").first();if(h.length){var e=new CCL.CallbackDebouncer(function(){return h.val(d.cleanUpLineBreaks(h.val()))});
h.on("input",function(){return g.validateOnInput(h)}).on("paste",function(){return e.invokeCallback(void 0,50)})}}d.cleanUpInputValue=function(a){return a?d.cleanUpLineBreaks(a).replace(/\s{2,}/g," ").trim():""};d.prototype.createValidationMessageContainer=function(){$("<span>").addClass(this.inputValidatorParameters.errorMessageClass).attr("data-"+this.utility.dataAttributeNames.InputValidationMessage,"").appendTo(this.container)};d.prototype.resetValidation=function(){this.validate(!0)};d.cleanUpLineBreaks=
function(a){return a.replace(/\r?\n/g,"")};d.prototype.validateOnInput=function(a){a=this.inputValidatorParameters.inputValidationFunction(d.cleanUpInputValue(a.val()));this.validate(a)};d.prototype.validate=function(a){this.modernInput.toggleTextError(this.container.parent(),this.inputValidatorParameters.errorMessageText,!a);if(this.inputValidatorParameters.onValidateFunction)this.inputValidatorParameters.onValidateFunction(a)};return d}();e.InputValidator=f})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));var UploadStatus;(function(f){f[f.Awaiting=0]="Awaiting";f[f.InProgress=1]="InProgress";f[f.Succeeded=2]="Succeeded";f[f.SucceededWithErrors=3]="SucceededWithErrors";f[f.Failed=4]="Failed"})(UploadStatus||(UploadStatus={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.settings=a;this.handleSubmitButtonBehaviour=function(a){b.lockSubmitButton(a===UploadStatus.InProgress)};this.isUploaderDirty=function(){var a=window[b.settings.ClientIds.UploaderControl];return!!a&&0<a.uploadedItems.uploadMetadataArray.length+a.uploadedItems.fileInCloudMetadataArray.length};window[a.ClientInstanceName]=this;this.$form=$("#"+this.settings.ClientIds.PageForm);this.$submitButton=$("#"+this.settings.ClientIds.SubmitButton);
this.$cancelButton=$("#"+this.settings.ClientIds.CancelButton);this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.$form,this.settings.Terms.BeforeUnloadWarningMessage,{cancelButtonId:this.settings.ClientIds.CancelButton,callback:this.isUploaderDirty});this.lockSubmitButton(!1)}d.prototype.lockSubmitButton=function(a){this.$submitButton.toggleHyperlink(!a)};return d}();e.EditPortfolioItemControl=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.input=a;this.serialize=b}Object.defineProperty(d.prototype,"dateValue",{get:function(){return this.date},set:function(a){this.date=a;this.input.val(this.serialize(a))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"stringValue",{get:function(){return this.input.val()},enumerable:!0,configurable:!0});return d}();e.DateInputWrapper=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(a){function b(b,c,d){a.call(this,b,c,{inlineEditContainer:b.settings.cssClasses.Description},{isNotEditableTooltip:b.settings.terms.eventDescriptionNotEditableTooltip});this.ajaxClient=d}__extends(b,a);b.prototype.buildMarkup=function(b,c,d,e){void 0===e&&(e=null);a.prototype.buildCommonMarkup.call(this,b,c,c.editable||!!e||c.PreviousEventExtraDescription&&0<c.PreviousEventExtraDescription.length&&0<c.description.length,this.utility.settings.cssClasses.DescriptionLabel,
this.utility.settings.terms.DescriptionLabel,this.getEditorBinding(c),d,e)};b.prototype.getTextContainerWatermark=function(a){return 0===a.courseId?this.utility.settings.terms.otherEventDescriptionWatermark:this.utility.settings.customerSettings.enableFrenchCalendarLayout?this.utility.settings.terms.courseEventPastDescriptionWatermark:this.utility.settings.terms.courseEventDescriptionWatermark};b.prototype.getCachedText=function(a){return a.description};b.prototype.getCachedPlainText=function(a){return a.descriptionPlainText};
b.prototype.isPlainText=function(a){return a.isPlainTextInDescription};b.prototype.sendTextAjax=function(a,b){return this.ajaxClient.editEventDescription({EventId:a.activityId,Text:b,HasResources:a.bookedResources&&0<a.bookedResources.length||0<a.plansCount||a.hasAnyHomeworkElementConnected})};return b}(d.MarkupBuilderBase);d.DescriptionMarkupBuilder=a})(e.EventTextContent||(e.EventTextContent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(a){function b(b,c,d){a.call(this,b,c,{inlineEditContainer:b.settings.cssClasses.DescriptionExtra},{isNotEditableTooltip:b.settings.terms.eventExtraDescriptionNotEditableTooltip});this.ajaxClient=d}__extends(b,a);b.prototype.buildMarkup=function(b,c,d,e){a.prototype.buildCommonMarkup.call(this,b,c,c.editable||0<c.NextEventId||0<c.extraDescription.length,this.utility.settings.cssClasses.DescriptionExtraHeader,this.utility.settings.terms.extraDescriptionLabel,
this.getEditorBinding(c),d,e)};b.prototype.buildPreviousExtraDescriptionMarkup=function(a,b,c){this.buildSectionTitle(a,this.utility.settings.cssClasses.PreviousEventExtraDescriptionLabel,this.utility.settings.terms.PreviousEventExtraDescriptionLabel);$("<div>").addClass(this.utility.settings.cssClasses.PreviousEventExtraDescription).appendTo($("<div>").addClass(this.utility.settings.cssClasses.PreviousEventContainer).addClass(this.utility.settings.cssClasses.UserInput).appendTo(a)).html(b).append($("<div>").text(c).addClass(this.utility.settings.cssClasses.PreviousEventDateLabel))};
b.prototype.getTextContainerWatermark=function(a){return this.utility.settings.terms.courseEventFutureDescriptionWatermark};b.prototype.getCachedText=function(a){return a.extraDescription};b.prototype.getCachedPlainText=function(a){return a.extraDescriptionPlainText};b.prototype.isPlainText=function(a){return a.isPlainTextInExtraDescription};b.prototype.sendTextAjax=function(a,b){return this.ajaxClient.editEventExtraDescription({EventId:a.activityId,Text:b,HasResources:a.bookedResources&&0<a.bookedResources.length||
0<a.plansCount||a.hasAnyHomeworkElementConnected})};return b}(d.MarkupBuilderBase);d.ExtraDescriptionMarkupBuilder=a})(e.EventTextContent||(e.EventTextContent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(a,b){this.utility=a;this.ajaxClient=b}a.prototype.attachAddResourceButtonClickHandler=function(a){var b=this;this.dialogContainer=a.mainContainer;a.mainContainer.on("click",this.utility.selectors.addElementButton,function(c){var g=$(c.currentTarget);if(!g.prop("disabled")){var h=b.utility.getAddResourceMenuParameters(g),d=function(){var c=b.getAlternativeChoice(h);c.openDialog(g,e.CalendarClientConstants.alternativeChoiceDialogOffsetY);
CCL.CommonFunctions.isPhoneScreenSize()&&c.updateOffsetAccordingToContainerHeight(a.mainContainer);a.setToggleElement($("."+b.utility.settings.cssClasses.ElementSelectorContainer).add($("."+b.utility.settings.cssClasses.CssModal)).add(c.getMask()))};if(b.getAlternativeChoice(h))d();else{var f=new e.CalendarBouncingDots(g,b.utility.settings.cssClasses.BouncingDotContainer,b.utility.settings.cssClasses.BouncingDot);g.prop("disabled",!0);b.ajaxClient.getAddResourceMenu(h).done(function(a){f.removeDotContainer();
g.prop("disabled",!1);$("body").append(a);d()})}}})};a.prototype.getDialogContainer=function(){return this.dialogContainer};a.prototype.getAlternativeChoice=function(a){return window[CCL.CommonFunctions.formatString(this.utility.settings.constants.AlternativeChoiceTemplate,a.CourseId)]};return a}();d.ElementLinkAlternativeChoiceManager=a})(f.ElementLink||(f.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.Calendar||(f.Calendar={});f=f.Schedule||(f.Schedule={});f=f.EventDetailsType||(f.EventDetailsType={});f[f.ListView=1]="ListView";f[f.ContextDialog=2]="ContextDialog"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){this.utility=a;this.combinedClasses={expandableSection:this.utility.settings.cssClasses.ExpandableContainer+" "+this.utility.settings.cssClasses.ExpandableSection,expandableHeaderArrowCollapsed:this.utility.settings.cssClasses.Icon+" "+this.utility.settings.cssClasses.IconArrowForward+" "+this.utility.settings.cssClasses.IconColorDefault,expandableHeaderArrowExpanded:this.utility.settings.cssClasses.Icon+" "+this.utility.settings.cssClasses.IconArrowDown+
" "+this.utility.settings.cssClasses.IconColorDefault}}a.prototype.buildExpandableContainer=function(a,c,g,h,d){var b=this;h=(void 0===h?{}:h).isExpanded;h=void 0===h?!1:h;c=$("<section>").addClass(this.combinedClasses.expandableSection).append($("<div>").addClass(this.utility.settings.cssClasses.ExpandableContainerHeader).append($("<i>").addClass(h?this.combinedClasses.expandableHeaderArrowExpanded:this.combinedClasses.expandableHeaderArrowCollapsed)).append($("<span>").append(c))).append($("<div>").addClass(this.utility.settings.cssClasses.ExpandableContainerContent).append(g));
a.append(c);return new ExpandableContainer(c,{isExpanded:h,onToggleCallback:function(a,c){c.find(b.utility.selectors.expandableContainerHeaderIcon).toggleClass(b.utility.settings.cssClasses.IconArrowForward,!a).toggleClass(b.utility.settings.cssClasses.IconArrowDown,a);d&&d()}})};return a}();e.ExpanderBuilder=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.tooltip=a;this.controls=c;this.topTooltipSettings={My:"center bottom",At:"center top-10",Arrow:"top"};this.rightTooltipSettings={My:"left center",At:"right+10 center",Arrow:"right"};this.openTooltip=function(){return b.tooltip.openTooltip(b.controls.HoverTarget,b.isTooltipTopOriented?b.topTooltipSettings:b.rightTooltipSettings)}}Object.defineProperty(a.prototype,"isTooltipTopOriented",{get:function(){return!0},
enumerable:!0,configurable:!0});a.prototype.closeTooltip=function(){this.tooltip.closeTooltip()};return a}();e.TooltipToggler=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(a){function b(){var b=this;a.apply(this,arguments);this.beginOpenTooltip=function(){b.clearTimeouts();b.openTimeout=setTimeout(b.openTooltip,200)};this.beginCloseTooltip=function(){b.clearTimeouts();b.closeTimeout=setTimeout(function(){return b.closeTooltip()},1E3)}}__extends(b,a);b.prototype.beginListeningTooltipEvents=function(){this.clearTimeouts();this.controls.HoverTarget.on("mouseover",this.beginOpenTooltip);this.controls.HoverTarget.on("mouseleave",
this.beginCloseTooltip)};b.prototype.endListeningTooltipEvents=function(){this.clearTimeouts();this.controls.HoverTarget.off("mouseover",this.beginOpenTooltip);this.controls.HoverTarget.off("mouseleave",this.beginCloseTooltip)};b.prototype.clearTimeouts=function(){clearTimeout(this.openTimeout);clearTimeout(this.closeTimeout)};return b}(e.TooltipToggler);e.TooltipTogglerForMouseDevice=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(a){function b(){var b=this;a.apply(this,arguments);this.toggleTooltipMobile=function(a){$.contains(b.controls.HoverTarget.get(0),a.target)?b.openTooltip():b.closeTooltip()};this.onDeviceOrientationChanged=function(){return b.closeTooltip()}}__extends(b,a);Object.defineProperty(b.prototype,"toggleEventName",{get:function(){return CCL.CommonFunctions.isIosDevice()?"touchend":"click"},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"isTooltipTopOriented",{get:function(){return window.innerHeight>window.innerWidth},enumerable:!0,configurable:!0});b.prototype.beginListeningTooltipEvents=function(){$(document).on(this.toggleEventName,this.toggleTooltipMobile);$(window).on("orientationchange",this.onDeviceOrientationChanged)};b.prototype.endListeningTooltipEvents=function(){$(document).off(this.toggleEventName,this.toggleTooltipMobile);$(window).off("orientationchange",this.onDeviceOrientationChanged)};return b}(e.TooltipToggler);
e.TooltipTogglerForTouchDevice=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.controls=a;this.toggleControl=function(){b.tooltipToggler.closeTooltip();b.isRecurringChecked?(b.controls.HoverTarget.show(),b.tooltipToggler.beginListeningTooltipEvents()):(b.controls.HoverTarget.hide(),b.tooltipToggler.endListeningTooltipEvents())};c=new CCL.CustomTooltip("CalendarEditEventAddElementButtonDisabledTooltip",{contentContainer:this.controls.Content,zIndex:1},c.CustomTooltipCssClasses);this.tooltipToggler=
CCL.CommonFunctions.isMobileDevice()?new e.TooltipTogglerForTouchDevice(c,a):new e.TooltipTogglerForMouseDevice(c,a);this.controls.Content.show();this.toggleControl();this.controls.RecurringCheckbox.change(this.toggleControl)}Object.defineProperty(a.prototype,"isRecurringChecked",{get:function(){return this.controls.RecurringCheckbox.is(":checked")},enumerable:!0,configurable:!0});return a}();e.AddElementButtonDisabledTooltip=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b,c,g,h,d,e){this.dataAttributeNames=a;this.cssClassesBase=b;this.terms=c;this.clientInstanceNamesBase=g;this.postMessageNames=h;this.controlsBase=d;this.constants=e;this.dataAttributes=this.initDataAttributesCommon();this.selectors=this.initSelectorsCommon()}d.prototype.initSelectorsCommon=function(){return{addElementButton:"."+this.cssClassesBase.AddElementButton,elementExternalSourceComputer:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementExternalSource,f.AddResourceMenu.ElementExternalSourceType.Computer),
elementListContainer:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListContainer),elementListContainerHomework:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListContainerHomework),elementListCount:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListCount),elementListItem:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListItem)}};d.prototype.initDataAttributesCommon=function(){return{elementListContainer:"data-"+this.dataAttributeNames.ElementListContainer,
elementListContainerHomework:"data-"+this.dataAttributeNames.ElementListContainerHomework,elementListCount:"data-"+this.dataAttributeNames.ElementListCount,elementListItem:"data-"+this.dataAttributeNames.ElementListItem}};d.prototype.getElementForEventData=function(a){return a.data(this.dataAttributeNames.ElementListItem)};d.prototype.getElementExternalSourceType=function(a){return a.data(this.dataAttributeNames.ElementExternalSource)};d.prototype.getContentElementType=function(a){return a.data(this.dataAttributeNames.ContentElementType)};
d.prototype.getAddResourceMenuParameters=function(a){return a.data(e.CalendarClientConstants.dataAttributeNames.addResourceMenuParameters)};d.prototype.getElementId=function(a){return this.getElementForEventData(a).ElementId};d.prototype.getElementByElementId=function(a){return $("["+this.dataAttributes.elementListItem+'*=\'"ElementId":'+a+",']")};d.prototype.getAddedElementsCount=function(a){return a.find(this.selectors.elementListItem).length};d.prototype.toggleElementActivation=function(a){this.getElementByElementId(a).find("."+
this.cssClassesBase.ElementListTitle).toggleClass(this.cssClassesBase.ElementItemInactive)};d.prototype.toggleCalendarDropdown=function(a){var b=a.enabled?"":this.terms.CannotChangeCalendarBecauseOfNextEventTooltip;a.calendarDropdown.prop("disabled",!a.enabled);a.calendarDropdown.prop("title",b)};return d}();e.CalendarUtilityBase=k})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=e.CalendarControllerModels.EventValidationScope,a=function(a){function b(b,c){a.call(this,b.DataAttributes,b.CssClasses,b.Terms,b.ClientInstanceNames,b.PostMessageNames,c,b.CalendarClientConstants);this.settings=b;this.controls=c}__extends(b,a);b.prototype.getEventDateValidationInputModel=function(a){var b=this,c=this.getEventSettingsRecurring(),g=this.parseJsonIntList(this.controls.EventBookingsBookedIdsHidden.val()),e=this.parseJsonIntList(this.controls.EventBookingsReservedIdsHidden.val()),
f=this.settings.SingleActivityId,k=0;this.getWeekDayCheckboxes().each(function(a,c){a=$(c);a.is(":checked")&&(c=CCL.CommonFunctions.getDataSelector(b.settings.DataAttributes.WeekDayEnumValue),a=a.closest(c),k+=parseInt(a.data(b.settings.DataAttributes.WeekDayEnumValue),10))});var q=(a&d.BookingsAvailability)===d.BookingsAvailability;return{ValidationScope:a,StartDate:this.controls.startDateInput.val(),StartTime:this.controls.startTimeInput.val(),StopDate:this.controls.endDateInput.val(),StopTime:this.controls.endTimeInput.val(),
CourseId:this.settings.LocationId,RecurrenceEndDate:c.RecurrenceEndDate,IsRecurring:c.IsRecurring,IsSingle:!c.IsRecurring,WasIsSingle:this.settings.WasIsSingle,RepeatWeekCount:this.controls.repeatWeekCountSelect.val()||"0",WeekDaysEnumValue:k,SelectedBookingIds:""+$.merge(g,e),HidePartlyBookedBookingsForRecurringEvent:q&&0!==f,EventId:f}};b.prototype.getEventSettingsRecurring=function(){return{StartDate:this.controls.startDateInput.val(),RecurrenceEndDate:0<this.controls.recurrenceEndDateInput.length?
this.controls.recurrenceEndDateInput.val():"",IsRecurring:this.controls.recurringCheckbox.is(":checked")}};b.prototype.getWeekDayCheckboxes=function(){this.weekDayCheckboxes||(this.weekDayCheckboxes=this.controls.repeatWeekDaysList.find("input:checkbox"));return this.weekDayCheckboxes};b.prototype.isBookingsHandlingNeeded=function(){return this.settings.EnableBookings||this.hasAnyBookingsSelected()};b.prototype.hasAnyBookingsSelected=function(){return 0<this.parseJsonIntList(this.controls.EventBookingsBookedIdsHidden.val()).length||
0<this.parseJsonIntList(this.controls.EventBookingsReservedIdsHidden.val()).length};b.prototype.openConfirmSubmitDialog=function(a,b){CCL.CommonFunctions.jAjaxConfirm(a,this.settings.Terms.ConfirmationDialogTitle,this.settings.Terms.Ok,this.settings.Terms.CancelButton,b)};b.prototype.parseJsonIntList=function(a){return JSON.parse(a||"[]")};b.timeoutForDatesIntervalShiftingMilliseconds=200;b.timeoutForValidationAfterDateShiftedMilliseconds=b.timeoutForDatesIntervalShiftingMilliseconds+100;return b}(e.CalendarUtilityBase);
f.Utility=a})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.utilityBase=a;this.toggleSectionByItemCount=function(a){var c=a.getElementsByClassName(b.utilityBase.cssClassesBase.ElementList).item(0);a.style.display=c&&c.hasChildNodes()?"":"none"}}d.prototype.getFakeElement=function(){return $("#"+this.utilityBase.constants.FakeElementItemId)};d.prototype.getCurrentFakeElementTitle=function(){return this.getFakeElement().find("."+this.utilityBase.cssClassesBase.ElementListTitle).text()};
d.prototype.hasFakeElement=function(){return this.getFakeElement().is(":visible")};d.prototype.removeElement=function(a,b){var c=this;void 0===b&&(b=void 0);var g=a.closest(this.elementListSelector);a.slideUp(e.CalendarClientConstants.animationSpeedMilliseconds,function(){a.remove();c.afterRemoveElement(g,b)})};d.prototype.buildFakeElementMarkup=function(a){var b=document.createElement("li");b.id=this.utilityBase.constants.FakeElementItemId;b.setAttribute(this.utilityBase.dataAttributes.elementListItem,
"");var c=this.utilityBase.controlsBase.LoadingWheel[0];c.style.display="";var g=document.createElement("div");g.classList.add(this.utilityBase.cssClassesBase.ElementListItemContainer);var h=document.createElement("span");h.classList.add(this.utilityBase.cssClassesBase.ElementListTitle);h.classList.add(this.utilityBase.cssClassesBase.FontItalic);h.textContent=CCL.CommonFunctions.htmlEncode(a);g.appendChild(c);g.appendChild(h);b.appendChild(g);return b};d.prototype.buildElementListSectionMarkup=function(){return'<ul class="'+
this.utilityBase.cssClassesBase.ElementList+" "+this.utilityBase.cssClassesBase.GenericList+'" />'};d.prototype.afterRemoveElement=function(a,b){0===this.utilityBase.getAddedElementsCount(a)&&a.slideUp();b&&b()};return d}();e.ElementListMarkupBuilderBase=f})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(a){function b(b){a.call(this,b);this.utility=b;this.elementListSelector=this.utility.selectors.elementListContainer}__extends(b,a);b.prototype.buildElementListMarkup=function(a){0<a.ResourceCount&&this.utility.controls.ElementListSection.get(0).insertAdjacentHTML("beforeEnd",a.Resources);this.utility.settings.IsAddingHomeworkElementsEnabled&&0<a.HomeworkCount&&this.utility.controls.HomeworkElementListSection.get(0).insertAdjacentHTML("beforeEnd",
a.Homework)};b.prototype.addFakeItemIntoElementSection=function(a){a=this.buildFakeElementMarkup(a);var b=this.utility.controls.ElementListSection.get(0),c=b.getElementsByClassName(this.utility.cssClassesBase.ElementList);c.length||(b.insertAdjacentHTML("beforeEnd",this.buildElementListSectionMarkup()),c=b.getElementsByClassName(this.utility.cssClassesBase.ElementList));c[0].insertAdjacentHTML("beforeEnd",a.outerHTML);"none"===b.style.display&&(b.style.display="")};b.prototype.removeFakeItemFromElementSection=
function(){this.getFakeElement().remove();this.toggleSectionByItemCount(this.utility.controls.ElementListSection.get(0))};b.prototype.toggleAddResourceButtonAndSections=function(a){this.toggleAddButton(a);this.toggleSectionByItemCount(this.utility.controls.ElementListSection.get(0));this.utility.settings.IsAddingHomeworkElementsEnabled&&this.toggleSectionByItemCount(this.utility.controls.HomeworkElementListSection.get(0))};b.prototype.afterRemoveElement=function(b,g){var c=this;a.prototype.afterRemoveElement.call(this,
b,function(){c.toggleAddButton();g&&g()})};b.prototype.toggleAddButton=function(a){void 0===a&&(a=void 0);a=a||this.utility.getAddedElementsCount($(document));$(this.utility.selectors.addElementButton).toggle(a<this.utility.constants.MaxCountOfAddedElements)};return b}(e.ElementListMarkupBuilderBase);f.ElementListMarkupBuilder=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b,c,g){void 0===g&&(g=3);this.targetContainer=a;this.dotContainerCssClass=b;this.dotsCssClass=c;this.dotsCount=g;b=$("<div>").addClass(this.dotContainerCssClass);for(c=0;c<g;c++)b.append($("<div>").addClass(this.dotsCssClass));a.append(b)}d.prototype.removeDotContainer=function(){this.targetContainer.find("."+this.dotContainerCssClass).remove()};return d}();e.CalendarBouncingDots=f})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb=
{}));(function(f){f=f.Calendar||(f.Calendar={});f=f.CalendarClientConstants||(f.CalendarClientConstants={});f.animationSpeedMilliseconds=500;f.dataAttributeNames={addResourceMenuParameters:"add-resource-menu-parameters"};f.alternativeChoiceDialogOffsetY=-7;f.uploadingFileTimeoutMilliseconds=400})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(a){function b(b,c,d){a.call(this,b);this.utility=b;this.expanderBuilder=c;this.callbackOnSectionToggle=d;this.enableElementLinkManagement=!0;this.elementListSelector=this.utility.selectors.expandableContainer}__extends(b,a);b.prototype.renderAddButtonWithElementSections=function(a,b,c){this.enableElementLinkManagement=b.enableElementLinkManagement&&c!==f.EventDetailsType.ListView;c=a.find("."+this.utility.settings.cssClasses.SelectedElementListAppendTarget);
0===c.length&&(c=this.generateElementListAppendTarget(),a.append(c));this.enableElementLinkManagement&&!a.find("."+this.utility.settings.cssClasses.AddElementButton).length&&c.before($("<div>").addClass(this.utility.settings.cssClasses.MarginTop10).append(this.buildAddResourceButton({CourseId:b.courseId})));this.renderElementList(c,b.elementListMarkups)};b.prototype.generateElementListAppendTarget=function(){return $("<div>").addClass(this.utility.settings.cssClasses.SelectedElementListAppendTarget)};
b.prototype.generateAttachedElementsHidden=function(){return $("<input>").attr(this.utility.selectors.addEventDialogAttachedElementsHidden,"").prop("type","hidden").prop("value","[]")};b.prototype.addFakeItemIntoElementSection=function(a,b){a=this.buildFakeElementMarkup(a);b=this.utility.getElementListAppendTarget(b);var c=b.find(this.utility.selectors.elementListContainer),g=c.find("."+this.utility.cssClassesBase.ElementList);g.length?(g.append(a),a=this.utility.getExpandableContainer(c),a.is(":visible")||
a.show(),this.updateHeaderCounter(a)):(c=document.createElement("ul"),c.classList.add(this.utility.settings.cssClasses.ElementList),c.classList.add(this.utility.settings.cssClasses.GenericList),c.innerHTML=a.outerHTML,this.buildResourceListMarkup(b,{Homework:"",HomeworkCount:0,Resources:c.outerHTML,ResourceCount:1}))};b.prototype.removeFakeItemFromElementSection=function(){var a=this,b=this.getFakeElement(),c=b.closest("."+this.utility.cssClassesBase.ElementList);b.remove();if(c.length){var d=this.utility.getExpandableContainer(c);
setTimeout(function(){a.updateHeaderCounter(d);a.toggleSectionByItemCount(d.get(0))},e.CalendarClientConstants.uploadingFileTimeoutMilliseconds)}};b.prototype.renderElementList=function(a,b){b&&(this.utility.settings.customerSettings.enableHomework&&this.buildHomeworkListMarkup(a,b),this.buildResourceListMarkup(a,b),this.toggleAddElementButton(a.closest("."+this.utility.settings.cssClasses.ContextDialogContent)))};b.prototype.rebuildElementListMarkup=function(a,b){a=a.find("."+this.utility.settings.cssClasses.SelectedElementListAppendTarget);
a.find(this.utility.selectors.expandableContainer).remove();this.renderElementList(a,b);this.updateHeaderCounter(this.utility.getExpandableContainer(a.find(this.utility.selectors.elementListContainer)))};b.prototype.buildAddResourceButton=function(a){return $("<button type='button'>").addClass(this.utility.settings.cssClasses.AddElementButton).data(e.CalendarClientConstants.dataAttributeNames.addResourceMenuParameters,a).append($(this.utility.settings.InlineIcons.AddElement)).append(document.createTextNode(" ")).append($("<span>").text(this.utility.settings.terms.AddResourceDialogTitle))};
b.prototype.buildHeader=function(a,b){return $("<span>").text(a).append(" (").append($("<span>").attr(this.utility.dataAttributes.elementListCount,"").text(b)).append(")")};b.prototype.afterRemoveElement=function(b,c){var g=this;a.prototype.afterRemoveElement.call(this,b,function(){g.toggleAddElementButton(b.closest("."+g.utility.settings.cssClasses.ContextDialogContent));g.updateHeaderCounter(b);c&&c()})};b.prototype.buildHomeworkListMarkup=function(a,b){this.buildElementListMarkup(a,this.utility.settings.terms.HomeworkResourcesSectionTitle,
this.utility.dataAttributes.elementListContainerHomework,b.Homework,b.HomeworkCount)};b.prototype.buildResourceListMarkup=function(a,b){this.buildElementListMarkup(a,this.utility.settings.terms.ResourcesSectionTitle,this.utility.dataAttributes.elementListContainer,b.Resources,b.ResourceCount)};b.prototype.buildElementListMarkup=function(a,b,c,d,e){null!=d&&0<d.length&&(c=$("<div>").attr(c,"").append(d),this.enableElementLinkManagement||c.find("."+this.utility.settings.cssClasses.ElementListItemRemove).remove(),
this.expanderBuilder.buildExpandableContainer(a,this.buildHeader(b,e),c,{isExpanded:!0},this.callbackOnSectionToggle))};b.prototype.updateHeaderCounter=function(a){a.find(this.utility.selectors.elementListCount).text(this.utility.getAddedElementsCount(a))};b.prototype.toggleAddElementButton=function(a){var b=this.utility.getManuallyAddedElementsCount(a);a.find(this.utility.selectors.addElementButton).toggle(b<this.utility.constants.MaxCountOfAddedElements)};return b}(e.ElementListMarkupBuilderBase);
d.ElementListMarkupBuilder=a})(f.ElementLink||(f.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b,h,d,e,f,k){var c=this;this.container=a;this.utility=b;this.callbacks=h;this.binding=d;this.isAlwaysPlainText=e;this.isMultiline=f;this.inputValidationFunction=k;this.onEditFunction=function(a,b){a.actualText=a.actualText.replace(/[^\S\n]{2,}/g," ").trim();if(c.inputValidationFunction&&!c.inputValidationFunction(a.actualText))a.stopOnEdit=!0,a.isUpdateSuccess=!1,b(a);else{var g=c.isMultiline?CCL.CommonFunctions.replaceLineBreaksWithPTags(CCL.CommonFunctions.htmlEncode(a.actualText)):
a.actualText;c.callbacks.onTextSaved();c.binding.sendTextAjax(g).fail(function(){return a.isUpdateSuccess=!1}).always(function(){return b(a)})}};this.onChangeModeFunction=function(a){[c.cssClasses.ScheduleDialogSubheader,c.cssClasses.ShowMoreOptionsLink,c.cssClasses.ExpandableContainerHeader,c.cssClasses.ExpandableContainerContent].forEach(function(b){b=$("."+b);if(CCL.CommonFunctions.isIe()||CCL.CommonFunctions.isEdge())b=b.parent();b.css("pointer-events",a.isEditMode||c.callbacks.checkIfAnythingElseIsInEditMode()?
"none":"")});if(a.isEditMode)c.initEditMode();else{c.container.removeClass(c.cssClasses.TextContainerFocused);if(c.callbacks.onEditFinished)c.callbacks.onEditFinished();a.actualText?c.initViewModeWithChangedText():a.isNewTextSaved||c.textContainer.hasClass(c.cssClasses.TextContainerWatermark)?c.initViewModeWithWatermark():c.initViewModeWithInitialText()}};this.cssClasses=this.utility.settings.cssClasses;this.editorOptions={autoResize:!0,autoResizeAdditionalHeight:0,multiline:!0,editFieldCssClass:this.cssClasses.Width100Percent+
" "+this.cssClasses.ResizeNone+" "+this.cssClasses.UserInput,watermark:this.binding.watermarkText,watermarkCssClass:this.cssClasses.TextContainerWatermark,preventLineBreaksInMultilineMode:!f}}a.prototype.makeTextContentInlineEditable=function(){this.textContainer=this.container.find("."+this.cssClasses.UserInput);this.editorInstance=new ClientInlineEditor(this.textContainer,void 0,this.createHidden(),this.editorOptions,this.onEditFunction,this.onChangeModeFunction,void 0);this.textContainer.click()};
a.prototype.createHidden=function(){return $("<input type='hidden'>").val(this.binding.cachedPlainText).appendTo(this.container)};a.prototype.initEditMode=function(){this.callbacks.onEditStarted(this.binding.event);this.editorInstance.hideWatermark();this.container.addClass(this.cssClasses.TextContainerFocused)};a.prototype.initViewModeWithChangedText=function(){this.textContainer.removeClass(this.cssClasses.TextContainerWatermark);var a=this.isMultiline?CCL.CommonFunctions.replaceBrTagsWithPTags(this.textContainer.html()):
this.isAlwaysPlainText?this.textContainer.text():this.textContainer.html();this.setText(a);this.binding.cachedText=a};a.prototype.initViewModeWithWatermark=function(){this.textContainer.hasClass(this.cssClasses.TextContainerWatermark)||this.textContainer.addClass(this.cssClasses.TextContainerWatermark);this.textContainer.text(this.binding.watermarkText)};a.prototype.initViewModeWithInitialText=function(){this.setText(this.binding.cachedText)};a.prototype.setText=function(a){this.isAlwaysPlainText?
this.textContainer.text(a):this.textContainer.html(a)};return a}();d.InlineEditContent=a})(e.InlineEdit||(e.InlineEdit={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(a){function b(b,c,d,e){var g=this;a.call(this,b,c,d,e);this.utility=b;this.ajaxClient=c;this.setFocusOutEvent=function(){var a=g.getDatePickerContainer();a.on("focusout",function(){return setTimeout(function(){if((!g.getNextEventDatePicker().isPickerVisible()||g.getNextEventDatePicker().isPickerClosing())&&0===$(document.activeElement).closest(a).length)g.onFocusOut()})})}}__extends(b,a);b.prototype.setDatePickerButtonClick=function(){var a=
this;this.getDatePickerButton().one("click",this.setFocusOutEvent).click(function(){a.getNextEventDatePicker().setDefaultDate(a.getDefaultDate());a.toggleDatePicker(!0);a.getNextEventDatePicker().focus()})};b.prototype.getAvailableDates=function(a,b,c,d){this.ajaxClient.getDatesOfEventsToBePickedAsNextEventForSchedulePage({courseId:b,eventId:c,startDate:a.startDate,endDate:a.endDate,eventStopDateTimeAsIsoString:d}).done(function(b){return a.allowedDates=b})};b.prototype.getAvailableTimeSlotsForDate=
function(a,b,c,d){this.ajaxClient.getTimeSlotsOfEventsToBePickedAsNextEventForSchedulePage({courseId:b,eventId:c,date:a.date,eventStopDateTimeAsIsoString:d}).done(function(b){return a.availableTimeSlots=b})};b.prototype.resetDatePicker=function(){this.toggleDatePicker(!1);var a=this.getNextEventDatePicker();a.clearDateAndTime(!1);a.setDefaultDate(null)};b.prototype.isInEditMode=function(){return this.isEditMode};b.prototype.toggleDatePicker=function(a){this.getDatePickerContainer()[0].style.display=
a?"inline-flex":"none";this.getDatePickerButton()[0].style.display=a?"none":"inline-flex";this.isEditMode=a};b.prototype.onFocusOut=function(){this.toggleDatePicker(!1)};return b}(e.NextEventDateWorkerBase);d.AddEditEventDialogNextEventDateWorker=a})(f.NextEvent||(f.NextEvent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(a){function b(b,c,d,e){var g=this;a.call(this,b,c,b.settings.ClientInstanceNames.AddEventNextEventPicker,b.settings.ClientInstanceNames.AddEventNextEventTimeSlotPicker);this.utility=b;this.locationParser=d;this.addEventEndDateHiddenFieldWrapper=e;this.setDatePickerButtonClick();$(function(){g.getNextEventDatePicker().getAvailableDatesFunction=function(a){return g.getAvailableDates(a,g.getCourseId(),0,g.getEventStopDateTimeAsIsoString())};
g.getNextEventTimeSlotPicker().getAvailableTimeSlotsForDateFunction=function(a){return g.getAvailableTimeSlotsForDate(a,g.getCourseId(),0,g.getEventStopDateTimeAsIsoString())}})}__extends(b,a);b.prototype.resetDatePicker=function(){a.prototype.resetDatePicker.call(this);this.getDatePickerButton().find("span").text(this.utility.settings.terms.PickDate)};b.prototype.getDatePickerButton=function(){return this.utility.controls.NextEvent.AddEventDatePickerButton};b.prototype.getDatePickerContainer=function(){return this.utility.controls.NextEvent.AddEventDatePickerContainer};
b.prototype.getDefaultDate=function(){return new Date(this.utility.controls.addEventEndDateHiddenField.val())};b.prototype.getCourseId=function(){return this.locationParser.parseCourseId(this.utility.controls.addEventCalendarsDropdown.val())};b.prototype.getEventStopDateTimeAsIsoString=function(){return JSON.stringify(this.addEventEndDateHiddenFieldWrapper.stringValue)};return b}(d.AddEditEventDialogNextEventDateWorker);d.AddEventDialogNextEventDateWorker=a})(e.NextEvent||(e.NextEvent={}))})(e.Schedule||
(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(a){function b(b,c,d){var g=this;a.call(this,b,c,b.settings.ClientInstanceNames.EditEventNextEventPicker,b.settings.ClientInstanceNames.EditEventNextEventTimeSlotPicker);this.onNextEventSaved=d;$(function(){g.getNextEventDatePicker().getAvailableDatesFunction=function(a){return g.getAvailableDates(a,g.queryArgs.courseId,g.queryArgs.eventId,g.queryArgs.eventStopDateTimeAsIsoString)};g.getNextEventTimeSlotPicker().getAvailableTimeSlotsForDateFunction=
function(a){return g.getAvailableTimeSlotsForDate(a,g.queryArgs.courseId,g.queryArgs.eventId,g.queryArgs.eventStopDateTimeAsIsoString)}})}__extends(b,a);Object.defineProperty(b.prototype,"nextEventQueryArgs",{set:function(a){this.resetDatePicker();this.setDatePickerButtonClick();this.queryArgs=a;0<a.nextEvent.eventId&&this.setDateTimePickerValues()},enumerable:!0,configurable:!0});b.prototype.setDateTimePickerValues=function(){var a=this.getNextEventDatePicker();a.setDate(CCL.SerializableDateTimeConverter.toDateWithSeconds(this.queryArgs.nextEvent.eventStart));
var b=this.getNextEventTimeSlotPicker();b.updateFilteredTimeForDate(a.getDateAsString(),a.selectedFilterId);b.setSelectedTimeSlot(this.queryArgs.nextEvent.eventId);b.toggle(!0)};b.prototype.getDatePickerButton=function(){return this.utility.controls.NextEvent.EditEventDatePickerButton};b.prototype.getDatePickerContainer=function(){return this.utility.controls.NextEvent.EditEventDatePickerContainer};b.prototype.getDefaultDate=function(){return new Date(JSON.parse(this.queryArgs.eventStopDateTimeAsIsoString))};
b.prototype.onFocusOut=function(){a.prototype.onFocusOut.call(this);this.getNextEventId()!==this.queryArgs.nextEvent.eventId&&this.saveNextEvent()};b.prototype.saveNextEvent=function(){var a=this,b=this.getNextEventId();this.ajaxClient.editNextEventId({EventId:this.queryArgs.eventId,NextEventId:b}).done(function(){a.queryArgs.nextEvent.eventId=b;if(a.onNextEventSaved)a.onNextEventSaved(b)})};return b}(d.AddEditEventDialogNextEventDateWorker);d.EditEventDialogNextEventDateWorker=a})(e.NextEvent||(e.NextEvent=
{}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b){this.utility=a;this.dateFormatter=b}a.prototype.buildMarkup=function(a,b,h){h=0<h.NextEventId?this.dateFormatter.getEventFormattedDateAndTime(CCL.SerializableDateTimeConverter.toDateWithSeconds(h.NextEventStart),CCL.SerializableDateTimeConverter.toDateWithSeconds(h.NextEventStop)):void 0;b?(this.utility.controls.NextEvent.EditEventDatePickerButton.find("span").text(h||this.utility.settings.terms.PickDate),this.utility.controls.NextEvent.EditEventDatePickerButton.appendTo(a),
this.utility.controls.NextEvent.EditEventDatePickerContainer.appendTo(a)):h&&$("<div>").addClass(this.utility.settings.cssClasses.NextEventDateLabel).text(h).appendTo(a)};return a}();d.NextEventMarkupBuilder=a})(e.NextEvent||(e.NextEvent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e=function(){return function(e,d,a){var b=this;void 0===a&&(a=function(){});this.checkSessionUrl=e;this.anErrorOccurredTerm=d;this.onBeforeRedirect=a;this.handleAjaxError=function(a){var c=function(){b.onBeforeRedirect();window.top.location.href=b.checkSessionUrl},h=function(){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&alert(CCL.CommonFunctions.htmlDecode(b.anErrorOccurredTerm))};a.status===CCL.CommonConstants.httpStatusCodes.badRequest||a.status===CCL.CommonConstants.httpStatusCodes.unauthorized||
a.status===CCL.CommonConstants.httpStatusCodes.methodNotAllowed?$.ajax({type:"GET",url:b.checkSessionUrl}).done(function(a){return(a?c:h)()}).fail(c):h()}}}();f.CommonAjaxClient=e})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.clientInstanceName=a;this.settings=b;window[a]=this;this.modalDialogClientInstanceName=b.ModalDialogClientInstanceName;this.modalDialog=window[b.ModalDialogClientInstanceName];this.modalDialog.setPreferredSize(b.PreferredWidth,b.PreferredHeight)}d.prototype.openDialog=function(a,b,c,g){void 0===c&&(c=!1);void 0===g&&(g=!0);b=this.createIFrameUrl(a,b,c,g);this.modalDialog.setIframeUrl(b,!1);this.modalDialog.setTitle(a===e.CopyMoveElementDialogMode.Copy?
this.settings.Terms.CopyTo:this.settings.Terms.MoveTo);this.modalDialog.openDialog(!1)};d.prototype.closeDialog=function(){CssModal.closeDialog()};d.prototype.setCopyElementDialogHeight=function(a){this.modalDialog.setPreferredSize(0,a)};d.prototype.copyMoveOperationInProgress=function(a){var b=this;this.modalDialog.toggleDialogCloseButton(!a);this.modalDialog.getIframe().load(function(){b.modalDialog.toggleDialogCloseButton(!0)})};d.prototype.copyMoveOperationCompleted=function(a){window.dispatchEvent(new CustomEvent(this.settings.CopyMoveOperationCompletedEventName,
{detail:a}))};d.prototype.createIFrameUrl=function(a,b,c,g){a=this.settings.IframePageUrl+"?"+this.settings.RequestItems.Mode+"="+a+"&"+this.settings.RequestItems.ElementIds+"="+(Array.isArray(b)?encodeURIComponent(b.join(",")):b);c&&(a=a+"&"+this.settings.RequestItems.HideLocationDropdown+"="+c);g||(a=a+"&"+this.settings.RequestItems.ShowFeedback+"="+g);return a};return d}();e.CopyMoveElementDialog=f})(f.CopyMoveElementDialog||(f.CopyMoveElementDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.clientInstanceName=a;this.settings=b;window[a]=this;$(function(){c.$copyMoveButton=$("#"+c.settings.ClientIds.CopyMoveButton);c.$copyWithTreeLinksButton=$("#"+c.settings.ClientIds.CopyWithTreeLinksButton);c.$cancelButton=$("#"+c.settings.ClientIds.CancelButton);c.$courseAndProjectsDropDownList=$("#"+c.settings.ClientIds.CourseAndProjectDropDownList);c.$includeAnswersCheckBox=$("#"+c.settings.ClientIds.IncludeAnswersCheckBox);
c.$includeAnswersCheckBoxHidden=$("#"+c.settings.ClientIds.IncludeAnswersCheckBoxHiddenField);c.$overwriteAssessmentCriteriaCheckBox=$("#"+c.settings.ClientIds.OverwriteAssessmentCriteriaCheckBox);c.$overwriteAssessmentCriteriaCheckBoxHidden=$("#"+c.settings.ClientIds.OverwriteAssessmentCriteriaCheckBoxHiddenField);c.$treeMenu=$("#"+c.settings.ClientIds.TreeMenu);c.$viewPort=$("#"+c.settings.ClientIds.ViewPort);c.$lastSelected=$("."+c.settings.CssClasses.NodeClicked);c.treeLinksFeedback=window[c.settings.TreeLinksWarning.TreeLinksFeedbackName];
c.treeLinksWarning=c.settings.TreeLinksWarning;c.terms=c.settings.Terms;c.mode=c.settings.Mode;c.copyMovePostbackClientFunction=new Function(c.settings.ClientFunctions.CopyMovePostback);c.copyWithTreeLinksPostbackClientFunction=new Function(c.settings.ClientFunctions.CopyWithTreeLinksPostback);c.currentlyInProgress=!1;c.$copyMoveButton.prop("disabled",!0).removeAttr("onclick").click(function(){c.inProgress();c.copyMovePostbackClientFunction()});c.$copyWithTreeLinksButton.prop("disabled",!0).removeAttr("onclick").click(function(){c.inProgress();
c.copyWithTreeLinksPostbackClientFunction()});c.treeLinksWarning.ShowTreeLinksWarning&&(c.updateTreeLinksFeedbackAndButtons(c.treeLinksWarning.TreeLinksWarningMessage),c.$includeAnswersCheckBox.length&&c.$includeAnswersCheckBox.removeAttr("onclick").click(function(){c.updateTreeLinksWarningClientFunction()}));c.settings.ReloadFolder&&("function"===typeof window.top.reloadFolder&&window.top.reloadFolder(),c.notifyAboutProgress(!1));c.attachTreeMenuListeners();c.resized=!1;c.initializeDebouncer();$(window).resize(function(){c.debouncer.invokeCallback(0,
100)})})}d.prototype.updateTreeLinksFeedbackAndButtons=function(a){a&&a.HasTreeLinks?(this.treeLinksFeedback.showMessage(CCL.FeedbackType.Warning,a.TreeLinksWarningMessage),this.$copyWithTreeLinksButton.show(),this.$copyMoveButton.prop("value",this.mode===e.CopyMoveElementDialogMode.Copy?this.terms.CopySelectedResourceOnly:this.terms.Move)):(this.treeLinksFeedback.hide(),this.$copyWithTreeLinksButton.hide(),this.$copyMoveButton.prop("value",this.mode===e.CopyMoveElementDialogMode.Copy?this.terms.Copy:
this.terms.Move))};d.prototype.updateTreeLinksWarningClientFunction=function(){var a=this;$.ajax({url:this.treeLinksWarning.GetTreeLinksWarningMessageUrl.replace(/includeAnswers=((true)|(false))/ig,"includeAnswers="+this.$includeAnswersCheckBox.is(":checked")),dataType:"json"}).done(function(b){a.updateTreeLinksFeedbackAndButtons(b)})};d.prototype.closeDialog=function(){window.parent.closeCopyOrMoveElementsDialog?window.parent.closeCopyOrMoveElementsDialog():window.parent[this.settings.DialogClientInstanceName]&&
window.parent[this.settings.DialogClientInstanceName].closeDialog()};d.prototype.initializeDebouncer=function(){var a=this;this.debouncer=new CCL.CallbackDebouncer(function(){a.resized||(window.parent.setCopyOrMoveElementsDialogHeight?(a.resized=!0,window.parent.setCopyOrMoveElementsDialogHeight($("html").outerHeight(!0)+30)):window.parent[a.settings.DialogClientInstanceName]&&(a.resized=!0,window.parent[a.settings.DialogClientInstanceName].setCopyElementDialogHeight($("html").outerHeight(!0)+30)))})};
d.prototype.attachTreeMenuListeners=function(){var a=this;this.$treeMenu.on("loaded.jstree",function(){$("."+a.settings.CssClasses.Tree).show()});var b=this;this.$treeMenu.on("select_node.jstree",function(c,g){c=$("#"+a.settings.ClientIds.SelectedTreeNode);g=$(g.rslt.obj);if(g.hasClass(b.settings.CssClasses.TreeMenuTogglableNode))return c.val(""),a.$copyMoveButton.prop("disabled",!0),a.$copyWithTreeLinksButton.prop("disabled",!0),!1;!1===a.currentlyInProgress&&(a.$copyMoveButton.prop("disabled",!1),
a.$copyWithTreeLinksButton.prop("disabled",!1));c.val($(g).prop("id"));b.isScrolledIntoView(g)||$("html, body, div").scrollTop(g.offset().top+b.$viewPort.scrollTop()-$(g).height());g.focus();a.$lastSelected&&a.$lastSelected.removeClass(b.settings.CssClasses.NodeSelected);a.$lastSelected=g;a.$lastSelected&&b.$lastSelected.addClass(b.settings.CssClasses.NodeSelected);return!0});this.$treeMenu.on("open_node.jstree",function(a,g){a=$(g.rslt.obj);if(a.hasClass(b.settings.CssClasses.TreeMenuTogglableNode))b.$treeMenu.jstree("deselect_node",
a),b.$treeMenu.jstree("open_node",a),b.$lastSelected&&b.$lastSelected.addClass(b.settings.CssClasses.NodeClicked);else return!0});this.$treeMenu.on("close_node.jstree",function(c,g){c=$(g.rslt.obj);if(c.hasClass(b.settings.CssClasses.TreeMenuTogglableNode)||b.settings.CssClasses.Folder)b.$treeMenu.jstree("deselect_node",c),b.$treeMenu.jstree("close_node",c),b.$lastSelected&&a.$lastSelected.addClass(b.settings.CssClasses.NodeClicked);else return!0})};d.prototype.isScrolledIntoView=function(a){var b=
this.$viewPort.scrollTop(),c=b+this.$viewPort.height(),g=a.offset().top+b;a=g+a.height();return a>=b&&g<=c&&a<=c&&g>=b};d.prototype.inProgress=function(){this.currentlyInProgress=!0;this.$copyMoveButton.prop("disabled",!0).prop("value","").addClass(this.settings.CssClasses.InProgress);this.$copyWithTreeLinksButton.prop("disabled",!0).prop("value","").addClass(this.settings.CssClasses.InProgress);this.$cancelButton.prop("disabled",!0);this.$courseAndProjectsDropDownList.prop("disabled",!0);this.$includeAnswersCheckBox.length&&
(this.$includeAnswersCheckBoxHidden.val(this.$includeAnswersCheckBox.is(":checked").toString()),this.$includeAnswersCheckBox.prop("disabled",!0));this.$overwriteAssessmentCriteriaCheckBox.length&&(this.$overwriteAssessmentCriteriaCheckBoxHidden.val(this.$overwriteAssessmentCriteriaCheckBox.is(":checked").toString()),this.$overwriteAssessmentCriteriaCheckBox.prop("disabled",!0));this.notifyAboutProgress(!0)};d.prototype.notifyAboutProgress=function(a){window.parent.copyMoveOperationInProgress?window.parent.copyMoveOperationInProgress(a):
window.parent[this.settings.DialogClientInstanceName]&&window.parent[this.settings.DialogClientInstanceName].copyMoveOperationInProgress&&window.parent[this.settings.DialogClientInstanceName].copyMoveOperationInProgress(a)};return d}();e.CopyMoveElementDialogPage=f})(f.CopyMoveElementDialog||(f.CopyMoveElementDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.settings=a;$("table button[id*='_Delete_']").click(function(a){return b.onDeleteGroup(a)})}d.prototype.isAnyGroupSelected=function(){var a=$("[id^='"+this.settings.TableClientId+"_Select']:checked");return 0<a.length?1===a.length&&-1<a[0].id.toLowerCase().indexOf("selectall")?!1:!0:!1};d.prototype.onDeleteGroup=function(a){a=$(a.currentTarget);confirm(this.settings.DeleteConfirmation)&&__doPostBack(a.data("event-target"),"")};
return d}();e.Groups=f})(f.Courses||(f.Courses={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.onWorkloadEnableChanged=function(a){$("#"+b.settings.Controls.WorkloadEnableCheckbox).is(":checked")?b.$workloadEstimationSection.show():(b.$workloadEstimationHoursTextBox.val("0"),b.$workloadEstimationMinutesDropDown.val("00"),b.$workloadEstimationSection.hide())};window[a]=this;this.settings=c;$(function(){b.$workloadEstimationSection=$("#"+b.settings.Controls.WorkloadEstimationSection);b.$workloadEstimationHoursTextBox=
$("#"+b.settings.Controls.WorkloadEstimationHoursTextBox);b.$workloadEstimationHoursInputError=$("#"+b.settings.Controls.WorkloadEstimationHoursInputError);b.$workloadEstimationMinutesDropDown=$("#"+b.settings.Controls.WorkloadEstimationMinutesDropdown);b.$workloadEnableCheckbox=$("#"+b.settings.Controls.WorkloadEnableCheckbox);b.$workloadEnableCheckbox.on("click",function(a){return b.onWorkloadEnableChanged(a)});$("#"+b.settings.Controls.WorkloadEnableCheckbox).is(":checked")||b.$workloadEstimationSection.hide();
b.$workloadEstimationSection.on("change keyup",function(){$(document).trigger(b.settings.Events.WorkloadChangedClient)})})}a.prototype.onChange=function(a){this.onChangeHandler=a};a.prototype.isValid=function(){var a=$.isNumeric(this.$workloadEstimationHoursTextBox.val()),c=60*this.$workloadEstimationHoursTextBox.val()+1*this.$workloadEstimationMinutesDropDown.val();if(!a||0>c||599940<c)return this.$workloadEstimationHoursInputError.show(),this.$workloadEstimationHoursTextBox.addClass("itsl-workload-estimationhourseditbox-error"),
!1;this.$workloadEstimationHoursInputError.hide();this.$workloadEstimationHoursTextBox.removeClass("itsl-workload-estimationhourseditbox-error");return!0};a.prototype.getWorkloadEnabled=function(){return $("#"+this.settings.Controls.WorkloadEnableCheckbox).is(":checked")?!0:(this.$workloadEstimationHoursTextBox.val("0"),this.$workloadEstimationMinutesDropDown.val("00"),!1)};a.prototype.getWorkloadEstimation=function(){var a=60*this.$workloadEstimationHoursTextBox.val()+1*this.$workloadEstimationMinutesDropDown.val();
return 0>a||599940<a?-1:a};return a}();e.WorkloadSetting=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b){this.controls=a;this.settings=b;this.eventPreview=new e.Agenda.AgendaEventPreview(b.ClientInstanceNames.EventDialog,a.EventDialog,b.WebMethods.GetEventDetails,b.WidgetSettings);this.utility=new e.Agenda.AgendaUtility(b.DataAttributes,null);this.setupEventItemClick();this.setupOpenStartUpEvent()}a.prototype.setupOpenStartUpEvent=function(){var a=this;if(null!=this.settings.StartupEvent&&($(window).load(function(){a.eventPreview.open(a.settings.StartupEvent.Id,
a.settings.StartupEvent.Title,a.settings.StartupEvent.Category,a.settings.StartupEvent.Url,a.settings.StartupEvent.ColorSchema)}),window.parent&&window.parent.document&&window.parent.history)){var b=CCL.CommonFunctions.setQueryStringParameter(window.parent.location.href,this.settings.StartupEvent.EventParameterName,"");window.parent.history.replaceState({},window.parent.document.title,b)}};a.prototype.setupEventItemClick=function(){var a=this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.EventTimeRangeLink),
function(b){b=$(b.currentTarget);b.getIfHyperLinkEnabled()&&a.eventPreview.open(a.utility.getEventId(b),a.utility.getEventTitle(b),a.utility.getEventCategory(b),a.utility.getEventUrl(b),a.utility.getEventColorSchema(b))});this.controls.Container.on("click","."+this.settings.CssClasses.KeepAttendanceButton,function(b){$(b.currentTarget).prop("disabled")||(b=$(b.currentTarget).closest(CCL.CommonFunctions.getDataSelector(a.settings.DataAttributes.EventId)).data(a.settings.DataAttributes.EventId),a.openKeepAttendanceDialog(b));
return!1})};a.prototype.clearEventDialogContent=function(){this.eventPreview.resetDialog()};a.prototype.openKeepAttendanceDialog=function(a){var b=this;a=new CustomEvent(this.settings.EventNames.OpenKeepAttendanceDialog,{detail:{eventId:a}});document.dispatchEvent(a);var c=function(a){document.removeEventListener(b.settings.EventNames.CloseKeepAttendanceDialog,c);if(a.detail&&a.detail.eventId&&a.detail.saved){var g=b.settings.Terms.FeedbackMessage.replace("{0}",a.detail.eventDate+" "+a.detail.eventTime).replace("{1}",
CCL.CommonFunctions.htmlEncode(a.detail.courseName));CCL.InformationFeedback.showFeedback(b.controls.Container,g);var h=(g=0<a.detail.presentCount||0<a.detail.absentCount)?CCL.CommonFunctions.formatString(b.settings.Terms.AttendanceHasBeenKeptWithStatistics,a.detail.presentCount,a.detail.absentCount)+" "+b.settings.Terms.EditAttendance:b.settings.Terms.RegisterAttendance;b.getKeepAttendanceButton(a.detail.eventId).prop("title",h).prop("aria-label",h);b.getAttendanceStatisticsLabel(a.detail.eventId).toggle(g).text(g?
a.detail.presentCount+"/"+a.detail.absentCount:"")}};document.addEventListener(this.settings.EventNames.CloseKeepAttendanceDialog,c)};a.prototype.getKeepAttendanceButton=function(a){return this.getEventContainer(a).find("."+this.settings.CssClasses.KeepAttendanceButton)};a.prototype.getAttendanceStatisticsLabel=function(a){return this.getEventContainer(a).find("."+this.settings.CssClasses.AttendanceStatisticsLabel)};a.prototype.getEventContainer=function(a){return this.controls.Container.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.EventId,
a))};return a}();d.EventsContentBlock=a})(e.Events||(e.Events={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b,h,d){this.controlsModel=b;this.url=h;this.widgetSettings=d;this.eventDialog=window[a]}a.prototype.resetDialog=function(){this.resetNav();this.resetHeaderIcons();this.controlsModel.Content.empty();this.controlsModel.Footer.AttendanceSection.empty();this.controlsModel.AjaxLoading.hide()};a.prototype.resetHeaderIcons=function(){var a=this;this.controlsModel.Header.HeaderColorSchema.removeClass();Object.keys(this.controlsModel.Header.Icons).forEach(function(b){a.controlsModel.Header.Icons[b].Instance.hide()})};
a.prototype.resetNav=function(){this.setNav("#")};a.prototype.setNav=function(a){this.controlsModel.Footer.ShowMore.prop("href",a)};a.prototype.SetTitle=function(a,b,h){b in this.controlsModel.Header.Icons&&(this.controlsModel.Header.HeaderColorSchema.addClass(h),this.controlsModel.Header.Icons[b].Instance.show());this.controlsModel.Header.HeaderTitle.html(a)};a.prototype.open=function(a,b,h,d,e){this.resetDialog();this.SetTitle(b,h,e);this.setNav(d);this.eventDialog.openDialog(!1);this.loadEvent(this.createGetEventAjaxRequest(a))};
a.prototype.loadEvent=function(a){var b=this;this.currentLoadingSession&&this.currentLoadingSession.abort&&this.currentLoadingSession.abort();this.controlsModel.Content.empty();this.controlsModel.AjaxLoading.show();this.currentLoadingSession=a();this.currentLoadingSession.done(function(a){b.controlsModel.Content.html(a.Content);b.controlsModel.Footer.AttendanceSection.html(a.AttendanceOverview);b.eventDialog.adjustWindowSize()}).always(function(){b.controlsModel.AjaxLoading.hide();b.currentLoadingSession=
void 0})};a.prototype.createGetEventAjaxRequest=function(a){var b=this;return function(){return CCL.CommonFunctions.safeAjaxPost({url:b.url.replace("{eventId}",a),data:{widgetSettings:b.widgetSettings}})}};return a}();d.AgendaEventPreview=a})(e.Agenda||(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.controls=a;this.settings=b;e.addToOtherCoursesDialogClientInstance=this;this.modalDialog=window[this.dialogId];this.controls.CloseButton.click(function(a){CssModal.closeDialog()});this.controls.CourseSearchButton.click(function(a){c.inputSelectize.isOpen?c.inputSelectize.close():c.inputSelectize.open()});this.controls.AddButton.click(function(a){a.preventDefault();c.selectedCourses=c.inputSelectize.items?c.inputSelectize.items.map(function(a){return c.settings.CoursesAvailableToPostBulletinsTo.filter(function(b){return b.CourseId===
parseInt(a,10)})[0]}):[];if(c.onSaveCallback)c.onSaveCallback();CssModal.closeDialog()});this.modalDialog.setCustomScripts({afterCloseDialog:function(){c.modalDialog.clearLastActiveElement();c.inputSelectize.blur()},afterOpenDialog:function(){c.inputSelectize.close();c.inputSelectize.focus();setTimeout(function(){c.refreshSelectedCourses()},10)}});this.initSelectize()}Object.defineProperty(d.prototype,"dialogId",{get:function(){return this.controls.Container.prop("id")},enumerable:!0,configurable:!0});
d.prototype.openDialog=function(a,b){this.onSaveCallback=b;this.modalDialog.openDialog(!1);this.selectedCourses=a};Object.defineProperty(d.prototype,"selectedCourses",{get:function(){return this.selectedCoursesArray},set:function(a){this.selectedCoursesArray=a},enumerable:!0,configurable:!0});d.prototype.getAvailableCoursesCount=function(){return this.settings.CoursesAvailableToPostBulletinsTo.length};d.prototype.clear=function(){this.inputSelectize.clear(!0)};d.prototype.initSelectize=function(){var a=
this,b=this.controls.CourseSearchInput;b.selectize({valueField:"Value",plugins:{"selectize-plugin-a11y":{},remove_button:{title:this.settings.Terms.Remove},no_results:{message:this.settings.Terms.NoMatches}},searchField:["Label"],highlight:!1,openOnFocus:!0,closeAfterSelect:!0,preload:"focus",addPrecedence:!0,persist:!1,loadThrottle:null,maxOptions:this.settings.MaxNumberOfCoursesToSelect,placeholder:this.settings.Terms.FindCourses,diacritics:!1,render:{item:function(b,g){return'<div class="itsl-selectize-item"><span class = "'+
a.settings.CourseIconClass+" "+b.ColorSchemaCssClass+'"></span><span class = "itsl-selectize-item-label">'+g(b.Label)+"</span></div>"},option:function(b,g){return'<div class="itsl-selectize-option"><span class = "'+a.settings.CourseIconClass+" "+b.ColorSchemaCssClass+'"></span><span class = "itsl-selectize-option-label">'+g(b.Label)+"</span></div>"}},load:function(b,g){a.settings.CoursesAvailableToPostBulletinsTo.forEach(function(b){a.inputSelectize.addOption({Label:b.Title,Value:b.CourseId,ColorSchemaCssClass:b.ColorSchemaCssClass})});
a.inputSelectize.refreshOptions()},onItemAdd:function(){a.updateSearchInput();a.inputSelectize.$control[0].scrollTop=a.inputSelectize.$control[0].scrollHeight},onItemRemove:function(){a.updateSearchInput()},onFocus:function(){a.updateSearchInput()}});this.inputSelectize=b[0].selectize;this.inputSelectize.$control.click(function(){return a.inputSelectize.open()});this.inputSelectize.$control_input.keypress(function(a){a.which===CCL.CommonConstants.keyCodes.enter&&a.preventDefault()}).keyup(function(b){b.which===
CCL.CommonConstants.keyCodes.escape&&a.inputSelectize.isFocused&&b.stopPropagation()})};d.prototype.refreshSelectedCourses=function(){var a=this.selectedCourses?this.selectedCourses.map(function(a){return a.CourseId.toString()}):[];this.inputSelectize.setValue(a,!0)};d.prototype.updateSearchInput=function(){this.inputSelectize.loadedSearches={};this.inputSelectize.lastQuery=null;this.inputSelectize.refreshOptions()};return d}();e.AddToOtherCoursesDialog=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.clientInstanceName=a;this.settings=b;window[a]=this;this.modalDialogClientInstanceName=b.ModalDialogClientInstanceName;this.modalDialog=window[b.ModalDialogClientInstanceName];this.modalDialog.setPreferredSize(b.PreferredWidth,b.PreferredHeight);this.modalDialog.setCustomScripts({afterOpenDialog:this.fixSidePanelExpansion.bind(this)})}d.prototype.openDialog=function(a){this.deferred=jQuery.Deferred();document.querySelector("#"+this.settings.DialogContentId).innerHTML=
a;a=document.querySelector("#"+this.settings.ModalDialogClientInstanceName).querySelectorAll("button");for(var b=0;b<a.length;b++)a[b].addEventListener("click",this.closeDialog.bind(this));this.modalDialog.openDialog(!1);return this.deferred.promise()};d.prototype.closeDialog=function(a){CssModal.closeDialog();"ok"===a.target.value?this.deferred.resolve(!0):this.deferred.resolve(!1)};d.prototype.fixSidePanelExpansion=function(){setTimeout(function(){return CCL.CommonFunctions.makePostMessageCall(window,
{messageName:CCL.CommonWindowMessages.MessageNames.collapseExtensionIframe})},500)};return d}();e.LearningObjectiveRemovalDialog=f})(f.LearningObjectiveRemovalDialog||(f.LearningObjectiveRemovalDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){}d.handle=function(a,b,c){switch(a.Code){case e.GenericResponseCode.Success:b(a.ResponseData);break;default:a.ErrorMessage&&alert(a.ErrorMessage),c&&c(a)}};return d}();e.GenericResponseHandler=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.LightBulletin||(f.LightBulletin={});f=f.PendingProcessStatus||(f.PendingProcessStatus={});f[f.InProgress=0]="InProgress";f[f.Failed=1]="Failed";f[f.Aborted=2]="Aborted"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){this.processes=new Map;this.lastProcessId=0}d.prototype.createProcess=function(a){var b=this.lastProcessId+1;a={processId:b,pendingStatus:e.PendingProcessStatus.InProgress,ajaxRequest:a};this.lastProcessId=b;this.processes.set(b,a);return a};d.prototype.getProcessById=function(a){return this.processes.get(a)};d.prototype.setProcessFailed=function(a){a.pendingStatus=e.PendingProcessStatus.Failed;this.clearProcessAjaxRequest(a)};d.prototype.clearProcessAjaxRequest=
function(a){a.ajaxRequest=void 0};d.prototype.cancelProcess=function(a){a=this.processes.get(a);a.pendingStatus===e.PendingProcessStatus.InProgress&&(a.pendingStatus=e.PendingProcessStatus.Aborted,a.ajaxRequest&&(a.ajaxRequest.abort(),this.clearProcessAjaxRequest(a)))};d.prototype.removeProcessById=function(a){this.processes.delete(a)};return d}();e.PendingEmbedProcessManager=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.settings=a;e.supervisorOverviewInstance=this}d.prototype.findSupervisor=function(a,b){return CCL.CommonFunctions.safeAjax({type:"GET",url:e.supervisorOverviewInstance.settings.FindSupervisorsServiceUrl+"?search="+a.term+"&supervisorType="+e.supervisorOverviewInstance.settings.SupervisorType+"&organisationId="+e.supervisorOverviewInstance.settings.OrganizationId,dataType:"json",success:function(a){b($.map(a,function(a){return{label:a.Name,
value:a.Name,id:a.PersonId,organization:a.Organization}}))}})};d.prototype.personSearchRenderItem=function(a,b){return $("<li>").append($("<button>").attr("type","button").text(b.label).addClass(e.supervisorOverviewInstance.settings.CssClasses.ButtonPerson).append($("<div>").addClass(e.supervisorOverviewInstance.settings.CssClasses.ButtonPersonHierarchy).text(b.organization))).appendTo(a)};d.prototype.selectedSupervisorChanged=function(a,b){location.href=e.supervisorOverviewInstance.settings.FilterUrl+
"&"+$.param({SearchText:b.item.value,SearchValue:b.item.id})};return d}();e.SupervisorOverview=f})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a){this.context=a;e.personProfileSiteInstance=this;this.enableTwoFactorCheckboxOnlyForAdmins()}d.prototype.checkEsafetyChanged=function(){if(e.personProfileSiteInstance.context.Settings.IsInstantMessageSystemEnabled&&e.personProfileSiteInstance.context.Settings.IsEditMode){this.rolesUnchecked=[];CCL.CommonFunctions.checkAndAddRole(e.personProfileSiteInstance.context.Settings.EsafetyStaffChecked,e.personProfileSiteInstance.context.Controls.StaffCheckboxClientId,
e.personProfileSiteInstance.context.LanguageTerms.Staff,this.rolesUnchecked);CCL.CommonFunctions.checkAndAddRole(e.personProfileSiteInstance.context.Settings.EsafetyStudentChecked,e.personProfileSiteInstance.context.Controls.StudentCheckboxClientId,e.personProfileSiteInstance.context.LanguageTerms.Student,this.rolesUnchecked);CCL.CommonFunctions.checkAndAddRole(e.personProfileSiteInstance.context.Settings.EsafetyGuestChecked,e.personProfileSiteInstance.context.Controls.GuestCheckboxClientId,e.personProfileSiteInstance.context.LanguageTerms.Guest,
this.rolesUnchecked);var a=f.Administration.PersonProfile.privacyChangedDialogManagerInstance;return a&&0<this.rolesUnchecked.length?(a.openDialog({submitFormMethod:this.context.Settings.SumbitFormMethodString},{personProfileId:e.personProfileSiteInstance.context.Settings.ProfileId,rolesUnchecked:this.rolesUnchecked}),!1):!0}};d.prototype.showConfirmEsafetyChanges=function(a,b,c){var g=e.personProfileSiteInstance.context.Settings.ProfileName,h="";$("#"+e.personProfileSiteInstance.context.Controls.InitiateCommunicationCheckBoxClientId).is(":checked")&&
(h="\n"+e.personProfileSiteInstance.context.LanguageTerms.AdditionEsafetyText);var d="";switch(this.rolesUnchecked.length){case 1:d=CCL.CommonFunctions.formatString(e.personProfileSiteInstance.context.LanguageTerms.UncheckedOneEsafetyRoleText,g,this.rolesUnchecked[0]);break;case 2:d=CCL.CommonFunctions.formatString(e.personProfileSiteInstance.context.LanguageTerms.UncheckedTwoEsafetyRolesText,g,this.rolesUnchecked[0],this.rolesUnchecked[1]);break;case 3:d=CCL.CommonFunctions.formatString(e.personProfileSiteInstance.context.LanguageTerms.UncheckedThreeEsafetyRolesText,
g)}var l="";c===f.Administration.PersonProfile.PrivacyChangedDialogActionType.MakeReadOnly&&(l=b?CCL.CommonFunctions.formatString(e.personProfileSiteInstance.context.LanguageTerms.MarkCurrentConversationsIncludingGroupAsReadOnlyText,g,a.join(", ")):CCL.CommonFunctions.formatString(e.personProfileSiteInstance.context.LanguageTerms.MarkCurrentConversationsAsReadOnlyText,g,a.join(", ")),l=l+"\n"+e.personProfileSiteInstance.context.LanguageTerms.ClosingCouldTakeSomeTime);return confirm(d+" "+l+" "+h)};
d.prototype.onHierarchyRoleChange=function(){this.enableTwoFactorCheckboxOnlyForAdmins()};d.prototype.enableTwoFactorCheckboxOnlyForAdmins=function(){var a=document.getElementById(this.context.Controls.TwoFactorCheckboxClientId),b=document.getElementById(this.context.Controls.HierarchyRoleDropDownClientId);a&&b&&(this.context.Settings.IsProfileOfSystemAdmin||b.value!==this.context.Settings.HierarchyRoleAdministratorValue?(this.context.Settings.IsProfileOfSystemAdmin||(a.checked=!1),a.disabled=!0):
a.disabled=!1)};return d}();e.PersonProfileSite=k})(f.WebComponents||(f.WebComponents={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.onAssessmentChanged=function(a){var b=c.$assessmentItemDropDown.find("option:selected").val(),g=b===c.settings.Constants.UseScoreItemValue;c.settings.EventNames.ToggleCriteriaWeightVisibility&&$(document).trigger(c.settings.EventNames.ToggleCriteriaWeightVisibility,{show:b!==c.settings.Constants.DoNotUseAssessmentItemValue});0===c.$assessmentItemDropDown.length&&(g=c.settings.Permissions.IsScoreUsed);c.$maxScoreFloatingSection.toggle(g);
c.onMaxScoreStateChanged();c.settings.Permissions.UseGradeBook&&c.toggleTermAndCategoryPanel();if(void 0!==c.onChangeHandler&&void 0!==a)c.onChangeHandler(a)};window[a]=this;this.settings=b;$(function(){c.$addToGradeBookCheck=$("#"+c.settings.Controls.AddToGradeBookCheckbox);c.$assessmentItemDropDown=$("#"+c.settings.Controls.AssessmentItemDropDown);c.$maxScoreFloatingSection=$("#"+c.settings.Controls.MaxScoreFloatingSection);c.$assessmentSection=$("#"+c.settings.Controls.AssessmentSection);c.$maxScoreTextBox=
$("#"+c.settings.Controls.MaxScoreTextBox);c.$addToGradeBookCheckWithLabel=c.$addToGradeBookCheck.add(c.$addToGradeBookCheck.next());c.$categoryDropDown=$("#"+c.settings.Controls.CategoryDropDown);c.$termDropDown=$("#"+c.settings.Controls.TermDropDown);c.onAssessmentChanged(void 0);c.$assessmentItemDropDown.change(c.onAssessmentChanged);c.$maxScoreTextBox&&(c.$maxScoreTextBox.on("blur input",function(){return c.onMaxScoreStateChanged()}),c.$maxScoreTextBox.keydown(function(a){-1!==$.inArray(a.which,
[CCL.CommonConstants.keyCodes.del,CCL.CommonConstants.keyCodes.backspace,CCL.CommonConstants.keyCodes.tab,CCL.CommonConstants.keyCodes.escape,CCL.CommonConstants.keyCodes.enter,CCL.CommonConstants.keyCodes.decimalPoint,CCL.CommonConstants.keyCodes.comma,CCL.CommonConstants.keyCodes.period])||a.which===CCL.CommonConstants.keyCodes.keyA&&(a.ctrlKey||a.metaKey)||a.which>=CCL.CommonConstants.keyCodes.end&&a.which<=CCL.CommonConstants.keyCodes.arrowDown||(a.shiftKey||a.which<CCL.CommonConstants.keyCodes.key0||
a.which>CCL.CommonConstants.keyCodes.key9)&&(a.which<CCL.CommonConstants.keyCodes.numpad0||a.which>CCL.CommonConstants.keyCodes.numpad9)&&a.preventDefault()}));c.settings.Permissions.UseGradeBook&&c.toggleTermAndCategoryPanel()})}d.prototype.canUseAutoMaxScore=function(){return this.settings.Permissions.CanUseAutoMaxScore};d.prototype.useAssessment=function(){return this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue};d.prototype.isValid=
function(){return this.$assessmentItemDropDown.find("option:selected").val()===this.settings.Constants.UseScoreItemValue&&this.$maxScoreTextBox?this.validateScore(this.$maxScoreTextBox.val()):!0};d.prototype.validateScore=function(a){if(""===a)return!1;a=parseFloat(a.replace(this.settings.NumberDecimalSeparator,"."));return isNaN(a)||a<this.settings.MaxScoreMinValue||a>this.settings.MaxScoreMaxValue?!1:!0};d.prototype.onChange=function(a){this.onChangeHandler=a};d.prototype.onMaxScoreStateChanged=
function(){this.settings.EventNames.MandatoryFieldsStateChangedClient&&$(document).trigger(this.settings.EventNames.MandatoryFieldsStateChangedClient)};d.prototype.getState=function(){var a={};a.AssessmentScaleId=parseInt(this.$assessmentItemDropDown.find("option:selected").val());a.IsScore=a.AssessmentScaleId===parseInt(this.settings.Constants.UseScoreItemValue,10);a.MaxScore=parseInt(this.$maxScoreTextBox.val());a.AddToGradeBook=this.$addToGradeBookCheck.is(":checked");this.$categoryDropDown&&(a.CategoryId=
parseInt(this.$categoryDropDown.val()));this.$termDropDown&&(a.TermId=parseInt(this.$termDropDown.val()));return a};d.prototype.toggleTermAndCategoryPanel=function(){var a=this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue;a&&this.$addToGradeBookCheck.is(":visible")||(this.$addToGradeBookCheckWithLabel.toggle(a),this.$addToGradeBookCheck.prop("checked",a),eval(this.settings.ToggleTermAndCategoryPanelClientFunctionName+"("+a+")"))};return d}();
e.AssessmentScaleControl=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c,g){var b=this;this.settings=a;this.collaborationWindows={};this.open=function(a){b.isCollaborationWindowOpened(a)&&b.collaborationWindows[a].close();b.shouldOpenWindowImmediately()&&(b.collaborationWindows[a]=window.open("","_blank"));$.getJSON(b.settings.Endpoints.GetCollaborationLink.replace("{collaborationId}",a.toString())).then(function(c,g,h){return b.handleSuccessResponse(a,c,h)}).fail(function(c){return b.handleFailureResponse(a,
c)})};this.shouldOpenWindowImmediately=function(){return!b.settings.IsAndroidWebView};this.isCollaborationWindowOpened=function(a){return b.collaborationWindows[a]&&!b.collaborationWindows[a].closed};this.handleSuccessResponse=function(a,c,g){if(c.IsSuccess)b.openWindowWithUrl(a,c);else b.onGetCollaborationLinkError(a,c,g)};this.openWindowWithUrl=function(a,c){b.isCollaborationWindowOpened(a)?b.collaborationWindows[a].location.href=c.CollaborationUrl:b.collaborationWindows[a]=window.open(c.CollaborationUrl,
"_blank")};this.handleFailureResponse=function(a,c){b.onGetCollaborationLinkError(a,null,c)};this.callbacks={onGetCollaborationLinkError:g.getFunctionByName(c?c.OnGetCollaborationLinkError:void 0)};$("#"+a.InstanceId+" ."+a.LinkListItemCssClass+" a").on("click",function(c){c=$(c.target).closest("."+a.LinkListItemCssClass).attr(a.CollaborationIdAttributeName);b.open(c)})}a.prototype.onGetCollaborationLinkError=function(a,c,g){this.isCollaborationWindowOpened(a)&&this.collaborationWindows[a].close();
if(this.callbacks.onGetCollaborationLinkError)this.callbacks.onGetCollaborationLinkError(c,g)};return a}();e.CollaborationLinkList=d})(e.Collaboration||(e.Collaboration={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b,c,g){var h=this;this.$elementTitleLabel=a;this.settings=b;this.elementId=c;this.parentFolderId=g;window[d.clientInstanceName]=this;new ClientInlineEditor(this.$elementTitleLabel,void 0,void 0,{clickToEditToolTip:this.settings.Terms.ClickToEditToolTip,clickToSaveToolTip:this.settings.Terms.ClickToSaveToolTip,submitOnEnter:!0,editFieldCssClass:this.settings.CssClasses.EditFieldCssClass,editFieldAutoWidth:!1,editFieldDisplayInline:!0,highlightOnSave:!0,
highlightOnFocus:!0,renderRightLinkWithIcon:!0,maxLength:this.settings.MaxLength,rightLinkViewModeCssClass:this.settings.CssClasses.RightLinkViewModeCssClass,rightLinkEditModeCssClass:this.settings.CssClasses.RightLinkEditModeCssClass},function(a,b){return h.onEditFunction(a,b)},function(a){return h.onChangeModeFunction(a)},void 0)}d.getInstance=function(){return window[d.clientInstanceName]};d.getText=function(){return d.getInstance().$elementTitleLabel.text()};d.prototype.onEditFunction=function(a,
b){var c=this;a.actualText&&$.trim(a.actualText)?CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.UpdateTitleWebMethod.replace("{elementId}",this.elementId.toString()),data:{title:a.actualText}}).done(function(g){a.actualText=g;b(a);$(c).trigger("change",g)}).fail(function(){a.isUpdateSuccess=!1;a.stopOnEdit=!0}):(a.isUpdateSuccess=!1,a.stopOnEdit=!0,b(a),CCL.CommonFunctions.jAlertAjaxError(this.settings.Terms.EmptyTitleErrorMessage,this.settings.Terms.ErrorOccured,this.settings.Terms.Ok,
!1))};d.prototype.onChangeModeFunction=function(a){if(!a.isEditMode&&a.isNewTextSaved&&window!=top){var b=top;b.reloadFolder&&b.reloadFolder("item"+this.parentFolderId,"item"+this.elementId,!0);top.SelectCurrentLocation(a.actualText,window.currentPathFromHome,this.elementId)}};d.clientInstanceName="ElementTitleEditorClientInstance";return d}();e.ElementTitleEditor=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c,g){this.utility=a;this.inputSelector=c;this.errorSelector=g;this.input=this.utility.controls.Dialog.find(c);this.error=this.utility.controls.Dialog.find(g);this.instance=this.utility.getClientInstance(this.input.prop("id"))}Object.defineProperty(a.prototype,"date",{get:function(){return this.instance.getDate()},set:function(a){this.instance.setDate(a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"dateAsQueryStringParameter",
{get:function(){return this.instance.getDateAsQueryStringParameter()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isDateValid",{get:function(){return this.instance.isDateValid()},enumerable:!0,configurable:!0});a.prototype.showError=function(a){void 0===a&&(a=void 0);this.input.addClass(this.utility.settings.CssClasses.DatePickerErrorState);a&&this.error.show().text(a)};a.prototype.hideError=function(){this.input.removeClass(this.utility.settings.CssClasses.DatePickerErrorState);
this.error.hide()};return a}();e.DatePickerWrapper=d})(e.PrintSettingsDialog||(e.PrintSettingsDialog={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.controls=a;this.settings=c;this.dataSelectors={courseTitleContainer:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.CourseTitleContainer),courseDropdown:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.CourseDropdown),dateFrom:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateFrom),dateTo:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateTo),dateFromError:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateFromError),
dateToError:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateToError),dateRangeError:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateRangeError),okButton:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.OkButton)}}Object.defineProperty(a.prototype,"dialog",{get:function(){return this.getClientInstance(this.controls.Dialog.prop("id"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"datePickerFrom",{get:function(){return new e.DatePickerWrapper(this,
this.dataSelectors.dateFrom,this.dataSelectors.dateFromError)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"datePickerTo",{get:function(){return new e.DatePickerWrapper(this,this.dataSelectors.dateTo,this.dataSelectors.dateToError)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"dateRangeError",{get:function(){return this.controls.Dialog.find(this.dataSelectors.dateRangeError)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"okButton",{get:function(){return this.controls.Dialog.find(this.dataSelectors.okButton)},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"courseTitleContainer",{get:function(){return this.controls.Dialog.find(this.dataSelectors.courseTitleContainer)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"courseDropdown",{get:function(){return this.controls.Dialog.find(this.dataSelectors.courseDropdown)},enumerable:!0,configurable:!0});a.prototype.getClientInstance=function(a){return window[a]};return a}();e.CalendarPrintUtility=d})(e.PrintSettingsDialog||
(e.PrintSettingsDialog={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.okButtonClickHandler=function(a){if(b.isInputValid())b.utility.settings.IsPossibleToChooseCourse&&(b.currentCourseId=Number(b.utility.courseDropdown.val())),b.utility.okButton.prop("href",b.makeCalendarPrintUrl({CourseId:b.currentCourseId,EventId:0,StartDate:b.utility.datePickerFrom.dateAsQueryStringParameter,EndDate:b.utility.datePickerTo.dateAsQueryStringParameter,IsPrintFromAdminPage:!b.utility.settings.IsPossibleToChooseCourse})),
CssModal.closeDialog();else return a.preventDefault(),!1};this.utility=new e.CalendarPrintUtility(a,c);this.utility.okButton.click(this.okButtonClickHandler);e.manager=this}a.prototype.openPrintSettingsDialog=function(a,c){this.hideErrors();this.currentCourseId=a;this.utility.datePickerFrom.date=CCL.SerializableDateTimeConverter.toDate(this.utility.settings.DefaultDateFrom);this.utility.datePickerTo.date=CCL.SerializableDateTimeConverter.toDate(this.utility.settings.DefaultDateTo);this.utility.courseTitleContainer.html(c);
this.utility.dialog.openDialog(!1)};a.prototype.makeCalendarPrintUrl=function(a){return this.utility.settings.Urls.GetCalendarPrintoutMarkup+"?"+$.param(a)};a.prototype.isInputValid=function(){this.hideErrors();return this.utility.datePickerFrom.isDateValid?this.utility.datePickerTo.isDateValid?this.utility.datePickerFrom.date>this.utility.datePickerTo.date?(this.utility.datePickerFrom.showError(),this.utility.datePickerTo.showError(),this.utility.dateRangeError.show().text(this.utility.settings.Terms.InvalidDateRange),
!1):!0:(this.utility.datePickerTo.showError(this.utility.settings.Terms.InvalidDateTo),!1):(this.utility.datePickerFrom.showError(this.utility.settings.Terms.InvalidDateFrom),!1)};a.prototype.hideErrors=function(){this.utility.datePickerFrom.hideError();this.utility.datePickerTo.hideError();this.utility.dateRangeError.hide()};return a}();e.DialogManager=d})(e.PrintSettingsDialog||(e.PrintSettingsDialog={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(d){function a(a,c){d.call(this,a.CheckSession,c);this.urls=a}__extends(a,d);a.prototype.getElementListMarkupByIds=function(a){return $.ajax({type:"POST",url:this.urls.GetElementListByIds,data:JSON.stringify(a),dataType:"html",contentType:"application/json; charset=utf-8"})};return a}(f.CommonAjaxClient);e.ElementPickerAjaxClient=k})(f.CustomActivityElementPicker||(f.CustomActivityElementPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){var a=this;this.cssClasses=d;$("."+this.cssClasses.SelectedElementList).on("mouseenter","li",function(b){b=$(b.currentTarget).find("."+a.cssClasses.ElementTitle).get(0);var c=$(b).closest("a"),g=b.offsetWidth;CCL.CommonFunctions.isChrome()&&!CCL.CommonFunctions.isEdge()||g++;c.prop("title",g<b.scrollWidth?b.textContent.trim():"")})}}();e.CustomActivityOverview=f})(f.CustomActivityOverview||(f.CustomActivityOverview={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b){this.webMethods=a;this.widgetSettings=b}a.prototype.createGetAgendaDayListContainerAjaxRequest=function(a,b,h){var c=this;return function(){return CCL.CommonFunctions.safeAjaxPost({url:c.webMethods.GetAgendaDayListContainer,data:{fromDateTime:a,toDateTime:b,datePeriod:h,widgetSettings:c.widgetSettings}})}};a.prototype.createHideTaskAjaxRequest=function(a,b,h,d){var c=this;return function(){return CCL.CommonFunctions.safeAjax({type:"DELETE",url:c.webMethods.HideTask.replace("{taskId}",
a),data:{fromDateTime:b,toDateTime:h,datePeriod:d,widgetSettings:c.widgetSettings}})}};return a}();d.AgendaAjaxClient=a})(e.Agenda||(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b){this.attributesModel=a;this.controls=b}a.prototype.getEventDescription=function(a){return a.data(this.attributesModel.EventDescription)};a.prototype.getEventColorSchema=function(a){return a.data(this.attributesModel.EventColorSchema)};a.prototype.getEventUrl=function(a){return a.data(this.attributesModel.EventUrl)};a.prototype.getEventId=function(a){return a.data(this.attributesModel.EventId)};a.prototype.getEventTitle=
function(a){return a.data(this.attributesModel.EventTitle)};a.prototype.getEventCategory=function(a){return a.data(this.attributesModel.EventCategory)};a.prototype.getTaskHideId=function(a){return a.data(this.attributesModel.TaskHideId)};a.prototype.getExpectedDatePeriod=function(a){if(a===this.controls.WeekViewLink.get(0))return f.Controls.DatePeriod.Week;if(a===this.controls.DayViewLink.get(0))return f.Controls.DatePeriod.Day;throw Error("Unexpected control: "+a);};return a}();d.AgendaUtility=a})(e.Agenda||
(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.settings=c;window[a]=this;this.$allowEveryoneCheckbox=$("."+c.AllowEveryoneCheckboxCss).find("input:checkbox");this.$disableCommentsCheckbox=$("."+c.DisableCommentsCheckboxCss).find("input:checkbox");this.editBulletinSettingsDialog=window[this.settings.EditBulletinsSettingsDialogClientId]}a.prototype.showEditBulletinSettings=function(){var a=this;this.editBulletinSettingsDialog.show().then(function(b){b===CCL.ConfirmDialogResult.Confirm?
(b={AllowEveryoneSetting:a.$allowEveryoneCheckbox.is(":checked")},a.$disableCommentsCheckbox&&a.$disableCommentsCheckbox.length&&(b.DisableCommentsSetting=a.$disableCommentsCheckbox.is(":checked")),$.ajax({type:"POST",url:a.settings.UpdateCourseBulletinSettingsUrl,contentType:"application/json; charset=utf-8",data:JSON.stringify({courseId:a.settings.CourseId,settings:b})}).fail(function(){jAlert(a.settings.ErrorMessage)}).done(function(){window.location.reload()})):(a.$allowEveryoneCheckbox.prop("checked",
a.settings.AllowAllUsersPostBulletinsCourseSetting),a.$disableCommentsCheckbox&&a.$disableCommentsCheckbox.length&&a.$disableCommentsCheckbox.prop("checked",a.settings.DisableLightBulletinCommentsCourseSetting))});$("#"+this.settings.EditBulletinsSettingsDialogClientId).find(":focusable").first().focus()};return a}();e.Bulletins=d})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.settings=a;this.startPositionDataAttribute="start-position";window[d.clientInstanceName]=this;this.initDragAndDrop()}d.prototype.initDragAndDrop=function(){var a=this,b=$("."+this.settings.Css.Container);b.sortable({axis:"y",scroll:!0,scrollSensitivity:50,scrollSpeed:10,handle:"",cursor:"move",dropOnEmpty:!0,items:$("."+this.settings.Css.ElementContainer)});b.on("sortstart",function(b,g){g.item.data(a.startPositionDataAttribute,g.item.index())}).on("sortreceive",
function(a,b){}).on("sortstop",function(b,g){b=g.item.data(a.startPositionDataAttribute);var c=g.item.index();if(b!==c){c=$(g.item);g=a.getElementIdFromElementContainer(c);var d=c.nextAll("."+a.settings.Css.ElementContainer).eq(0);b=!1;0===d.length&&(d=c.prevAll("."+a.settings.Css.ElementContainer).eq(0),b=!0);c=a.getElementIdFromElementContainer(d);a.dragAndDropElement(g,c,b)}})};d.prototype.getElementIdFromElementContainer=function(a){return parseInt(a.data(this.settings.ElementIdDataAttribute),
10)};d.prototype.dragAndDropElement=function(a,b,c){var g=this;$.ajax({url:this.settings.DragAndDropElementUrl,type:"PUT",dataType:"JSON",contentType:"application/json",data:JSON.stringify({folderId:this.settings.FolderId,dragElementId:a,dropElementId:b,insertAfterTargetElement:c})}).done(function(a){a?(a=top,a.reloadFolder&&a.reloadFolder("item"+g.settings.FolderId)):g.showError()}).fail(function(){return g.showError()})};d.prototype.showError=function(){CCL.CommonFunctions.jAlertAjaxError(this.settings.Terms.SomethingWentWrong,
this.settings.Terms.ErrorOccurred,this.settings.Terms.Ok,!0)};d.clientInstanceName="OrganizeFolderClientInstanceName";return d}();e.OrganizeFolder=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function a(a,c,g,h,d,e){var b=this;this.$itemSelector=a;this.$filterMenu=c;this.idDataAttribute=g;this.selectAllItemId=h;this.optionCheckboxPrefix=d;this.languageTerms=e;this.handleItemSelection=function(a){var c=a.closest("[data-"+b.idDataAttribute+"]").data(b.idDataAttribute),g=a.is(":checked");a=c===b.selectAllItemId;var h=b.$filterMenu.find("[data-"+b.idDataAttribute+"]");if(a)h.each(function(a,c){a=$(c).data(b.idDataAttribute);b.getOptionCheckBox(a).prop("checked",
g)});else{b.getOptionCheckBox(c).prop("checked",g);var d=null,e=!0;h.each(function(a,c){a=$(c).data(b.idDataAttribute);return a!==b.selectAllItemId&&(a=b.getOptionCheckBox(a).is(":checked"),null==d&&(d=a),a!==d)?e=!1:!0});b.toggleAllOptionCheckBox(e,!1,d)}b.setDefaultItemText()};this.hasItems=function(){return 0<b.$filterMenu.find("[data-"+b.idDataAttribute+"]").length};this.getSelectedItems=function(){var a=[];b.$filterMenu.find("[data-"+b.idDataAttribute+"]").each(function(c,g){c=$(g).data(b.idDataAttribute);
b.getOptionCheckBox(c).is(":checked")&&c!==b.selectAllItemId&&a.push(c)});return a};this.areAllItemsSelected=function(){return null!=b.allOptionCheckBox?b.allOptionCheckBox.is(":checked"):!1};this.areNoneItemsSelected=function(){return 0===b.getSelectedItems().length};this.setDefaultItemText=function(){if(b.areAllItemsSelected())var a=b.languageTerms.All+" "+b.languageTerms.Items.toLowerCase();else b.areNoneItemsSelected()?a=b.languageTerms.SelectItem:(a=b.getSelectedItems(),a=1<a.length?b.getSelectedItems().length+
" "+b.languageTerms.Items.toLowerCase():b.$filterMenu.find("[data-"+b.idDataAttribute+'="'+a[0]+'"]').find("label").text());b.$itemSelector.text(CCL.CommonFunctions.htmlEncode(a))};this.getOptionCheckBox=function(a){return $("#"+b.optionCheckboxPrefix+a)};this.toggleAllOptionCheckBox=function(a,c,g){a?c||b.allOptionCheckBox.prop("checked",g):b.allOptionCheckBox.prop("checked",!1)};this.setDefaultItemText()}Object.defineProperty(a.prototype,"allOptionCheckBox",{get:function(){return this.getOptionCheckBox(this.selectAllItemId)},
enumerable:!0,configurable:!0});return a}(),d=function(){function a(b,c,g){var h=this;this.settings=c;this.controls=g;this.selectedItemIds=[];this.onItemClickHandler=function(b){h.itemMultiSelectorManager.handleItemSelection($(b.target));h.selectedItemIds=h.itemMultiSelectorManager.areAllItemsSelected()||h.itemMultiSelectorManager.areNoneItemsSelected()?[]:h.itemMultiSelectorManager.getSelectedItems();h.controls.ItemMultiSelector.trigger(a.itemMultiSelectorOnChangeEventName,h)};this.initPerfectScrollbar=
function(){h.controls.MenuContainer.perfectScrollbar({suppressScrollX:!0});var a=new CCL.CallbackDebouncer(function(){h.controls.MenuContainer.perfectScrollbar("update")});$(window).on("resize",function(){a.invokeCallback(null,100)})};window[b]=this;this.itemMultiSelectorManager=new f(this.controls.ItemMultiSelector,this.controls.MenuContainer,this.settings.DataAttributes.ItemId,this.settings.SelectAllItemId,this.settings.OptionCheckboxPrefix,this.settings.LanguageTerms);this.initPerfectScrollbar();
this.controls.ItemMultiSelector.parent().on("focusin",function(){h.controls.ItemMultiSelector.addClass(h.settings.CssClasses.MenuIsActive)});this.controls.ItemMultiSelector.parent().on("focusout",function(){h.controls.ItemMultiSelector.removeClass(h.settings.CssClasses.MenuIsActive)});this.controls.ItemMultiSelector.on("keyup",function(a){a.which===CCL.CommonConstants.keyCodes.enter&&h.controls.ItemMultiSelector.trigger("click")});this.controls.MenuContainer.on("change",this.onItemClickHandler)}Object.defineProperty(a.prototype,
"hasItems",{get:function(){return this.itemMultiSelectorManager.hasItems()},enumerable:!0,configurable:!0});a.itemMultiSelectorOnChangeEventName="itemMultiSelector:onchange";return a}();e.ItemMultiSelector=d})(f.ItemMultiSelector||(f.ItemMultiSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){var a=this;this.settings=d;this.onItemClickHandler=function(b){a.$checkbox.prop("checked",!a.$checkbox.is(":checked")).change();b.stopPropagation()};this.$checkbox=$("#"+this.settings.OptionCheckboxClientId);d=$("#"+d.ClientId);d.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onItemClickHandler);d.on("keyup",function(b){if(b.which===CCL.CommonConstants.keyCodes.enter)a.onItemClickHandler(b)})}}();e.Item=f})(f.ItemMultiSelector||
(f.ItemMultiSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e=function(){return function(){this.registerSafeImgBinding=function(){ko.bindingHandlers.safeImg={init:function(e,d){var a=ko.utils.unwrapObservable(d());d=ko.utils.unwrapObservable(a.src);a=ko.utils.unwrapObservable(a.fallback);$(e).prop("src",d||a)},update:function(e,d){var a=ko.utils.unwrapObservable(d());d=ko.utils.unwrapObservable(a.src);a=ko.utils.unwrapObservable(a.fallback);$(e).prop("src",d||a)}}};this.registerPerfectScrollBarBinding=function(){ko.bindingHandlers.perfectlyScrollable=
{init:function(e,d,a,b,c){d=ko.unwrap(d())||{minScrollbarLength:10};var g=$(e);g.perfectScrollbar(d);var h=new CCL.CallbackDebouncer(function(){g.perfectScrollbar("update")}),f=function(){h.invokeCallback(null,100)};$(window).on("resize",f);ko.utils.domNodeDisposal.addDisposeCallback(e,function(){g.perfectScrollbar("destroy");$(window).off("resize",f)})}}}}}();f.KnockoutCustomBindingsManager=e})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.clientFunctions={};window[a]=this;this.settings=b;this.terms=b.Terms;this.cssClasses=b.CssClasses;this.clientFunctions.DeleteCurrentPostback=new Function(b.ClientFunctions.DeleteCurrentPostback);this.clientFunctions.DeleteSelectedPostback=new Function(b.ClientFunctions.DeleteSelectedPostback);this.clientFunctions.PublishAllPostback=new Function(b.ClientFunctions.PublishAllPostback);this.clientFunctions.UnpublishAllPostback=new Function(b.ClientFunctions.UnpublishAllPostback);
this.clientFunctions.UnpublishCurrentPostback=new Function(b.ClientFunctions.UnpublishCurrentPostback);this.clientFunctions.UnpublishSelectedPostback=new Function(b.ClientFunctions.UnpublishSelectedPostback);this.grid=window[b.Controls.GridClientInstanceName]}d.prototype.publishAll=function(){var a=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.PublishAllConfirmation,this.terms.PleaseConfirm,this.terms.Yes,this.terms.No,function(b){b&&a.clientFunctions.PublishAllPostback()})};d.prototype.unpublishAll=
function(){var a=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.UnpublishAllConfirmation,this.terms.PleaseConfirm,this.terms.Yes,this.terms.No,function(b){b&&a.clientFunctions.UnpublishAllPostback()})};d.prototype.deleteCurrentLearningObjective=function(){this.deleteConfirmation(this.settings.IsCurrentSubjectPublished,this.clientFunctions.DeleteCurrentPostback,this.clientFunctions.UnpublishCurrentPostback)};d.prototype.deleteSelectedLearningObjectives=function(){var a=this.grid.getSelectedValues();
if(0===a.length)CCL.CommonFunctions.jAlertAjaxError(this.terms.PleaseMakeSelection,this.terms.Alert,this.terms.Ok,!1);else{for(var b=!1,c=0;c<a.length;c++)if(0<this.grid.getRow(a[c]).find("."+this.cssClasses.Published).length){b=!0;break}this.deleteConfirmation(b,this.clientFunctions.DeleteSelectedPostback,this.clientFunctions.UnpublishSelectedPostback)}};d.prototype.deleteConfirmation=function(a,b,c){var g=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.FirstDeleteConfirmation,this.terms.PleaseConfirm,
this.terms.Ok,this.terms.Cancel,function(h){h&&(a?g.deleteConfirmationFromPublishedSubject(b,c):b())})};d.prototype.deleteConfirmationFromPublishedSubject=function(a,b){var c=[];c.push(new CCL.ConfirmButtonMetaData(this.terms.Unpublish,"","confirm_unpublish"));c.push(new CCL.ConfirmButtonMetaData(this.terms.Delete,this.cssClasses.DeleteButton,"confirm_delete"));c.push(new CCL.ConfirmButtonMetaData(this.terms.Cancel,"","confirm_cancel"));CCL.CommonFunctions.jAjaxMultiButtonConfirm("<p>"+this.terms.DeleteConfirmationFromPublishedSubjectBody+
"</p><p>"+this.terms.DeleteConfirmationFromPublishedSubjectFooter+"</p>",this.terms.AreYouSure,c,function(c){c&&c.customId&&"confirm_cancel"!==c.customId&&("confirm_delete"===c.customId?a():"confirm_unpublish"===c.customId&&b())})};return d}();e.LearningObjectiveOverview=f})(f.LearningObjectiveRepository||(f.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){}d.convertElementIdsToElementStateMapping=function(a,b){var c=new Map;a.forEach(function(a){c.set(a,b)});return c};return d}();e.LearningObjectiveRepositoryHelper=f})(f.LearningObjectiveRepository||(f.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){return function(d){var a=this;this.settings=d;this.openDialog=function(){var b=[];JSON.parse(a.$subjectHiddenField.val()).forEach(function(a){b.push(a.Id)});var c={elementStates:e.LearningObjectiveRepositoryHelper.convertElementIdsToElementStateMapping(b,f.CheckboxStateMachine.State.AttachedByUser),disabledElementIds:[],showAll:!0,header:a.settings.HeaderText,elementType:f.ElementLinkDialog.ContentElementType.LearningObjectives,allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.None,
allowEmptySubmit:!0,afterOkClickCallback:function(b){var c=[];b.forEach(function(a,b){a!==f.CheckboxStateMachine.State.Empty&&c.push(b)});a.updateUiWithNewElements(c)}};a.elementLinkDialogManagerInstance.openDialog(c,{countryCode:a.settings.CountryCode})};this.createTagItInput=function(){CCL.TagItInput.createTagItInput(a.$aliasesContainer,{isReadonly:!1,placeholderText:a.settings.AliasesPlaceholderText,tagitLimit:255})};this.updateSubjectsInUi=function(){var b=JSON.parse(a.$subjectHiddenField.val());
a.$subjectContainer.html("");b.forEach(function(b){var c=$("<div/>").addClass(a.settings.CssClasses.LearningObjectiveContainerCssClass),h=$("<img/>").addClass(a.settings.CssClasses.LearningObjectiveIconCssClass),d=$("<span/>").addClass(a.settings.CssClasses.LearningObjectiveTitleCssClass).text(b.Title),e=$("<span> &times; </span>").addClass(a.settings.CssClasses.LearningObjectiveDeleteCssClass).on("click",function(){a.removeSubject(b.Id)});c.append(h).append(" ").append(d).append(" ").append(e);a.$subjectContainer.append(c).append($("<br/>"))})};
this.removeSubject=function(b){var c=-1,g=JSON.parse(a.$subjectHiddenField.val());g.forEach(function(a,g){a.Id===b&&(c=g)});-1!==c&&(g.splice(c,1),a.$subjectHiddenField.val(JSON.stringify(g)),a.updateSubjectsInUi())};this.updateUiWithNewElements=function(b){$.ajax({type:"GET",url:a.settings.GetLearningObjectiveNamesUrl,data:{learningObjectiveIds:b.join(",")},dataType:"jsonp"}).done(function(b){a.$subjectHiddenField.val(JSON.stringify(b));a.updateSubjectsInUi()}).fail(function(a,b,h){CCL.CommonFunctions.alertAjaxError(a,
b,h)})};this.elementLinkDialogManagerInstance=f.ElementLinkDialog.elementLinkDialogManagerInstance;this.$subjectContainer=$("#"+d.ClientIds.SubjectLabelContainerClientId);this.$subjectHiddenField=$("#"+d.ClientIds.SubjectLabelHiddenFieldClientId);this.$aliasesContainer=$("#"+d.ClientIds.AliasesContainerClientId);this.createTagItInput();CCL.CommonFunctions.preventSubmitOnEnter($("#"+d.ClientIds.LabelTextboxClientId));$("#"+d.ClientIds.AddSubjectsButtonClientId).on("click",function(){a.openDialog();
return!1})}}();e.LearningObjectiveSubjectLabelsManager=k})(f.LearningObjectiveRepository||(f.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function b(a){var c=this;this.settings=a;this.signalRRetryConnection=0;window[b.clientInstanceName]=this;$(function(){c.jQueryAny=jQuery;c.jQueryAny.connection.hub.url=c.settings.Endpoint;var a=c.jQueryAny.connection.learningPathHub;"undefined"!==typeof a&&null!==a&&void 0!==a&&(a.client.activityCompleted=function(a,b){c.triggerStudentProgressEvent(d.ActivityCompleted,a,b)},a.client.resourceViewed=function(a,b){c.triggerStudentProgressEvent(d.ResourceViewed,
a,b)},a.client.teachersActionNeeded=function(a){c.triggerStudentProgressEvent(d.TeachersActionNeeded,a,0)},a.client.finishIsReached=function(a){c.triggerStudentProgressEvent(d.FinishIsReached,a,0)},a.client.anotherTryNeeded=function(a){c.triggerStudentProgressEvent(d.AnotherTryNeeded,a,0)});c.startSignalRHub();c.jQueryAny.connection.hub.connectionSlow(function(){return console.log("We are currently experiencing difficulties with the connection.")});c.jQueryAny.connection.hub.reconnecting(function(){c.setSignalROnlineStatus(!1);
console.log("SignalR reconnecting.")});c.jQueryAny.connection.hub.disconnected(function(){c.setSignalROnlineStatus(!1);console.log("SignalR disconnected.");c.reconnectToSignalRHub(!0)});c.jQueryAny.connection.hub.reconnected(function(){c.setSignalROnlineStatus(!0);console.log("SignalR reconnected.");c.reconnectToSignalRHub(!1)})})}b.prototype.triggerStudentProgressEvent=function(c,g,h){$(window).trigger(b.studentProgressChangedEvent,new a(c,g,h))};b.prototype.setSignalROnlineStatus=function(a){$(window).trigger("SignalRConnectionStatus",
a)};b.prototype.startSignalRHub=function(){var a=this;this.jQueryAny.connection.hub.start().done(function(){var b="";localStorage.getItem("learningpath-channelid")&&(b=localStorage.getItem("learningpath-channelid"));5>=b.length&&(b="");$.ajax({url:a.settings.CommunicationChannelEndPoint,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({channelId:a.jQueryAny.connection.hub.id,unregister:b})}).done(function(){a.setSignalROnlineStatus(!0);a.reconnectToSignalRHub(!1);console.log("SignalR connection registered. ChannelId: "+
a.jQueryAny.connection.hub.id)});localStorage.setItem("learningpath-channelid",a.jQueryAny.connection.hub.id)}).fail(function(b){a.setSignalROnlineStatus(!1);a.reconnectToSignalRHub(!0);console.log("Error starting SignalR connection: "+b)})};b.prototype.reconnectToSignalRHub=function(a){var b=this;a?this.signalRRetryConnection<=this.settings.RetryConnectionMax&&(this.signalRRetryConnection+=1,window.clearInterval(this.signalRRetryInterval),this.signalRRetryInterval=window.setInterval(function(){return b.startSignalRHub()},
3E3)):(window.clearInterval(this.signalRRetryInterval),this.signalRRetryConnection=0)};b.clientInstanceName="LearningPathSignalRListenerClientInstanceName";b.studentProgressChangedEvent="LearningPathSignalRListener:studentProgressChanged";return b}();e.LearningPathSignalRListener=f;(function(a){a[a.NoProgress=0]="NoProgress";a[a.ResourceViewed=1]="ResourceViewed";a[a.ActivityCompleted=2]="ActivityCompleted";a[a.TeachersActionNeeded=3]="TeachersActionNeeded";a[a.FinishIsReached=4]="FinishIsReached";
a[a.AnotherTryNeeded=5]="AnotherTryNeeded"})(e.StudentProgressType||(e.StudentProgressType={}));var d=e.StudentProgressType,a=function(){return function(a,c,g){this.studentProgressType=a;this.learningPathId=c;this.unlockedElementId=g}}();e.StudentProgressEventData=a})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.settings=a;window[d.clientInstanceName]=this;$(function(){b.$elementListContainer=$("#"+b.settings.Controls.ElementListContainerId);b.$frame=$("#"+b.settings.Controls.Frame);b.$loadingIndicator=$("#"+b.settings.Controls.LoadingIndicator);b.$feedback=$("#"+b.settings.Controls.Feedback);b.$elementListContainer.on("click","."+b.settings.Css.ElementTitle,function(a){a=$(a.currentTarget).closest("."+b.settings.Css.ElementContainer);
a=parseInt(a.data(b.settings.DataAttributes.ElementId),10);b.setCurrentElement(a);return!1});b.setCurrentElement(b.settings.ElementIdToSelect);IframeResizer.reportSetIframeDefaultHeight()})}d.getInstance=function(){return window[d.clientInstanceName]};d.reloadElementList=function(a){d.getInstance().reloadElementList(a)};d.prototype.setCurrentElement=function(a){if(!a||a!==this.currentElementId){var b=!1;if(0<a){var c=this.$elementListContainer.find("."+this.settings.Css.ElementContainer+"[data-element-id="+
a+"]");0===c.length&&(c=this.$elementListContainer.find("."+this.settings.Css.ElementContainer).first(),b=!0)}else c=this.$elementListContainer.find("."+this.settings.Css.ElementContainer).first(),b=!0;var g=c.find("."+this.settings.Css.ElementTitle).prop("href");$("."+this.settings.Css.ElementContainer).removeClass(this.settings.Css.SelectedElement);c.addClass(this.settings.Css.SelectedElement);this.$elementListContainer.scrollTop(c.offset().top-this.$elementListContainer.offset().top+this.$elementListContainer.scrollTop());
this.setFrameUrl(g);this.currentElementId=b?0:a}};d.prototype.setFrameUrl=function(a){a?(this.$frame.prop("src",a),this.$loadingIndicator.hide()):(this.$frame.contents().find("html").html(""),this.$loadingIndicator.show())};d.prototype.getElementLinkTitle=function(a){return this.$elementListContainer.find(""+CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementId,a)).find("."+this.settings.Css.ElementTitle)};d.prototype.reloadElementList=function(a){var b=this;$.get(this.settings.Urls.StudentViewElementList+
"&selectedElementId="+this.currentElementId).done(function(c){b.$elementListContainer.html(c);CCL.InformationFeedback.showFeedbackWithextraButton(b.$feedback,b.getFeedbackMessage(a.studentProgressType),0<a.unlockedElementId?b.settings.Terms.Continue:b.settings.Terms.Ok,function(){0<a.unlockedElementId&&b.setCurrentElement(a.unlockedElementId);CCL.InformationFeedback.hideFeedback(b.$feedback)})})};d.prototype.getFeedbackMessage=function(a){switch(a){case e.StudentProgressType.ActivityCompleted:return this.settings.Terms.NewStepAvailable;
case e.StudentProgressType.ResourceViewed:return this.settings.Terms.TakeGoodLookAtThisResource;case e.StudentProgressType.FinishIsReached:return this.settings.Terms.ThatWasIt;case e.StudentProgressType.TeachersActionNeeded:return this.settings.Terms.YouCanContinueAfterTeacherReviewed;case e.StudentProgressType.AnotherTryNeeded:return this.settings.Terms.PleaseGiveItAnotherTry;default:return""}};d.clientInstanceName="StudentViewLearningPathInstance";return d}();e.TakeLearningPathDialogContent=f})(f.LearningPath||
(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a){var b=this;this.convertId="confirm_convert_to_folder";this.deleteId="confirm_delete";this.cancelId="confirm_cancel";window[d.clientInstanceName]=this;this.settings=a;$(function(){$("."+b.settings.Css.DeleteLink).click(function(){$.ajax({url:b.settings.Urls.GetConfirmationModelForElementsDeleting,data:{elementIds:b.settings.LearningPathId},dataType:"json"}).done(function(a){var c=[],g=0===$("."+b.settings.Css.StepElementTitle).length,d=g?b.settings.Terms.EmptyLearningPathDeleteConfirmation:
b.settings.Terms.LearningPathDeleteConfirmation;c.push(new CCL.ConfirmButtonMetaData(b.settings.Terms.Delete,b.settings.Css.RedButton,b.deleteId));g||c.push(new CCL.ConfirmButtonMetaData(b.settings.Terms.MakeNormalFolder,b.settings.Css.ConfirmConvertButton,b.convertId));c.push(new CCL.ConfirmButtonMetaData(b.settings.Terms.Cancel,"",b.cancelId));a&&a.HasTreeLinks&&(d=a.TreeLinksDeleteConfirmationMessage+" "+d);b.showDeleteConvertConfirmDialog(d,c)})});$("."+b.settings.Css.ConvertToFolderLink).click(function(){var a=
[];a.push(new CCL.ConfirmButtonMetaData(b.settings.Terms.Ok,b.settings.Css.BlueButton,b.convertId));a.push(new CCL.ConfirmButtonMetaData(b.settings.Terms.Cancel,"",b.cancelId));b.showDeleteConvertConfirmDialog(b.settings.Terms.AreYouSure,a)});var a=new f.Controls.ElementTitleEditor($("."+b.settings.Css.TitleLabel),b.settings.TitleEditorSettings,b.settings.LearningPathId,b.settings.ParentFolderId);if(b.settings.PopupScripts&&(b.settings.PopupScripts.AddElement&&b.executeScript(b.settings.PopupScripts.AddElement),
b.settings.PopupScripts.UpdateElement))$(a).on("change",function(){return b.executeScript(b.settings.PopupScripts.UpdateElement)})})}d.prototype.showDeleteConvertConfirmDialog=function(a,b){var c=this;CCL.CommonFunctions.jAjaxMultiButtonConfirm("",a,b,function(a){if(a&&a.customId)switch(a.customId){case c.deleteId:c.deleteLearningPath();break;case c.convertId:c.convertLearningPathToFolder()}})};d.prototype.showError=function(a,b){void 0===b&&(b=!1);CCL.CommonFunctions.jAlertAjaxError(a,this.settings.Terms.ErrorOccured,
this.settings.Terms.Ok,b)};d.prototype.convertLearningPathToFolder=function(){var a=this;$.ajax({url:this.settings.Urls.ConvertToFolder.Action,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({LearningPathId:this.settings.LearningPathId})}).done(function(b){b.Success?a.settings.UseSimpleMenu?window.top.location.href=a.settings.Urls.ConvertToFolder.RedirectAfterSucceed:window.location.href=a.settings.Urls.ConvertToFolder.RedirectAfterSucceed:a.showError(b.ErrorMessage)}).fail(function(){return a.showError(a.settings.Terms.LearningPathGeneralErrorMessage)})};
d.prototype.deleteLearningPath=function(){var a=this;$.ajax({url:this.settings.Urls.Delete.Action,type:"DELETE",dataType:"json",contentType:"application/json",data:JSON.stringify({LearningPathId:this.settings.LearningPathId})}).done(function(b){b.Success?window.location.href=a.settings.Urls.Delete.RedirectAfterSucceed:a.showError(b.ErrorMessage)}).fail(function(){return a.showError(a.settings.Terms.LearningPathGeneralErrorMessage)})};d.prototype.executeScript=function(a){(new Function(a))()};d.clientInstanceName=
"LearningPathCommonEditActionsInstance";return d}();e.LearningPathCommonEditActions=k})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;window[d.clientInstanceName]=this;this.settings=a;$(function(){$("#"+b.settings.Controls.OpenDialogLink).click(function(a){a=$(a.currentTarget).prop("href");b.dialog.openDialog(a);return!1});b.dialog=CCL.FullScreenDialog.getInstance();$(b.dialog).on(CCL.FullScreenDialog.onCloseEvent,function(){clearTimeout(b.timer);window.location.href=b.settings.Urls.ViewLearningPath});$(window).on(e.LearningPathSignalRListener.studentProgressChangedEvent,
function(a,g){b.settings.LearningPathId===g.learningPathId&&(b.timer=setTimeout(function(){return b.reloadElementList(g)},b.getTimeout(g)))})})}d.prototype.reloadElementList=function(a){this.dialog.isOpened()?e.TakeLearningPathDialogContent.reloadElementList(a):window.location.href=this.settings.Urls.ViewLearningPath};d.prototype.getTimeout=function(a){return a.studentProgressType===e.StudentProgressType.ResourceViewed?this.settings.Timeouts.ResourceCompletedInMs:a.studentProgressType===e.StudentProgressType.FinishIsReached?
this.settings.Timeouts.FinishIsReachedInMs:this.settings.Timeouts.ActivityCompletedInMs};d.clientInstanceName="TakeLearningPathDialogLauncherInstance";return d}();e.TakeLearningPathDialogLauncher=f})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function a(b,c){var g=this;this.dataUrl=b;this.model=c;this.page=0;this.run=function(b){b&&(g.page=b);g.model.lettersLoading(!0);b={supervisorType:g.model.settings.SupervisorType,termId:g.model.termId(),hierarchyIds:g.model.hierarchyIds(),paging:{pageIndex:g.page,pageSize:a.pageSize},sorting:{sort:g.model.sorting.term,sortDescending:g.model.sorting.descending},search:g.model.lettersSearch()};b=CCL.CommonFunctions.safeAjaxPost({url:g.dataUrl,data:b,dataType:"json"});
b.done(function(a){g.model.addLetters(a);g.page++;g.model.lettersLoading(!1)});return b}}a.pageSize=50;return a}(),d=function(){return function(){this.term="FullName";this.descending=!1}}(),a=function(){function a(a,b){var c=this;this.settings=a;this.controls=b;this.addLetters=function(a){[].push.apply(c.allLetters(),a);c.allLetters.valueHasMutated();c.lettersLoading(!1);c.lettersCount(c.allLetters().length);c.areAllLettersRetreived(!a||0===a.length||a.length<k.pageSize)};this.showCard=function(a){return c.showStudentProfile(a)};
this.showLetters=function(a){return c.showStudentProfile(a,"letters")};this.setSorting=function(a,b){a=$(b.currentTarget).data(c.settings.DataAttributes.SortValue);c.allLetters([]);c.lettersLoading(!0);c.lettersCount(0);a===c.sorting.term?c.sorting.descending=!c.sorting.descending:(c.sorting.term=a,c.sorting.descending=!0);c.fetcher.page=0;c.fetcher.run()};this.showMoreLetters=function(a){$(a.currentTarget).blur();c.fetchNextLettersPage()};this.getParentLettersOverview=function(a){return 0<a.parentLettersTotalNumber?
a.lettersOpenedByParentsTotalNumber+"/"+a.parentLettersTotalNumber:"-"};this.getStudentLettersOverview=function(a){return 0<a.studentLettersTotalNumber?a.lettersOpenedByStudentTotalNumber+"/"+a.studentLettersTotalNumber:"-"};this.fetchData=function(){c.allLetters([]);c.lettersCount(c.allLetters().length);c.lettersLoading(!0);c.fetcher.page=0;null!=c.fetchDataPromise&&c.fetchDataPromise.readyState!==c.fetchDataPromise.DONE&&c.fetchDataPromise.abort();c.fetchDataCallbackDebouncer.invokeCallback({},
200)};this.onSearchChangeHandler=function(a){var b=$(a.currentTarget).val();b=(a.which===CCL.CommonConstants.keyCodes.del||a.which===CCL.CommonConstants.keyCodes.backspace)&&b&&""===$.trim(b);if(a.which===CCL.CommonConstants.keyCodes.enter||b)c.lettersSearch($(a.currentTarget).val()),c.fetchData(),c.$searchFilter.val(c.lettersSearch()),a.stopPropagation();CCL.CommonFunctions.isMobileDevice()&&a.which===CCL.CommonConstants.keyCodes.enter&&$(a.currentTarget).blur();0===$(a.currentTarget).val().length?
c.$searchFilterClear.hide():c.$searchFilterClear.show()};this.onSearchClearHandler=function(){c.lettersSearch("");c.$searchFilter.val(c.lettersSearch());c.$searchFilterClear.hide();c.fetchData()};this.fetchNextLettersPage=function(){c.areAllLettersRetreived()||(null!=c.lettersScrollingPromise&&c.lettersScrollingPromise.readyState!==c.lettersScrollingPromise.DONE&&c.lettersScrollingPromise.abort(),c.lettersScrollingTimeout&&clearTimeout(c.lettersScrollingTimeout),c.lettersScrollingTimeout=setTimeout(function(){c.allLetters.valueHasMutated();
c.lettersScrollingPromise=c.fetcher.run()},50))};this.onFetchLettersHandler=function(a){a=$(a.target).scrollTop();if(a>c.lettersLastScrollTop){var b=$("."+c.settings.CssClasses.StudentsList).children("li");b=b.eq(b.length-k.pageSize/2);CCL.CommonFunctions.isOnScreen(b,.5,.5)&&c.fetchNextLettersPage()}c.lettersLastScrollTop=a};this.showStudentProfile=function(a,b){document.showProfileCard?b?document.showProfileCard(a.personId,b):document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,
"","resizable,scrollbars,height=500,width=750")};this.configTermFilter=function(){c.controls.TermFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,c.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,b){c.measureLettersOverviewPageFilterUsageKpi();c.termId(b.selectedItemId);c.fetchData()};this.configHierarchyFilter=function(){c.controls.HierarchyFilter.on(f.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,c.onHierarchyFilterItemClickHandler)};
this.onHierarchyFilterItemClickHandler=function(a,b){c.measureLettersOverviewPageFilterUsageKpi();c.hierarchyIds(b.selectedItemIds);c.fetchData()};this.measureLettersOverviewPageFilterUsageKpi=function(){CCL.CommonFunctions.measureKpi(c.settings.WebMethods.MeasureKpi,c.settings.SupervisorKpiSection,c.settings.LettersOverviewPageFilterUsageKpiMeasurement,c.settings.RegularKpiContext)};this.fetchDataCallbackDebouncer=new CCL.CallbackDebouncer(function(){c.fetchDataPromise=c.fetcher.run()});this.allLetters=
ko.observableArray([]);this.lettersInitiated=ko.observable(!1);this.lettersLoading=ko.observable(!0);this.letters=ko.pureComputed(function(){return c.allLetters()});this.lettersCount=ko.observable(0);this.areAllLettersRetreived=ko.observable(!1);this.lettersSearch=ko.observable("");this.$searchFilter.keyup(this.onSearchChangeHandler);this.$searchFilterClear.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onSearchClearHandler);this.sorting=new d;this.lettersLastScrollTop=$(window).scrollTop();
$(window).on("scroll touchmove",this.onFetchLettersHandler);this.configTermFilter();this.configHierarchyFilter();this.termId=ko.observable(null);this.hierarchyIds=ko.observableArray([]);this.isSearchOrFilteringApplied=ko.pureComputed(function(){return 0<c.lettersSearch().length||null!=c.termId()||0<c.hierarchyIds().length})}Object.defineProperty(a.prototype,"$searchFilter",{get:function(){return $("."+this.settings.CssClasses.SearchFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"$searchFilterClear",{get:function(){return $("."+this.settings.CssClasses.SearchFilterClear)},enumerable:!0,configurable:!0});return a}();e.LettersOverviewViewModel=a;var b=function(){function b(b,c){var g=this;this.settings=b;this.controls=c;this.preventFromDropDownMenuFromClosing=function(a){$(a.target).hasClass("c-supervisor-letters__inner")&&a.stopPropagation()};(new f.KnockoutCustomBindingsManager).registerSafeImgBinding();this.model=new a(b,c);ko.applyBindings(this.model,$("."+this.settings.CssClasses.Container)[0]);
this.$container.on("click",this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){g.$container.off("click",g.preventFromDropDownMenuFromClosing)});this.model.fetcher=new k(this.settings.WebMethods.GetSupervisorLettersOverviews,this.model);this.model.fetcher.run().done(function(){g.model.lettersInitiated(!0)})}Object.defineProperty(b.prototype,"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});
return b}();e.SupervisorLetters=b})(f.Letter||(f.Letter={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(a,b){var c=this;this.settings=b;window[a]=this;this.settings=b;this.$mainContainer=$("#"+this.settings.Controls.MainContainer);this.$courseGroupSelectorLink=$("#"+this.settings.Controls.GroupSelectorLink);this.$submitIndividuallyLink=$("#"+this.settings.Controls.SubmitIndividuallyLink);this.settingManager=e.Settings.Manager.getInstance();$(function(){$("#"+c.settings.Controls.DropDownMenuContainer).find("."+c.settings.MenuItemCssClass).click(function(a){a=
$(a.currentTarget).data("groupid");CCL.CommonFunctions.safeAjaxPost({url:c.settings.WebMethods.CreateCollaborationBasedOnCourseGroup.replace("{elementId}",c.settings.ElementId.toString()),data:{groupId:a}}).done(function(a){return c.processResponse(a)}).fail(function(){return c.settingManager.alertError()})});c.$submitIndividuallyLink.on("click",function(){CCL.CommonFunctions.safeAjaxPost({url:c.settings.WebMethods.UseIndividualSubmission.replace("{elementId}",c.settings.ElementId.toString())}).done(function(a){return c.processResponse(a)}).fail(function(){return c.settingManager.alertError()})})})}
a.prototype.processResponse=function(a){a.Success?window.location.href=window.location.href.split("#")[0]:this.settingManager.alertError(a.Message)};return a}();d.CourseGroups=a})(f.Collaboration||(f.Collaboration={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(d){function a(a,c,g){d.call(this,c,g,function(){});this.actionUrlsBase=a}__extends(a,d);a.prototype.getElementListMarkupForEventIds=function(a,c,g,d,e,f){void 0===e&&(e="");void 0===f&&(f=!1);return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrlsBase.GetElementListMarkupForEventIds,data:{eventId:a,startDateTime:c,courseId:g,elementIds:d,fakeElementTitle:e,showConnectedDate:f},dataType:"json"})};a.prototype.createNewFileElementForEvent=function(a,c,g,
d){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrlsBase.CreateNewFileElementForEvent,data:{CourseId:a,EventId:c,FileName:g.name,FileId:g.id,SignedFileId:g.signature,ShouldFileBeAttachedToEventImmediately:d}})};return a}(f.CommonAjaxClient);e.AjaxClientBase=k})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(a){function b(b){a.call(this,b,"","");this.actionUrls=b}__extends(b,a);b.prototype.validateDateRelatedContent=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.ValidateDateRelatedContent,data:a})};b.prototype.checkRecurringEventPeriodDuration=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.CheckRecurringEventPeriodDuration,async:!1,data:a})};b.prototype.getDatesOfEventsToBePickedAsNextEventForEditEventPage=
function(a){return $.ajax({type:"GET",url:this.actionUrls.GetDatesOfEventsToBePickedAsNextEventForEditEventPage,async:!1,data:a,dataType:"json"})};b.prototype.getTimeSlotsOfEventsToBePickedAsNextEventForEditEventPage=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetTimeSlotsOfEventsToBePickedAsNextEventForEditEventPage,async:!1,data:a,dataType:"json"})};b.prototype.getBookingMarkups=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.GetBookingMarkups,data:a,dataType:"json"})};
return b}(e.AjaxClientBase);f.AjaxClient=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(a){function b(b,g){a.call(this,g,g.checkSession,b.settings.terms.errorMessage);this.actionUrls=g}__extends(b,a);b.prototype.getAddResourceMenu=function(a){return $.ajax({type:"GET",url:this.actionUrls.getAddResourceMenu,data:a})};b.prototype.updateEventElements=function(a){return $.ajax({type:"PUT",url:this.actionUrls.updateEventElements,data:JSON.stringify(a),contentType:"application/json"})};b.prototype.removeElement=function(a){return $.ajax({type:"DELETE",
url:this.actionUrls.removeElement,data:JSON.stringify(a),contentType:"application/json"})};b.prototype.createEventWithLocation=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.createEventWithLocation,data:a,dataType:"json"})};b.prototype.editEventTitle=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.EditEventTitle,data:a,dataType:"json"})};b.prototype.editEventDescription=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.editEventDescriptionUrl,
data:a,dataType:"json"})};b.prototype.editEventExtraDescription=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.EditEventExtraDescription,data:a,dataType:"json"})};b.prototype.editNextEventId=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.EditNextEventId,data:a,dataType:"json"})};b.prototype.eventScope=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.eventScopeUrl,data:a,dataType:"json"})};b.prototype.getPreferences=
function(a){return $.ajax({type:"GET",url:this.actionUrls.GetPersonSettingsByPrefix,data:{settingNamePrefix:a}})};b.prototype.deleteEvent=function(a,b){return CCL.CommonFunctions.safeAjaxPost({url:a.deleteEventUrl,data:{ActivityId:a.activityId,IsSingle:b}})};b.prototype.getDatesOfEventsToBePickedAsNextEventForSchedulePage=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetDatesOfEventsToBePickedAsNextEventForSchedulePage,async:!1,data:a,dataType:"json"})};b.prototype.getTimeSlotsOfEventsToBePickedAsNextEventForSchedulePage=
function(a){return $.ajax({type:"GET",url:this.actionUrls.GetTimeSlotsOfEventsToBePickedAsNextEventForSchedulePage,async:!1,data:a,dataType:"json"})};b.prototype.checkIfAnyOfMyEventsFiltered=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.checkIfAnyOfMyEventsFiltered,data:a,dataType:"json"})};b.prototype.getCourseApprovalDates=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetCourseApprovalDates,async:!1,data:a,dataType:"json"})};b.prototype.checkRecurringEventGroupsMembership=
function(a){return $.ajax({type:"GET",url:this.actionUrls.CheckRecurringEventGroupsMembership,async:!1,data:a,dataType:"json"})};return b}(e.AjaxClientBase);f.AjaxClient=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(a){function b(b,g){a.call(this,b.dataAttributes,b.cssClasses,b.terms,b.ClientInstanceNames,b.PostMessageNames,g,b.constants);this.settings=b;this.controls=g;this.initSelectors();this.initDataAttributes()}__extends(b,a);b.prototype.getExpandableContainer=function(a){return a.closest(this.selectors.expandableContainer)};b.prototype.getManuallyAddedElementsCount=function(a){return a.find("li["+this.dataAttributes.elementListItem+"*='\"AddedManually\":true']").length};
b.prototype.formatSectionNameWithCounter=function(a,b){return a+" ("+b+")"};b.prototype.getElementListAppendTarget=function(a){return a.find("."+this.settings.cssClasses.SelectedElementListAppendTarget)};b.prototype.initSelectors=function(){this.selectors.addEventDialogAttachedElementsHidden="data-"+this.settings.dataAttributes.AddEventDialogAttachedElementsHidden;this.selectors.contextDialogHeaderH2="."+this.settings.cssClasses.ContextDialogHeader+" > h2";this.selectors.expandableContainerHeaderIcon=
"."+this.settings.cssClasses.ExpandableContainerHeader+" > ."+this.settings.cssClasses.Icon;this.selectors.expandableContainer="."+this.settings.cssClasses.ExpandableContainer};b.prototype.initDataAttributes=function(){this.dataAttributes.addEventDialogAttachedElementsHidden=CCL.CommonFunctions.getDataSelector(this.settings.dataAttributes.AddEventDialogAttachedElementsHidden)};return b}(e.CalendarUtilityBase);f.Utility=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var f;(function(a){a[a.NotLoaded=0]="NotLoaded";a[a.Loading=1]="Loading";a[a.Loaded=2]="Loaded"})(f||(f={}));var d=function(){function a(a,c,g,d){function b(a){var b=a.position().left+a.width()/2;a=a.position().top+10;q.openDialogAt(b,a,!1)}var h=this,e=f.NotLoaded,k=$("<div class='ccl-context-dialog-content-container'></div>").hide();a.after(k);var n=null,q=new ContextDialog(k,{showHeader:!1,showCloseLink:!1,useMobileViewIfNeeded:!1,width:420,marginTop:c.height(),marginLeft:-210,
scrollToLastWindowOnClose:!1,cssClass:d}),v=q.closeDialog;q.setCloseFunction(function(a){v(a)});window.addEventListener("orientationchange",function(a){return q.closeDialog(a)});k.click(function(){return q.closeDialog()});c.click(function(a){if(q.isOpened())q.closeDialog();else{var c=$(a.target),d=h.getParams(c);e!==f.Loaded||h.paramsAreEqual(n,d)||(e=f.NotLoaded,k.empty());e===f.Loaded?b($(a.currentTarget)):e===f.NotLoaded&&(e=f.Loading,$.get(g,h.formatUrlParams(d),function(c){c&&(k.append(c),b($(a.currentTarget)));
e=f.Loaded;n=d}).fail(function(){return e=f.NotLoaded}))}})}a.prototype.getParams=function(a){throw Error("Abstract method should be overriden");};a.prototype.paramsAreEqual=function(a,c){throw Error("Abstract method should be overriden");};a.prototype.formatUrlParams=function(a){throw Error("Abstract method should be overriden");};return a}();e.BaseDetailedInfo=d})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c){var b=$(".tablelisting"),h=$(".tablelisting > table > tbody > tr > td > a");d.call(this,b,h,a,c)}__extends(a,d);a.prototype.getParams=function(a){var b=a.data("period");a=a.closest("tr").children("td").eq(1).children().html();return{Period:b,CustomerId:a}};a.prototype.paramsAreEqual=function(a,c){return null==a?!1:a.Period===c.Period&&a.CustomerId===c.CustomerId};a.prototype.formatUrlParams=function(a){return{periodid:a.Period,customerId:a.CustomerId}};
return a}(e.BaseDetailedInfo);e.ListOnlineSitesDetailedInfo=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c,g){var b=$(".tabsframe > div");d.call(this,b,a,c,g)}__extends(a,d);a.prototype.getParams=function(a){var b=a.data("period");a=a.closest("tr").data("c-c");return{Period:b,CountryCode:a}};a.prototype.paramsAreEqual=function(a,c){return null==a?!1:a.Period===c.Period&&a.CountryCode===c.CountryCode};a.prototype.formatUrlParams=function(a){return{periodid:a.Period,countrycode:a.CountryCode}};return a}(e.BaseDetailedInfo);e.ListOnlineSummaryDetailedInfo=
f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.isUploaderDirty=function(){var a=c.getNewUploaderInstance();return!!a&&0<a.uploadedItems.uploadMetadataArray.length+a.uploadedItems.fileInCloudMetadataArray.length};this.isFormDirty=function(){return c.isUploaderDirty()||!c.customScripts.isDescriptionEmpty()||0<c.$titleInput.val().length||0<c.$criteriaWeightsHidden.val().length};this.handleConfirmDialogAndSaveButtonBehaviour=function(a){switch(a){case UploadStatus.InProgress:c.lockSaveButton(!0);
break;case UploadStatus.SucceededWithErrors:case UploadStatus.Succeeded:case UploadStatus.Awaiting:case UploadStatus.Failed:c.lockSaveButton(!1)}c.updateSaveButtonState()};var g=this;window[a.ClientInstanceName]=this;this.settings=a;this.customScripts=b;this.timer=0;this.selectedLoIds=this.settings.LearningObjectiveIds;this.$criteriaWeightsHidden=$("#"+this.settings.ClientIds.CriteriaWeightsHidden);this.$manageRubricPopupTriggerLink=$("#"+this.settings.ClientIds.ManageRubricPopupTriggerLink);this.$criteriaWeightsHidden.val(JSON.stringify(this.settings.CriteriaWeights));
this.$document=$(document);b="."+this.settings.Css.SaveButton;this.$saveButton=$(b);this.buttonLoadingIndicator=new CCL.ButtonLoadingIndicator(b,this.settings.Css.ButtonInProgress,null,100);this.$titleInput=$("#"+this.settings.ClientIds.Title);this.isTitleValid=this.validateTitle();this.isDescriptionToolbarExpanded=a.IsDescriptionToolbarExpanded;this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload($("#"+this.settings.ClientIds.Form),this.settings.Terms.BeforeUnloadWarningMessage,{$cancelButtons:this.$saveButton,
callback:this.isFormDirty});this.settings.SubmitButtonLocked&&this.$saveButton.toggleHyperlink(!1);g.isSettingsValid=!0;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,function(a){a.extendedData.updateSettings||(g.selectedLoIds=a.extendedData.loIds,g.$criteriaWeightsHidden.val(a.extendedData.criteriaWeights),$(document).trigger(c.settings.EventNames.RubricChanged,{loIds:c.selectedLoIds,criteriaWeights:a.extendedData.criteriaWeights}))});
this.$manageRubricPopupTriggerLink.click(function(){g.initManageManageRubricPopup();window[g.settings.ClientIds.RubricPopup].openDialog();return!1});this.$titleInput.on("blur",function(){g.onTitleChangeHandler()});this.$titleInput.on("input",function(a){g.onInputChangeHandler(a,g.onTitleChangeHandler)});this.$document.on(this.settings.EventNames.ValidStateChanged,function(a,b){g.isSettingsValid=b;g.updateSaveButtonState()});this.$document.on(this.settings.EventNames.LearningObjectivesChanged,function(a,
b){b.isSyncContext||(g.selectedLoIds=b.ids,$(document).trigger(c.settings.EventNames.UpdateMaxScore,{loIds:g.selectedLoIds,criteriaWeights:g.$criteriaWeightsHidden.val()}))});this.$document.on(this.settings.EventNames.ToggleCriteriaWeightsVisibility,function(a,b){c.settings.ShowCriteriaWeights=b.show});if(!g.settings.IsDescriptionReadOnly)if("undefined"!==typeof CKEDITOR)CKEDITOR.on("instanceReady",function(){var a=g.customScripts.getDescriptionEditorInput();a.on("blur",function(){c.onDescriptionChangeHandler()});
a.on("change",function(a){c.onInputChangeHandler(a,c.onDescriptionChangeHandler)});a.on("contentDom",function(){a.document.on("keyup",function(a){c.onInputChangeHandler(a,c.onDescriptionChangeHandler)})});if(g.isDescriptionToolbarExpanded){var b=a.getCommand(g.settings.DescriptionToolbarExpandedCommandName),d=b.editorFocus;b.editorFocus=!1;a.execCommand(g.settings.DescriptionToolbarExpandedCommandName);b.editorFocus=d}a.on(g.settings.EventNames.DescriptionToolbarExpanded,function(a){g.isDescriptionToolbarExpanded=
a.data.expanded;g.toggleDescriptionToolbar()});c.onDescriptionChangeHandler()});else this.onDescriptionChange($(this.customScripts.getDescriptionEditorInput()));this.updateSaveButtonState();this.$document.on(a.EventNames.PreviewDialogOpened,function(){CCL.CommonFunctions.makePostMessageCall(window,new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.hideSettings,{ForceReload:!1}))});this.$document.on(a.EventNames.PreviewDialogClosed,function(){CCL.CommonFunctions.makePostMessageCall(window,
new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.showSettings))});this.buttonLoadingIndicator.disableLoadingIndicator=!this.$saveButton.getIfHyperLinkEnabled();$("button."+this.settings.Css.CancelButton).on("click",function(){window.close()})}d.prototype.closeManageRubricDialog=function(){var a=$("#"+this.settings.ClientIds.RubricPopup).find("iframe").get(0).contentWindow;CCL.CommonFunctions.makePostMessageCall(a,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.submitIframe))};
d.prototype.collectContent=function(){var a={};a.Title=this.$titleInput.val();a.Description=this.customScripts.isDescriptionEmpty()?"":this.customScripts.getDescription();var b=this.getNewUploaderInstance();b&&(a.SerializedUploadResults=JSON.stringify(b.uploadedItems));a.SerializedCriteriaWeights=this.$criteriaWeightsHidden.val();return a};d.prototype.lockSaveButton=function(a){this.settings.SubmitButtonLocked=a};d.prototype.validateTitle=function(){var a=this.$titleInput.val();return a&&0<a.length};
d.prototype.onDescriptionChange=function(a){var b=this;a.on("blur",function(){b.onDescriptionChangeHandler()});a.on("input",function(a){b.onInputChangeHandler(a,b.onDescriptionChangeHandler)})};d.prototype.onTitleChangeHandler=function(){var a=this.getSettingsEditor();null!=a&&a.stateChanged();this.isTitleValid=this.validateTitle();this.updateSaveButtonState()};d.prototype.getSettingsEditor=function(){null==this.settingsEditor&&(this.settingsEditor=window[this.settings.ClientIds.EditSettingsViewInstanceName]);
return this.settingsEditor};d.prototype.typeWatch=function(a,b){clearTimeout(this.timer);this.timer=setTimeout(a.bind(this),b)};d.prototype.onInputChangeHandler=function(a,b){a=a.which;a>=CCL.CommonConstants.keyCodes.arrowLeft&&a<=CCL.CommonConstants.keyCodes.arrowDown||this.typeWatch(b,500)};d.prototype.onDescriptionChangeHandler=function(){var a=this.getSettingsEditor();null!=a&&a.stateChanged();this.updateSaveButtonState()};d.prototype.initManageManageRubricPopup=function(){var a=this.settings.ManageRubricDialogUrl,
b=this.getParameterByName(a,"Ids");a=b?a.replace(b[0],b[0][0]+"Ids="+encodeURIComponent(this.selectedLoIds.join(","))):a+(-1===a.indexOf("?")?"?":"&")+"Ids="+encodeURIComponent(this.selectedLoIds.join(","));if(b=this.$criteriaWeightsHidden.val()){var c=this.getParameterByName(a,"CriteriaWeights");a=c?a.replace(c[0],c[0][0]+"CriteriaWeights="+encodeURIComponent(b)):a+(-1===a.indexOf("?")?"?":"&")+"CriteriaWeights="+encodeURIComponent(b)}b=this.settings.ShowCriteriaWeights?"1":"0";a=(c=this.getParameterByName(a,
"ShowCriteriaWeights"))?a.replace(c[0],c[0][0]+"ShowCriteriaWeights="+b):a+(-1===a.indexOf("?")?"?":"&")+"ShowCriteriaWeights="+b;window[this.settings.ClientIds.RubricPopup].setIframeUrl(a)};d.prototype.getParameterByName=function(a,b){return RegExp("[?&]"+b+"=([^&]*)").exec(a)};d.prototype.updateSaveButtonState=function(){this.settings.SubmitButtonLocked?this.$saveButton.toggleHyperlink(!1):this.$saveButton.toggleHyperlink(this.isSettingsValid&&this.isTitleValid);this.buttonLoadingIndicator.disableLoadingIndicator=
!this.$saveButton.getIfHyperLinkEnabled()};d.prototype.toggleDescriptionToolbar=function(){CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPersonSetting,data:{key:this.settings.PersonSettingIsDescriptionToolbarExpandedKey,value:this.isDescriptionToolbarExpanded?"true":"false"}})};d.prototype.getNewUploaderInstance=function(){var a=window.document.getElementById(this.settings.ClientIds.UploadAreaClientId);return a?a[this.settings.ClientIds.UploaderControlClientInstanceName]:void 0};
return d}();e.AddLearningToolElement=f})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){}d.prototype.validateAndTransferElementStateAfterClick=function(a,b){this.validateElementState(a,b);return this.transferElementState(b)};d.prototype.transferElementStateAfterSave=function(a){return a===e.State.AttachedByUser?e.State.Saved:a===e.State.DetachedByUser?e.State.Empty:a};d.prototype.isElementChecked=function(a){return a===e.State.AttachedByUser||a===e.State.Saved};d.prototype.validateElementState=function(a,b){if(!(a&&!this.isElementChecked(b)||
!a&&this.isElementChecked(b)))throw Error("Incorrect element state occurred IsChecked "+a+" StateBeforeCheck "+b);};d.prototype.transferElementState=function(a){switch(a){case e.State.DetachedByUser:return e.State.Saved;case e.State.Empty:return e.State.AttachedByUser;case e.State.AttachedByUser:return e.State.Empty;case e.State.Saved:return e.State.DetachedByUser;default:throw Error("Unknown State "+a);}};return d}();e.Machine=f})(f.CheckboxStateMachine||(f.CheckboxStateMachine={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.peerAndSelfAssessmentStateChanged=function(a){b.togglePeerAssessment();$(document).trigger(b.settings.Triggers.StateChanged,[b.activated,b.selfAssessmentActivated])};this.deadlineChanged=function(a){b.enabled=b.hasDeadline&&!b.groupActivityEnabled};this.groupActivityStateChanged=function(a,c){b.groupActivityEnabled=c;b.groupActivityEnabled&&(b.activated=!1,b.selfAssessmentActivated=!1);b.enabled=b.hasDeadline&&
!b.groupActivityEnabled;b.selfAssessmentEnabled=!b.groupActivityEnabled};window[a]=this;this.settings=c;$(function(){b.$peerAssessmentDropDownContainer=$("#"+b.settings.Controls.PeersCountDropDownContainer);b.$peerAssessmentDropDown=$("#"+b.settings.Controls.PeersCountDropDown);b.$container=$("#"+b.settings.Controls.Container);b.$checkbox=$("#"+b.settings.Controls.Checkbox);b.$selfAssessmentCheckbox=$("#"+b.settings.Controls.SelfAssessmentCheckbox);b.customTooltipForCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(b.$checkbox);
b.$customTooltipForSelfAssessmentCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(b.$selfAssessmentCheckbox);b.deadline=window[b.settings.ClientInstanceNames.Deadline];b.groupActivityEnabled=b.settings.GroupActivityEnabled;b.enabled=b.settings.Enabled;b.selfAssessmentEnabled=!b.settings.GroupActivityEnabled;b.$peerAssessmentDropDown.val(b.settings.PeersCount.toString());b.togglePeerAssessment();if(!b.settings.Enabled||!b.settings.HasDeadlinePassed)if($(b.deadline).change(b.deadlineChanged),
b.$checkbox.change(b.peerAndSelfAssessmentStateChanged),b.settings.Events.GroupActivityStateChanged)$(document).off(b.settings.Events.GroupActivityStateChanged).on(b.settings.Events.GroupActivityStateChanged,b.groupActivityStateChanged);b.$selfAssessmentCheckbox.change(b.peerAndSelfAssessmentStateChanged)})}Object.defineProperty(a.prototype,"activated",{get:function(){return this.$checkbox.is(":checked")},set:function(a){this.$checkbox.toggle(a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"selfAssessmentActivated",{get:function(){return this.$selfAssessmentCheckbox.is(":checked")},set:function(a){this.$selfAssessmentCheckbox.toggle(a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"enabled",{set:function(a){this.$container.toggleClass(this.settings.CssClasses.Disabled,!a);this.$checkbox.prop("disabled",!a);this.customTooltipForCheckbox.setToolTipHtml(a?"":this.tooltip);this.customTooltipForCheckbox.enableToolTip(!a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"selfAssessmentEnabled",{set:function(a){this.$selfAssessmentCheckbox.prop("disabled",!a);this.$customTooltipForSelfAssessmentCheckbox.setToolTipHtml(a?"":this.settings.Terms.SelfAssessmentDisabledWarning);this.$customTooltipForSelfAssessmentCheckbox.enableToolTip(!a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"peersToAssessCount",{get:function(){return this.$peerAssessmentDropDown.val()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasDeadline",{get:function(){var a=
this.deadline.getState().DateTime;return void 0!==a&&""!==a&&null!=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"tooltip",{get:function(){return this.settings.HasDeadlinePassed?this.settings.Terms.DeadlineHasPassedWarning:this.hasDeadline?this.groupActivityEnabled?this.settings.Terms.PeerAssessmentDisabledWarning:"":this.settings.Terms.DeadlineIsEmptyWarning},enumerable:!0,configurable:!0});a.prototype.togglePeerAssessment=function(){this.$peerAssessmentDropDownContainer.toggle(this.$checkbox.is(":checked"));
this.$peerAssessmentDropDownContainer.prop("disabled",!this.$checkbox.is(":enabled"));this.$peerAssessmentDropDown.prop("disabled",!this.$checkbox.is(":enabled"))};return a}();e.PeerAssessment=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a){var b=this;this.viewModel=a;this.onJQueryReady=function(){b._$controlElement=$("#"+b.viewModel.ContainerId);b._$whenToShowResultElement=$("."+b.viewModel.WhenToShowResultSelector,b._$controlElement);b._$whenToShowQuestionListAndAnswerElement=$("."+b.viewModel.WhenToShowQuestionListAndAnswerSelector,b._$controlElement);b._$whenToShowQuestionListAndAnswerContainer=$("#"+b.viewModel.WhenToShowQuestionListAndAnswerContainer,
b._$controlElement);b._$revealCorrectAnswerContainer=$("#"+b.viewModel.RevealCorrectAnswerContainer,b._$controlElement);b._$maxAttemptsAllowedElement=$(""+b.viewModel.MaxAttemptsAllowedSelector)};this._$revealCorrectAnswerElement=$("#"+a.RevealCorrectAnswerClientId);this._deadlinePicker=window[a.DeadlineInstanceName];$(this.onJQueryReady)}Object.defineProperty(a.prototype,"$controlElement",{get:function(){return this._$controlElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"$whenToShowResultElement",{get:function(){return this._$whenToShowResultElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowResultAllOptionElements",{get:function(){return $("option",this.$whenToShowResultElement)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerElement",{get:function(){return this._$whenToShowQuestionListAndAnswerElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerAllOptionElements",
{get:function(){return $("option",this.$whenToShowQuestionListAndAnswerElement)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"revealCorrectAnswerElement",{get:function(){return this._$revealCorrectAnswerElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerContainer",{get:function(){return this._$whenToShowQuestionListAndAnswerContainer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$revealCorrectAnswerContainer",
{get:function(){return this._$revealCorrectAnswerContainer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$maxAttemptsAllowedElement",{get:function(){return this._$maxAttemptsAllowedElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"deadlinePicker",{get:function(){return this._deadlinePicker},enumerable:!0,configurable:!0});a.prototype.appendOptionToWhenToShowResultElement=function(a,b){this.$whenToShowResultElement.append($("<option></option>").prop("value",
a.toString()).text(b))};a.prototype.appendOptionToWhenToShowQuestionListAndAnswerElement=function(a,b){this.$whenToShowQuestionListAndAnswerElement.append($("<option></option>").prop("value",a.toString()).text(b))};Object.defineProperty(a.prototype,"$whenToShowResultAfterDeadlineOptionItem",{get:function(){return this.$getWhenToShowResultOptionItem(e.WhenToShowResult.AfterDeadline)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem",
{get:function(){return this.$getWhenToShowQuestionListAndAnswerOptionItem(e.WhenToShowQuestionListAndAnswer.AfterDeadline)},enumerable:!0,configurable:!0});a.prototype.setTextToWhenToShowResultOption=function(a,b){$("option[value="+a.toString()+"]",this.$whenToShowResultElement).text(b)};a.prototype.setTextToWhenToShowQuestionListAndAnswerOption=function(a,b){$("option[value="+a.toString()+"]",this.$whenToShowQuestionListAndAnswerElement).text(b)};a.prototype.$getWhenToShowResultOptionItem=function(a){return $("option[value="+
a.toString()+"]",this.$whenToShowResultElement)};a.prototype.$getWhenToShowQuestionListAndAnswerOptionItem=function(a){return $("option[value="+a.toString()+"]",this.$whenToShowQuestionListAndAnswerElement)};return a}();d.ControlsProvider=a})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(){this.handlers=[]}a.prototype.on=function(a){this.handlers.push(a)};a.prototype.trigger=function(a){this.handlers.slice(0).forEach(function(b){return b(a)})};return a}();d.EventHandler=a;var b=function(){return function(a,b){this.previous=a;this.current=b}}();d.MaxAttemptsEventData=b;var c=function(){function c(c,g){var d=this;this.viewModel=c;this.controlsProvider=g;this.deadlineChanged=function(a){d.onDeadlineChangedHandler.trigger(d.hasDeadline)};
this.attemptsChanged=function(a){d.onAttemptsChangedHandler.trigger(new b(d.previousMaxAttemptsAllowed,d.maxAttemptsAllowed));d.previousMaxAttemptsAllowed=d.maxAttemptsAllowed};this.onJQueryReady=function(){d.previousMaxAttemptsAllowed=d.maxAttemptsAllowed;$(d.controlsProvider.deadlinePicker).change(d.deadlineChanged);d.controlsProvider.$maxAttemptsAllowedElement.change(d.attemptsChanged)};this.onDeadlineChangedHandler=new a;this.onAttemptsChangedHandler=new a;$(this.onJQueryReady)}Object.defineProperty(c.prototype,
"onDeadlineChanged",{get:function(){return this.onDeadlineChangedHandler},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"onAttemptsChanged",{get:function(){return this.onAttemptsChangedHandler},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"maxAttemptsAllowed",{get:function(){return parseInt(this.controlsProvider.$maxAttemptsAllowedElement.val())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasDeadline",{get:function(){var a=this.controlsProvider.deadlinePicker.getState().DateTime;
return void 0!==a&&""!==a&&null!=a},enumerable:!0,configurable:!0});c.prototype.hasMaxAttemptsChangedToMultiple=function(a,b){return 1===a&&(1<b||b===this.viewModel.UnlimitedAttemptsValue)};c.prototype.hasMaxAttemptsChangedToSingle=function(a,b){return 1===b&&(1<a||a===this.viewModel.UnlimitedAttemptsValue)};return c}();d.ExternalDependenciesController=c})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b,d){var c=this;this.viewModel=a;this.controlsProvider=b;this.externalDependenciesController=d;this.removeAfterDeadline=function(){var a=c.whenToShowResult;c.controlsProvider.$whenToShowResultAfterDeadlineOptionItem.remove();a===e.WhenToShowResult.AfterDeadline&&c.controlsProvider.$whenToShowResultElement.val(c.defaultWhenToShowResult).change()};this.addAfterDeadline=function(){if(void 0===c.controlsProvider.$whenToShowResultAfterDeadlineOptionItem[0]){var a=
e.WhenToShowResult.AfterDeadline;c.controlsProvider.appendOptionToWhenToShowResultElement(a,c.getWhenToShowResultOptionText(a))}};this.deadlineChanged=function(a){a?c.addAfterDeadline():c.removeAfterDeadline()};this.replaceEachAttemptWithTheAttempt=function(){c.replaceAttempt(!0)};this.replaceTheAttemptWithEachAttempt=function(){c.replaceAttempt(!1)};this.replaceAttempt=function(a){var b=e.WhenToShowResult.AfterEachAttempt;a=a?c.getWhenToShowResultOptionAlternativeText(b):c.getWhenToShowResultOptionText(b);
c.controlsProvider.setTextToWhenToShowResultOption(b,a)};this.removeAfterAllAttempts=function(a){c.controlsProvider.$getWhenToShowResultOptionItem(e.WhenToShowResult.AfterAllAttempts).remove();a===e.WhenToShowResult.AfterAllAttempts&&c.controlsProvider.$whenToShowResultElement.val(c.defaultWhenToShowResult).change()};this.attachDefaultList=function(){c.controlsProvider.$whenToShowResultAllOptionElements.each(function(a,b){a=$(b).val();$(b).text(c.getWhenToShowResultOptionText(a))});if(void 0===c.controlsProvider.$getWhenToShowResultOptionItem(e.WhenToShowResult.AfterAllAttempts)[0]&&
c.shouldHaveAfterAllAttemptsOption){var a=e.WhenToShowResult.AfterAllAttempts;c.controlsProvider.appendOptionToWhenToShowResultElement(a,c.getWhenToShowResultOptionText(a))}c.replaceTheAttemptWithEachAttempt()};this.adjustWhenToShowResultElementValue=function(a,b,g){c.externalDependenciesController.hasMaxAttemptsChangedToSingle(a,b)?g===e.WhenToShowResult.AfterAllAttempts&&c.controlsProvider.$whenToShowResultElement.val(e.WhenToShowResult[e.WhenToShowResult.AfterEachAttempt]).change():c.externalDependenciesController.hasMaxAttemptsChangedToMultiple(a,
b)&&(a=e.WhenToShowResult[e.WhenToShowResult.AfterAllAttempts],b===c.viewModel.UnlimitedAttemptsValue&&(a=e.WhenToShowResult[e.WhenToShowResult.AfterEachAttempt]),g===e.WhenToShowResult.AfterEachAttempt&&c.controlsProvider.$whenToShowResultElement.val(a).change())};this.attemptsChanged=function(a){switch(a.current){case 1:c.replaceEachAttemptWithTheAttempt();c.removeAfterAllAttempts(c.whenToShowResult);break;case c.viewModel.UnlimitedAttemptsValue:c.replaceTheAttemptWithEachAttempt();c.removeAfterAllAttempts(c.whenToShowResult);
break;default:c.attachDefaultList()}c.adjustWhenToShowResultElementValue(a.previous,a.current,c.whenToShowResult)};this.onJQueryReady=function(){c.buildWhenToShowResultList()};d.onDeadlineChanged.on(this.deadlineChanged);d.onAttemptsChanged.on(this.attemptsChanged);$(this.onJQueryReady)}Object.defineProperty(a.prototype,"defaultWhenToShowResult",{get:function(){return e.WhenToShowResult[e.WhenToShowResult.AfterEachAttempt]},enumerable:!0,configurable:!0});a.prototype.getWhenToShowResultOptionText=
function(a){return this.viewModel.WhenToShowResultsOptions.filter(function(b){return b.Value===a})[0].Text};a.prototype.getWhenToShowResultOptionAlternativeText=function(a){return this.viewModel.WhenToShowResultsOptions.filter(function(b){return b.Value===a})[0].AlternativeText};a.prototype.buildWhenToShowResultList=function(){var a=this;this.controlsProvider.$whenToShowResultElement.empty();$.each(this.viewModel.WhenToShowResultsOptions,function(b,c){c.Value===e.WhenToShowResult.AfterEachAttempt?
1===a.externalDependenciesController.maxAttemptsAllowed?a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.AlternativeText):a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.Text):c.Value===e.WhenToShowResult.AfterDeadline?a.externalDependenciesController.hasDeadline&&a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.Text):c.Value===e.WhenToShowResult.AfterAllAttempts?a.shouldHaveAfterAllAttemptsOption&&a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,
c.Text):a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.Text)});this.controlsProvider.$whenToShowResultElement.val(this.viewModel.ResultsAndFeedbackState.WhenToShowResult.toString()).change();this.deadlineChanged(this.externalDependenciesController.hasDeadline)};Object.defineProperty(a.prototype,"whenToShowResult",{get:function(){var a=this.controlsProvider.$whenToShowResultElement.val();return e.WhenToShowResult[a]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"whenToShowResultsChanged",{get:function(){return this.whenToShowResult!==this.viewModel.ResultsAndFeedbackState.WhenToShowResult},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"shouldHaveAfterAllAttemptsOption",{get:function(){return 1!==this.externalDependenciesController.maxAttemptsAllowed&&this.externalDependenciesController.maxAttemptsAllowed!==this.viewModel.UnlimitedAttemptsValue&&this.whenToShowResult!==e.WhenToShowResult.WhenTeacherDecides&&this.whenToShowResult!==e.WhenToShowResult.AfterDeadline},
enumerable:!0,configurable:!0});return a}();d.WhenToShowResultsController=a})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b){var c=this;this.controls=a;this.settings=b;this.ajaxParams={};this.afterOkClickCallback=function(a){if(a){c.currentElementStates=f.MapUtils.makeCopy(a);c.saveElementStates();var b=[];a.forEach(function(a,g){c.checkboxStateMachine.isElementChecked(a)&&b.push(g)});c.updateElementListMarkup(b)}};this.currentElementStates=new Map;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.loadElementStates();this.ajaxParams={locationId:this.settings.CourseId,
locationType:f.AddResourceMenu.ElementExternalSourceType.Course};this.ajaxClient=new e.ElementPickerAjaxClient(this.settings.Urls,this.settings.Terms.AnErrorOccurred);this.controls.AddButton.click(function(){var a={elementStates:f.MapUtils.makeCopy(c.currentElementStates),elementType:f.ElementLinkDialog.ContentElementType.Files,showAll:!0,allowFolderSelection:!1,header:c.settings.Terms.DialogTitle,afterOkClickCallback:c.afterOkClickCallback,openerPage:f.ElementLinkDialog.ElementsPopupOpener.None,
relatedEntityId:c.settings.CustomActivityId};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(a,c.ajaxParams)});a=$(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.SelectedElementListAppendTarget));a.on("click","."+this.settings.CssClasses.DetachElement,function(a){a=$(a.target).closest("li");var b=a.data(c.settings.DataAttributes.ElementId),g=a.closest("."+c.settings.CssClasses.SelectedElementList),d=a.next().find("a").first();0===d.length&&(d=c.controls.AddButton);
a.remove();0===g.children("li").length&&g.remove();d.focus();c.detachElementFromMap(b)});a.on("mouseenter","."+this.settings.CssClasses.SelectedElementList+" > li",function(a){a=$(a.currentTarget).find("."+c.settings.CssClasses.ElementTitle).get(0);var b=$(a).closest("a"),g=a.offsetWidth;CCL.CommonFunctions.isChrome()&&!CCL.CommonFunctions.isEdge()||g++;b.prop("title",g<a.scrollWidth?a.textContent.trim():"")})}d.prototype.loadElementStates=function(){this.currentElementStates=f.MapUtils.jsonStringToMap(this.controls.PickerResultHidden.val(),
f.MapUtils.numberKeyConverter)};d.prototype.saveElementStates=function(){this.controls.PickerResultHidden.val(f.MapUtils.mapToJsonString(this.currentElementStates))};d.prototype.updateElementListMarkup=function(a){var b=$(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.SelectedElementListAppendTarget));b.empty();this.ajaxClient.getElementListMarkupByIds({CourseId:this.settings.CourseId,ElementIds:a}).done(function(a){return b.append($(a))})};d.prototype.detachElementFromMap=function(a){var b=
this.currentElementStates.get(a);b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,b);this.currentElementStates.set(a,b);this.saveElementStates()};return d}();e.PickerManager=k})(f.CustomActivityElementPicker||(f.CustomActivityElementPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b,d,f){var c=this;this.viewModel=a;this.controlsProvider=b;this.whenToShowResultsController=d;this.externalDependenciesController=f;this.removeAfterDeadline=function(){c.removeAfterDeadlineSetNewValue(c.defaultWhenToShowQuestionListAndAnswer)};this.addAfterDeadline=function(){if(c.whenToShowResultsController.whenToShowResult!==e.WhenToShowResult.WhenTeacherDecides){if(void 0===c.controlsProvider.$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem[0]){var a=
e.WhenToShowQuestionListAndAnswer.AfterDeadline;c.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(a,c.getWhenToShowQuestionListAndAnswerOptionText(a))}}else c.removeAfterDeadlineSetNewValue(c.neverWhenToShowQuestionListAndAnswer)};this.deadlineChanged=function(a){a?c.addAfterDeadline():c.removeAfterDeadline()};this.whenToShowResultChanged=function(a){a=c.whenToShowResultsController.whenToShowResult;a===e.WhenToShowResult.Never&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(e.WhenToShowQuestionListAndAnswer.Never.toString()).change();
c.buildWhenToShowQuestionListAndAnswerList(c.whenToShowQuestionListAndAnswer);c.controlsProvider.$whenToShowQuestionListAndAnswerContainer.toggle(a!==e.WhenToShowResult.Never);c.deadlineChanged(c.externalDependenciesController.hasDeadline)};this.whenToShowQuestionListAndAnswerChanged=function(a){a=c.whenToShowQuestionListAndAnswer;a===e.WhenToShowQuestionListAndAnswer.Never&&c.controlsProvider.revealCorrectAnswerElement.toggle(!1);c.controlsProvider.$revealCorrectAnswerContainer.toggle(a!==e.WhenToShowQuestionListAndAnswer.Never)};
this.replaceEachAttemptWithTheAttempt=function(){c.replaceAttempt(!0)};this.replaceTheAttemptWithEachAttempt=function(){c.replaceAttempt(!1)};this.replaceAttempt=function(a){var b=e.WhenToShowQuestionListAndAnswer.AfterEachAttempt;a=a?c.getWhenToShowQuestionListAndAnswerOptionAlternativeText(b):c.getWhenToShowQuestionListAndAnswerOptionText(b);c.controlsProvider.setTextToWhenToShowQuestionListAndAnswerOption(b,a)};this.removeAfterAllAttempts=function(a){c.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(e.WhenToShowQuestionListAndAnswer.AfterAllAttempts).remove();
a===e.WhenToShowQuestionListAndAnswer.AfterAllAttempts&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(c.defaultWhenToShowQuestionListAndAnswer).change()};this.attachDefaultList=function(){c.controlsProvider.$whenToShowQuestionListAndAnswerAllOptionElements.each(function(a,b){a=$(b).val();$(b).text(c.getWhenToShowQuestionListAndAnswerOptionText(a))});if(void 0===c.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(e.WhenToShowQuestionListAndAnswer.AfterAllAttempts)[0]&&
c.shouldHaveAfterAllAttemptsOption){var a=e.WhenToShowQuestionListAndAnswer.AfterAllAttempts;c.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(a,c.getWhenToShowQuestionListAndAnswerOptionText(a))}c.whenToShowResultsController.whenToShowResult===e.WhenToShowResult.WhenTeacherDecides&&c.removeAfterAllAttempts(c.whenToShowQuestionListAndAnswer);c.replaceTheAttemptWithEachAttempt()};this.adjustWhenToShowQuestionListAndAnswerElementValue=function(a,b,g){c.externalDependenciesController.hasMaxAttemptsChangedToSingle(a,
b)?g===e.WhenToShowQuestionListAndAnswer.AfterAllAttempts&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterEachAttempt]).change():c.externalDependenciesController.hasMaxAttemptsChangedToMultiple(a,b)&&(a=e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterAllAttempts],b===c.viewModel.UnlimitedAttemptsValue&&(a=e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterEachAttempt]),
g===e.WhenToShowQuestionListAndAnswer.AfterEachAttempt&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a).change())};this.attemptsChanged=function(a){switch(a.current){case 1:c.replaceEachAttemptWithTheAttempt();c.removeAfterAllAttempts(c.whenToShowQuestionListAndAnswer);break;case c.viewModel.UnlimitedAttemptsValue:c.replaceTheAttemptWithEachAttempt();c.removeAfterAllAttempts(c.whenToShowQuestionListAndAnswer);break;default:c.attachDefaultList()}c.adjustWhenToShowQuestionListAndAnswerElementValue(a.previous,
a.current,c.whenToShowQuestionListAndAnswer)};this.onJQueryReady=function(){c.buildWhenToShowQuestionListAndAnswerList(c.viewModel.ResultsAndFeedbackState.WhenToShowQuestionListAndAnswer);c.controlsProvider.$whenToShowResultElement.change(c.whenToShowResultChanged);c.controlsProvider.$whenToShowQuestionListAndAnswerElement.change(c.whenToShowQuestionListAndAnswerChanged);c.controlsProvider.$whenToShowQuestionListAndAnswerContainer.toggle(c.whenToShowResultsController.whenToShowResult!==e.WhenToShowResult.Never)};
f.onDeadlineChanged.on(this.deadlineChanged);f.onAttemptsChanged.on(this.attemptsChanged);$(this.onJQueryReady)}Object.defineProperty(a.prototype,"defaultWhenToShowQuestionListAndAnswer",{get:function(){return e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterEachAttempt]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"neverWhenToShowQuestionListAndAnswer",{get:function(){return e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.Never]},
enumerable:!0,configurable:!0});a.prototype.getWhenToShowQuestionListAndAnswerOptionText=function(a){return this.viewModel.WhenToShowQuestionListAndAnswerOptions.filter(function(b){return b.Value===a})[0].Text};a.prototype.getWhenToShowQuestionListAndAnswerOptionAlternativeText=function(a){return this.viewModel.WhenToShowQuestionListAndAnswerOptions.filter(function(b){return b.Value===a})[0].AlternativeText};a.prototype.removeAfterDeadlineSetNewValue=function(a){var b=this.whenToShowQuestionListAndAnswer;
this.controlsProvider.$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem.remove();b===e.WhenToShowQuestionListAndAnswer.AfterDeadline&&this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a).change()};Object.defineProperty(a.prototype,"shouldHaveAfterAllAttemptsOption",{get:function(){return this.whenToShowResultsController.shouldHaveAfterAllAttemptsOption},enumerable:!0,configurable:!0});a.prototype.buildWhenToShowQuestionListAndAnswerList=function(a){var b=this;this.controlsProvider.$whenToShowQuestionListAndAnswerElement.empty();
$.each(this.viewModel.WhenToShowQuestionListAndAnswerOptions,function(a,c){c.Value===e.WhenToShowQuestionListAndAnswer.AfterEachAttempt?b.whenToShowResultsController.whenToShowResult!==e.WhenToShowResult.WhenTeacherDecides&&(1===b.externalDependenciesController.maxAttemptsAllowed?b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.AlternativeText):b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text)):c.Value===e.WhenToShowQuestionListAndAnswer.AfterAllAttempts?
b.shouldHaveAfterAllAttemptsOption&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text):c.Value===e.WhenToShowQuestionListAndAnswer.WithResults?b.whenToShowResultsController.whenToShowResult===e.WhenToShowResult.WhenTeacherDecides&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text):c.Value===e.WhenToShowQuestionListAndAnswer.AfterDeadline?b.externalDependenciesController.hasDeadline&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,
c.Text):b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text)});void 0!==this.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(a)[0]?this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a.toString()).change():this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(e.WhenToShowQuestionListAndAnswer.Never.toString()).change();this.deadlineChanged(this.externalDependenciesController.hasDeadline)};Object.defineProperty(a.prototype,
"whenToShowQuestionListAndAnswer",{get:function(){var a=this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val();return e.WhenToShowQuestionListAndAnswer[a]},enumerable:!0,configurable:!0});return a}();d.WhenToShowQuestionListAndAnswerController=a})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.AssessmentScaleState=d;d=function(){function a(a,c){var b=this;this.onAssessmentChanged=function(a){var c=b.$assessmentItemDropDown.find("option:selected").val(),g=c===b.settings.Constants.UseScoreItemValue;b.settings.EventNames.ToggleCriteriaWeightVisibility&&$(document).trigger(b.settings.EventNames.ToggleCriteriaWeightVisibility,{show:c!==b.settings.Constants.DoNotUseAssessmentItemValue});0===b.$assessmentItemDropDown.length&&
(g=b.settings.Permissions.IsScoreUsed);b.$maxScoreFloatingSection.toggle(g);b.onMaxScoreStateChanged();b.settings.Permissions.UseGradeBook&&b.toggleTermAndCategoryPanel();if(void 0!==b.onChangeHandler&&void 0!==a)b.onChangeHandler(a)};window[a]=this;this.settings=c;$(function(){b.$assessmentItemDropDown=$("#"+b.settings.Controls.AssessmentItemDropDown);b.$maxScoreFloatingSection=$("#"+b.settings.Controls.MaxScoreFloatingSection);b.$maxScoreTextBox=$("#"+b.settings.Controls.MaxScoreTextBox);b.$assessmentRecordContainer=
$("#"+b.settings.Controls.AssessmentRecordContainer);b.$termAndCategoryContainer=$("#"+b.settings.Controls.TermAndCategoryContainer);b.$categoryDropDown=$("#"+b.settings.Controls.CategoryDropDown);b.$termDropDown=$("#"+b.settings.Controls.TermDropDown);b.$addToGradeBookCheckbox=$("#"+b.settings.Controls.AddToGradeBookCheckbox);if(b.settings.Permissions.UseGradeBook)b.$addToGradeBookCheckbox.on("change",function(a){return b.toggleTermAndCategoryContainer(a)});b.$assessmentItemDropDown.on("change",
function(a){return b.onAssessmentChanged(a)});if(b.$maxScoreTextBox)b.$maxScoreTextBox.on("blur input",function(){return b.onMaxScoreStateChanged()}).on("keydown",function(a){return b.onMaxScoreKeyDown(a)})})}a.prototype.onChange=function(a){this.onChangeHandler=a};a.prototype.getState=function(){var a={};a.AssessmentScaleId=parseInt(this.$assessmentItemDropDown.find("option:selected").val(),10);a.IsScore=a.AssessmentScaleId===parseInt(this.settings.Constants.UseScoreItemValue,10);a.MaxScore=parseInt(this.$maxScoreTextBox.val(),
10);this.settings.Permissions.UseGradeBook&&(a.AddToGradeBook=this.$addToGradeBookCheckbox.is(":checked"));this.$categoryDropDown&&(a.CategoryId=parseInt(this.$categoryDropDown.val(),10));this.$termDropDown&&(a.TermId=parseInt(this.$termDropDown.val(),10));return a};a.prototype.useAssessment=function(){return this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue};a.prototype.canUseAutoMaxScore=function(){return this.settings.Permissions.CanUseAutoMaxScore};
a.prototype.isValid=function(){return this.$assessmentItemDropDown.find("option:selected").val()===this.settings.Constants.UseScoreItemValue&&this.$maxScoreTextBox?this.validateScore(this.$maxScoreTextBox.val()):!0};a.prototype.updateMaxScore=function(a,c,g){var b=this;a&&0!==a.length?CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetCriteriaWeightTotal,data:{elementId:this.settings.ElementId,courseId:this.settings.CourseId,learningObjectiveIds:a,changedCriteriaWeights:c}}).done(function(a){b.calculateMaxScore(0<
a.criteriaWeightTotal,a.criteriaWeightTotal);g&&g()}):this.calculateMaxScore(!1,0)};a.prototype.onMaxScoreStateChanged=function(){this.settings.EventNames.MandatoryFieldsStateChangedClient&&$(document).trigger(this.settings.EventNames.MandatoryFieldsStateChangedClient)};a.prototype.calculateMaxScore=function(a,c){a?(this.$maxScoreTextBox.val((c*this.settings.NumberOfAchievementLevels).toString()),this.$maxScoreTextBox.attr("readonly","readonly"),CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$maxScoreTextBox,
this.settings.AutoMaxScoreToolTip)):(this.$maxScoreTextBox.removeAttr("readonly"),CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$maxScoreTextBox,""))};a.prototype.validateScore=function(a){if(""===a)return!1;a=parseFloat(a.replace(this.settings.NumberDecimalSeparator,"."));return isNaN(a)||a<this.settings.MaxScoreMinValue||a>this.settings.MaxScoreMaxValue?!1:!0};a.prototype.toggleTermAndCategoryPanel=function(){var a=this.$assessmentItemDropDown.find("option:selected").val()!==
this.settings.Constants.DoNotUseAssessmentItemValue;a&&this.$assessmentRecordContainer.is(":visible")||(this.$assessmentRecordContainer.toggle(a),this.$addToGradeBookCheckbox.prop("checked",a).change())};a.prototype.toggleTermAndCategoryContainer=function(a){a=$(a.target).is(":checked");this.$termAndCategoryContainer.toggle(a)};a.prototype.onMaxScoreKeyDown=function(a){CCL.CommonFunctions.preventInputIncorrectCharacters(a,[CCL.CommonConstants.keyCodes.del,CCL.CommonConstants.keyCodes.backspace,CCL.CommonConstants.keyCodes.tab,
CCL.CommonConstants.keyCodes.escape,CCL.CommonConstants.keyCodes.enter])};return a}();e.AssessmentScale=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.GroupActivityState=d;d=function(){function a(a,c){var b=this;this.peerAndSelfAssessmentStateChanged=function(a,c,g){b.peerAssessmentEnabled=c;b.selfAssessmentEnabled=g;b.enabled=b.canEdit()};this.groupActivityCheckboxChanged=function(a){b.toggleGroupActivity();$(document).trigger(b.settings.Triggers.StateChanged,b.enabled)};window[a]=this;this.settings=c;$(function(){b.peerAssessmentEnabled=b.settings.PeerAssessmentEnabled;
b.selfAssessmentEnabled=b.settings.SelfAssessmentEnabled;b.$checkBox=$("#"+b.settings.Controls.CheckboxId);b.customTooltipForCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(b.$checkBox);b.$dropDown=$("#"+b.settings.Controls.DropDownId);b.$container=$("#"+b.settings.Controls.Container);b.enabled=b.canEdit();b.toggleGroupActivity();b.$checkBox.change(b.groupActivityCheckboxChanged);if(b.settings.Events.PeerAndSelfAssessmentStateChanged)$(document).off(b.settings.Events.PeerAndSelfAssessmentStateChanged).on(b.settings.Events.PeerAndSelfAssessmentStateChanged,
b.peerAndSelfAssessmentStateChanged)})}Object.defineProperty(a.prototype,"enabled",{get:function(){return this.$checkBox.is(":checked")&&this.canEdit()},set:function(a){this.$container.toggleClass(this.settings.CssClasses.Disabled,!a);this.$checkBox.prop("disabled",!a);this.customTooltipForCheckbox.setToolTipHtml(a?"":this.tooltip);this.customTooltipForCheckbox.enableToolTip(!a)},enumerable:!0,configurable:!0});a.prototype.getState=function(){var a={};a.isGroupActivity=this.$checkBox.is(":checked");
a.groupType=this.$dropDown.val();return a};Object.defineProperty(a.prototype,"tooltip",{get:function(){return this.settings.AtLeastOneAnswerExistsForElement?this.settings.Terms.AnswersExistWarning:this.settings.IsLearningPathSubElement?this.settings.Terms.IsLearningPathSubElementWarning:this.peerAssessmentEnabled||this.selfAssessmentEnabled?this.settings.Terms.GroupActivityDisabledWarning:""},enumerable:!0,configurable:!0});a.prototype.toggleGroupActivity=function(){this.$dropDown.toggle(this.enabled)};
a.prototype.canEdit=function(){return!this.settings.AtLeastOneAnswerExistsForElement&&!this.settings.IsLearningPathSubElement&&!this.peerAssessmentEnabled&&!this.selfAssessmentEnabled};return a}();e.GroupActivity=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.settings=c;window[a]=this;$(function(){b.settings.VisibilitySettings.Activation&&(b.activationControl=window[b.settings.ClientInstanceNames.ActivationControl]);b.settings.VisibilitySettings.WorkloadSetting&&(b.workloadSettingControl=window[b.settings.ClientInstanceNames.WorkloadSettingControl]);b.settingsManager=e.Manager.getInstance();b.$saveSettingsButton=$("."+b.settings.CssClasses.SaveSettingsButton);b.attemptsControl=
b.settings.VisibilitySettings.Attempts?window[b.settings.ClientInstanceNames.AttemptsControl]:null;b.resultsAndFeedbackControl=b.settings.VisibilitySettings.ResultsAndFeedback?window[b.settings.ClientInstanceNames.ResultsAndFeedbackControl]:null;b.settings.VisibilitySettings.AnonymousSubmission&&(b.$anonymousCheckBox=$("#"+b.settings.Controls.AnonymousSubmissionCheckBox));b.settings.VisibilitySettings.PlagiarismControl&&(b.$plagiarismCheckBox=$("#"+b.settings.Controls.PlagiarismCheckBox));b.settings.VisibilitySettings.Mandatory&&
(b.$notMandatoryCheckBox=$("#"+b.settings.Controls.NotMandatoryCheckBox));b.settings.VisibilitySettings.Results&&(b.$resultsCheckBox=$("#"+b.settings.Controls.ResultsCheckBox));b.settings.VisibilitySettings.Deadline&&(b.deadlinePicker=window[b.settings.ClientInstanceNames.Deadline]);b.settings.VisibilitySettings.Homework&&(b.$homeworkCheckBox=$("#"+b.settings.Controls.HomeworkCheckBox));b.settings.VisibilitySettings.PeerAssessment&&(b.peerAssessment=window[b.settings.ClientInstanceNames.PeerAssessment]);
b.settings.VisibilitySettings.GroupSubmission&&(b.groupActivitySelector=window[b.settings.ClientInstanceNames.GroupActivitySelector]);b.settings.VisibilitySettings.AssessmentScale&&(b.assessmentScaleSelector=window[b.settings.ClientInstanceNames.AssessmentScaleControl]);b.settings.VisibilitySettings.TestMode&&(b.$testModeCheckBox=$("#"+b.settings.Controls.TestModeCheckBox));b.initLearningObjectivesListControl();b.initSubmissionStatusControl()});$(document).on(this.settings.EventNames.MandatoryFieldsStateChanged,
function(){b.settings.EventNames.ValidStateChanged&&$(document).trigger(b.settings.EventNames.ValidStateChanged,b.validateMandatoryFields())});if(this.settings.CanUseRubric)if(this.settings.IsAddMode)$(document).on(this.settings.EventNames.RubricChanged,function(a,c){b.learningObjectiveList.syncLearningObjectives(c.loIds);b.updateMaxScore(c.loIds,c.criteriaWeights)}),$(document).on(this.settings.EventNames.UpdateMaxScore,function(a,c){b.updateMaxScore(c.loIds,c.criteriaWeights)});else $(document).on(this.settings.EventNames.LearningObjectiveChanged,
function(a,c){b.updateMaxScore(c.ids);b.settingsManager.setRefreshIframeAfterSave()});$(document).on(this.settings.EventNames.MandatoryFieldsStateChanged+" "+this.settings.EventNames.ElementActivationChangedEventName+" "+this.settings.EventNames.DeadlineStateChanged+" "+this.settings.EventNames.WorkloadChanged,function(){b.settings.EventNames.ValidStateChanged&&$(document).trigger(b.settings.EventNames.ValidStateChanged,b.validateMandatoryFields()&&b.validateElementActivation())});this.settings.VisibilitySettings.Deadline&&
this.settings.IsDeadlineRequired&&this.settings.LearningToolId==this.settings.LearningToolIds.Assignment&&($(document).on(this.settings.EventNames.ElementActivationChangedEventName,function(){b.deadlinePicker.mandatory(b.activationControl.isActive()||b.activationControl.hasTimeSpan())}),this.deadlinePicker.mandatory(this.activationControl.isActive()||this.activationControl.hasTimeSpan()),this.stateChanged())}a.prototype.validateMandatoryFields=function(){var a=!0;this.settings.VisibilitySettings.AssessmentScale&&
(a=this.assessmentScaleSelector.isValid());var c=!0;this.settings.VisibilitySettings.WorkloadSetting&&(c=this.workloadSettingControl.isValid());return a&&c};a.prototype.validateElementActivation=function(){return this.settings.IsDeadlineRequired&&this.settings.LearningToolId==this.settings.LearningToolIds.Assignment?this.settings.VisibilitySettings.Deadline&&this.settings.LearningToolId==this.settings.LearningToolIds.Assignment?this.activationControl.isActive()||this.activationControl.hasTimeSpan()?
this.deadlinePicker.isSet():!0:!1:!0};a.prototype.stateChanged=function(){this.settings.EventNames.ValidStateChanged&&$(document).trigger(this.settings.EventNames.ValidStateChanged,this.validateMandatoryFields()&&this.validateElementActivation())};a.prototype.hideFeedback=function(){this.settings.VisibilitySettings.Deadline&&this.deadlinePicker.mandatory(!1)};a.prototype.updateMaxScore=function(a,c){var b=this;void 0===c&&(c="");this.assessmentScaleSelector.canUseAutoMaxScore()&&this.assessmentScaleSelector.updateMaxScore(a,
c,function(){$(document).trigger(b.settings.EventNames.ValidStateChanged,b.validateMandatoryFields())})};a.prototype.initLearningObjectivesListControl=function(){this.learningObjectiveList||(this.learningObjectiveList=window[this.settings.ClientInstanceNames.LearningObjectiveList])};a.prototype.initSubmissionStatusControl=function(){this.settings.VisibilitySettings.SubmissionStatusForTeacher&&(this.$submissionStatus=$("#"+this.settings.Controls.SubmissionStatusControl),this.$submissionStatus.val()||
(this.settingsManager.showFeedbackErrorMessage(this.settings.Terms.NoSubmissionStatusesFound),this.$saveSettingsButton.toggleHyperlink(!1)))};a.prototype.collectSettings=function(){var a={};if(this.settings.VisibilitySettings.Deadline){var c=this.deadlinePicker.getState();a.Deadline=c.DateTime;a.CloseAfterDeadline=c.CloseAfterDeadline}this.settings.VisibilitySettings.Homework&&(a.Homework=this.$homeworkCheckBox.is(":checked"));this.settings.VisibilitySettings.AssessmentScale&&(c=this.assessmentScaleSelector.getState(),
a.AssessmentScaleId=c.AssessmentScaleId,a.UseScore=c.IsScore,a.MaxScore=c.IsScore?c.MaxScore:0,a.IsAddToAssessmentRecord=c.AddToGradeBook,a.TermId=c.TermId,a.CategoryId=c.CategoryId);this.settings.VisibilitySettings.PeerAssessment&&(this.peerAssessment.activated&&0<this.peerAssessment.peersToAssessCount&&(a.PeersToAssessCount=this.peerAssessment.peersToAssessCount),a.IsSelfAssessmentActivated=this.peerAssessment.selfAssessmentActivated);this.settings.VisibilitySettings.TestMode&&(a.TestMode=this.$testModeCheckBox.is(":checked"));
this.settings.VisibilitySettings.Attempts&&(a.AttemptsState=this.attemptsControl.getState());this.settings.VisibilitySettings.ResultsAndFeedback&&(a.ResultsAndFeedbackState=this.resultsAndFeedbackControl.getState());this.settings.VisibilitySettings.SubmissionStatusForTeacher&&(a.SubmissionStatusId=parseInt(this.$submissionStatus.val(),10));this.settings.VisibilitySettings.GroupSubmission&&(c=this.groupActivitySelector.getState(),a.IsGroupActivity=c.isGroupActivity,a.SubmissionGroupType=c.groupType);
this.settings.VisibilitySettings.AnonymousSubmission&&(a.IsAnonymous=this.$anonymousCheckBox.is(":checked"));this.settings.VisibilitySettings.PlagiarismControl&&(a.IsCheckPlagiarism=this.$plagiarismCheckBox.is(":checked"));this.settings.VisibilitySettings.Mandatory&&(a.IsNotMandatory=this.$notMandatoryCheckBox.is(":checked"));this.activationControl&&(c=this.activationControl.getActivationTimeSpanState(),a.Active=c.isActive,a.UseActivationTimespan=c.useActivationTimeSpan,a.UseActivationTimespan&&(a.ActivationTimespanFrom=
c.fromState.dateAsString,a.ActivationTimespanTo=c.toState.dateAsString));this.settings.VisibilitySettings.LearningObjectiveListDialog&&(a.LearningObjectivesIds=this.learningObjectiveList.getLearningObjectiveIds());this.settings.VisibilitySettings.Results&&(a.IsAssessmentVisible=this.$resultsCheckBox.is(":checked"));this.settings.VisibilitySettings.WorkloadSetting&&(a.Workload=this.workloadSettingControl.getWorkloadEnabled(),a.WorkloadEstimation=this.workloadSettingControl.getWorkloadEstimation());
return a};a.prototype.validateControls=function(){return this.activationControl?this.activationControl.validateControl():!0};return a}();e.Edit=d})(e.Settings||(e.Settings={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(a){a[a.Hidden=0]="Hidden";a[a.Summary=1]="Summary";a[a.Read=2]="Read";a[a.OverlayEdit=3]="OverlayEdit"})(e.LearningToolElementSettingsView||(e.LearningToolElementSettingsView={}));var d=e.LearningToolElementSettingsView;(function(){return function(){}})();var a=function(){function a(b){var c=this;this.viewAttributesMap={};window[a.clientInstanceName]=this;this.settings=b;$(function(){c.$body=$("body");c.$mainContainer=$("#"+c.settings.Controls.MainContainer);
c.$contentFrameContainer=$("#"+c.settings.Controls.ContentFrame);c.$settingsControlContainer=$("#"+c.settings.Controls.SettingsControl);c.$editSettingsContainer=$("#"+c.settings.Controls.EditSettingsContainer);c.$readSettingsContainer=$("#"+c.settings.Controls.ReadSettingsContainer);c.$background=$("#"+c.settings.Controls.Background);c.settings.IsAddMode||(c.iframe=c.$contentFrameContainer.get(0).contentWindow);c.viewAttributesMap=(a={},a[d.Hidden]={isDirty:!0,cssClass:c.settings.CssClasses.Views.Hidden},
a[d.Summary]={$container:c.$readSettingsContainer,isDirty:!1,cssClass:c.settings.CssClasses.Views.Summary,loadViewUrl:c.settings.Urls.ReadSettings,afterLoadFunction:c.afterLoadSummarySettings},a[d.Read]={$container:c.$readSettingsContainer,isDirty:!0,cssClass:c.settings.CssClasses.Views.OverlayRead,loadViewUrl:c.settings.Urls.ReadSettings,afterLoadFunction:c.afterLoadReadSettings},a[d.OverlayEdit]={$container:c.$editSettingsContainer,isDirty:!0,cssClass:c.settings.CssClasses.Views.OverlayEdit,loadViewUrl:c.settings.Urls.EditSettings,
afterLoadFunction:c.afterLoadEditSettings},a);c.attachEventListeners();c.editFocusTracker=new CCL.FocusTracker(c.$settingsControlContainer);c.switchView(c.settings.IsAddMode?d.OverlayEdit:d.Read);var a})}a.getInstance=function(){return window[a.clientInstanceName]};a.prototype.afterLoadSummarySettings=function(){this.stopTrackingFocus();this.$readSettingsContainer.find("."+this.settings.CssClasses.SectionHeaderIconLink).attr("tabindex",0)};a.prototype.afterLoadReadSettings=function(){this.stopTrackingFocus();
this.setFocusAndHighlight();this.$readSettingsContainer.find("."+this.settings.CssClasses.SectionHeaderIconLink).removeAttr("tabindex")};a.prototype.refreshExtensionFrame=function(){this.iframe&&CCL.CommonFunctions.makePostMessageCall(this.iframe,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.studentWasAssessed))};a.prototype.notifyExtensionSettingsUpdated=function(a){this.iframe&&(a?CCL.CommonFunctions.makePostMessageCallWithData(this.iframe,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionSettingsChanged),
a):CCL.CommonFunctions.makePostMessageCall(this.iframe,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionSettingsChanged)))};a.prototype.refreshTreeMenu=function(){var a=top;a&&a.reloadFolder&&!this.settings.IsLearningPathSubElement&&a.reloadFolder()};a.prototype.refreshPageFunctionsMenu=function(a){window[this.settings.ClientInstanceNames.ViewLearningToolElementPage].changePageFunctionsState(a)};a.prototype.showFeedbackErrorMessage=function(a,b){void 0===
b&&(b=!1);CCL.ErrorFeedback.showFeedback(this.$settingsControlContainer,a,null,b)};a.prototype.hideFeedback=function(){var a=this.getSettingsEditor();null!=a&&a.hideFeedback();CCL.ErrorFeedback.hideFeedback(this.$settingsControlContainer)};a.prototype.getSettingsEditor=function(){null==this.settingsEditor&&(this.settingsEditor=window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName]);return this.settingsEditor};a.prototype.setRefreshIframeAfterSave=function(){this.settings.NeedRefreshIframeAfterSave=
!0};a.prototype.attachEventListeners=function(){var a=this,b=$(window);CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.extensionContentChanged,function(b){b.expandRead?a.switchView(d.Read,!0):a.switchView(a.currentView,!0)});CCL.CommonFunctions.attachPostMessageEventListener(b,[CCL.CommonWindowMessages.MessageNames.hideSettings,CCL.CommonWindowMessages.MessageNames.enableFullScreen],function(){a.switchView(d.Hidden)});CCL.CommonFunctions.attachPostMessageEventListener(b,
[CCL.CommonWindowMessages.MessageNames.showSettings,CCL.CommonWindowMessages.MessageNames.disableFullScreen],function(b){a.currentView===d.Hidden&&a.switchView(a.previousView,!b||b.ForceReload)});CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.reloadParentIframe,function(){window.location.reload(!0)});this.$body.on("click","."+this.settings.CssClasses.ChangeOptionsLink,function(){a.switchView(d.OverlayEdit,!0);return!1}).on("click","."+this.settings.CssClasses.SaveSettingsButton,
function(){a.$saveSettingsButton.getIfHyperLinkEnabled()&&a.save();return!1}).on("click","."+this.settings.CssClasses.SettingsDialogExpandButton,function(){a.isMobileView()||a.switchView(d.Read)}).on("click","."+this.settings.CssClasses.Views.Summary+" ."+this.settings.CssClasses.SectionHeaderIconLink,function(b){a.onSummaryIconClick($(b.currentTarget))}).on("keypress","."+this.settings.CssClasses.Views.Summary+" ."+this.settings.CssClasses.SectionHeaderIconLink,function(b){if(b.which===CCL.CommonConstants.keyCodes.enter)a.onSummaryIconClick($(b.currentTarget))}).on("click",
"."+this.settings.CssClasses.ShowMoreOptionsLink,function(){a.toggleMobileOptions(!a.isMobileOptionsExpanded())}).on("keydown",function(b){switch(b.which){case CCL.CommonConstants.keyCodes.escape:a.currentView!==d.Read&&a.currentView!==d.OverlayEdit||a.cancelButtonClick()}});if(!this.settings.IsAddMode)this.$body.on("click","."+this.settings.CssClasses.CancelEditSettingsButton,function(){return a.cancelButtonClick()}).on("click","."+this.settings.CssClasses.SettingsDialogCollapseButton,function(){a.switchView(d.Summary)});
this.$background.click(function(){a.hideFeedback();a.cancelButtonClick()});if(this.settings.IsDeadlineRequired)$(document).on(this.settings.ValidStateChanged,function(b,c){a.$saveSettingsButton||(a.$saveSettingsButton=$("."+a.settings.CssClasses.SaveSettingsButton));a.$saveSettingsButton.toggleHyperlink(c)})};a.prototype.onSummaryIconClick=function(a){this.isMobileView()||(a=parseInt(a.closest("."+this.settings.CssClasses.SettingSection).data(this.settings.LearningToolElementSettingTypeDataAttribute),
10),this.switchToExpandedView(a))};a.prototype.afterLoadEditSettings=function(){var a=this;if(this.settings.IsDeadlineRequired&&!this.settings.IsAddMode)$(document).on(this.settings.ValidStateChanged,function(b,c){a.$saveSettingsButton=$("."+a.settings.CssClasses.SaveSettingsButton);a.$saveSettingsButton.toggleHyperlink(c)});else this.$saveSettingsButton=$("."+this.settings.CssClasses.SaveSettingsButton);this.$cancelEdittingSettingsButton=$("."+this.settings.CssClasses.CancelEditSettingsButton);this.stopTrackingFocus();
this.settings.IsAddMode||this.editFocusTracker.startTrackFocus();this.setFocusAndHighlight();new CCL.ButtonLoadingIndicator("."+this.settings.CssClasses.SettingsWrapper+" ."+this.settings.CssClasses.SaveSettingsButton,this.settings.CssClasses.ButtonInProgress,null,100)};a.prototype.setFocusAndHighlight=function(){var a=this;setTimeout(function(){var b=a.viewAttributesMap[a.currentView].$container.find("."+a.settings.CssClasses.SettingSection);b.removeClass(a.settings.CssClasses.SettingsSectionHighlight);
b=a.getSectionToHighlight(b);a.controlToHighlight=0;if(b){b.addClass(a.settings.CssClasses.SettingsSectionHighlight);var c=a.getFirstElementToFocusInContainer(b)}else a.settings.IsAddMode||(c=a.getFirstElementToFocusInContainer(a.getViewContainer(a.currentView)));a.scrollToElementIfNeed(b).done(function(){c&&!c.prop("disabled")&&c.focus()})},1)};a.prototype.getFirstElementToFocusInContainer=function(a){return a.find("input, a, select").first()};a.prototype.getSectionToHighlight=function(a){var b=
this,c=void 0;$.each(a,function(a,g){a=$(g);return b.controlToHighlight===parseInt(a.data(b.settings.LearningToolElementSettingTypeDataAttribute),10)?(c=a,!1):!0});return c};a.prototype.hideAllViews=function(){this.$editSettingsContainer.hide();this.$readSettingsContainer.hide()};a.prototype.showOverlayDialogIfNeeds=function(a){this.$background.toggle(a===d.OverlayEdit)};a.prototype.switchView=function(a,b){var c=this;void 0===b&&(b=!1);if(a!==this.currentView||b){this.toggleToolTipForCurrentView(!1);
var g=this.viewAttributesMap[a];b&&(g.isDirty=!0);g.isDirty&&g.loadViewUrl?$.get(g.loadViewUrl).done(function(b){g.$container.html(b);c.refreshViewUi(a,g);c.toggleToolTipForCurrentView(!0)}).fail(function(){c.alertError()}):(this.refreshViewUi(a,g),this.toggleToolTipForCurrentView(!0))}};a.prototype.toggleToolTipForCurrentView=function(a){this.currentView===d.Summary&&CCL.UnobtrusiveCustomTooltipManager.enableTooltipOnTarget($("."+this.settings.CssClasses.SettingSection),a)};a.prototype.switchToExpandedView=
function(a){this.controlToHighlight=isNaN(a)?0:a;this.switchView(this.settings.CanEdit?d.OverlayEdit:d.Read,this.settings.CanEdit)};a.prototype.alertError=function(a){void 0===a&&(a="");CCL.CommonFunctions.jAlertAjaxError(a?a:this.settings.Terms.SomethingWentWrong,this.settings.Terms.ErrorOccured,this.settings.Terms.Ok,!1)};a.prototype.refreshViewUi=function(a,b){this.$mainContainer.removeClass().addClass(b.cssClass);this.previousView=this.currentView;this.currentView=a;this.hideAllViews();this.showOverlayDialogIfNeeds(a);
(this.afterLoadFunction=b.afterLoadFunction)&&this.afterLoadFunction();this.toggleMobileOptions(this.isMobileOptionsExpanded());b.isDirty=!1;b.$container.show();a=0<this.getViewContainer(this.currentView).find("."+this.settings.CssClasses.ShowOnlyIfMobileOptionsExpanded).length;this.getShowMoreLinkForCurrentView().toggle(a)};a.prototype.enableSaveCancelButtons=function(a){this.$cancelEdittingSettingsButton.toggleHyperlink(a);this.$saveSettingsButton.toggleHyperlink(a);this.settings.ClientInstanceNames.ContentHolderClientInstanceName&&
window[this.settings.ClientInstanceNames.ContentHolderClientInstanceName].lockSaveButton(!a)};a.prototype.enableSaveCancelButtonsAndToggleSpinner=function(a){this.enableSaveCancelButtons(a);a&&$(this.$saveSettingsButton).trigger(CCL.ButtonLoadingIndicator.eventRemoveLoadingIndicator)};a.prototype.cancelButtonClick=function(){this.settings.IsAddMode||(this.hideFeedback(),this.switchView(this.getViewToSwitchBack()));return!1};a.prototype.isMobileView=function(){return $(window).width()<=CCL.CommonConstants.mediaScreenSizes.iPadPortraitMode};
a.prototype.getViewToSwitchBack=function(){switch(this.currentView){case d.Read:return d.Summary;case d.OverlayEdit:return this.isMobileView()?d.Read:this.previousView;default:throw"Unsupported view transition";}};a.prototype.save=function(a){var b=this;void 0===a&&(a=!1);this.hideFeedback();this.enableSaveCancelButtonsAndToggleSpinner(!1);var c=this.collectContentAndSettings(a);window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName].validateControls()?CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.SaveSettings,
data:c}).done(function(a){a.Success?b.settings.IsAddMode&&a.ClientScriptToCompleteSaving?eval(a.ClientScriptToCompleteSaving):a.ClientScriptToCompleteSavingExtended?(a=eval(a.ClientScriptToCompleteSavingExtended),$.when(a).then(function(a){!0===a?b.save(a):b.enableSaveCancelButtonsAndToggleSpinner(!0)})):a.PageUrlToRedirect?window.location.replace(a.PageUrlToRedirect):(b.switchView(b.getViewToSwitchBack(),!0),(b.settings.NeedRefreshIframeAfterSave||a.RefreshExtensionIframe)&&b.refreshExtensionFrame(),
b.settings.SettingsUpdateNotification&&b.notifyExtensionSettingsUpdated(c.Settings.NotificationData),b.refreshTreeMenu(),b.refreshPageFunctionsMenu(a.EnableElementActivationPageFeatures)):(b.showFeedbackErrorMessage(a.Errors.join("<br />"),!0),b.enableSaveCancelButtonsAndToggleSpinner(!0))}).fail(function(){b.alertError();b.enableSaveCancelButtonsAndToggleSpinner(!0)}):(this.enableSaveCancelButtonsAndToggleSpinner(!0),this.showFeedbackErrorMessage(this.settings.Terms.YourInputIsInvalid,!0),this.scrollToElementIfNeed($("."+
this.settings.CssClasses.InvalidInput+":first")))};a.prototype.collectContentAndSettings=function(a){var b=window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName],c={};c.ElementId=this.settings.ElementId;c.IsAddMode=this.settings.IsAddMode;c.Settings=b.collectSettings();c.Settings.IsLearningObjectivesRemovalConfirmed=a;this.settings.ClientInstanceNames.ContentHolderClientInstanceName&&(c.Content=window[this.settings.ClientInstanceNames.ContentHolderClientInstanceName].collectContent());
return c};a.prototype.toggleMobileOptions=function(a){var b=a?this.settings.Terms.ShowLess:this.settings.Terms.ShowMore;this.getShowMoreLinkForCurrentView().children("span").text(b);this.getViewContainer(this.currentView).toggleClass(this.settings.CssClasses.ExpandMobileOptions,a)};a.prototype.isMobileOptionsExpanded=function(){return this.getViewContainer(this.currentView).hasClass(this.settings.CssClasses.ExpandMobileOptions)};a.prototype.getShowMoreLinkForCurrentView=function(){return this.getViewContainer(this.currentView).find("."+
this.settings.CssClasses.ShowMoreOptionsLink)};a.prototype.getViewContainer=function(a){return this.viewAttributesMap[a].$container};a.prototype.stopTrackingFocus=function(){this.editFocusTracker.stopTrackFocus()};a.prototype.scrollToElementIfNeed=function(a){if(!a)return $.when();if(this.settings.IsAddMode)return CCL.CommonFunctions.isElementFullyShownInWindow(a)||window.scrollTo(a.offset().top,0),$.when();var b=this.getViewContainer(this.currentView).find("."+this.settings.CssClasses.OverlayDialogInnerContainer);
return CCL.CommonFunctions.isElementFullyShownInContainer(a,b)?$.when():b.animate({scrollTop:a.offset().top},500).promise()};a.prototype.refreshReadView=function(){this.switchView(this.currentView,!0)};a.clientInstanceName="LearningToolElementSettingsManager";return a}();e.Manager=a})(e.Settings||(e.Settings={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){}}();e.ManageLearnerDefinedGroupState=f;f=function(){function d(a,b){var c=this;this.renderItem=function(a,b){return $("<li>").append(b.metadata?'<a>\n                            <img alt="" class="'+c.settings.CssClasses.AutoCompleteItem.Image+'" src="'+b.metadata.ImageUrl+'" />\n                            <span class="'+c.settings.CssClasses.AutoCompleteItem.Info+'">\n                                <span>'+b.label+"</span>\n                                "+
(""!==b.metadata.Organization?'<span class="'+c.settings.CssClasses.AutoCompleteItem.Organization+'">'+b.metadata.Organization+"</span>":"")+"\n                            </span>\n                       </a>":'<span class="'+c.settings.CssClasses.AutoCompleteItem.NoMatches+'">'+c.settings.Terms.NoMatches+"</span>").addClass(c.settings.CssClasses.AutoCompleteItem.Item).appendTo(a)};this.participantsAutocomplete=function(a,b){c.participantsAutocompleteRequest&&c.participantsAutocompleteRequest.abort&&
c.participantsAutocompleteRequest.abort();var g=c.getAddedPersonIds();c.participantsAutocompleteRequest=$.getJSON(c.settings.WebMethods.FindParticipants.replace("{elementId}",c.settings.ElementId.toString()).replace("{collaborationId}",c.settings.CollaborationId.toString()),{courseId:c.settings.CourseId,search:a.term}).done(function(a){a=a.filter(function(a){return 0===g.filter(function(b){return b===a.PersonId}).length});a.length?b($.map(a,function(a){return{label:a.Name,value:a.Name,metadata:a}})):
b([{value:b.term}])}).always(function(){c.participantsAutocompleteRequest=void 0})};this.onRemoveClick=function(a){$(a.target).closest("."+c.settings.CssClasses.GroupList.UserContainer).remove()};window[a]=this;this.settings=b;this.$membersContainer=$("#"+this.settings.Controls.MembersContainerId);this.$groupContentContainer=$("#"+this.settings.Controls.GroupContentContainerClientId);$(function(){c.addPerson(c.settings.CurrentPerson,!0);c.settings.GroupMembers&&c.settings.GroupMembers.length&&c.settings.GroupMembers.forEach(function(a){c.addPerson(a,
!1)})});$(document).on(this.settings.Events.OnSelectUser,function(a,b){b&&(a={},a.Name=b.Name,a.ImageUrl=b.ImageUrl,a.PersonId=b.PersonId,c.addPerson(a,!1))})}d.prototype.addPerson=function(a,b){this.$membersContainer.append(this.getPersonHtml(a,b))};d.prototype.getPersonHtml=function(a,b){var c=$('<div class="'+this.settings.CssClasses.GroupList.UserContainer+'"></div>'),g=$('<div class="'+this.settings.CssClasses.GroupList.ImageContainer+'"><img alt="" src="'+a.ImageUrl+'" class="'+this.settings.CssClasses.GroupList.Image+
'" /></div>'),d=$('<div class="'+this.settings.CssClasses.GroupList.NameContainer+'"><span>'+CCL.CommonFunctions.htmlEncode(a.Name)+"</span></div>");c.data("meta",a).append(g).append(d);a=$('<div class="'+this.settings.CssClasses.GroupList.RemoveLinkContainer+'"></div>');b||(b=$('<a href="#">&times;</a>'),b.click(this.onRemoveClick),a.append(b));c.append(a);return c};d.prototype.getAddedPersonInfos=function(){return $.makeArray(this.$membersContainer.find("div."+this.settings.CssClasses.GroupList.UserContainer).map(function(a,
b){return $(b).data("meta")}))};d.prototype.getAddedPersonIds=function(){return this.getAddedPersonInfos().map(function(a){return a.PersonId})};d.prototype.getState=function(){return{personIds:this.getAddedPersonIds()}};return d}();e.ManageLearnerDefinedGroup=f})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
var BaseMetadata=function(){return function(f,e,k){this.name=f;this.sourceType=e;this.mimeType=k}}(),LocalFileInputHandle=function(){function f(e){this.fileInput=e}f.prototype.get=function(){return this.fileInput};return f}(),LocalFileHandle=function(){function f(e){this.file=e}f.prototype.get=function(){return this.file};return f}(),ExternalSourceFileHandle=function(){function f(e,f,d,a){this.url=e;this.id=f;this.canBeCopied=d;this.canBeShared=a}f.prototype.get=function(){return objectState.isNullOrUndefined(this.id)?
this.url:{url:this.url,id:this.id,canBeCopied:null==this.canBeCopied?!0:this.canBeCopied,canBeShared:null==this.canBeShared?!0:this.canBeShared}};return f}(),SourceType;(function(f){f[f.Dropbox=1]="Dropbox";f[f.Google=2]="Google";f[f.OneDriveForBusiness=3]="OneDriveForBusiness";f[f.Local=4]="Local";f[f.OneDrivePersonal=5]="OneDrivePersonal";f[f.WebDav=6]="WebDav";f[f.Ziggeo=7]="Ziggeo"})(SourceType||(SourceType={}));
(function(f){f.isOneDrive=function(e){return e===f.OneDrivePersonal||e===f.OneDriveForBusiness};f.isCloud=function(e){return e===f.Dropbox||e===f.Google||f.isOneDrive(e)||e===f.WebDav||e===f.Ziggeo}})(SourceType||(SourceType={}));
var FileInOneDriveHandle=function(){function f(e){this.postMessageFile=e}f.prototype.get=function(){return objectState.isNullOrUndefined(this.postMessageFile.id)?this.postMessageFile.url:{url:this.postMessageFile.url,viewUrl:this.postMessageFile.viewUrl,downloadUrl:this.postMessageFile.downloadUrl,id:this.postMessageFile.id,canBeCopied:null==this.postMessageFile.canBeCopied?!0:this.postMessageFile.canBeCopied,canBeShared:null==this.postMessageFile.canBeShared?!0:this.postMessageFile.canBeShared}};
return f}(),PickerFileResult=function(){function f(e,f,d,a,b,c){this.fileHandle=e;this.name=f;this.size=d;this.sourceType=a;this.relativePath=b;this.mimeType=c}f.prototype.getFileHandle=function(){return this.fileHandle.get()};f.createExternalSourcePickerFileResult=function(e,k,d,a,b,c,g,h){return new f(new ExternalSourceFileHandle(e,c,g,h),k,d,a,null,b)};f.createLocalPickerFileResultWithInput=function(e,k){return new f(new LocalFileInputHandle(e),k,null,SourceType.Local)};f.createLocalPickerFileResult=
function(e){return new f(new LocalFileHandle(e),e.name,e.size,SourceType.Local,null,e.type)};f.createFolderPickerFileResultWithRelativePath=function(e,k){return new f(new LocalFileHandle(e),e.name,e.size,SourceType.Local,k,e.type)};f.createPickerFileResultWithFileName=function(e){return new f(new LocalFileHandle(null),e,0,SourceType.Local,null,null)};f.createOneDrivePickerFileResult=function(e){return new f(new FileInOneDriveHandle(e),e.name,e.size,e.sourceType,null,e.mimeType)};return f}(),UploadMetadata=
function(f){function e(e,d,a,b,c,g,h,m){f.call(this,d,a,g);this.id=e;this.name=d;this.sourceType=a;this.signature=b;this.signedFileRepoId=c;this.mimeType=g;this.isTemplate=h;this.customId=m}__extends(e,f);e.updateName=function(e,d){e.name=d};e.setTemplate=function(e,d){e.isTemplate=d};e.create=function(f,d){var a=f.name,b=f.sourceType;f=f.mimeType;var c=null,g=null,h=null,m=null;d&&(d.fileGuid&&(c=d.fileGuid),d.signedGuid&&(g=d.signedGuid),d.signedFileRepoId&&(h=d.signedFileRepoId),d.mimeType&&(f=
d.mimeType),d.customId&&(m=d.customId));return new e(c,a,b,g,h,f,!1,m)};return e}(BaseMetadata);
(function(f){(function(e){var k=f.CheckboxStateMachine.State,d=function(){function a(a,c,g,d,e,l,k,p){var b=this;void 0===p&&(p=void 0);this.courseId=a;this.eventId=c;this.utilityBase=g;this.markupBuilderBase=d;this.callbacks=e;this.addResourceDialogTitle=l;this.ajaxClientBase=k;this.mainContainer=p;this.fileUploadInProgress=this.shouldFileBeAttachedToEventImmediately=!1;this.onAddResourceMenuItemLinkClick=function(a){switch(parseInt($(a.currentTarget).data(b.utilityBase.dataAttributeNames.ElementExternalSource),
10)){case f.AddResourceMenu.ElementExternalSourceType.Course:b.addFromCourse();break;case f.AddResourceMenu.ElementExternalSourceType.Library:b.addFromLibrary();break;case f.AddResourceMenu.ElementExternalSourceType.Computer:b.fileUploadInProgress||b.addFromComputer()}};this.afterOkClickCallback=function(a){a&&(a.forEach(function(a,c){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.DetachedByUser||b.currentElementStates.set(c,a)}),a=b.getElementIdsToAttach(),b.saveElementStates(),
b.callbacks.afterAttachElements&&0<a.length&&b.callbacks.afterAttachElements(a))};this.currentElementStates=new Map;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;CCL.CommonFunctions.attachPostMessageEventListener($(window),this.utilityBase.postMessageNames.SendElementIdToCourseFeature,function(a){b.attachElement(a.elementId)})}a.prototype.attachElement=function(a){this.currentElementStates.set(a,k.AttachedByUser);this.saveElementStates();this.callbacks.afterAttachElements&&this.callbacks.afterAttachElements(this.getElementIdsToAttach())};
a.prototype.removeElement=function(a){var b=this.utilityBase.getElementId(a);this.updateElementState(b);this.markupBuilderBase.removeElement(a,this.callbacks.afterDetachElements)};a.prototype.removeElementById=function(a){this.updateElementState(a);this.markupBuilderBase.removeElement(this.utilityBase.getElementByElementId(a),this.callbacks.afterDetachElements)};a.prototype.toggleElementActivation=function(a){this.utilityBase.toggleElementActivation(a)};a.prototype.closeAddElementDialog=function(){var a=
this.getAlternativeChoice();return a&&a.isDialogOpened()?(a.closeDialog(),!0):!1};a.prototype.onFileSelectedImpl=function(a){var b=this;this.toggleAddFromComputerOption(!1);setTimeout(function(){b.fileUploadInProgress&&b.markupBuilderBase.addFakeItemIntoElementSection(a[0].name,b.mainContainer)},e.CalendarClientConstants.uploadingFileTimeoutMilliseconds)};a.prototype.onFileUploadSuccessImpl=function(a){var b=this;this.fileUploadInProgress&&(this.addFileRequest=this.ajaxClientBase.createNewFileElementForEvent(this.courseId,
this.eventId,a,this.shouldFileBeAttachedToEventImmediately),this.addFileRequest.done(function(a){b.markupBuilderBase.removeFakeItemFromElementSection();b.toggleAddFromComputerOption(!0);if(a.Success&&(b.attachElement(a.ElementId),b.callbacks.onElementListChanged))b.callbacks.onElementListChanged();b.addFileRequest=void 0}))};a.prototype.onFileUploadFailedImpl=function(a,c){this.cleanRequestsAndOptions();CCL.CommonFunctions.jAjaxConfirm(c,this.utilityBase.terms.FailedFileUploadChoiceDialogTitle,this.utilityBase.terms.FailedFileUploadChoiceDialogUploadNewFile,
this.utilityBase.terms.FailedFileUploadChoiceDialogCancel,function(a){a&&$("#"+Components.ComponentName.localPicker).click()});this.markupBuilderBase.removeFakeItemFromElementSection();if(this.callbacks.onErrorMessageShown)this.callbacks.onErrorMessageShown()};a.prototype.cleanRequestsAndOptions=function(){this.addFileRequest&&(this.addFileRequest.abort(),this.addFileRequest=void 0);this.toggleAddFromComputerOption(!0)};a.prototype.addFromCourse=function(){var a={elementStates:f.MapUtils.makeCopy(this.currentElementStates),
elementType:f.ElementLinkDialog.ContentElementType.All,header:this.addResourceDialogTitle,afterOkClickCallback:this.afterOkClickCallback,showAll:!1,allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.CalendarEvent,relatedEntityId:this.eventId,maxCountOfAddedElements:this.utilityBase.constants.MaxCountOfAddedElements};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(a,this.ajaxParams)};a.prototype.addFromLibrary=function(){window[this.utilityBase.clientInstanceNamesBase.LibraryBrowserDialog].browseLibrary({CourseId:this.courseId})};
a.prototype.addFromComputer=function(){$("#"+Components.ComponentName.localPicker).click()};a.prototype.getElementIdsToAttach=function(){var a=this,c=[];this.currentElementStates.forEach(function(b,d){a.checkboxStateMachine.isElementChecked(b)&&c.push(d)});return c};a.prototype.updateElementState=function(a){var b=this.currentElementStates.get(a);b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,b);this.currentElementStates.set(a,b);this.saveElementStates()};a.prototype.toggleAddFromComputerOption=
function(a){this.fileUploadInProgress=!a;var b=this.getAlternativeChoice();b&&b.getSecondColumn().find(this.utilityBase.selectors.elementExternalSourceComputer).toggleHyperlink(a).css("pointerEvents",a?"":"none");if(this.callbacks.onUploadFromComputer)this.callbacks.onUploadFromComputer(this.fileUploadInProgress)};return a}();e.AddEditEventElementLinkManagerBase=d})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){var d=function(a){function b(c,g,d,e,l,k,p){a.call(this,c,g,d,e,l,d.settings.Terms.AddResourceDialogTitle,k);this.utility=d;this.markupBuilder=e;if(!l.afterAttachElements)throw Error("Argument afterAttachElements is undefined!");this.loadElementStates();this.ajaxParams={locationId:c,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};b.instance=window[p]=this}__extends(b,a);b.onFileUploadSuccess=function(a){b.instance.onFileUploadSuccessImpl(a)};
b.onFileUploadFailed=function(a,g){b.instance.onFileUploadFailedImpl(a,g)};b.onFileSelected=function(a){b.instance.onFileSelectedImpl(a)};b.prototype.cleanAndRemoveElementStates=function(){var a=this,b=[];this.currentElementStates.forEach(function(c,g){a.checkboxStateMachine.isElementChecked(c)&&b.push(g)});for(var d=0;d<b.length;d++)this.removeElementById(b[d]);this.saveElementStates()};b.prototype.loadElementStates=function(){var a=this.utility.controls.elementIdsWithStatesHidden.val();0<this.utility.controls.elementIdsWithStatesHidden.length&&
a&&(this.currentElementStates=f.MapUtils.jsonStringToMap(a,f.MapUtils.numberKeyConverter))};b.prototype.saveElementStates=function(){this.utility.controls.elementIdsWithStatesHidden.val(f.MapUtils.mapToJsonString(this.currentElementStates)).trigger("change")};b.prototype.getAlternativeChoice=function(){return window[CCL.CommonFunctions.formatString(this.utility.settings.ClientInstanceNames.AlternativeChoiceTemplate,this.courseId)]};return b}(e.AddEditEventElementLinkManagerBase);k.ElementLinkManager=
d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(a){function b(b,c,d,e,f,k,n){var g=this;a.call(this,b,void 0,c,d,e,c.settings.terms.AddResourceDialogTitle,f,k.mainContainer);this.utility=c;this.markupBuilder=d;this.ajaxClient=f;this.dialog=k;this.alternativeChoiceManager=n;this.setToggleElementInDialog=function(a){a.setToggleElement($("#popup_overlay, #popup_container"))};this.callbacks.onErrorMessageShown=function(){return g.setToggleElementInDialog(k)};this.alternativeChoiceManager.attachAddResourceButtonClickHandler(this.dialog)}
__extends(b,a);b.onFileUploadSuccess=function(a){b.currentManager.onFileUploadSuccessImpl(a)};b.onFileUploadFailed=function(a,c){b.currentManager.onFileUploadFailedImpl(a,c)};b.onFileSelected=function(a){b.currentManager.onFileSelectedImpl(a)};b.cleanRequestsAndOptions=function(){var a=window.document.getElementById(b.currentManager.utility.settings.ClientInstanceNames.UploadArea);a&&(a[b.currentManager.utility.settings.ClientInstanceNames.UploadControl].clearFileListAndLastRequest(),b.currentManager.cleanRequestsAndOptions())};
b.prototype.getElementIdsHidden=function(){return $(this.utility.dataAttributes.addEventDialogAttachedElementsHidden)};b.prototype.emptyElementIdsHidden=function(){this.getElementIdsHidden().prop("value","[]")};b.prototype.getAlternativeChoice=function(){return this.alternativeChoiceManager.getAlternativeChoice({CourseId:this.courseId})};return b}(e.AddEditEventElementLinkManagerBase);d.ElementLinkManagerDialogBase=a})(f.ElementLink||(f.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||
(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=f.CheckboxStateMachine.State,b=function(b){function c(a,c,g,d,f,k){var h=this;b.call(this,void 0,a,g,f,c,d,k);this.refreshElementList=function(a){h.ajaxClient.getElementListMarkupForEventIds(0,h.utility.controls.addEventStartDateHiddenField.val(),h.getCurrentCourseId(),a,h.markupBuilder.getCurrentFakeElementTitle()).done(function(a){h.markupBuilder.rebuildElementListMarkup(h.mainContainer,a);h.mainContainer.find("."+h.utility.settings.cssClasses.ElementList).on("click",
"."+h.utility.settings.cssClasses.ElementListItemRemove,function(a){h.removeElement($(a.target).closest(h.utility.selectors.elementListItem))})})};this.eventTypeParser=new e.EventTypeParser(a);this.callbacks.afterAttachElements=this.refreshElementList}__extends(c,b);c.prototype.setParameters=function(a,b){this.ajaxParams={locationId:a,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};this.courseId=a;this.elementListHidden=b;this.loadElementStates()};c.prototype.generateElementSections=
function(a,b){var c=this.mainContainer.find("."+this.utility.settings.cssClasses.ContextDialogContent),g=this.mainContainer.find("."+this.utility.settings.cssClasses.SelectedElementListAppendTarget);0<g.length?(g.empty(),this.emptyElementIdsHidden(),c.find("."+this.utility.settings.cssClasses.AddElementButton).remove()):b&&(g=this.markupBuilder.generateElementListAppendTarget(),c.append(g).append(this.markupBuilder.generateAttachedElementsHidden()));b&&(this.markupBuilder.renderAddButtonWithElementSections(c,
{courseId:a,enableElementLinkManagement:this.utility.settings.customerSettings.enableAddResource,elementListMarkups:{Resources:void 0,ResourceCount:0,Homework:void 0,HomeworkCount:0}},e.EventDetailsType.ContextDialog),this.setParameters(a,this.getElementIdsHidden()))};c.prototype.loadElementStates=function(){var b=this;this.currentElementStates=new Map;var c=this.elementListHidden.val();0<this.elementListHidden.length&&c&&JSON.parse(c).forEach(function(c){b.currentElementStates.set(c,a.AttachedByUser)})};
c.prototype.saveElementStates=function(){var b=[];this.currentElementStates.forEach(function(c,g){c===a.AttachedByUser&&b.push(g)});this.elementListHidden.val(JSON.stringify(b))};c.prototype.setCalendarEventElementLinkManager=function(){d.ElementLinkManagerDialogBase.currentManager=window[this.utility.settings.constants.CalendarEventElementLinkManager]=this};c.prototype.getCurrentCourseId=function(){return this.eventTypeParser.parseCourseId(this.utility.controls.addEventCalendarsDropdown.val())};
return c}(d.ElementLinkManagerDialogBase);d.AddEventElementLinkManager=b})(e.ElementLink||(e.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=f.CheckboxStateMachine.State,b=function(b){function c(a,c,g,d,e,f){b.call(this,void 0,a,g,e,c,d,f);this.dialogCallbacks=e;this.shouldFileBeAttachedToEventImmediately=!0}__extends(c,b);c.prototype.setCalendarEventElementLinkManager=function(){d.ElementLinkManagerDialogBase.currentManager=window[this.utility.settings.constants.CalendarEventElementLinkManager]=this};c.prototype.setParameters=function(a){this.currentEvent=a;this.ajaxParams={locationId:this.currentEvent.courseId,
locationType:f.AddResourceMenu.ElementExternalSourceType.Course};this.courseId=this.currentEvent.courseId;this.loadElementStates();this.eventId=a.activityId};c.prototype.onRemoveElementClick=function(b,c,g){var d=this,e=b.closest(this.utility.selectors.elementListItem);b=e.find("."+this.utility.settings.cssClasses.ElementListTitle).text();b=CCL.CommonFunctions.formatString(this.utility.settings.terms.removeElementConfirmation,b);0<g.length&&(b+="\n"+g);if(confirm(b)){this.dialogCallbacks.dialogPositionRecalculation();
var h=this.utility.getElementForEventData(e);this.ajaxClient.removeElement({EventId:h.EventId,ElementId:h.ElementId}).done(function(){d.currentElementStates.set(h.ElementId,a.DetachedByUser);d.onRemoveElementsComplete(e)})}};c.prototype.saveElementStates=function(){var a=this,b=[],c=[];this.currentElementStates.forEach(function(a,g){switch(a){case f.CheckboxStateMachine.State.AttachedByUser:b.push(g);break;case f.CheckboxStateMachine.State.DetachedByUser:c.push(g)}});(0<b.length||0<c.length)&&this.ajaxClient.updateEventElements({EventId:this.currentEvent.activityId,
ElementIdsToAdd:b,ElementIdsToRemove:c,FakeElementTitle:this.markupBuilder.getCurrentFakeElementTitle()}).done(function(b){a.onUpdateEventElementsComplete(b)})};c.prototype.loadElementStates=function(){var a=this;this.currentElementStates=new Map;var b=[];this.currentDialogContainer||(this.currentDialogContainer=this.alternativeChoiceManager.getDialogContainer());this.currentDialogContainer.find("."+this.utility.settings.cssClasses.ElementList).find(this.utility.selectors.elementListItem).each(function(c,
g){c=a.utility.getElementForEventData($(g));c.AddedManually&&a.currentElementStates.set(c.ElementId,f.CheckboxStateMachine.State.Saved);c.CanBeRemoved||b.push(c.ElementId)});return b};c.prototype.addFromCourse=function(){var a=this.loadElementStates();a={elementStates:f.MapUtils.makeCopy(this.currentElementStates),disabledElementIds:a,afterOkClickCallback:this.afterOkClickCallback,maxCountOfAddedElements:this.utility.constants.MaxCountOfAddedElements,elementType:f.ElementLinkDialog.ContentElementType.All,
showAll:!0,header:this.utility.settings.terms.AddResourceDialogTitle,allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.CalendarEvent};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(a,this.ajaxParams)};c.prototype.onUpdateEventElementsComplete=function(a){a&&this.markupBuilder.rebuildElementListMarkup(this.currentDialogContainer,a);this.dialogCallbacks.onElementListChanged()};c.prototype.onRemoveElementsComplete=function(a){this.markupBuilder.removeElement(a,
this.dialogCallbacks.dialogPositionRecalculation);this.dialogCallbacks.onElementListChanged()};return c}(d.ElementLinkManagerDialogBase);d.EditEventElementLinkManager=b})(e.ElementLink||(e.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(a,b){var c=this;this.settings=b;window[a]=this;this.settings=b;this.$saveButton=$("#"+this.settings.Controls.GroupDialogOkButton);this.$cancelButton=$("#"+this.settings.Controls.GroupDialogCancelButton);this.$learnerDefinedGroupLink=$("#"+this.settings.Controls.GroupLink);this.$submitIndividuallyLink=$("#"+this.settings.Controls.SubmitIndividuallyLink);this.$withdrawLink=$("#"+this.settings.Controls.WithdrawLink);this.manageGroupDialog=
window[this.settings.Controls.ManageGroupDialog];this.settingManager=e.Settings.Manager.getInstance();$(function(){c.manageGroupDialog.setCustomScripts({afterOpenDialog:function(){setTimeout(function(){$("."+c.settings.Css.ExpandedExtensionIframe).addClass(c.settings.Css.ExpandedExtensionIframeStackedUnderSettings)},100)},beforeCloseDialog:function(){$("."+c.settings.Css.ExpandedExtensionIframe).removeClass(c.settings.Css.ExpandedExtensionIframeStackedUnderSettings)}});c.$submitIndividuallyLink.on("click",
function(){CCL.CommonFunctions.safeAjaxPost({url:c.settings.WebMethods.UseIndividualSubmission.replace("{elementId}",c.settings.ElementId.toString())}).done(function(a){return c.processResponse(a)}).fail(function(){return c.settingManager.alertError()})});c.$learnerDefinedGroupLink.on("click",function(){c.manageGroupDialog.openDialog(!1)});c.$withdrawLink.on("click",function(){c.settings.IsIndividualSubmission?c.withdrawFromGroup():CCL.CommonFunctions.jAjaxConfirm(c.settings.Terms.WithdrawConfirmation,
c.settings.Terms.ConfirmTitle,c.settings.Terms.Yes,c.settings.Terms.No,function(a){a&&c.withdrawFromGroup()})});c.$saveButton.on("click",function(){c.saveGroup()&&CssModal.closeDialog()});c.$cancelButton.on("click",function(){CssModal.closeDialog()})})}a.prototype.saveGroup=function(){var a=this;this.$saveButton.toggleHyperlink(!1);var b=$("#"+this.settings.Controls.ManageGroupDialog).find("iframe").get(0).contentWindow[this.settings.ManageGroupDialogInstanceName].getState();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.CreateCollaborationBasedOnLearnerDefinedGroup.replace("{elementId}",
this.settings.ElementId.toString()),data:{personIds:b.personIds}}).done(function(b){return a.processResponse(b)}).fail(function(){return a.settingManager.alertError()});return!0};a.prototype.withdrawFromGroup=function(){var a=this;CCL.CommonFunctions.safeAjax({type:"DELETE",url:this.settings.WebMethods.WithdrawFromLearnerDefinedGroup.replace("{elementId}",this.settings.ElementId.toString())}).done(function(b){return a.processResponse(b)}).fail(function(){return a.settingManager.alertError()})};a.prototype.processResponse=
function(a){a.Success?window.location.href=window.location.href.split("#")[0]:this.settingManager.alertError(a.Message)};return a}();d.LearnerDefinedGroups=a})(f.Collaboration||(f.Collaboration={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,b,d,e,f){this._isActive=a;this._useTimeSpan=b;this._timeZoneOffsetInSeconds=d;this._incorrectFormatTerm=e;this._dateShouldBeSetTerm=f}Object.defineProperty(a.prototype,"isActive",{get:function(){return this._isActive},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"useActivationTimeSpan",{get:function(){return this._useTimeSpan},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fromDateTime",{get:function(){return this.fromState.date},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"toDateTime",{get:function(){return this.toState.date},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isValid",{get:function(){if(!this.useActivationTimeSpan)return!0;var a=this.validationErrors;return 0===a.fromValidationError.length&&0===a.toValidationError.length},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fromNow",{get:function(){return!this.useActivationTimeSpan||this.useActivationTimeSpan&&
void 0==this.fromDateTime},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"toInfinity",{get:function(){return!this.useActivationTimeSpan||this.useActivationTimeSpan&&void 0==this.toDateTime},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"validationErrors",{get:function(){var a={fromValidationError:"",toValidationError:""};if(!this.useActivationTimeSpan)return a;this.fromState.isValid||(a.fromValidationError=this._incorrectFormatTerm);this.toState.isValid||(a.toValidationError=
this._incorrectFormatTerm);if(0<a.fromValidationError.length||0<a.toValidationError.length)return a;!this.toInfinity&&this.fromNow&&(a.fromValidationError=this._dateShouldBeSetTerm);return a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isActiveAccordingToTimeSpan",{get:function(){if(!this.useActivationTimeSpan)return this.isActive;var a=CCL.DateFunctions.getItslNow(this._timeZoneOffsetInSeconds);return this.fromNow&&this.toInfinity?!0:this.fromNow?this.isFirstLessThanSecond(a,
this.toDateTime):this.toInfinity?this.isFirstLessThanSecond(this.fromDateTime,a):this.isFirstLessThanSecond(this.fromDateTime,a)&&this.isFirstLessThanSecond(a,this.toDateTime)},enumerable:!0,configurable:!0});a.prototype.isFirstLessThanSecond=function(a,b){if(a&&b)return a<b};return a}();e.ActivationTimeSpanState=d;var a=function(){function a(a,b){var c=this;window[a]=this;this.settings=b;this.isElementActiveNow=this.settings.IsActive;this.useTimespan=this.settings.UseActivationTimespan;$(function(){c.fillJQueryElements();
c.fromDateTimePickerInstance=window[c.settings.ClientInstances.FromDateTimePickerClientInstanceName];c.toDateTimePickerInstance=window[c.settings.ClientInstances.ToDateTimePickerClientInstanceName];c.$activationLink.add(c.$activationLabel).click(function(){c.useTimespan&&(c.useTimespan=!1);c.isElementActiveNow=!c.isElementActiveNow;c.updateControlState();CCL.UnobtrusiveCustomTooltipManager.closeTooltip()});c.$toggleTimespanLink.click(function(){c.useTimespan=!c.useTimespan;c.updateControlState()});
c.updateControlState();$(c.fromDateTimePickerInstance).add($(c.toDateTimePickerInstance)).change(function(){return c.updateControlState()})})}a.prototype.getActivationTimeSpanState=function(){var a=new d(this.isElementActiveNow,this.useTimespan,this.settings.TimeZoneOffsetInSeconds,this.settings.Terms.DateMustBeOnTheFormatX,this.settings.Terms.PleaseEnterDate);a.useActivationTimeSpan&&(a.fromState=this.fromDateTimePickerInstance.getDateTimePickerState(),a.toState=this.toDateTimePickerInstance.getDateTimePickerState());
return a};a.prototype.hasTimeSpan=function(){if(!this.useTimespan)return!1;var a=this.getActivationTimeSpanState();return a.fromState.isValid&&!a.fromState.isEmpty};a.prototype.isActive=function(){return this.isElementActiveNow};a.prototype.validateControl=function(){var a=this.getActivationTimeSpanState(),b=a.validationErrors,d={isInvalid:b.toValidationError&&0<b.toValidationError.length,errorMessage:b.toValidationError,highlightInput:!0};this.fromDateTimePickerInstance.toggleValidationError({isInvalid:b.fromValidationError&&
0<b.fromValidationError.length,errorMessage:b.fromValidationError,highlightInput:!0});this.toDateTimePickerInstance.toggleValidationError(d);return a.isValid};a.prototype.isStringNullOrEmpty=function(a){return!a||0===a.length};a.prototype.fillJQueryElements=function(){this.$textAndIconContainer=$("#"+this.settings.Controls.TextAndIconContainer);this.$activationLink=$("#"+this.settings.Controls.ActivationLink);this.$activationImage=this.$activationLink.find("img");this.$activationLabel=$("#"+this.settings.Controls.ActivationLabel);
this.$toggleTimespanLink=$("#"+this.settings.Controls.ToggleTimespanLink);this.$timespanContainer=$("#"+this.settings.Controls.TimespanContainer);this.$fromDateInput=$("#"+this.settings.Controls.FromDateInput);this.$fromHoursDropDown=$("#"+this.settings.Controls.FromHoursDropDown);this.$fromMinutesDropDown=$("#"+this.settings.Controls.FromMinutesDropDown);this.$toDateInput=$("#"+this.settings.Controls.ToDateInput);this.$toHoursDropDown=$("#"+this.settings.Controls.ToHoursDropDown);this.$toMinutesDropDown=
$("#"+this.settings.Controls.ToMinutesDropDown)};a.prototype.updateControlState=function(){var a=this.getActivationTimeSpanState();a.useActivationTimeSpan&&(a=a.isActiveAccordingToTimeSpan,void 0!=a&&(this.isElementActiveNow=a));this.$timespanContainer.toggle(this.useTimespan);this.$toggleTimespanLink.toggleClass(this.settings.Css.AddLink,!this.useTimespan).toggleClass(this.settings.Css.RemoveLink,this.useTimespan);this.$toggleTimespanLink.find("span").text(this.useTimespan?this.settings.Terms.RemoveScheduledVisibility:
this.settings.Terms.AddScheduledVisibility);this.$activationLabel.html(this.isElementActiveNow?this.settings.Terms.ResourceIsVisible:this.settings.Terms.ResourceIsNotVisible);this.$activationImage.attr("src",this.isElementActiveNow?this.settings.Images.Active:this.settings.Images.Inactive);a=this.isElementActiveNow?this.settings.Tooltips.ClickToMakeInvisible:this.settings.Tooltips.ClickToMakeVisible;CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$activationLink,a);CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$activationLabel,
a);this.settings.Events.ElementActivationChangedEventName&&$(document).trigger(this.settings.Events.ElementActivationChangedEventName)};return a}();e.Activation=a})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;window[a]=this;this.settings=b;this.$toggle=$("#"+b.Controls.CompletedToggle);this.$simpleStatusSelector=$("#"+b.Controls.SimpleStatusSelector);if(0<this.$toggle.length||0<this.$simpleStatusSelector.length){this.$score=$("#"+b.Controls.Score);this.$assessment=$("#"+b.Controls.Assessment);var g=$("#"+b.Controls.CompletedToggleLabel),d=$("#"+b.Controls.AssessmentLabel+", #"+b.Controls.ScoreLabel);this.$toggle.on(b.ToggleStateChangedEventName,
function(a,c){a=window[c.toggleInstanceId];a.isChecked()?g.html(b.Terms.CompletedToggleOn):g.html(b.Terms.CompletedToggleOff);d.toggleClass(b.CssClasses.MandatoryMark,a.isChecked())});this.settings.IsAssessmentMandatoryForCompletedStatus&&(this.$score.add(this.$simpleStatusSelector).change(function(){d.toggleClass(b.CssClasses.MandatoryMark,c.isAsessmentMissingForCompleted())}),this.$assessment.on("autocompletechange",function(){d.toggleClass(b.CssClasses.MandatoryMark,c.isAsessmentMissingForCompleted())}))}this.rubricToggleChangeValue=
b.RubricToggleChangeValue;this.$criteriaAssessmentToggle=$("#"+this.settings.Controls.CriteriaAssessment);this.$rubricCriteriaList=$("#"+this.settings.Controls.RubricCriteriaList);this.$criteriaAssessmentToggle.change(function(){return c.toggleCriteriaAssessmentList()})}d.prototype.toggleCriteriaAssessmentList=function(){var a=this.$criteriaAssessmentToggle.val()===this.rubricToggleChangeValue;this.$rubricCriteriaList.toggleClass(this.settings.CssClasses.Hidden,!a)};d.prototype.isAsessmentMissingForCompleted=
function(){return(this.$toggle.is(":checked")||this.$simpleStatusSelector.val()===this.settings.SimpleStatusSelectorCompletedValue)&&(this.$assessment.val()===this.settings.NotAssessedValue||""===this.$score.val())};d.prototype.validateAssessmentForCompleted=function(a,b){b.IsValid=!this.isAsessmentMissingForCompleted()};return d}();e.ActivityMultipleAssessment=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.synchronize(a)}Object.defineProperty(d.prototype,"currentClientTime",{get:function(){return(new Date).getTime()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"clientDeltaTime",{get:function(){return this.currentClientTime-this.clientFixedTime},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"currentServerTime",{get:function(){return new Date(this.serverFixedTime+this.clientDeltaTime)},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"currentServerTimeWithoutSeconds",{get:function(){var a=this.currentServerTime;a.setSeconds(0);a.setMilliseconds(0);return a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isSynchronizeNeeded",{get:function(){return 3E5<this.clientDeltaTime},enumerable:!0,configurable:!0});d.prototype.synchronize=function(a){this.serverFixedTime=a.getTime();this.clientFixedTime=this.currentClientTime};return d}();e.DateTimeSynchronizer=f})(f.Controls||
(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.endDate=new Date;window[a]=this;this.settings=b;this.datePeriod=this.settings.DatePeriod;this.startDate=$.datepicker.parseDate(this.settings.DateFormat,this.settings.StartDate);this.setEndDate();this.weekNumber=this.settings.WeekNumber;this.dayNames=this.settings.DayNames;$(function(){c.$prevButton=$("#"+c.settings.ClientIds.PrevButton);c.$nextButton=$("#"+c.settings.ClientIds.NextButton);c.$dateShortLabel=$("#"+c.settings.ClientIds.DateShortLabel);
c.$datePrefixLabel=$("#"+c.settings.ClientIds.DatePrefixLabel);c.$prevButton.click(function(){return c.goToPreviousPeriod()});c.$nextButton.click(function(){return c.goToNextPeriod()});c.triggerPeriodChangedEvent()})}d.prototype.toggleNavigationButtons=function(a){this.$prevButton.toggleHyperlink(a);this.$nextButton.toggleHyperlink(a)};d.prototype.changeDatePeriod=function(a){this.startDate=$.datepicker.parseDate(this.settings.DateFormat,a);this.setEndDate();this.setWeekNumber();this.updateTitleLabel();
this.triggerPeriodChangedEvent()};d.prototype.toggleWeekDayMode=function(a,b){this.datePeriod=a;switch(this.datePeriod){case e.DatePeriod.Day:this.$prevButton.prop("title",this.settings.Terms.GoToThePreviousDay);this.$nextButton.prop("title",this.settings.Terms.GoToTheNextDay);break;case e.DatePeriod.Week:this.$prevButton.prop("title",this.settings.Terms.GoToThePreviousWeek),this.$nextButton.prop("title",this.settings.Terms.GoToTheNextWeek)}this.changeDatePeriod(b)};d.prototype.goToPreviousPeriod=
function(){this.$prevButton.getIfHyperLinkEnabled()&&(this.setNewPeriodDates(-this.getNumberOfDaysInPeriod()),this.updateTitleLabel(),this.triggerPeriodChangedEvent(),this.$prevButton.removeAttr("disabled"),this.$prevButton.focus())};d.prototype.goToNextPeriod=function(){this.$nextButton.getIfHyperLinkEnabled()&&(this.setNewPeriodDates(this.getNumberOfDaysInPeriod()),this.updateTitleLabel(),this.triggerPeriodChangedEvent(),this.$nextButton.removeAttr("disabled"),this.$nextButton.focus())};d.prototype.setNewPeriodDates=
function(a){this.startDate&&(this.setStartDate(a),this.setEndDate(),this.setWeekNumber())};d.prototype.setStartDate=function(a){this.startDate=this.addDays(this.startDate,a);this.startDate.setHours(0);this.startDate.setMinutes(0)};d.prototype.setEndDate=function(){this.endDate=this.addDays(this.startDate,this.getNumberOfDaysInPeriod()-1);this.endDate.setHours(23);this.endDate.setMinutes(59)};d.prototype.setWeekNumber=function(){this.weekNumber=$.datepicker.iso8601Week(this.startDate)};d.prototype.triggerPeriodChangedEvent=
function(){$(this).trigger(d.periodChangedEventName,{startDate:this.getStartDate(),endDate:this.getEndDate()})};d.prototype.addDays=function(a,b){a=new Date(a.valueOf());a.setDate(a.getDate()+b);return a};d.prototype.updateTitleLabel=function(){var a=this.settings.ShowWeekNumber?String.format(this.settings.Terms.WeekNumberTemplate,this.weekNumber.toString()):"",b=$.datepicker.formatDate(this.settings.DateFormat,this.startDate),c=$.datepicker.formatDate(this.settings.DateFormat,this.endDate);this.$datePrefixLabel.toggle(this.datePeriod===
e.DatePeriod.Day||this.settings.ShowWeekNumber);switch(this.datePeriod){case e.DatePeriod.Day:this.$datePrefixLabel.text(this.dayNames[this.startDate.getDay()]);this.$dateShortLabel.text(b);break;case e.DatePeriod.Week:this.$datePrefixLabel.text(a);this.$dateShortLabel.text(b+" - "+c);break;default:throw Error("Incorrect date period occurred: "+this.datePeriod+".");}};d.prototype.getNumberOfDaysInPeriod=function(){switch(this.datePeriod){case e.DatePeriod.Day:return 1;case e.DatePeriod.Week:return 7;
default:throw Error("Incorrect date period occurred: "+this.datePeriod+".");}};d.prototype.getDateTimeAsString=function(a){return a?$.datepicker.formatDate(this.settings.DateFormat,a)+" "+e.DateTimePicker.getNumberAsTwoCharString(a.getHours())+":"+e.DateTimePicker.getNumberAsTwoCharString(a.getMinutes()):""};d.prototype.getStartDate=function(){return this.getDateTimeAsString(this.startDate)};d.prototype.getEndDate=function(){return this.getDateTimeAsString(this.endDate)};d.periodChangedEventName=
"datePeriodSelector:periodChanged";return d}();e.DatePeriodSelector=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c,g,e){d.call(this,a,c,g,e)}__extends(a,d);a.prototype.getParams=function(a){var b=a.attr("data-date");a=a.parent().parent().attr("data-kpi-m-id");return{Date:b,MeasurementId:a}};a.prototype.paramsAreEqual=function(a,c){return null==a?!1:a.Date===c.Date&&a.MeasurementId===c.MeasurementId};a.prototype.formatUrlParams=function(a){return{date:a.Date,measurementid:a.MeasurementId}};return a}(e.BaseDetailedInfo);e.FeatureAdoptionDetailedInfo=f})(f.Controls||
(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;window[a]=this;this.settings=b;$(function(){c.$dataHidden=$("#"+c.settings.Controls.DataHidden);c.$listContainer=$("#"+c.settings.Controls.ListContainer);c.$orderChangedHidden=$("#"+c.settings.Controls.OrderChangedHidden);c.$listContainer.on("click","."+c.settings.Css.RemoveLink,function(a){a=$(a.currentTarget).closest("li");a=parseInt(a.data("id"),10);c.deleteElement(a)})})}d.prototype.getElementIds=function(){var a=this.$dataHidden.val();
return a?JSON.parse(a):[]};d.prototype.updateOrder=function(a){for(var b=[],c=0;c<a.length;c++){var g=a[c];g&&g.length&&(g=parseInt(g),isNaN(g)||b.push(g))}0<b.length&&this.$dataHidden.val(JSON.stringify(b));this.$orderChangedHidden.val("true")};d.prototype.addElement=function(a){var b=this;return $.getJSON(this.settings.WebMethods.GetElement.replace("{elementId}",a.toString())).done(function(a){b.addElementItem(a.ElementId,a.Title,a.IsActive,a.IconUrl)})};d.prototype.addElements=function(a){var b=
this;return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetElements.replace("{courseId}",this.settings.CourseId.toString()),data:{elementIds:a},dataType:"json"}).done(function(a){$.each(a,function(a,c){b.addElementItem(c.ElementId,c.Title,c.IsActive,c.IconUrl)})})};d.prototype.addElementItem=function(a,b,c,g){var d=JSON.parse(this.$dataHidden.val());if(-1===$.inArray(a,d)){var e=this.settings.Terms.RemoveTooltip.replace("{0}",b);c=c?"":this.settings.Css.Inactive;this.$listContainer.append($("<li></li>").attr("data-id",
a).append($("<span></span>").attr("class",this.settings.Css.ListItem).append($("<span></span>").attr("class",this.settings.Css.AssignmentIcon).append($("<img>").attr("src",g)).append($("<span></span>").attr("class",c).text(b)).append("&nbsp;")).append($("<span></span>").attr("class",this.settings.Css.RemoveLink).attr("title",e).text(this.settings.DeleteChar))));d.push(a);this.$dataHidden.val(JSON.stringify(d));this.$orderChangedHidden.val("true")}else a=this.$listContainer.find(CCL.CommonFunctions.getDataSelector("id",
a)+" span:first-child span:first-child span"),a.text(b),a.toggleClass(this.settings.Css.Inactive,!c)};d.prototype.deleteElement=function(a){var b=JSON.parse(this.$dataHidden.val()),c=b.indexOf(a);-1<c&&(b.splice(c,1),this.$dataHidden.val(JSON.stringify(b)));(a=this.$listContainer.find(CCL.CommonFunctions.getDataSelector("id",a)))&&a.remove()};d.prototype.deleteElements=function(a){var b=this;$.each(a,function(a,g){b.deleteElement(g)})};return d}();e.ElementList=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.viewModel=c;window[a]=this;this.controlsProvider=new e.ResultsAndFeedbackInternals.ControlsProvider(c);this.externalDependenciesController=new e.ResultsAndFeedbackInternals.ExternalDependenciesController(c,this.controlsProvider);this.whenToShowResultsController=new e.ResultsAndFeedbackInternals.WhenToShowResultsController(c,this.controlsProvider,this.externalDependenciesController);this.whenToShowQuestionListAndAnswerController=new e.ResultsAndFeedbackInternals.WhenToShowQuestionListAndAnswerController(c,
this.controlsProvider,this.whenToShowResultsController,this.externalDependenciesController);$(function(){b.controlsProvider.$revealCorrectAnswerContainer.toggle(b.whenToShowQuestionListAndAnswerController.whenToShowQuestionListAndAnswer!==e.WhenToShowQuestionListAndAnswer.Never)})}Object.defineProperty(a.prototype,"revealCorrectAnswer",{get:function(){return this.controlsProvider.revealCorrectAnswerElement.is(":checked")},enumerable:!0,configurable:!0});a.prototype.getState=function(){return{WhenToShowResult:this.whenToShowResultsController.whenToShowResult,
WhenToShowQuestionListAndAnswer:this.whenToShowQuestionListAndAnswerController.whenToShowQuestionListAndAnswer,RevealCorrectAnswer:this.revealCorrectAnswer,WhenToShowResultsChanged:this.whenToShowResultsController.whenToShowResultsChanged}};return a}();e.ResultsAndFeedback=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.viewModel=c;this.attemptsChanged=function(a){b.whichAttemptCountsContainer.toggle(1!==b.maxAttemptsAllowed)};window[a]=this;$(function(){b.controlElement=$("#"+c.ContainerId);b.maxAttemptsAllowedElement=$("."+c.MaxAttemptsAllowedSelector,b.controlElement);b.whichAttemptCountsElement=$("."+c.WhichAttemptCountsSelector,b.controlElement);b.whichAttemptCountsContainer=$("#"+c.WhichAttemptCountsContainer,b.controlElement);
b.maxAttemptsAllowedElement.change(b.attemptsChanged).change()})}Object.defineProperty(a.prototype,"maxAttemptsAllowed",{get:function(){return parseInt(this.maxAttemptsAllowedElement.val(),10)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"whichAttemptCounts",{get:function(){var a=this.whichAttemptCountsElement.val();return e.WhichAttemptCounts[a]},enumerable:!0,configurable:!0});a.prototype.getState=function(){return{MaxAttemptsAllowed:this.maxAttemptsAllowed,WhichAttemptCounts:this.whichAttemptCounts,
WhichAttemptCountsChanged:this.whichAttemptCounts!==this.viewModel.AttemptsState.WhichAttemptCounts}};return a}();e.Attempts=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){}}();e.DateWithAdditionalInfo=f;var d=function(){function a(a,c,g,d){this._dateFormat=a;if(0>g||24<=g||0>d||60<=d)this._isValid=!1;else if(c&&c.length){this._isEmpty=!1;try{this._date=$.datepicker.parseDate(this._dateFormat,c),this._date.setHours(g),this._date.setMinutes(d),this._isValid=!0}catch(m){this._isValid=!1}}else this._isValid=this._isEmpty=!0}Object.defineProperty(a.prototype,"isValid",{get:function(){return this._isValid},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"isEmpty",{get:function(){return this._isEmpty},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"date",{get:function(){return this._date},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"dateAsString",{get:function(){return this.isEmpty||!this.isValid?"":$.datepicker.formatDate(this._dateFormat,this._date)+" "+a.getNumberAsTwoCharString(this._date.getHours())+":"+a.getNumberAsTwoCharString(this._date.getMinutes())},
enumerable:!0,configurable:!0});a.getNumberAsTwoCharString=function(a){a=a.toString();return 1===a.length?"0"+a:a};return a}();e.DateTimePickerState=d;f=function(){function a(a,c){var b=this;this.getDatesToHighlight=function(a,b){return[]};window[a]=this;this.settings=c;this.$datePickerInput=$("#"+this.settings.Controls.DateInputId);this.$hoursDropDown=$("#"+this.settings.Controls.HoursDropDownId);this.$minutesDropDown=$("#"+this.settings.Controls.MinutesDropDownId);this.$validationMessage=$("#"+
this.settings.Controls.ValidationMessageId);this.$textDescription=$("#"+this.settings.Controls.TextDescriptionId);var d={showOn:"focus",buttonImage:"",buttonImageOnly:!1,showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0};d.dateFormat=this.settings.DatePickerOptions.DateFormat;d.firstDay=this.settings.DatePickerOptions.FirstDayOfWeek;d.monthNames=this.settings.DatePickerOptions.MonthNames;d.monthNamesShort=this.settings.DatePickerOptions.MonthNamesShort;d.dayNames=this.settings.DatePickerOptions.DayNames;
d.dayNamesShort=this.settings.DatePickerOptions.AbbreviatedDayNames;d.dayNamesMin=this.settings.DatePickerOptions.AbbreviatedDayNames;d.closeText=this.settings.DatePickerOptions.CloseText;d.prevText=this.settings.DatePickerOptions.PrevText;d.nextText=this.settings.DatePickerOptions.NextText;d.currentText=this.settings.DatePickerOptions.CurrentText;d.showWeek=this.settings.DatePickerOptions.ShowWeek;d.weekHeader=this.settings.DatePickerOptions.WeekHeader;d.onChangeMonthYear=function(a,c,g){b.updateDatesToHighLight(a,
c)};d.beforeShowDay=function(a){var c=!0;b.settings.EnableSelectingDatesInThePast||(c=new Date,c=a>=new Date(c.getFullYear(),c.getMonth(),c.getDate()));b.minDate&&(c=a>=b.minDateAtTheBeginningOfDay);if(!b.datesToHighlight||0===b.datesToHighlight.length)return[c];c=[c,""];for(var g=0;g<b.datesToHighlight.length;g++)if(b.areDatesEqual(a,b.datesToHighlight[g].Date)){c[1]=b.datesToHighlight[g].CssClass;break}return c};d.beforeShow=function(a,c){CCL.DatePickerAccessibilityAdapter.setCurrentDatePicker(b);
a=$(a).datepicker("getDate");null==a&&(a=new Date);b.updateDatesToHighLight(a.getFullYear(),a.getMonth()+1)};d.onSelect=function(a){if(b.datesToHighlight&&0!==b.datesToHighlight.length&&(a=$.datepicker.parseDate(d.dateFormat,a))){for(var c=0,g=0,e=0;e<b.datesToHighlight.length;e++)if(b.areDatesEqual(b.datesToHighlight[e].Date,a)){c=b.datesToHighlight[e].Date.getHours();g=b.datesToHighlight[e].Date.getMinutes();break}0!==c||0!==g?b.setTime(c,g):b.setTime(b.settings.DefaultHours,b.settings.DefaultMinutes)}b.updateTimePickerState();
b.updateDependentPicker();b.settings.EnableAutoSelectCurrentTimeForCurrentDate&&b.dateTimeSync&&b.isDateInputTextValid()&&(a=b.dateTimeSync.currentServerTime,b.areDatesEqual(b.getDateTime(),a)&&b.setTimePickerStateToCurrentTime(a));$(b).trigger("change",b.getDateTime())};d.onClose=function(){if(CCL.CommonFunctions.isIe()){var a=b.$datePickerInput.datepicker("option","showOn");b.$datePickerInput.datepicker("option","showOn","button");setTimeout(function(){b.$datePickerInput.focus();setTimeout(function(){b.$datePickerInput.datepicker("option",
"showOn",a)})})}else b.$datePickerInput.focus()};if(this.$datePickerInput&&(this.$datePickerInput.datepicker(d),""===this.$datePickerInput.val()&&this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes),this.$datePickerInput.change(function(){b.updateTimePickerState();$(b).trigger("change",b.getDateTime())}),this.settings.EnableTriggerDateInputBlurEvent))this.$datePickerInput.add(this.$hoursDropDown).add(this.$minutesDropDown).on("blur",function(){return $(b).trigger("blur",b.getDateTime())});
this.$hoursDropDown.add(this.$minutesDropDown).change(function(){$(b).trigger("change",b.getDateTime());b.toggleValidationError({isInvalid:!1})});this.updateTimePickerState()}Object.defineProperty(a.prototype,"dependentPicker",{set:function(a){this.dependentPickerInstance=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"dateTimeSynchronizer",{set:function(a){this.dateTimeSync=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"minDate",{get:function(){return this.minDateValue},
set:function(a){this.minDateValue=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"minDateAtTheBeginningOfDay",{get:function(){var a=new Date(this.minDateValue.getTime());a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a},enumerable:!0,configurable:!0});a.prototype.areDatesEqual=function(a,c){return a.getFullYear()===c.getFullYear()&&a.getMonth()===c.getMonth()&&a.getDate()===c.getDate()};a.prototype.setTime=function(a,c){1<this.settings.MinutesInterval?
(a=this.getTimeOfNextInterval(a,c,this.settings.MinutesInterval),this.setDropDownValue(this.$hoursDropDown,a.hours.toString()),this.setDropDownValue(this.$minutesDropDown,a.minutes.toString())):(this.setDropDownValue(this.$hoursDropDown,a.toString()),this.setDropDownValue(this.$minutesDropDown,c.toString()))};a.prototype.getTimeOfNextInterval=function(a,c,g){return 60-c<g?{hours:a+1,minutes:0}:{hours:a,minutes:Math.ceil(c/g)*g}};a.prototype.setDropDownValue=function(a,c){if(a){var b=!1;a.find("option").each(function(a,
g){return g.getAttribute("value")===c?(b=!0,!1):!0});b&&a.val(c)}};a.prototype.getDateTimePickerState=function(){return new d(this.settings.DatePickerOptions.DateFormat,this.$datePickerInput.val(),this.getDropDownValue(this.$hoursDropDown),this.getDropDownValue(this.$minutesDropDown))};a.prototype.getStringValue=function(){var b=this.$datePickerInput.val();return b?b+" "+a.getNumberAsTwoCharString(this.getHours())+":"+a.getNumberAsTwoCharString(this.getMinutes()):""};a.prototype.getDateTimeAsString=
function(){var b=this.getDateTime();return b?$.datepicker.formatDate(this.settings.DatePickerOptions.DateFormat,b)+" "+a.getNumberAsTwoCharString(b.getHours())+":"+a.getNumberAsTwoCharString(b.getMinutes()):""};Object.defineProperty(a.prototype,"isDateValidOrEmpty",{get:function(){return 0===this.$datePickerInput.val().length||this.isDateInputTextValid()},enumerable:!0,configurable:!0});a.prototype.getDateTime=function(){var a=void 0;try{a=$.datepicker.parseDate(this.settings.DatePickerOptions.DateFormat,
this.$datePickerInput.val())}catch(c){}if(a)return a.setHours(this.getHours()),a.setMinutes(this.getMinutes()),a};a.prototype.setDateTime=function(a){"undefined"===typeof a?(this.$datePickerInput.val(""),this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes)):(this.$datePickerInput.val($.datepicker.formatDate(this.settings.DatePickerOptions.DateFormat,a)),this.setTime(a.getHours(),a.getMinutes()));this.updateTimePickerState();this.updateDependentPicker()};a.prototype.toggleValidationError=
function(a){a.isInvalid?(a.errorMessage&&0<a.errorMessage.length&&(this.$validationMessage.text(a.errorMessage).show(),this.$textDescription.hide()),a.highlightInput&&(this.$datePickerInput.addClass(this.settings.CssClasses.InvalidInput),this.$hoursDropDown.addClass(this.settings.CssClasses.InvalidInput),this.$minutesDropDown.addClass(this.settings.CssClasses.InvalidInput))):(this.$validationMessage.empty().hide(),this.$textDescription.show(),this.$datePickerInput.removeClass(this.settings.CssClasses.InvalidInput),
this.$hoursDropDown.removeClass(this.settings.CssClasses.InvalidInput),this.$minutesDropDown.removeClass(this.settings.CssClasses.InvalidInput))};a.prototype.highlightOnAutoCorrectInvalidInput=function(a){var b=this;this.$datePickerInput.addClass(this.settings.CssClasses.InvalidInput);this.$hoursDropDown.addClass(this.settings.CssClasses.InvalidInput);this.$minutesDropDown.addClass(this.settings.CssClasses.InvalidInput);setTimeout(function(){b.$datePickerInput.removeClass(b.settings.CssClasses.InvalidInput);
b.$hoursDropDown.removeClass(b.settings.CssClasses.InvalidInput);b.$minutesDropDown.removeClass(b.settings.CssClasses.InvalidInput)},a)};a.getNumberAsTwoCharString=function(a){a=a.toString();return 1===a.length?"0"+a:a};a.prototype.getHours=function(){return this.getDropDownValue(this.$hoursDropDown)};a.prototype.getMinutes=function(){return this.getDropDownValue(this.$minutesDropDown)};a.prototype.getDropDownValue=function(a){return a?(a=a.val())&&""!==a.toString()?+a:0:0};a.prototype.enable=function(a){this.$datePickerInput.prop("disabled",
!a);this.$hoursDropDown.add(this.$minutesDropDown).prop("disabled",!a||!this.isDateInputTextValid())};a.prototype.updateDatesToHighLight=function(a,c){this.getDatesToHighlight&&"function"===typeof this.getDatesToHighlight&&(this.datesToHighlight=this.getDatesToHighlight(new Date(a,c-2,25),new Date(a,c,6)))};a.prototype.isDateInputTextValid=function(){var a=void 0;try{a=$.datepicker.parseDate(this.settings.DatePickerOptions.DateFormat,this.$datePickerInput.val())}catch(c){}return void 0!==a&&null!==
a};a.prototype.updateTimePickerState=function(){this.toggleValidationError({isInvalid:!1});this.$hoursDropDown.add(this.$minutesDropDown).prop("disabled",!this.isDateInputTextValid())};a.prototype.setTimePickerStateToCurrentTime=function(a){this.setTime(a.getHours(),a.getMinutes())};a.prototype.updateDependentPicker=function(){this.dependentPickerInstance&&(this.getDateTime()>=this.dateTimeSync.currentServerTime||this.dependentPickerInstance.settings.EnableSelectingDatesInThePast)&&(this.dependentPickerInstance.minDate=
this.getDateTime())};a.prototype.isFocusWithinControl=function(){return this.$datePickerInput.is(":focus")||this.$hoursDropDown.is(":focus")||this.$minutesDropDown.is(":focus")};a.prototype.closePicker=function(){this.$datePickerInput.datepicker("hide")};a.prototype.clearDateAndTime=function(a){this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes);a||this.$datePickerInput.val("")};a.prototype.getDate=function(){return this.getDateTimePickerState().date};a.prototype.setDate=function(a){this.setDateTime(a)};
return a}();e.DateTimePicker=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.DeadlineState=d;d=function(){function a(a,c){var b=this;this.peerAndSelfAssessmentStateChanged=function(a,c,g){b.emptyDeadlineValidationEnabled=c;b.$closeAfterDeadlineCheckBox.prop("checked",c||b.settings.CloseAfterDeadline).change();b.$closeAfterDeadlineCheckBox.prop("disabled",c);b.customTooltipForCheckbox.setToolTipHtml(c?b.settings.Terms.CloseAfterDeadlineDisabledWarning:"");b.initEmptyDeadlineValidation()};window[a]=
this;this.settings=c;$(function(){b.dateTimePicker=window[b.settings.ClientInstanceNames.DateTimePicker];b.$deadlineSection=$("["+b.settings.SectionDataAttribute+"]");b.$deadlineHeaderText=b.$deadlineSection.find("."+b.settings.HeaderTextClass);b.$closeAfterDeadlineCheckBox=$("#"+b.settings.Controls.CloseAfterDeadlineCheckBox);b.customTooltipForCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(b.$closeAfterDeadlineCheckBox);if(b.settings.HasDeadlinePassed&&b.settings.PeerAssessmentEnabled)b.enabled=
!1;else{if(b.settings.Events.PeerAndSelfAssessmentStateChanged)$(document).off(b.settings.Events.PeerAndSelfAssessmentStateChanged).on(b.settings.Events.PeerAndSelfAssessmentStateChanged,b.peerAndSelfAssessmentStateChanged);$(b.dateTimePicker).change(function(){b.emptyDeadlineValidationEnabled&&b.dateTimePicker.getDateTimePickerState().isEmpty?b.dateTimePicker.toggleValidationError({isInvalid:!0,errorMessage:c.Terms.SetDeadline,highlightInput:!0}):$(b).trigger("change",b.dateTimePicker.getDateTime())});
b.dateTimePicker&&(b.dateTimePicker.getDatesToHighlight=function(a,c){var g=[];b.settings.WebMethods.GetEventsDateTime&&b.settings.CourseId&&0<b.settings.CourseId&&CCL.CommonFunctions.safeAjax({url:b.settings.WebMethods.GetEventsDateTime,type:"POST",async:!1,data:{startDate:JSON.stringify(a),endDate:JSON.stringify(c),courseId:b.settings.CourseId}}).done(function(a){for(var c=0;c<a.length;c++){var d=a[c],e={};e.Date=b.convertStringToDate(d.Date);e.CssClass=d.CssClass;g.push(e)}});return g},$(b.dateTimePicker).on("change",
function(){b.settings.Events.DeadlineStateChanged&&$(document).trigger(b.settings.Events.DeadlineStateChanged)}))}})}a.prototype.getState=function(){return{CloseAfterDeadline:this.settings.UseCloseAfterDeadline?this.$closeAfterDeadlineCheckBox.is(":checked"):!1,DateTime:this.dateTimePicker.getStringValue()}};a.prototype.isSet=function(){return this.dateTimePicker.getDateTimePickerState().isValid&&!this.dateTimePicker.getDateTimePickerState().isEmpty};a.prototype.mandatory=function(a){this.$deadlineHeaderText.toggleClass(this.settings.CssClasses.Mandatory,
a)};a.prototype.convertStringToDate=function(a){a=a.split(".");return new Date(+a[2],+a[1]-1,+a[0],+a[3],+a[4])};Object.defineProperty(a.prototype,"enabled",{set:function(a){this.$closeAfterDeadlineCheckBox.prop("disabled",!a);this.dateTimePicker.enable(a)},enumerable:!0,configurable:!0});a.prototype.initEmptyDeadlineValidation=function(){this.emptyDeadlineValidationEnabled||this.dateTimePicker.toggleValidationError({isInvalid:!1})};return a}();e.Deadline=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||
(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d.invalidDateAllowEmpty=function(a,b){return e.ValidatorFactory.checkToggle(function(){return!a.isDateValidOrEmpty},a,b)};d.invalidDateDenyEmpty=function(a,b){return e.ValidatorFactory.checkToggle(function(){return void 0===a.getDateTime()},a,b)};d.invalidDateAllowEmptyNoHighlight=function(a,b,c){return e.ValidatorFactory.checkNoHighlight(a,function(){return!a.isDateValidOrEmpty},b,c)};d.invalidDateDenyEmptyNoHighlight=function(a,b,c){return e.ValidatorFactory.checkNoHighlight(a,
function(){return void 0===a.getDateTime()},b,c)};d.compareDates=function(a,b,c,g){return e.ValidatorFactory.checkToggle(function(){return a(b.getDateTime(),c)},b,g)}})(e.DateTimePickerValidatorFactory||(e.DateTimePickerValidatorFactory={}))})(e.Validation||(e.Validation={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){function a(a,c,g){g&&c.isInvalid&&g();a.toggleValidationError(c);return!c.isInvalid}d.lessThanOrEqual=function(a,c){return a<=c};d.all=function(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];return function(){return 0===a.filter(function(a){return!a()}).length}};d.until=function(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];return function(){return a.every(function(a){return a()})}};d.checkToggle=function(b,c,g){return function(){return a(c,
{isInvalid:b(),errorMessage:g,highlightInput:!0},void 0)}};d.checkNoHighlight=function(b,c,g,d){return function(){return a(b,{isInvalid:c(),errorMessage:g,highlightInput:!1},d)}}})(e.ValidatorFactory||(e.ValidatorFactory={}))})(e.Validation||(e.Validation={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.contentMaxHeight=250;this.settings=c;window[a]=this;this.$mainContainer=$("."+c.ContainerCssClass);this.$showMore=$("#"+c.ShowMoreClientId);this.$showLess=$("#"+c.ShowLessClientId);this.showLess(!0)}a.prototype.showMore=function(){var a=this;this.$showMore.hide();this.expandMainContainer();var c=this.$mainContainer.height();this.$mainContainer.css("height",this.contentMaxHeight).css("overflow","hidden").animate({height:c},
function(){a.expandMainContainer();c>a.contentMaxHeight&&a.$showLess.show()})};a.prototype.showLess=function(a){var b=this;this.$showLess.hide();this.expandMainContainer();this.$mainContainer.height()<=this.contentMaxHeight||this.$mainContainer.css("overflow","hidden").animate({height:this.contentMaxHeight},a?0:400,function(){b.$mainContainer.css("position","relative");b.$showMore.show();b.$mainContainer.find(":tabbable:visible").on("focus",function(a){b.showMoreWhenOutOfView(a)})})};a.prototype.showMoreWhenOutOfView=
function(a){a=$(a.currentTarget).offset().top;var b=this.$mainContainer.offset().top+this.contentMaxHeight-this.$showMore.height();a>b&&(this.showMore(),this.$mainContainer.find(":tabbable:visible").off("focus"))};a.prototype.expandMainContainer=function(){this.$mainContainer.css("height","").css("overflow","").css("position","")};return a}();e.ShowMoreLessLinks=d})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b){var c=this;this.controls=a;this.settings=b;this.eventDialog=window[this.settings.ClientInstanceNames.EventDialog];this.currentDatePeriod=this.settings.DatePeriod;this.ajaxClient=new d.AgendaAjaxClient(this.settings.WebMethods,this.settings.WidgetSettings);this.utility=new d.AgendaUtility(this.settings.DataAttributes,this.controls);this.eventPreview=new d.AgendaEventPreview(this.settings.ClientInstanceNames.EventDialog,
a.EventDialog,b.WebMethods.GetEventDetails,b.WidgetSettings);this.setupEventItemClick();this.setupHideTaskItemClick();this.controls.DayViewLink.add(this.controls.WeekViewLink).click(function(a){return c.changeDatePeriod(c.utility.getExpectedDatePeriod(a.currentTarget))});this.contentBlockExpander=new CCL.ContentBlockExpander(this.controls.Container,{maxHeight:this.settings.ExpanderMaxPixelHeight,collapseHeight:this.settings.ExpanderCollapsePixelHeight,lang:{showLess:this.settings.Terms.ShowLess,showMore:this.settings.Terms.ShowMore}});
$(function(){c.datePeriodSelector=window[c.settings.ClientInstanceNames.DatePeriodSelector];$(c.datePeriodSelector).on(f.Controls.DatePeriodSelector.periodChangedEventName,function(a,b){return c.loadAgenda(c.ajaxClient.createGetAgendaDayListContainerAjaxRequest(b.startDate,b.endDate,c.currentDatePeriod))})})}a.prototype.afterUpdateWidget=function(){this.contentBlockExpander.reRenderShowMoreLink()};a.prototype.clearEventDialogContent=function(){this.eventPreview.resetDialog()};a.prototype.changeDatePeriod=
function(a){this.currentDatePeriod!==a&&(this.currentDatePeriod=a,this.controls.DayViewLink.toggleClass(this.settings.CssClasses.TogglerItemActive,this.currentDatePeriod===f.Controls.DatePeriod.Day),this.controls.WeekViewLink.toggleClass(this.settings.CssClasses.TogglerItemActive,this.currentDatePeriod===f.Controls.DatePeriod.Week),this.datePeriodSelector.toggleWeekDayMode(this.currentDatePeriod,this.currentDatePeriod===f.Controls.DatePeriod.Week?this.settings.FirstDayOfTheWeek:this.settings.Today))};
a.prototype.setupEventItemClick=function(){var a=this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.EventTimeRangeLink),function(b){b=$(b.currentTarget);b.getIfHyperLinkEnabled()&&(b=b.closest("."+a.settings.CssClasses.EventItemContainer),a.eventPreview.open(a.utility.getEventId(b),a.utility.getEventTitle(b),a.utility.getEventCategory(b),a.utility.getEventUrl(b),a.utility.getEventColorSchema(b)))})};a.prototype.setupHideTaskItemClick=function(){var a=
this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.TaskHideId),function(b){return a.loadAgenda(a.ajaxClient.createHideTaskAjaxRequest(a.utility.getTaskHideId($(b.currentTarget)),a.datePeriodSelector.getStartDate(),a.datePeriodSelector.getEndDate(),a.currentDatePeriod))})};a.prototype.loadAgenda=function(a){var b=this;this.currentLoadingSession&&this.currentLoadingSession.abort&&this.currentLoadingSession.abort();this.controls.AjaxLoadingWheel.show();
this.controls.DayListContainer.empty().hide();this.contentBlockExpander.reRenderShowMoreLink();this.currentLoadingSession=a();this.currentLoadingSession.done(function(a){return b.controls.DayListContainer.append(a.html).show()}).always(function(){b.controls.AjaxLoadingWheel.hide();b.contentBlockExpander.renderShowMoreLinkIfNeed(!1);b.currentLoadingSession=void 0})};return a}();d.AgendaContentBlock=a})(e.Agenda||(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.controls=a;this.settings=b;this.selectors={elementLinkItem:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkItemId),listItemFocusedArea:"."+this.settings.CssClasses.ListItemFocusedArea,elementLinkFolderActionExpand:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderActionExpand)}}d.prototype.isListItemFocusedArea=function(a){return a.is(this.selectors.listItemFocusedArea)};d.prototype.closestListItemFocusedArea=
function(a){return a.closest(this.selectors.listItemFocusedArea)};d.prototype.closestElementItem=function(a){return a.closest(this.selectors.elementLinkItem)};d.prototype.getElementId=function(a){return a.data(this.settings.DataAttributes.ElementLinkItemId)};d.prototype.getCheckbox=function(a){return $("#"+this.settings.ElementItemPrefix+a)};return d}();e.Utility=f})(f.ElementLinkDialog||(f.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.ElementLinkDialog||(f.ElementLinkDialog={});f=f.ElementsPopupOpener||(f.ElementsPopupOpener={});f[f.None=0]="None";f[f.Plan=1]="Plan";f[f.WorkingPortfolioTask=2]="WorkingPortfolioTask";f[f.WorkingPortfolioPersonalizedTask=3]="WorkingPortfolioPersonalizedTask";f[f.CalendarEvent=4]="CalendarEvent";f[f.LearningPath=5]="LearningPath"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.controls=a;this.settings=b;this.getParticipantCheckBox=function(a){return $("#"+c.settings.ControlIds.DialogPersonItemCheckBoxPrefix+a)};this.getGroupCheckBox=function(a){return $("#"+c.settings.ControlIds.DialogGroupItemCheckBoxPrefix+a)}}d.prototype.getItemId=function(a){return a.data(this.settings.DataAttributes.ItemId)};d.prototype.getItemType=function(a){return a.data(this.settings.DataAttributes.ItemType)};d.prototype.getSelectedItemMarkup=
function(a){return a.data(this.settings.DataAttributes.SelectedItemMarkup)};d.prototype.findLoadMoreItemsPointer=function(a){return a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.LoadMoreItems))};d.prototype.getVirtualCount=function(a){return a.data(this.settings.DataAttributes.VirtualCount)};d.prototype.findListItems=function(a){return a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};d.prototype.findSelectedItems=function(a){return this.controls.SelectedList.children("undefined"===
typeof a?CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId):CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemType,a))};d.prototype.closestListItem=function(a){return a.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};d.prototype.closestSelectedItem=function(a){return a.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};return d}();e.Utility=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker=
{}))})(ItslearningWeb||(ItslearningWeb={}));(function(f){(function(e){var k=function(d){function a(a){d.call(this,a.controls.RadioButtonGroup,[[e.ItemType.Participant,a.controls.ParticipantsRadioButton],[e.ItemType.Group,a.controls.GroupsRadioButton]])}__extends(a,d);return a}(f.OptionRadioButton.OptionRadioButtonManagerBase);e.OptionRadioButtonManager=k})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,a){this.utility=d;this.itemType=a;this.checkboxStateManager=new e.CheckboxStateManager;this.markupBuilder=new e.MarkupBuilder(this.utility,a);switch(a){case e.ItemType.Participant:this.itemList=this.utility.controls.ParticipantList;this.terms={noItemsMeetSearchCriteria:this.utility.settings.Terms.NoParticipantsFound,noItemsInCourse:this.utility.settings.Terms.NoParticipantsInCourse,searchPlaceholder:this.utility.settings.Terms.SearchForParticipants};
this.getCheckbox=this.utility.getParticipantCheckBox;break;case e.ItemType.Group:this.itemList=this.utility.controls.GroupList;this.terms={noItemsMeetSearchCriteria:this.utility.settings.Terms.NoGroupsFound,noItemsInCourse:this.utility.settings.Terms.NoGroupsInCourse,searchPlaceholder:this.utility.settings.Terms.SearchForGroups};this.getCheckbox=this.utility.getGroupCheckBox;break;default:throw Error("Unknown ItemType "+a);}}}();e.DialogItemModeDependentObjects=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.utility=a;this.itemType=b;this.cache=new Map}d.prototype.putMarkupFromSelectedItems=function(){var a=this;this.utility.findSelectedItems(this.itemType).each(function(b,c){return a.cache.set(a.utility.getItemId($(c)),c.outerHTML)})};d.prototype.putMarkupFromToggledItem=function(a){this.cache.set(this.utility.getItemId(a),this.utility.getSelectedItemMarkup(a))};d.prototype.buildMarkup=function(a){var b=this;return a.map(function(a){return b.cache.get(a)}).join("")};
return d}();e.MarkupBuilder=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(){this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.committedStateMap=new Map;this.pendingStateMap=new Map;this.ignoreCheckboxEvents=!1}d.prototype.setInitiallySelectedItemIds=function(a){for(var b=0;b<a.length;b++)this.committedStateMap.set(a[b],f.CheckboxStateMachine.State.Saved)};d.prototype.getSelectedItemIds=function(){var a=this,b=[];this.committedStateMap.forEach(function(c,g){a.isStateChecked(c)&&b.push(g)});return b};d.prototype.isItemPendingChecked=
function(a){return this.isStateChecked(this.pendingStateMap.get(a)||f.CheckboxStateMachine.State.Empty)};d.prototype.initializePendingStateMap=function(){this.pendingStateMap=f.MapUtils.makeCopy(this.committedStateMap)};d.prototype.commitPendingStateMap=function(){this.committedStateMap=f.MapUtils.makeCopy(this.pendingStateMap)};d.prototype.withIgnoreCheckboxEvents=function(a){this.ignoreCheckboxEvents=!0;try{a()}finally{this.ignoreCheckboxEvents=!1}};d.prototype.transferPendingState=function(a){var b=
a.itemId;a=a.isChecked;if(!this.ignoreCheckboxEvents){var c=this.pendingStateMap.get(b)||f.CheckboxStateMachine.State.Empty;a=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(a,c);this.pendingStateMap.set(b,a)}};d.prototype.transferCommittedStateToUnchecked=function(a){var b=this.committedStateMap.get(a);b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,b);this.committedStateMap.set(a,b)};d.prototype.isStateChecked=function(a){return a===f.CheckboxStateMachine.State.Saved||
a===f.CheckboxStateMachine.State.AttachedByUser};return d}();e.CheckboxStateManager=k})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.controls=a;this.settings=b;this.searchTimeoutMilliseconds=1E3;this.pageIndex=0;this.searchDebouncer=new CCL.CallbackDebouncer(function(){return c.search()});this.isSelectedListCollapsed=!0;this.onCheckboxStateChanged=function(a){a=$(a.currentTarget);var b=c.utility.closestListItem(a),g=c.utility.getItemId(b);c.currentObjects.checkboxStateManager.transferPendingState({itemId:g,isChecked:a.is(":checked")});c.currentObjects.markupBuilder.putMarkupFromToggledItem(b)};
this.onClickingListItem=function(a){var b=$(a.currentTarget);0<b.find("label").find($(a.target)).length||c.optionRadioManager.isSelected(e.ItemType.Participant)&&b.children("a").get(0).contains(a.target)||c.toggleOptionCheckBox(c.utility.getItemId(b),function(a){return!a})};this.onWithdrawItem=function(a){a.preventDefault();var b=c.utility.closestSelectedItem($(a.currentTarget));a=c.utility.getItemId(b);var g=c.utility.getItemType(b);b.remove();b=g===e.ItemType.Participant?c.personObjects.checkboxStateManager:
c.groupObjects.checkboxStateManager;c.uncheckCheckbox(a,b);b.transferCommittedStateToUnchecked(a);c.updatePickerResultHidden();c.updateCollapserWhenNumberOfSelectedItemsChanged();c.setSelectedItemSectionVisibility()};this.utility=new e.Utility(a,b);this.modalDialog=window[this.settings.ClientInstanceNames.Dialog];this.personObjects=new e.DialogItemModeDependentObjects(this.utility,e.ItemType.Participant);this.groupObjects=new e.DialogItemModeDependentObjects(this.utility,e.ItemType.Group);this.currentObjects=
this.settings.InitialItemType===e.ItemType.Group?this.groupObjects:this.personObjects;this.updateUiAfterSwitchBetweenParticipantsAndGroups();this.optionRadioManager=new e.OptionRadioButtonManager(this.utility);this.isIosDevice=CCL.CommonFunctions.isIosDevice();this.setupOkButtonClickHandler();this.controls.ShowMoreSelectedItemsLink.click(function(a){a.preventDefault();c.toggleCollapser()});this.controls.ChangeLink.click(function(a){c.openDialog();c.personObjects.checkboxStateManager.initializePendingStateMap();
c.groupObjects.checkboxStateManager.initializePendingStateMap();c.updateCheckboxes();a.preventDefault()});a=this.controls.ParticipantList.add(this.controls.GroupList);a.on((g={},g.change=this.onCheckboxStateChanged,g),"input:checkbox");a.on("click","li",this.onClickingListItem);this.controls.SelectedList.on("click","."+this.settings.CssClasses.WithdrawLink,this.onWithdrawItem);this.setupLoadMoreOnScroll();this.setupRadioButtonChangeHandler();this.setupSearch();this.personObjects.checkboxStateManager.setInitiallySelectedItemIds(this.settings.InitiallySelectedParticipantIds);
this.groupObjects.checkboxStateManager.setInitiallySelectedItemIds(this.settings.InitiallySelectedGroupIds);this.personObjects.markupBuilder.putMarkupFromSelectedItems();this.groupObjects.markupBuilder.putMarkupFromSelectedItems();this.updatePickerResultHidden();this.controls.DialogContent.keypress(function(a){a.which!==CCL.CommonConstants.keyCodes.enter||c.controls.OkButton.is(":focus")||a.preventDefault()});var g}d.prototype.setupLoadMoreOnScroll=function(){var a=this;this.controls.DialogContent.on((this.isIosDevice?
"touchmove":"")+" scroll",function(){var b=a.currentObjects.itemList,c;!a.isLoadingInProgress&&0<a.utility.findLoadMoreItemsPointer(b).length&&CCL.CommonFunctions.isOnScreen((c=a.utility.findListItems(b)).eq(Math.max(0,c.length-3)),.1,.1,a.isIosDevice?window.parent:window)&&a.loadMoreItems()})};d.prototype.setupRadioButtonChangeHandler=function(){var a=this;this.optionRadioManager.addOnChangeHandler(function(){a.switchCurrentObjects();a.search()})};d.prototype.setupSearch=function(){var a=this;this.controls.SearchTextBox.on("input",
function(b){""===a.controls.SearchTextBox.val()?a.search():a.searchDebouncer.invokeCallback(void 0,a.searchTimeoutMilliseconds);b.preventDefault()})};d.prototype.search=function(){this.pageIndex=0;this.loadMoreItems({cleanExistingEntries:!0})};d.prototype.loadMoreItems=function(a){var b=this;a=(void 0===a?{}:a).cleanExistingEntries;var c=this.currentObjects.itemList;this.isLoadingInProgress=!0;if(void 0===a?0:a)c.empty(),this.controls.NoItemsFoundPanel.hide(),this.controls.AjaxLoader.show();this.itemsRequest&&
this.itemsRequest.abort&&this.itemsRequest.abort();this.itemsRequest=this.searchOrLoadMore();this.itemsRequest.done(function(a){b.utility.findLoadMoreItemsPointer(c).remove();c.append(a);var g=b.utility.findLoadMoreItemsPointer(c);a=b.utility.findListItems(c).length;var d=0!==a;g=0<g.length?b.utility.getVirtualCount(g):a;b.controls.PageInfo.toggle(d).text(CCL.CommonFunctions.formatString(b.settings.Terms.ShowingXofYLabelFormat,a,g));c.toggle(d);d||b.controls.NoItemsFoundPanel.text(""===b.controls.SearchTextBox.val()?
b.currentObjects.terms.noItemsInCourse:b.currentObjects.terms.noItemsMeetSearchCriteria);b.controls.NoItemsFoundPanel.toggle(!d);b.pageIndex++;b.updateCheckboxes()}).always(function(){b.itemsRequest=void 0;b.isLoadingInProgress=!1;b.controls.AjaxLoader.hide()})};d.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.click(function(b){a.applySelectedItems();CssModal.closeDialog();b.preventDefault()})};d.prototype.applySelectedItems=function(){this.personObjects.checkboxStateManager.commitPendingStateMap();
this.groupObjects.checkboxStateManager.commitPendingStateMap();this.updatePickerResultHidden();this.controls.SelectedList.empty().append(this.personObjects.markupBuilder.buildMarkup(this.personObjects.checkboxStateManager.getSelectedItemIds())).append(this.groupObjects.markupBuilder.buildMarkup(this.groupObjects.checkboxStateManager.getSelectedItemIds()));this.updateCollapserWhenNumberOfSelectedItemsChanged();this.setSelectedItemSectionVisibility()};d.prototype.updateCollapserWhenNumberOfSelectedItemsChanged=
function(){this.updateToggleSelectedItemsCountLinkText();this.controls.ShowMoreSelectedItemsLinkContainer.toggle(this.utility.findSelectedItems().length>this.settings.NumberOfSelectedItemsToDisplayInCollapsedMode)};d.prototype.toggleCollapser=function(){this.isSelectedListCollapsed=!this.isSelectedListCollapsed;this.controls.SelectedList.toggleClass(this.settings.CssClasses.SelectedListCollapsed,this.isSelectedListCollapsed);this.updateToggleSelectedItemsCountLinkText()};d.prototype.updateToggleSelectedItemsCountLinkText=
function(){this.controls.ShowMoreSelectedItemsLink.text(this.isSelectedListCollapsed?CCL.CommonFunctions.formatString(this.settings.Terms.ShowAllFormat,this.utility.findSelectedItems().length):this.settings.Terms.Hide)};d.prototype.updateCheckboxes=function(){var a=this;this.currentObjects.checkboxStateManager.withIgnoreCheckboxEvents(function(){a.utility.findListItems(a.currentObjects.itemList).each(function(b,c){b=$(c);c=a.utility.getItemId(b);a.toggleOptionCheckBox(c,a.currentObjects.checkboxStateManager.isItemPendingChecked(c));
a.currentObjects.markupBuilder.putMarkupFromToggledItem(b)})})};d.prototype.setSelectedItemSectionVisibility=function(){var a=0<this.utility.findSelectedItems().length;this.controls.SelectedListContainer.toggle(a);this.controls.NoOneIsChosenLabel.toggle(!a)};d.prototype.openDialog=function(){this.controls.SearchTextBox.focus();this.modalDialog.openDialog(!1);this.controls.SearchTextBox.val("");this.search()};d.prototype.searchOrLoadMore=function(){var a={ElementOrParentFolderId:this.settings.ElementOrParentFolderId,
PageIndex:this.pageIndex,Search:this.controls.SearchTextBox.val(),IsGroups:this.optionRadioManager.isSelected(e.ItemType.Group)};return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetParticipantOrGroupListContent,data:a,dataType:"html"})};d.prototype.sortSelectedList=function(){var a=this;this.utility.findSelectedItems().get().sort(function(b,c){var g=a.settings.IsParticipantListSortOrderAscending?c:b,d="data-"+a.settings.DataAttributes.SelectedItemSortExpression;return $(a.settings.IsParticipantListSortOrderAscending?
b:c).attr(d).localeCompare($(g).attr(d))}).forEach(function(b){a.controls.SelectedList.append(b)})};d.prototype.uncheckCheckbox=function(a,b){var c=this;b.withIgnoreCheckboxEvents(function(){c.toggleOptionCheckBox(a,!1)})};d.prototype.updatePickerResultHidden=function(){var a={ParticipantIds:this.personObjects.checkboxStateManager.getSelectedItemIds(),GroupIds:this.groupObjects.checkboxStateManager.getSelectedItemIds()};this.controls.PickerResultHidden.val(JSON.stringify(a))};d.prototype.toggleOptionCheckBox=
function(a,b){if(a=this.currentObjects.getCheckbox(a))b="boolean"===typeof b?b:b(a.is(":checked")),a.is(":checked")!==b&&(a.prop("checked",b),a.trigger("change"))};d.prototype.switchCurrentObjects=function(){this.currentObjects=this.optionRadioManager.isSelected(e.ItemType.Participant)?this.personObjects:this.groupObjects;this.updateUiAfterSwitchBetweenParticipantsAndGroups()};d.prototype.updateUiAfterSwitchBetweenParticipantsAndGroups=function(){this.utility.controls.ParticipantList.toggle(this.currentObjects.itemType===
e.ItemType.Participant);this.utility.controls.GroupList.toggle(this.currentObjects.itemType===e.ItemType.Group);this.utility.controls.SearchTextBox.prop("placeholder",this.currentObjects.terms.searchPlaceholder)};return d}();e.PickerManager=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.settings=a;this.addCourseWindow=$("."+this.settings.CssClasses.Window);this.addCourseForm=this.addCourseWindow.find("form");this.scrollable=this.addCourseForm.find("."+this.settings.CssClasses.ScrollDiv);this.titleInput=$("#"+this.settings.ControlIds.CourseTitle);this.titleError=$("."+this.settings.CssClasses.Title.Error);this.courseIcon=$("."+this.settings.CssClasses.CourseIcon);this.colorPicker=$("#"+this.settings.ControlIds.ColorPicker);
this.colorPickerHover=this.colorPicker.next();this.codeInput=$("."+this.settings.CssClasses.Code);this.buttons=$("."+this.settings.CssClasses.Buttons);this.buttonSubmit=$("#"+this.settings.ControlIds.CreateCourseButton);this.buttonCancel=$("#"+this.settings.ControlIds.CancelButton);this.advancedOptionsToggler=$("."+this.settings.CssClasses.Advanced.Toggler);this.advancedOptionsContent=$("."+this.settings.CssClasses.Advanced.Content);this.advancedOptionsLanguage=this.advancedOptionsToggler.data("lang");
this.advancedOptionsShow=!1;this.advancedOptionsTemplates=$("."+this.settings.CssClasses.Advanced.Templates);this.courseType=$(this.settings.ControlIds.CourseType);this.courseTemplateHolder=$("."+this.settings.CssClasses.Advanced.TemplatesHolder);this.courseTemplateLink=$("."+this.settings.CssClasses.Advanced.TemplateLink);this.courseTemplatesIframe=$("."+this.settings.CssClasses.Advanced.TemplatesIframe);this.radioButtonLabel=$("."+this.settings.CssClasses.RadioButtonLabel);this.modalMask=$("."+
this.settings.CssClasses.ModalMask);this.setupControls();this.setupControlsEvents()}d.prototype.setupControls=function(){this.courseTemplateHolder.hide();this.changeColor();this.scrollable.perfectScrollbar({suppressScrollX:!0});this.titleInput.focus();this.advancedOptionsTemplates.hide()};d.prototype.setupControlsEvents=function(){var a=this;this.courseTemplatesIframe.load(function(){a.advancedOptionsTemplates.is(":visible")?(a.scrollable.scrollTop(1E3).perfectScrollbar("update"),a.courseTemplatesIframe.contents().find("#"+
a.settings.ControlIds.TemplateSearchTextBox).focus()):a.titleInput.focus()});this.advancedOptionsToggler.on("click touch",function(b){a.advancedOptionsShow=!a.advancedOptionsShow;a.advancedOptionsToggler.toggleClass(a.settings.CssClasses.Advanced.TogglerOpen);a.buttons.toggleClass(a.settings.CssClasses.ButtonsShadow);a.advancedOptionsContent.toggle();a.advancedOptionsToggler.text(a.advancedOptionsShow?a.advancedOptionsLanguage.hide:a.advancedOptionsLanguage.show);a.scrollable.animate({scrollTop:a.advancedOptionsShow?
a.advancedOptionsToggler.offset().top:0},250);b.preventDefault();return!1});this.colorPickerHover.change(function(){a.changeColor()});this.courseType.change(function(){var b=a.courseType.get();a.advancedOptionsTemplates.hide();a.courseTemplateHolder.hide();1>=b.length||(b[0].checked?($("."+a.settings.CssClasses.TemplateId).val("null"),$("."+a.settings.CssClasses.TemplateType).val("0"),a.scrollable.perfectScrollbar("update")):(a.courseTemplatesIframe.attr("src",b[1].checked?a.settings.Urls.FindCourseTemplates:
a.settings.Urls.FindPlannerTemplates),a.fecthTemplates(),a.scrollable.scrollTop(1E3).perfectScrollbar("update"),a.courseTemplatesIframe.contents().find("#"+a.settings.ControlIds.TemplateSearchTextBox).focus()),a.buttonSubmit.trigger("buttonSubmitDisable"))});this.titleInput.on("input",function(){var b=0===a.titleInput.val().trim().length;a.titleError.css({display:b?"block":"none"});a.titleError.next().css({"margin-top":b?"0px":"","margin-bottom":b?"0px":""});a.buttonSubmit.trigger("buttonSubmitDisable")});
this.buttonSubmit.on("buttonSubmitDisable",function(){var b=a.isTitleEmpty()||!a.isCourseTypeRegular()&&!a.isTemplateSelected();a.buttonSubmit.prop("disabled",b)});this.buttonCancel.on("keydown",function(b){if(b.keyCode===CCL.CommonConstants.keyCodes.tab)return a.titleInput.focus(),b.preventDefault(),!1});this.radioButtonLabel.on("keydown",function(a){if(a.keyCode===CCL.CommonConstants.keyCodes.enter)return $(a.target).click(),a.preventDefault(),!1});this.buttonCancel.on("click touch",function(){a.addCourseWindow.remove();
a.modalMask.remove()});this.modalMask.on("click touch",function(){a.addCourseWindow.remove();a.modalMask.remove()});this.courseTemplateHolder.on("click touch","."+this.settings.CssClasses.Advanced.TemplateLink,function(){a.courseTemplateHolder.hide();a.fecthTemplates()});this.addCourseWindow.on("invalid-form.validate","form",function(){var a=$(this).find('input[type="submit"]');setTimeout(function(){a.removeAttr("disabled")},1)});this.addCourseForm.on("submit",function(b){for(var c={},g=0,d=$(a.addCourseForm).serializeArray();g<
d.length;g++){var e=d[g],f=e.name;c.hasOwnProperty(f)||(c[f]=e.value)}CCL.CommonFunctions.safeAjaxPost({url:a.settings.Urls.CreateCourse,data:c}).done(function(a){window.location.href=a});b.preventDefault()});this.addCourseWindow.on("submit","form",function(a){var b=$(this).find('input[type="submit"]');setTimeout(function(){b.attr("disabled","disabled")},0)})};d.prototype.isTitleEmpty=function(){return 0===this.titleInput.val().trim().length};d.prototype.isCourseTypeRegular=function(){return this.courseType.get()[0].checked};
d.prototype.isTemplateSelected=function(){return 0<$("."+this.settings.CssClasses.TemplateId).val().length};d.prototype.changeColor=function(){this.currentColor&&this.courseIcon.removeClass(this.currentColor);this.currentColor=this.colorPickerHover[0].classList[0];this.courseIcon.addClass(this.currentColor)};d.prototype.fecthTemplates=function(){var a=this;window.parent.selectCourseTemplate=function(b,c){void 0===c&&(c=!1);c=c?a.settings.TemplateFromPlanner:a.settings.TemplateFromCourse;$("."+a.settings.CssClasses.TemplateId).val(b.toString());
$("."+a.settings.CssClasses.TemplateType).val(c.toString());a.advancedOptionsTemplates.hide();a.buttonSubmit.trigger("buttonSubmitDisable");CCL.CommonFunctions.safeAjaxPost({url:a.settings.Urls.SetTemplate,cache:!1,data:{templateId:b,templateType:c}}).done(function(b){a.courseTemplateHolder.html(b);a.courseTemplateHolder.show();a.scrollable.perfectScrollbar("update")});delete window.parent.selectCourseTemplate};this.advancedOptionsTemplates.show()};return d}();e.AddCourse=f})(f.Courses||(f.Courses=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;e.enrolInCoursesInstance=this;this.coursesTableSelector=a.CoursesTableSelector;this.checkboxColumnSelector=a.CheckboxColumnSelector;this.alertMessageText=a.AlertMessageText;$(a.ToolbarSelector+" a").click(function(a){return b.checkBeforeEnrolWithdraw(a)})}d.prototype.isAnyCourseSelected=function(){return 0<$(this.coursesTableSelector+" "+this.checkboxColumnSelector+" input:checked").length};d.prototype.checkBeforeEnrolWithdraw=function(a){if(!this.isAnyCourseSelected())return a.preventDefault(),
jAlert(this.alertMessageText),!1};return d}();e.EnrolInCourses=f})(f.Courses||(f.Courses={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.isTopicSelected=function(){return parseInt(c.topicPickerInstance.getSelectedItem().id,10)>c.settings.NotChosenOptionValue};this.settings=a;this.controls=b;$(function(){c.controls.ShowInPlannerCheckbox.change(function(){var a=c.controls.ShowInPlannerCheckbox.is(":checked");a||(c.topicPickerInstance.closeMenu(),c.planPickerInstance.closeMenu());c.controls.TopicPlanPanel.toggle(a)});c.settings.UseTopics&&(c.planPickerInstance.toggleEnabled(c.isTopicSelected()&&
c.controls.ShowInPlannerCheckbox.is(":enabled")),c.topicPickerInstance.onchange(function(){c.planPickerInstance.toggleEnabled(!1);c.isTopicSelected()||!c.planPickerInstance.hasAnyItems()?(c.topicPickerInstance.toggleEnabled(!1),c.controls.PlanPicker.hide(),c.controls.NoPlansLabel.hide(),c.controls.Loader.show(),$.ajax({type:"GET",url:c.settings.Actions.GetPlansForCourseAndTopic,data:{courseId:c.settings.CourseId,topicId:c.topicPickerInstance.getSelectedItem().id,selectPlanLabel:c.settings.Resources.SelectPlan}}).always(function(){c.controls.Loader.hide();
c.planPickerInstance.toggleEnabled(c.isTopicSelected());c.topicPickerInstance.toggleEnabled(!0)}).done(function(a){var b=1<a.length||!c.isTopicSelected();c.planPickerInstance.loadMenu(a);c.planPickerInstance.selectItem(2===a.length?a[1].id:c.settings.NotChosenOptionValue);c.controls.PlanPicker.toggle(b);c.controls.NoPlansLabel.toggle(!b);c.planPickerInstance.resizeComponent()})):(c.planPickerInstance.selectItem(c.settings.NotChosenOptionValue),c.controls.PlanPicker.show(),c.controls.NoPlansLabel.hide(),
c.planPickerInstance.resizeComponent())}))})}Object.defineProperty(d.prototype,"topicPickerInstance",{get:function(){return"undefined"===typeof this.topicPickerInstanceValue?this.topicPickerInstanceValue=window[this.settings.ClientInstanceNames.Topic]:this.topicPickerInstanceValue},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"planPickerInstance",{get:function(){return"undefined"===typeof this.planPickerInstanceValue?this.planPickerInstanceValue=window[this.settings.ClientInstanceNames.Plan]:
this.planPickerInstanceValue},enumerable:!0,configurable:!0});return d}();e.ElementPlanPicker=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=e.CalendarControllerModels.EventType,a=function(){function a(a){this.utility=a}a.prototype.parseEventType=function(a){if(this.hasEventTypePrefix(this.coursePrefix,a)){var b=d.Course;a=parseInt(a.substring(this.coursePrefix.length),10)}else this.hasEventTypePrefix(this.projectPrefix,a)?(b=d.Project,a=parseInt(a.substring(this.projectPrefix.length),10)):(b=d.Person,a=0);return{eventType:b,locationId:a}};a.prototype.parseCourseId=function(a){var b=this.parseEventType(a);
if(b.eventType!==d.Course)throw Error("Invalid location: expected course, got "+a);return b.locationId};a.prototype.hasEventTypePrefix=function(a,b){return b&&b.startsWith(a)&&b.length>a.length};Object.defineProperty(a.prototype,"coursePrefix",{get:function(){return this.utility.settings.locationPrefixes.courseValuePrefix},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"projectPrefix",{get:function(){return this.utility.settings.locationPrefixes.projectValuePrefix},enumerable:!0,
configurable:!0});return a}();f.EventTypeParser=a})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){var a=this;this.findSectionOrMeasurement=function(b,c){$.getJSON(a.settings.FindSectionOrMeasurementUrl,{search:b.term},function(a){c($.map(a,function(a){return{value:a.Name,isMeasurement:a.IsMeasurement,id:a.Id}}))})};this.renderSearchBoxItem=function(a,c){return $("<li/>").append("<span "+(c.isMeasurement?"":"class='h-fnt-bd'")+">"+c.value+"</span>").appendTo(a)};this.selectSearchBoxItem=function(b,c){a.searchKpiContent(c.item.value,
c.item.id)};this.searchKpiContent=function(b,c){window.location.search="?"+a.settings.SearchStringParamName+"="+b+"&"+a.settings.SearchValueParamName+"="+(c?c:"")};e.measureFilterInstance=this;this.settings=d;this.settings.Controls.SearchBoxContainer.on(this.settings.TextSearchEvent,function(b,c){return a.searchKpiContent(c,null)})}}();e.MeasureFilter=f})(f.FeatureAdoption||(f.FeatureAdoption={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e;(function(d){d[d.Initial=0]="Initial";d[d.Started=1]="Started";d[d.StoppingInProcess=2]="StoppingInProcess";d[d.Stopped=3]="Stopped";d[d.Preview=4]="Preview";d[d.Paused=5]="Paused";d[d.Delete=6]="Delete";d[d.Upload=7]="Upload"})(e||(e={}));var k=function(){function d(a,b){this.timeout=0;this.updateProgressEvent=null;this.currentRecordDuration=0;this.currentState=e.Initial;window[a]=this;this.settings=b;this.eventNames=b.EventNames;this.initialize()}d.prototype.initialize=function(){var a=
this;this.$mainPanel=$("#"+this.settings.MainPanelClientId);this.$startRecordingButton=$("#"+this.settings.StartResumeButtonClientId);this.$stopRecordingButton=$("#"+this.settings.StopButtonClientId);this.$stopRecordingButton.hide();this.$currentTimeLabel=$("#"+this.settings.CurrentTimeLabelClientId);this.$playPausePreviewButton=$("#"+this.settings.PlayRecordButtonClientId);this.$recordingLight=$("#"+this.settings.RecordingLightClientId);this.$progressBar=$("#"+this.settings.ProgressBarClientId);
this.isPreviewSessionStarted=!1;this.recorder=window[this.settings.RecorderClientInstanceName];this.timeout=this.settings.ShouldRecordVideo?this.settings.MaxSecondsVideo:this.settings.MaxSecondsAudio;$(document).on(this.eventNames.RecordingStoppedEventName,function(){if(a.currentState===e.Delete)a.onDeleteRecord();else a.currentState!==e.Initial&&a.currentState!==e.Started&&a.getRecorder().preparePreview()});$(document).on(this.eventNames.PreviewPreparedEventName,function(){a.currentRecordDuration=
a.getRecorder().getDuration();a.currentState!==e.Initial&&a.currentState!==e.Started&&(a.setProgress(0,a.currentRecordDuration,!1),a.getRecorder().supportsSeek()&&(a.$progressBar.on("click",function(b){a.seekInPlayback(b)}),a.$progressBar.css("cursor","pointer")),a.currentState===e.Upload?(a.updateControls(e.Stopped),$(document).trigger(a.eventNames.UploadPreparedEventName)):a.setState(e.Stopped))});$(document).on(this.eventNames.PreviewPreparedFailedEventName,function(){a.onDeleteRecord()});$(document).on(this.eventNames.RecordingPlaybackEndedEventName,
function(){clearTimeout(a.updateProgressEvent);a.setProgress(a.currentRecordDuration,a.currentRecordDuration,!1);a.setState(e.Stopped);a.isPreviewSessionStarted=!1});$(document).on(this.eventNames.HasUserMediaAccessEventName,function(){$(document).trigger(a.eventNames.RecordingStartedEventName);clearTimeout(a.updateProgressEvent);a.updateProgressEvent=setInterval(function(){a.updateProgress(a.timeout,!0)},100);a.setState(e.Started)});$(document).on(this.eventNames.RecordingInteruptedEventName,function(){a.onDeleteRecord();
a.closeRecordingSession()});$(document).on(this.eventNames.SwitchToAudioRecorderEventName,function(){a.settings.ShouldRecordVideo=!1;a.timeout=a.settings.MaxSecondsAudio;a.setProgress(0,a.timeout,!0);a.$mainPanel.removeClass(a.settings.CssMainContainerVideo);a.$mainPanel.addClass(a.settings.CssMainContainerAudio)});$(document).on(this.eventNames.UpdateMaximumRecordingLength,function(b,c){a.timeout=Math.min(c,a.settings.ShouldRecordVideo?a.settings.MaxSecondsVideo:a.settings.MaxSecondsAudio);a.setProgress(0,
a.timeout,!0)});this.setProgress(0,this.timeout,!0);this.setState(e.Initial)};d.prototype.startRecording=function(){var a=this.getRecorder();a&&this.currentState!==e.Started&&a.startRecording()};d.prototype.stopRecording=function(){this.stopRecorderAndUpdateState(e.StoppingInProcess)};d.prototype.deleteRecording=function(){if(this.getRecorder())if(this.currentState===e.Started)this.stopRecorderAndUpdateState(e.Delete);else this.onDeleteRecord()};d.prototype.onDeleteRecord=function(){clearTimeout(this.updateProgressEvent);
var a=this.getRecorder();a&&(this.currentRecordDuration=0,this.setProgress(0,this.timeout,!1),$(document).trigger(this.eventNames.RecordingDeletedEventName),a.deleteRecord(),this.setState(e.Initial))};d.prototype.stopRecorderAndUpdateState=function(a){var b=this.getRecorder();b&&this.currentState===e.Started&&(clearTimeout(this.updateProgressEvent),this.setState(a),b.stopRecording())};d.prototype.closeRecordingSession=function(){try{var a=this.getRecorder();a&&(clearTimeout(this.updateProgressEvent),
a.closeRecordingSession())}catch(b){}};d.prototype.previewRecording=function(){var a=this;this.getRecorder().previewRecord();clearTimeout(this.updateProgressEvent);this.updateProgressEvent=setInterval(function(){a.updateProgress(a.currentRecordDuration,!1)},100);this.isPreviewSessionStarted=!0;this.setState(e.Preview)};d.prototype.pauseResumePreview=function(a){var b=this.getRecorder();b&&(b.pauseResumePreview(a),this.setState(a?e.Paused:e.Preview))};d.prototype.prepareUpload=function(){this.currentState===
e.Started?(this.updateControls(e.StoppingInProcess),this.stopRecorderAndUpdateState(e.Upload)):(this.currentState===e.Preview&&this.pauseResumePreview(!0),$(document).trigger(this.eventNames.UploadPreparedEventName))};d.prototype.uploadRecord=function(a){var b=this.getRecorder();b&&b.uploadRecord(this.settings.UploadProxyUrl,a)};d.prototype.seekInPlayback=function(a){var b=$(a.currentTarget),c=b.offset();a=this.currentRecordDuration*(a.pageX-c.left)/b.width();this.getRecorder().seek(a);this.currentState===
e.Stopped&&this.updateProgress(this.currentRecordDuration,!1)};d.prototype.getRecorder=function(){this.recorder||(this.recorder=window[this.settings.RecorderClientInstanceName]);return this.recorder};d.prototype.setState=function(a){this.currentState=a;this.updateControls(a)};d.prototype.updateControls=function(a){var b=this;switch(a){case e.Initial:this.$stopRecordingButton.removeClass(this.settings.CssStateStopping).hide();this.$startRecordingButton.show();this.$playPausePreviewButton.hide();this.$progressBar.off("click");
this.$progressBar.css("cursor","default");this.$recordingLight.hide();clearTimeout(this.updateProgressEvent);break;case e.Started:this.$stopRecordingButton.on("click",function(){b.stopRecording()});this.$stopRecordingButton.show();this.$startRecordingButton.hide();this.$recordingLight.show().css("display","inline-block");break;case e.Delete:case e.StoppingInProcess:this.$mainPanel.removeClass(this.settings.CssStatePlaying);this.$stopRecordingButton.addClass(this.settings.CssStateStopping);this.$stopRecordingButton.off("click");
this.$recordingLight.hide();break;case e.Stopped:this.$mainPanel.removeClass(this.settings.CssStatePlaying);this.$stopRecordingButton.removeClass(this.settings.CssStateStopping);this.$stopRecordingButton.hide();this.$playPausePreviewButton.show();this.$playPausePreviewButton.attr("title",this.settings.PlayPreviewButtonTooltip);this.$playPausePreviewButton.off("click");this.$playPausePreviewButton.on("click",function(){b.previewRecording()});break;case e.Preview:this.$mainPanel.addClass(this.settings.CssStatePlaying);
this.$playPausePreviewButton.attr("title",this.settings.PausePreviewButtonTooltip);this.$playPausePreviewButton.off("click");this.$playPausePreviewButton.on("click",function(){b.pauseResumePreview(!0)});break;case e.Paused:this.$mainPanel.removeClass(this.settings.CssStatePlaying),this.$playPausePreviewButton.attr("title",this.settings.PlayPreviewButtonTooltip),this.$playPausePreviewButton.off("click"),this.$playPausePreviewButton.on("click",function(){b.pauseResumePreview(!1)})}};d.prototype.updateProgress=
function(a,b){var c=this.getRecorder();c&&(c=c.getCurrentTime())&&this.setProgress(c,a,b)};d.prototype.setProgress=function(a,b,c){c?0>=Math.floor(10*(b-a))?(a=this.convertTime(b),this.stopRecorderAndUpdateState(e.StoppingInProcess)):a=this.convertTime(a):(this.updateProgressBar(a,b),a=this.convertTime(a));a+=" / "+this.convertTime(b);this.$currentTimeLabel.text(a)};d.prototype.convertTime=function(a){a=Math.round(a);var b=Math.floor(a/60);a=Math.floor(a-60*b);return(10<=b?"":"0")+b+":"+((10<=a?"":
"0")+a)};d.prototype.updateProgressBar=function(a,b){var c=$("."+this.settings.CssPlayBar);c&&c.width(100*a/b+"%")};return d}();f.MediaRecorderControl=k})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e=function(){function e(d,a){this.flashId="FlashRecorder";window[d]=this;this.settings=a;this.eventNames=a.EventNames;this.name=d;this.initialize()}e.prototype.initialize=function(){var d={quality:"high",bgcolor:"#ffffff",allowscriptaccess:"always",allowfullscreen:"true",wmode:"transparent"},a={id:this.flashId,name:"FlashRecorder",align:"middle",wmode:"transparent"};this.settings.RequestMediaResourcesOnLoad&&(swfobject.embedSWF("flash/FlashRecorder.swf","flashContent",545,220,"11.4.0",
"playerProductInstall.swf",{},d,a,this.flashReady(this)),swfobject.createCSS("#flashContent","display:block;text-align:left;"))};e.prototype.startRecording=function(){this.flash.startRecording()};e.prototype.stopRecording=function(){this.flash.stopRecording(this.eventNames.RecordingStoppedEventName)};e.prototype.preparePreview=function(){raiseEvent(this.eventNames.PreviewPreparedEventName,"","")};e.prototype.pauseResumePreview=function(d){this.flash.pauseResumePlayback(d)};e.prototype.getCurrentTime=
function(){return this.flash.getCurrentTime()};e.prototype.getDuration=function(){return this.flash.getDuration()};e.prototype.previewRecord=function(){this.flash.previewRecord()};e.prototype.deleteRecord=function(){this.flash.resetRecording()};e.prototype.uploadRecord=function(d,a){this.flash.saveRecording(a,d)};e.prototype.flashReady=function(d){var a=this;setTimeout(function(){d.flash=document.getElementById(d.flashId);if(d.flash){var b=$(d.flash).parent().width(),c=$(d.flash).parent().height();
$(d.flash).width(b).height(c);window.top.onresize=function(){var a=$(d.flash).parent().width();$(d.flash).width(a).height(c)};d.flash.init(d.flashId,b,c,d.settings.ShouldRecordVideo,a.eventNames.HasUserMediaAccessEventName,a.eventNames.RecordingPlaybackEndedEventName,a.eventNames.RecordingUploadCompletedEventName,a.name,a.settings.ShouldRecordVideo?a.settings.MaxSecondsVideo:a.settings.MaxSecondsAudio)}else $("."+a.settings.RecorderControlsClassName).hide()},750)};e.prototype.closeRecordingSession=
function(){this.flash.closeRecordingSession()};e.prototype.seek=function(d){this.flash.seek(d)};e.prototype.supportsSeek=function(){return!0};e.prototype.showAccessDenied=function(){window.top.jAlert?window.top.jAlert(this.settings.AccessDeniedErrorMessage,"",null):jAlert(this.settings.AccessDeniedErrorMessage,"",null)};e.prototype.confirmSwitchToAudio=function(){var d=this;this.showConfirmAudioSwitch(this.settings.ChangeToAudioRecorderMessage,function(a){a?(d.settings.ShouldRecordVideo=!1,d.flash.switchToAudio(),
$(document).trigger(d.eventNames.SwitchToAudioRecorderEventName)):$(document).trigger(d.eventNames.SwitchToUploadTabEventName)})};e.prototype.showConfirmAudioSwitch=function(d,a){var b=this.settings.UploadFileButtonText.replace(/(["])/g,"&quot;");window.top.jConfirm?(window.top.$.alerts.cancelButton=b,window.top.jConfirm(d,"",a)):($.alerts.cancelButton=b,jConfirm(d,"",a))};e.prototype.updateMaximumRecordingLength=function(d){$(document).trigger(this.eventNames.UpdateMaximumRecordingLength,d)};return e}();
f.FlashRecorder=e})(ItslearningWeb||(ItslearningWeb={}));function raiseEvent(f,e,k){$(document).trigger(f,[e,k])}function resizeAudioPlayer(f){$("#"+f).width(1).height(1)}function showAccessDenied(f){window[f].showAccessDenied()}function confirmSwitchToAudio(f){window[f].confirmSwitchToAudio()}function updateMaximumRecordingLength(f,e){window[f].updateMaximumRecordingLength(e)}
(function(f){(function(e){(function(e){e[e.SingleFile=1]="SingleFile";e[e.MultipleFiles=2]="MultipleFiles";e[e.MultipleFilesAndFolders=3]="MultipleFilesAndFolders"})(e.UploadType||(e.UploadType={}));(function(e){e[e.Pending=1]="Pending";e[e.InProgress=2]="InProgress";e[e.Success=3]="Success";e[e.Error=4]="Error";e[e.PartialSuccess=5]="PartialSuccess"})(e.UploadStatus||(e.UploadStatus={}))})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,a,b){var c=this;this.settings=d;this.summaryParser=a;this.feedbackManager=b;this.handleInitialUploadSummary=function(a){a.IsProcessingInProgress?(c.feedbackManager.showInformationFeedback(c.settings.uploadInProgressMessage),c.wasPollingStarted=!0,c.checkStatusAfterInterval()):c.handleUploadsFinished(a)};this.checkStatusAfterInterval=function(){setTimeout(c.checkUploadStatus,c.settings.pollingIntervalInMilliseconds)};this.checkUploadStatus=
function(){$.getJSON(c.settings.statusServiceUrl,{folderId:c.settings.folderId}).then(c.handleSubsequentUploadSummary).fail(c.handleErrorResponse)};this.handleSubsequentUploadSummary=function(a){a.IsProcessingInProgress?c.checkStatusAfterInterval():c.handleUploadsFinished(a)};this.handleUploadsFinished=function(a){c.feedbackManager.hideInformationFeedback();c.summaryParser.isThereOnlyOneSingleFileUpload(a)?c.handleOneSingleFileUploadFinished(a):c.summaryParser.areThereAnyUploadsToHandle(a)&&c.handleManyFileUploadsFinished(a)};
this.handleOneSingleFileUploadFinished=function(a){c.summaryParser.areAllUploadsFinishedWithSuccess(a)?(a=c.summaryParser.getFileNamesForSingleFileUploads(a)[0],a=CCL.CommonFunctions.htmlEncode(a),a=c.settings.singleFileXUploadSuccessMessage.replace("{0}","<strong>"+a+"</strong>"),c.feedbackManager.showInformationFeedback(a),c.refreshTreeMenuIfNeeded()):c.feedbackManager.showErrorFeedback(c.settings.singleFileUploadErrorMessage)};this.handleManyFileUploadsFinished=function(a){c.summaryParser.areAllUploadsFinishedWithSuccess(a)?
c.displayMessageWithRefreshInstructionsIfNeeded(c.settings.multipleFileUploadSuccessMessage):c.summaryParser.areUploadsFinishedWithPartialSuccess(a)?c.displayMessageWithRefreshInstructionsIfNeeded(c.settings.partialSuccessMessage):c.feedbackManager.showErrorFeedback(c.settings.multipleFileUploadErrorMessage)};this.displayMessageWithRefreshInstructionsIfNeeded=function(a){c.shouldDisplayRefreshButton()?c.feedbackManager.showInformationFeedback("<strong>"+a+"</strong> "+c.settings.pleaseRefreshThePageToSeeThemMessage,
c.refreshElementsList):(c.refreshTreeMenuIfNeeded(),c.feedbackManager.showInformationFeedback(a))};this.shouldDisplayRefreshButton=function(){return c.wasPollingStarted};this.handleErrorResponse=function(a){401===a.status?c.redirectToLogOutPage():c.checkStatusAfterInterval()};this.redirectToLogOutPage=function(){window.top.location.replace(c.settings.logOutPageUrl)};this.refreshElementsList=function(){c.refreshTreeMenuIfNeeded();c.refreshWindow()};this.refreshTreeMenuIfNeeded=function(){if(c.settings.isTreeMenuRendered){var a=
new CCL.CommonWindowMessages.GenericMessage(c.settings.refreshTreeMenuPostMessageName);CCL.CommonFunctions.makePostMessageCall(window.parent,a)}};this.refreshWindow=function(){location.reload()};a.areThereAnyUploadsToHandle(d.initialSummary)&&this.handleInitialUploadSummary(d.initialSummary)}}();e.UploadStatusChecker=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,a,b){var c=this;this.refreshButtonText=b;this.showInformationFeedback=function(a,b){var g={disableAutomaticHiding:!0};b&&(g.extraButtonName=c.refreshButtonText,g.extraButtonCallback=b);CCL.InformationFeedback.showFeedback(c.informationFeedbackContainer,a,g)};this.showErrorFeedback=function(a){CCL.CommonFunctions.isMobileDevice()?CCL.ErrorFeedback.showFeedback(c.errorFeedbackContainer,a,function(){}):(c.hideBottomNavigationBar(),CCL.ErrorFeedback.showFeedback(c.errorFeedbackContainer,
a,c.showBottomNavigationBar))};this.hideInformationFeedback=function(){CCL.InformationFeedback.hideFeedback(c.informationFeedbackContainer)};this.showBottomNavigationBar=function(){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.showBottomNavigationBar))};this.hideBottomNavigationBar=function(){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.hideBottomNavigationBar))};
this.informationFeedbackContainer=$("#"+d);this.errorFeedbackContainer=$("#"+a);if(!CCL.CommonFunctions.isMobileDevice())$(window).on("beforeunload",function(){c.showBottomNavigationBar()})}}();e.UploadStatusFeedbackManager=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){var d=this;this.areThereAnyUploadsToHandle=function(a){return a&&(a.IsProcessingInProgress||a.UploadInfos&&0<a.UploadInfos.length)};this.isThereOnlyOneSingleFileUpload=function(a){return a&&a.UploadInfos&&1===a.UploadInfos.length&&a.UploadInfos[0].UploadType===e.UploadType.SingleFile};this.areAllUploadsFinishedWithSuccess=function(a){return a&&a.UploadInfos&&0<a.UploadInfos.length&&a.UploadInfos.every(function(a){return a.Status===e.UploadStatus.Success})};
this.areUploadsFinishedWithPartialSuccess=function(a){return a&&a.UploadInfos&&(a.UploadInfos.some(function(a){return a.Status===e.UploadStatus.PartialSuccess})||a.UploadInfos.some(function(a){return a.Status===e.UploadStatus.Success})&&a.UploadInfos.some(function(a){return a.Status===e.UploadStatus.Error}))};this.getFileNamesForSingleFileUploads=function(a){return a&&a.UploadInfos?a.UploadInfos.filter(function(a){return a.UploadType===e.UploadType.SingleFile}).map(d.getSingleFileUploadFileName):
[]};this.getSingleFileUploadFileName=function(a){return a.Details&&a.Details.Name?a.Details.Name:""}}}();e.UploadSummaryParser=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a){this.settings=a;this.elementLinkDialogManagerInstance=f.ElementLinkDialog.elementLinkDialogManagerInstance;e.learningObjectiveStateRepositoryManagerInstance=this;this.hasAnyChanges=!1}d.prototype.openDialog=function(a,b){var c=this,g=[];b={elementStates:e.LearningObjectiveRepositoryHelper.convertElementIdsToElementStateMapping(b,f.CheckboxStateMachine.State.AttachedByUser),disabledElementIds:b,showAll:!0,header:this.settings.Terms.Header,elementType:f.ElementLinkDialog.ContentElementType.LearningObjectives,
allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.None,afterOkClickCallback:function(b){b&&(b.forEach(function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.Saved||g.push(b)}),0<g.length&&(c.hasAnyChanges=!0,c.connectElementsToState(g,a)))},afterCloseDialogCallback:function(){c.hasAnyChanges&&setTimeout(function(){location.reload()},100)}};this.elementLinkDialogManagerInstance.openDialog(b,{countryCode:this.settings.CountryCode})};
d.prototype.deleteLearningObjectivesFromState=function(a,b){$.ajax({type:"DELETE",url:this.settings.Urls.DeleteLearningObjectivesFromState,data:{learningObjectiveId:a,stateId:b},dataType:"html"}).done(function(){location.reload()})};d.prototype.connectElementsToState=function(a,b){$.ajax({type:"PUT",url:this.settings.Urls.AddLearningObjectivesToState,data:{learningObjectiveIds:a,stateId:b},dataType:"html"}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};return d}();e.LearningObjectiveStateRepositoryManager=
k})(f.LearningObjectiveRepository||(f.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.dialogSelfClickHandler=function(a){a.stopPropagation();b.contextDialog.isOpened()&&window.setTimeout(function(){b.contextDialog.closeDialog()},100)};this.contextDialogControlId="#"+a.ContextDialogControlId;this.alignmentReportItemSelector=$(a.ReportItemSelector);this.contextDialogActivatorSelector=$(a.ContextDialogActivatorSelector);this.activeItemClassName=a.ActiveItemClassName;this.contextDialogContentContainerSelector=a.ContextDialogContentContainerSelector;
this.filterContainer=$(a.FilterContainerSelector);this.filterDataAttributeSuffix=a.FilterDataAttributeSuffix;this.itemsContainer=$(a.ItemsContainerSelector);this.measureViewAlignedUrl=a.MeasureViewAlignedUrl;this.measureViewNotAlignedUrl=a.MeasureViewNotAlignedUrl;this.measureViewAttachedDataUrl=a.MeasureViewAttachedDataUrl;this.initContextDialog();this.initReportItem();this.initFilter()}d.prototype.openContextDialog=function(a){this.contextDialog.isOpened()&&this.contextDialog.closeDialog();this.contextDialog.openDialogAt(a.x,
a.y)};d.prototype.initReportItem=function(){var a=this;this.contextDialogActivatorSelector.on("click",function(b){var c=$(b.currentTarget);c.addClass(a.activeItemClassName);var g=c.find(a.contextDialogContentContainerSelector).html();a.contextDialog.setContent(g);c=c.position();a.openContextDialog({x:c.left,y:c.top});a.contextDialog.setBeforeCloseDialog(function(){$(b.currentTarget).removeClass(a.activeItemClassName)});$.ajax(a.measureViewAttachedDataUrl)})};d.prototype.initContextDialog=function(){var a=
this;this.contextDialog=new ContextDialog(this.contextDialogControlId,{showHeader:!1,blackThemeActivated:!1,showCloseLink:!0,width:"404px",scrollToLastWindowOnClose:!1,useMobileViewIfNeeded:!0,marginTop:35,marginLeft:-2,marginRight:0,marginBottom:0,cssClass:"itsl-lo-alignment-report-context-dialog"});$(document).on({"contextdialog:show":function(){window.setTimeout(function(){a.contextDialog.mainContainer.on("click",a.dialogSelfClickHandler)},100)},"contextdialog:close":function(){a.contextDialog.mainContainer.off("click",
a.dialogSelfClickHandler)}})};d.prototype.initFilter=function(){var a=this,b=this.filterContainer.find("a[data-"+this.filterDataAttributeSuffix+"]"),c=b.map(function(b,c){return $(c).data(a.filterDataAttributeSuffix)}).get().join(" ");b.click(function(g){g=$(g.target);b.removeClass(a.activeItemClassName);g.addClass(a.activeItemClassName);g=g.data(a.filterDataAttributeSuffix);a.itemsContainer.removeClass(c).addClass(g);"filter-aligned"===g?$.ajax(a.measureViewAlignedUrl):"filter-not-aligned"===g&&
$.ajax(a.measureViewNotAlignedUrl)})};return d}();e.AlignmentReport=f})(f.LearningObjective||(f.LearningObjective={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this._settings=a;this._parameters=a.ParametersNames}d.prototype.browseLibrary=function(a){var b=CCL.CommonFunctions.setQueryStringParameter(this._settings.BrowseLibraryUrl,this._parameters.CourseId,a.CourseId||this._settings.CourseId);a.RelatedEntityId&&(b=CCL.CommonFunctions.setQueryStringParameter(b,this._parameters.RelatedEntityId,a.RelatedEntityId));a.ElementCategory&&(b=CCL.CommonFunctions.setQueryStringParameter(b,this._parameters.ElementType,
a.ElementCategory));a.CustomId&&(b=CCL.CommonFunctions.setQueryStringParameter(b,this._parameters.CustomId,a.CustomId));a.LearningObjectivesIds&&0<a.LearningObjectivesIds.length&&(b=CCL.CommonFunctions.setQueryStringParameter(b,this._parameters.LearningObjectiveId,a.LearningObjectivesIds.join(",")));a.FolderId&&(b=CCL.CommonFunctions.setQueryStringParameter(b,this._parameters.FolderId,a.FolderId));this.browserDialog.setIframeUrl(b,!0);this.browserDialog.openDialog()};d.prototype.setDialogCustomScripts=
function(a){this.browserDialog.setCustomScripts(a)};Object.defineProperty(d.prototype,"browserDialog",{get:function(){return window[this._settings.ModalId]},enumerable:!0,configurable:!0});return d}();e.LibraryBrowser=f})(f.Library||(f.Library={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.settings=a;this.iframeHolders=$();this.loadEmbedContentDebouncer=new CCL.CallbackDebouncer(function(){return b.loadEmbedContentAsync()});this.loadEmbedContentTimeoutInMilliseconds=300;this.embedConsideredVisibleRatio=.2;this.loadEmbedContentAftercallTimes=5;this.embedIframeShowAnimationSpeedInMilliseconds=500;$(window).on(this.settings.isIosDevice?"touchmove":"scroll",function(){return b.loadEmbedContentDebouncer.invokeCallback(0,
b.loadEmbedContentTimeoutInMilliseconds)})}d.prototype.loadEmbedContentAsync=function(a){var b=this;void 0===a&&(a=-1);var c=this.getPendingIframeHolder();if(c){var g=this.createAjaxLoader();-1<a&&g.height(a);var d=this.createIframe(this.getEmbedIframeUrl(c),!1);this.findClosestEmbedBox(c).append(g);c.append(d);d.one("load",function(){d.fadeIn(b.embedIframeShowAnimationSpeedInMilliseconds);b.loadEmbedContentAftercallIterationNumber=1;b.loadEmbedContentDebouncer.invokeCallback(0,b.loadEmbedContentTimeoutInMilliseconds)})}else 0<
this.loadEmbedContentAftercallIterationNumber&&(this.loadEmbedContentDebouncer.invokeCallback(0,this.loadEmbedContentAftercallIterationNumber*this.loadEmbedContentTimeoutInMilliseconds),this.loadEmbedContentAftercallIterationNumber+=1,this.loadEmbedContentAftercallIterationNumber>this.loadEmbedContentAftercallTimes&&(this.loadEmbedContentAftercallIterationNumber=0))};d.prototype.findIframeHolders=function(a){return a.find("[data-"+this.settings.dataAttributes.embedIframeUrl+"]")};d.prototype.appendIframeHolders=
function(a){this.iframeHolders=this.iframeHolders.add(this.findIframeHolders(a))};d.prototype.getEmbedIframeUrl=function(a){return a.data(this.settings.dataAttributes.embedIframeUrl)};d.prototype.createAjaxLoader=function(){return $("<div class='"+this.settings.cssClasses.ajaxLoader+"'></div>")};d.prototype.findAjaxLoader=function(a){return a.find("."+this.settings.cssClasses.ajaxLoader)};d.prototype.createIframe=function(a,b){return $("<iframe src='"+a+"' width='100%' height='100%' scrolling='no' class='"+
this.settings.cssClasses.noBorder+"' allowfullscreen "+(b?"":"style='display:none'")+"></iframe>")};d.prototype.removeAjaxLoader=function(a){a.find("."+this.settings.cssClasses.ajaxLoader).remove()};d.prototype.isEmbedInProgress=function(a){return 0<this.findAjaxLoader(a).length};d.prototype.getPendingIframeHolder=function(){for(var a=0;a<this.iframeHolders.length;a++){var b=this.iframeHolders.eq(a),c=this.findClosestBulletinItem(b);if(!this.isEmbedInProgress(b)&&!d.isEmbedFinished(b)&&!this.isEmbedError(c)&&
this.isOnScreen(c))return b}};d.isEmbedFinished=function(a){return 0<a.find("iframe").length};d.prototype.isEmbedError=function(a){return 0<a.find("."+this.settings.cssClasses.oembedError).length};d.prototype.isOnScreen=function(a){return CCL.CommonFunctions.isOnScreen(a,this.embedConsideredVisibleRatio,this.embedConsideredVisibleRatio,this.settings.isIosDevice?window.parent:window)};d.prototype.findClosestEmbedBox=function(a){return a.closest(this.settings.selectors.embedBox)};d.prototype.findClosestBulletinItem=
function(a){return a.closest(this.settings.selectors.bulletinItem)};return d}();e.EmbedAsynchronousLoader=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=f.Controls.Validation.ValidatorFactory,d=f.Controls.Validation.DateTimePickerValidatorFactory,a=function(){function a(a){var b=this;this.utility=a;this.undoBadInputActiveFrom=function(){b.activeFrom.highlightOnAutoCorrectInvalidInput(500);setTimeout(function(){b.activeFrom.setDateTime(b.currentStrategyValue.activeFromDate)},500)};this.undoBadInputActiveTo=function(){b.activeTo.highlightOnAutoCorrectInvalidInput(500);setTimeout(function(){b.activeTo.minDate=b.utility.dateTimeSynchronizer.currentServerTimeWithoutSeconds;
b.activeTo.minDate.setMinutes(b.activeTo.minDate.getMinutes()+5);b.activeTo.setDateTime(!b.currentStrategyValue.activeToDate||b.currentStrategyValue.activeToDate<b.activeTo.minDate?b.activeTo.minDate:b.currentStrategyValue.activeToDate)},500)};this.runCheckOnBlurEvent(this.activeFrom,k.until(d.invalidDateDenyEmptyNoHighlight(this.activeFrom,this.utility.settings.Resources.InvalidDateFormat,this.undoBadInputActiveFrom),k.checkNoHighlight(this.activeFrom,function(){return b.activeFrom.getDateTime()<
b.activeFrom.minDate},"",this.undoBadInputActiveFrom)));this.runCheckOnBlurEvent(this.activeTo,k.until(d.invalidDateAllowEmptyNoHighlight(this.activeTo,this.utility.settings.Resources.InvalidDateFormat,this.undoBadInputActiveTo),k.checkNoHighlight(this.activeTo,function(){return b.activeTo.getDateTime()<=b.activeTo.minDate},"",this.undoBadInputActiveTo),k.checkNoHighlight(this.activeTo,function(){return b.activeTo.getDateTime()<=b.activeFrom.getDateTime()},this.utility.settings.Resources.ActiveFromDateShouldBeLaterThanActiveToDate,
void 0)))}Object.defineProperty(a.prototype,"currentStrategy",{set:function(a){this.currentStrategyValue=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeFrom",{get:function(){return window[this.utility.settings.ClientInstances.FromDateTimePicker]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeTo",{get:function(){return window[this.utility.settings.ClientInstances.ToDateTimePicker]},enumerable:!0,configurable:!0});a.prototype.validateDates=function(){var a=
this;return k.all(d.invalidDateDenyEmpty(this.activeFrom,this.utility.settings.Resources.InvalidDateFormat),k.until(k.checkNoHighlight(this.activeFrom,function(){return a.activeFrom.getDateTime()<a.activeFrom.minDate},"",this.undoBadInputActiveFrom),d.invalidDateAllowEmpty(this.activeTo,this.utility.settings.Resources.InvalidDateFormat),k.checkNoHighlight(this.activeTo,function(){return a.activeTo.getDateTime()<=a.utility.dateTimeSynchronizer.currentServerTimeWithoutSeconds},"",this.undoBadInputActiveTo),
d.compareDates(k.lessThanOrEqual,this.activeTo,this.activeFrom.getDateTime(),this.utility.settings.Resources.ActiveFromDateShouldBeLaterThanActiveToDate)))()};a.prototype.runCheckOnBlurEvent=function(a,b){$(a).on("blur",function(){setTimeout(function(){a.isFocusWithinControl()||b()},1)})};return a}();e.ScheduleDialogInputValidator=a})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.inputValidator=b;this.utilityValue=a;this.activeFromPickerInstance.dependentPicker=this.activeToPickerInstance}Object.defineProperty(d.prototype,"activeFromDate",{get:function(){throw Error("Abstract method should be overriden");},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"activeToDate",{get:function(){throw Error("Abstract method should be overriden");},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"strategicData",{get:function(){return this.strategicDataValue},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"utility",{get:function(){return this.utilityValue},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"activeFromPickerInstance",{get:function(){return window[this.utility.settings.ClientInstances.FromDateTimePicker]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"activeToPickerInstance",{get:function(){return window[this.utility.settings.ClientInstances.ToDateTimePicker]},
enumerable:!0,configurable:!0});d.prototype.loadDialogState=function(a,b){this.strategicDataValue=b;this.inputValidator.currentStrategy=this;this.utility.synchronizeDateTimePicker(this.activeFromPickerInstance);this.activeFromPickerInstance.toggleValidationError({isInvalid:!1});this.activeToPickerInstance.toggleValidationError({isInvalid:!1});this.loadDialogStateDone(a)};d.prototype.persistDialogState=function(){this.inputValidator.validateDates()&&(this.persistValidatedDialogState(),this.inputValidator.currentStrategy=
void 0)};d.prototype.loadDialogStateDone=function(a){throw Error("Abstract method should be overriden");};d.prototype.persistValidatedDialogState=function(){throw Error("Abstract method should be overriden");};return d}();e.ScheduleDialogBaseStorageStrategy=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c){d.call(this,a,c);this.resetStorage()}__extends(a,d);Object.defineProperty(a.prototype,"activeFromDate",{get:function(){return this.storage.activeFrom},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeToDate",{get:function(){return this.storage.activeTo},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeFrom",{get:function(){return CCL.SerializableDateTimeConverter.fromDate(this.storage.activeFrom)},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeTo",{get:function(){return CCL.SerializableDateTimeConverter.fromDate(this.storage.activeTo)},enumerable:!0,configurable:!0});a.prototype.resetStorage=function(){this.storage={activeFrom:void 0,activeTo:void 0}};a.prototype.loadDialogStateDone=function(a){a.OkButton.val(this.utility.settings.Resources.ApplyButtonText);a=this.utility.dateTimeSynchronizer.currentServerTimeWithoutSeconds;if(!this.storage.activeFrom||this.storage.activeFrom<
a)this.storage.activeFrom=a;this.storage.activeTo&&this.storage.activeTo<a&&(this.storage.activeTo=a);this.activeFromPickerInstance.minDate=a;this.activeToPickerInstance.minDate=a;this.activeFromPickerInstance.setDateTime(this.storage.activeFrom);this.activeToPickerInstance.setDateTime(this.storage.activeTo)};a.prototype.persistValidatedDialogState=function(){this.storage={activeFrom:this.activeFromPickerInstance.getDateTime(),activeTo:this.activeToPickerInstance.getDateTime()};this.storage.activeFrom||
this.storage.activeTo?this.utility.ajaxClient.getTimeSpan({ActiveFrom:CCL.SerializableDateTimeConverter.fromDate(this.storage.activeFrom),ActiveTo:CCL.SerializableDateTimeConverter.fromDate(this.storage.activeTo)}).done(this.strategicData.onSuccess).always(CssModal.closeDialog):CssModal.closeDialog()};return a}(e.ScheduleDialogBaseStorageStrategy);e.ScheduleDialogTemporaryStorageStrategy=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c){d.call(this,a,c)}__extends(a,d);Object.defineProperty(a.prototype,"activeFromDate",{get:function(){return this.activeFrom},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeToDate",{get:function(){return this.activeTo},enumerable:!0,configurable:!0});a.prototype.loadDialogStateDone=function(a){var b=this;a.OkButton.val(this.utility.settings.Resources.OkButtonText);this.activeFromPickerInstance.setDateTime(void 0);this.activeToPickerInstance.setDateTime(void 0);
this.activeTo=this.activeFrom=void 0;this.utility.ajaxClient.getSchedule(this.strategicData.lightBulletinId).done(function(a){return e.GenericResponseHandler.handle(a,function(){var c=a.ResponseData;b.activeFrom=CCL.SerializableDateTimeConverter.toDate(c.ActiveFrom);b.activeTo=CCL.SerializableDateTimeConverter.toDate(c.ActiveTo);b.activeFromPickerInstance.setDateTime(b.activeFrom);b.activeFromPickerInstance.minDate=CCL.SerializableDateTimeConverter.toDate(c.Created);b.activeToPickerInstance.setDateTime(b.activeTo);
b.activeToPickerInstance.minDate=new Date},function(){CssModal.closeDialog();a.Code===e.GenericResponseCode.LightBulletinNotFound&&b.utility.removeBulletin(b.utility.getBulletinById(b.strategicData.lightBulletinId))})})};a.prototype.persistValidatedDialogState=function(){this.utility.ajaxClient.updateSchedule(this.strategicData.lightBulletinId,{ActiveFrom:CCL.SerializableDateTimeConverter.fromDate(this.activeFromPickerInstance.getDateTime()),ActiveTo:CCL.SerializableDateTimeConverter.fromDate(this.activeToPickerInstance.getDateTime())},
this.strategicData.bulletinsDisplayMode).done(this.strategicData.onSuccess).always(CssModal.closeDialog)};return a}(e.ScheduleDialogBaseStorageStrategy);e.ScheduleDialogAjaxStorageStrategy=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.utility=a}Object.defineProperty(d.prototype,"areCommentsDisabledForNewBulletins",{get:function(){return this.areCommentsDisabledForNewBulletinsValue},set:function(a){this.areCommentsDisabledForNewBulletinsValue=a;this.utility.controls.AddMenu.ToggleCommentsOptionSpan.text(this.getToggleCommentsTerm(a));this.utility.controls.CommentsAvailabilityStatusPlaceHolder.toggle(a)},enumerable:!0,configurable:!0});d.prototype.resetCommentsDisabledForNewBulletins=
function(){this.areCommentsDisabledForNewBulletins=this.utility.settings.DisableLightBulletinCommentsDefaultValue};d.prototype.togglePossibilityToAddComments=function(a,b,c){c&&CCL.DomElementClass.GetInstanceForElement(a.CommentControlClientInstanceName).togglePossibilityToAddComments(!a.DisableComments);b.text(this.getToggleCommentsTerm(a.DisableComments))};d.prototype.getToggleCommentsTerm=function(a){return a?this.utility.settings.Resources.EnableComments:this.utility.settings.Resources.DisableComments};
return d}();e.LightBulletinCommentToggler=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.scrollTopTimeoutMilliseconds=200;this.animationTimeInMilliseconds=a.animationTimeInMilliseconds}d.prototype.animateShow=function(a,b){a.slideDown(this.animationTimeInMilliseconds,function(){b&&b();a.css("overflow","")})};d.prototype.animateHideAndRemove=function(a,b){this.animateHide(a,function(){a.remove();b&&b()})};d.prototype.animateScrollTop=function(a,b,c){var g=this;void 0===c&&(c=!1);setTimeout(function(){$("html, body").animate({scrollTop:a},
{duration:c?0:g.animationTimeInMilliseconds,complete:b})},this.scrollTopTimeoutMilliseconds)};d.prototype.animateHide=function(a,b){a.slideUp(this.animationTimeInMilliseconds,b)};return d}();e.LightBulletinAnimator=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.LightBulletin||(f.LightBulletin={});f=f.LightBulletinConstants||(f.LightBulletinConstants={});f.maxCountOfAddedElements=50;f.animationTimeInMilliseconds=250;f.watchEmbedsPasteTimeoutInMilliseconds=50;f.watchEmbedsKeyUpTimeoutInMilliseconds=1500;f.renderShowMoreDelayInMilliseconds=500;f.domainPartOfEmailRegexParams={regex:/(^|\s)[^a-z0-9._%+-]*(@[a-z0-9.-]+\.[a-z]{2,3})/ig,replaceGroupIndex:1};f.dataAttributeNames={pendingProcessId:"pending-process-id",loadedProcessId:"loaded-process-id"}})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a){this.utility=a;this.elementStates=new Map;this.settings=a.settings;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.newsContentBlock=this.utility.controls.Container.parents("."+this.settings.CssClasses.WidgetCbNews)}d.prototype.onResourceButtonClick=function(a,b,c,g,d){var h=this,l=this.elementStates.has(a)?this.elementStates.get(a):this.initiallyLoadElementStatesFromUi(a,b),k={locationId:this.settings.CourseId,locationType:this.settings.LocationTypeCourse};
f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog({elementStates:f.MapUtils.makeCopy(l),afterOkClickCallback:function(e){return h.onDialogAddButtonClick(a,b,f.MapUtils.makeCopy(e),c,g,d)},afterCloseDialogCallback:function(){h.utility.animator.animateScrollTop(0<a?b.offset().top:h.newsContentBlock.offset().top,function(){return b.find("."+h.settings.CssClasses.EditorTextarea).focus()},h.settings.IsIeBrowser)},maxCountOfAddedElements:e.LightBulletinConstants.maxCountOfAddedElements,elementType:f.ElementLinkDialog.ContentElementType.All,
showAll:!0,header:this.settings.Resources.ElementLinkDialogHeader,allowFolderSelection:!0},k)};d.prototype.onDetachResourceButtonClick=function(a,b,c,g){var d=c.data(this.settings.DataAttributes.ElementLinkElementId);this.elementStates.has(a)||this.elementStates.set(a,this.initiallyLoadElementStatesFromUi(a,b));var e=this.elementStates.get(a),l=e.get(d);l=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,l);e.set(d,l);l===f.CheckboxStateMachine.State.Empty?(c.remove(),g()):l===
f.CheckboxStateMachine.State.DetachedByUser&&this.hideWhenEditOrRemoveWhenNew(a,c,g);this.toggleDetailedView(this.utility.getElementLinkList(this.utility.getCurrentBulletinItemOrNew(b)))};d.prototype.resetUnsavedElementLinks=function(a,b){if(this.elementStates.has(a)){var c=this.utility.getElementLinkList(b),g=[],d=[];this.forEachElementState(a,function(a,b){a===f.CheckboxStateMachine.State.AttachedByUser?g.push(b):a===f.CheckboxStateMachine.State.DetachedByUser&&d.push(b)});a=this.elementStates.get(a);
var e=void 0;for(e=0;e<g.length;e++){var l=g[e];c.find("[data-"+this.settings.DataAttributes.ElementLinkElementId+'="'+l+'"]').remove();a.delete(l)}for(e=0;e<d.length;e++)l=d[e],this.utility.animator.animateShow(c.find("[data-"+this.settings.DataAttributes.ElementLinkElementId+'="'+l+'"]')),a.set(l,f.CheckboxStateMachine.State.Saved);this.toggleDetailedView(this.utility.getElementLinkList(b))}};d.prototype.getElementIdsForBulletin=function(a){var b=[],c=[];this.forEachElementState(a,function(a,d){a===
f.CheckboxStateMachine.State.AttachedByUser?b.push(d):a===f.CheckboxStateMachine.State.DetachedByUser&&c.push(d)});return{elementsToAttach:b,elementsToDetach:c}};d.prototype.cleanAppendData=function(a,b){var c=this;if(0===a)this.elementStates.delete(a);else{var g=this.elementStates.get(a),d=[];this.forEachElementState(a,function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.DetachedByUser||d.push(b)});var e=this.utility.getElementLinkList(b);d.forEach(function(a){var b=
c.checkboxStateMachine.transferElementStateAfterSave(g.get(a));g.set(a,b);b===f.CheckboxStateMachine.State.Empty&&e.find("[data-"+c.settings.DataAttributes.ElementLinkElementId+'="'+a+'"]').remove()})}};d.prototype.onDialogAddButtonClick=function(a,b,c,g,d,m){var h=this;d();this.elementStates.set(a,c);var k=this.utility.getElementLinkList(b);0===k.length&&(k=$(this.utility.controls.Container.data(this.settings.DataAttributes.ElementLinkList)),b.find("[data-"+this.settings.DataAttributes.ElementLinkAppendTarget+
"]").append(k));var p=[],n=[];this.forEachElementState(a,function(b,c){var g=k.find("[data-"+h.settings.DataAttributes.ElementLinkElementId+'="'+c+'"]');switch(b){case f.CheckboxStateMachine.State.Empty:g.remove();break;case f.CheckboxStateMachine.State.AttachedByUser:0===g.length?n.push(c):p.push(c);break;case f.CheckboxStateMachine.State.Saved:h.utility.animator.animateShow(g);p.push(c);break;case f.CheckboxStateMachine.State.DetachedByUser:h.hideWhenEditOrRemoveWhenNew(a,g)}});0<n.length?this.utility.ajaxClient.elementLinkItemsContent(n).done(function(a){a&&
(k.append($(a)),h.sortElementLinks(k),h.toggleDetailedView(k),b.find("."+h.settings.CssClasses.ElementLinkDelete).show(),m&&m())}).fail(function(a,b,c){g();CCL.CommonFunctions.alertAjaxError(a,b,c)}):this.toggleDetailedView(k);n.length+p.length>=e.LightBulletinConstants.maxCountOfAddedElements&&this.utility.toggler.toggleResourceButton(b,!1)};d.prototype.sortElementLinks=function(a){var b=this;a.children("li").get().sort(function(a,g){var c=b.settings.IsElementListSortOrderAscending?g:a,d="data-"+
b.settings.DataAttributes.ElementLinkListItemSortExpression;return $(b.settings.IsElementListSortOrderAscending?a:g).attr(d).localeCompare($(c).attr(d))}).forEach(function(b){a.append(b)})};d.prototype.toggleDetailedView=function(a){a=a.children("li").removeClass(this.settings.CssClasses.ElementLinkListItemDetailedView).filter(":visible");1===a.length&&a.addClass(this.settings.CssClasses.ElementLinkListItemDetailedView)};d.prototype.initiallyLoadElementStatesFromUi=function(a,b){var c=this,g=new Map;
this.utility.getElementLinkList(b).children("li").each(function(a,b){a=$(b).data(c.settings.DataAttributes.ElementLinkElementId);g.set(a,f.CheckboxStateMachine.State.Saved)});this.elementStates.set(a,g);return g};d.prototype.forEachElementState=function(a,b){(a=this.elementStates.get(a))&&a.forEach(b)};d.prototype.hideWhenEditOrRemoveWhenNew=function(a,b,c){0===a?b.remove():b.hide();"function"===typeof c&&c()};return d}();e.ElementLinkBuilder=k})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.oembedErrorCssClasses=a;this.oembedErrorResources=b;this.linkParser=new CCL.LinkParser}d.prototype.hasOembedError=function(a){return 0!==a.find("."+this.oembedErrorCssClasses.OembedBoxError).length};d.prototype.generateOembedError=function(a,b,c,g){var d=this;a.oembedPlaceHolder.find("iframe").remove();var e=$("<a>").prop("target","_blank").prop("href",a.originalEmbedCode).text(this.linkParser.getDomain(a.originalEmbedCode));e=CCL.CommonFunctions.formatString(this.oembedErrorResources.OembedErrorMessage,
e.get(0).outerHTML);e=$('<div class="'+this.oembedErrorCssClasses.OembedErrorContentBlock+'"></div>').append('<p class="'+this.oembedErrorCssClasses.OembedErrorTitle+'">'+this.oembedErrorResources.OembedErrorTitle+"</p>").append('<span class="'+this.oembedErrorCssClasses.OembedErrorMessage+'">'+e+"</span>").append("<br />").append($('<button type="button" class="'+this.oembedErrorCssClasses.OembedErrorTryAgain+'">'+this.oembedErrorResources.OembedErrorTryAgain+"</button>").on("click",function(){var e=
"function"===typeof c?c():0,f=a.oembedPlaceHolder.find("."+d.oembedErrorCssClasses.OembedBoxError),h=f.outerHeight();f.remove();a.oembedPlaceHolder.find("iframe").remove();b.loadEmbedContentAsync(h+e);"function"===typeof g&&g()}));return $('<div class="'+this.oembedErrorCssClasses.OembedBoxError+" "+this.oembedErrorCssClasses.Clearfix+'"></div>').append('<span class="'+this.oembedErrorCssClasses.OembedErrorImageBox+'"></span>').append(e)};return d}();e.EmbedError=f})(f.LightBulletin||(f.LightBulletin=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.utility=a;this.settings=a.settings;this.controls=a.controls}d.prototype.getBulletinEditor=function(a){return this.utility.isAddMode(a)?this.controls.NewBulletinText:a.data(d.bulletinEditorDataAttribute)};d.prototype.getBulletinEditorInstance=function(a){return a.data(d.bulletinEditorInstanceDataAttribute)};d.prototype.makeEditorAutoResizable=function(a){setTimeout(function(){return a.autogrow({whiteSpaceMatters:!0})})};d.prototype.createBulletinEditor=
function(a){var b=new e.LightBulletinEditorInstance(this.utility,a);a.data(d.bulletinEditorInstanceDataAttribute,b);return b};d.prototype.removeBulletinEditorInstanceDataAttribute=function(a){a.removeData(d.bulletinEditorInstanceDataAttribute)};d.prototype.resetEditor=function(a,b){a.removeAttr("style");b&&a.focus();this.utility.watchEmbeds.watchEmbeds(a)};d.bulletinEditorDataAttribute="bulletinEditor";d.bulletinEditorInstanceDataAttribute="bulletinEditorInstance";return d}();e.LightBulletinEditor=
f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.utility=a;this.bulletinItem=b;a=$(this.utility.controls.Container.attr("data-"+this.utility.settings.DataAttributes.BulletinItemEditorButtonsTemplate));this.editor=$(this.utility.controls.Container.attr("data-"+this.utility.settings.DataAttributes.BulletinItemEditorTemplate));this.editorButtons=a;this.cancelButton=a.find(this.utility.selectors.cancelEditAction);this.applyButton=a.find(this.utility.selectors.applyEditAction);this.bulletinId=
this.utility.getBulletinId(b)}d.prototype.removeBulletinEditor=function(){this.bulletinItem.find("[data-"+this.utility.settings.DataAttributes.BulletinItemEditorTarget+"]").children().remove();this.editorButtons.remove()};return d}();e.LightBulletinEditorInstance=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.utility=a}d.prototype.applyNewImageLoadingComplete=function(a){var b=this,c=this.filterNewImageBoxes(this.utility.getImageBox(a));this.utility.getImage(c).one("load",function(){return c.removeClass(b.utility.settings.CssClasses.ImageBoxLoading)})};d.prototype.hideOrRemoveImageBoxFromContainer=function(a){this.hideOrRemoveImageBox(this.utility.getImageBox(a))};d.prototype.hideOrRemoveImageBox=function(a){this.filterNewImageBoxes(a).remove();
this.filterNotNewImageBoxes(a).hide()};d.prototype.resetUnsavedImage=function(a){var b=this.utility.getImageBox(a);this.filterNewImageBoxes(b).remove();this.filterNotNewImageBoxes(b).show();this.removeImageError(a);this.clearAddImageButtonFileInputValue(a)};d.prototype.getParsedUploadResult=function(a){return this.parseSerialzedImageData(this.filterNewImageBoxes(this.utility.getImageBox(a)).last().find("input[type='hidden']"))};d.prototype.getDeleteAttachedImageValue=function(a){a=this.utility.getImageBox(a);
var b;return 0===this.filterNewImageBoxes(a).length&&0<(b=this.filterNotNewImageBoxes(a)).length&&b.length===b.not(":visible").length};d.prototype.applyImageEditsIfNeeded=function(a,b){var c=this.utility.getImageBox(a),g=this.filterNewImageBoxes(c);c=this.filterNotNewImageBoxes(c);var d=c.filter(":hidden");0<g.length&&(c.remove(),this.utility.setImageIsNew(g,!1),b&&g.find("[data-"+this.utility.settings.DataAttributes.BulletinAttachedImageLink+"]").prop("href",b));0<d.length&&d.remove();this.removeImageError(a)};
d.prototype.removeImageError=function(a){this.utility.getImageError(a).remove()};d.prototype.addImageButtonFileInputHasValue=function(a){return!!a.find(this.utility.selectors.addImageButtonFileInput).val()&&0<this.utility.getVisibleImageBox(a).length};d.prototype.clearAddImageButtonFileInputValue=function(a){a.find(this.utility.selectors.addImageButtonFileInput).val("")};d.prototype.filterNewImageBoxes=function(a){var b=this;return a.filter(function(a,g){return b.utility.getImageIsNew($(g))})};d.prototype.filterNotNewImageBoxes=
function(a){var b=this;return a.filter(function(a,g){return!b.utility.getImageIsNew($(g))})};d.prototype.parseSerialzedImageData=function(a){return 0<a.length?CCL.CommonFunctions.safeParseJson(a.val()):void 0};return d}();e.LightBulletinImageBox=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){this.fragments=[];this.createPlaceholder=function(a){return"@@LightBulletinTextObfuscator"+a+"@@"}}d.prototype.replaceTextFragmentsWithPlaceholders=function(a,b){var c=this;return a.replace(b.regex,function(a){for(var g=[],d=1;d<arguments.length;d++)g[d-1]=arguments[d];g=g[b.replaceGroupIndex];d=c.createPlaceholder(c.fragments.length);c.fragments.push(g);return a.replace(g,d)})};d.prototype.replacePlaceholdersWithTextFragments=function(a){var b=
this;a=this.fragments.reduce(function(a,g,d){return a.replace(b.createPlaceholder(d),g)},a);this.fragments=[];return a};return d}();e.LightBulletinTextObfuscator=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.utility=a;this.watchEmbedsDebouncer=new CCL.CallbackDebouncer(function(a){return b.switchWatchEmbeds(a.element,a.enabled)})}d.prototype.toggleOembedEditClasses=function(a,b){a.find("."+this.utility.settings.CssClasses.OembedBoxHeader).toggle(!b.isViewMode);this.utility.getVisibleOembedBox(a).toggleClass(this.utility.settings.CssClasses.OembedBoxEditMode,!b.isViewMode&&!b.isEmbedInProgress)};d.prototype.toggleAddBulletinMenu=
function(a){this.utility.controls.AddMenu.LinkContainer.toggle(a)};d.prototype.switchWatchEmbeds=function(a,b){this.utility.watchEmbeds.switchWatchEmbedsInBulletinItem(a,b)};d.prototype.toggleResourceButton=function(a,b){this.utility.getCurrentBulletinItemOrNew(a).find(this.utility.selectors.addResourceAction).prop("disabled",!b)};d.prototype.toggleAddEditButton=function(a,b){this.utility.getAddEditButton(a).prop("disabled",!b)};d.prototype.toggleAddImageButton=function(a,b){a=this.utility.getAddImageButton(a);
a.prop("disabled",!b);a.find(this.utility.selectors.addImageButtonFileInput).toggle(b)};d.prototype.toggleAddToOtherCoursesButton=function(a,b){this.utility.getAddToOtherCoursesButton(a).prop("disabled",!b)};d.prototype.toggleControlsInBulletin=function(a,b){var c=this.utility.getAddEditButton(a);this.utility.isAddMode(a)?c.prop("disabled",!b.canBePosted):c.prop("disabled",b.isEmbedInProgress);this.toggleAttachingActionsToBulletin(a,b)};d.prototype.toggleAttachingActionsToBulletin=function(a,b){a=
this.utility.getCurrentBulletinItemOrNew(a);this.toggleResourceButton(a,!(b.hasVisibleOembedBox||b.isEmbedInProgress||b.maxCountOfAddedElementsReached||b.hasVisibleImage||b.isMultiCourseLightBulletin));var c=b.hasVisibleOembedBox||b.isEmbedInProgress||b.hasAttachedElementLinks||b.hasVisibleImage;this.toggleAddImageButton(a,!(b.hasVisibleOembedBox||b.isEmbedInProgress||b.hasAttachedElementLinks));var g=e.addToOtherCoursesDialogClientInstance.getAvailableCoursesCount();this.toggleAddToOtherCoursesButton(a,
!b.hasAttachedElementLinks&&0<g);this.watchEmbedsDebouncer.invokeCallback({element:a,enabled:!c},500)};d.prototype.toggleBulletinAttachmentButtons=function(a,b){this.toggleResourceButton(a,b);this.toggleAddImageButton(a,b)};return d}();e.LightBulletinToggler=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){f.linkifyNodes=function(d){var a=new e.LightBulletinTextObfuscator;d.each(function(b,c){c.innerHTML=a.replaceTextFragmentsWithPlaceholders(c.innerHTML,e.LightBulletinConstants.domainPartOfEmailRegexParams);c.innerHTML=linkifyHtml(c.innerHTML);c.innerHTML=a.replacePlaceholdersWithTextFragments(c.innerHTML)})}})(e.LightBulletinLinkifyWrapper||(e.LightBulletinLinkifyWrapper={}))})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b,c,g){this.controls=a;this.settings=b;this.initSelectors();this.initClasses(c,g)}d.prototype.synchronizeDateTimePicker=function(a){var b=this;a.dateTimeSynchronizer=this.dateTimeSynchronizer;this.dateTimeSynchronizer.isSynchronizeNeeded&&this.ajaxClient.getCurrentDateTime().done(function(a){return b.dateTimeSynchronizer.synchronize(CCL.SerializableDateTimeConverter.toDateWithSeconds(a))})};d.prototype.validateBulletinAndToggleControls=function(a){var b=
this.textValidator.validateBulletin(this.editor.getBulletinEditor(a),this.getCurrentBulletinItemOrNew(a));this.toggler.toggleControlsInBulletin(a,b);this.isAddMode(a)&&this.toggler.toggleAddBulletinMenu(b.passedEmptyTextValidation);return b};d.prototype.linkifyTextNodes=function(a){this.linkifyNodes(a.find("[data-"+this.settings.DataAttributes.Text+"]"))};d.prototype.linkifyNodes=function(a){e.LightBulletinLinkifyWrapper.linkifyNodes(a)};d.prototype.isAddMode=function(a){return 0===a.length||a.get(0)===
this.controls.NewBulletinItem.get(0)};d.prototype.isViewMode=function(a){return 0===this.getAddEditButton(a).length};d.prototype.getBulletinId=function(a){return a.data(this.settings.DataAttributes.BulletinId)||0};d.prototype.getBulletinById=function(a){return this.controls.Container.find("[data-"+this.settings.DataAttributes.BulletinId+"='"+a+"']")};d.prototype.findBulletinItemByChild=function(a){return a.closest(this.selectors.bulletinItem)};d.prototype.getCurrentBulletinItemOrNew=function(a){return this.isAddMode(a)?
this.controls.NewBulletinItem:a};d.prototype.getAddEditButton=function(a){return this.isAddMode(a)?this.controls.PostNewBulletin:a.find(this.selectors.applyEditAction)};d.prototype.getAddImageButton=function(a){return this.getCurrentBulletinItemOrNew(a).find(this.selectors.addImageButton)};d.prototype.getAddToOtherCoursesButton=function(a){return this.controls.AddMenu.AddToOtherCoursesButton};d.prototype.removeBulletin=function(a){this.animator.animateHideAndRemove(a.closest("li"))};d.prototype.getOembedBox=
function(a){return a.find("."+this.settings.CssClasses.OembedBox)};d.prototype.getVisibleOembedBox=function(a){return this.getOembedBox(a).filter(":visible")};d.prototype.hasVisibleOembedBox=function(a){return 0<this.getVisibleOembedBox(a).length};d.prototype.getHiddenOembedBox=function(a){return this.getOembedBox(a).filter(":hidden")};d.prototype.getImageBox=function(a){return a.find("."+this.settings.CssClasses.ImageBox)};d.prototype.getImageError=function(a){return a.find("."+this.settings.CssClasses.ImageError)};
d.prototype.getVisibleImageBox=function(a){return this.getImageBox(a).filter(":visible")};d.prototype.hasVisibleImage=function(a){return 0<this.getVisibleImageBox(a).length};d.prototype.getHiddenImageBox=function(a){return this.getImageBox(a).filter(":hidden")};d.prototype.hasHiddenImage=function(a){return 0<this.getHiddenImageBox(a).length};d.prototype.getImageIsNew=function(a){return a.data(this.settings.DataAttributes.ImageIsNew)};d.prototype.setImageIsNew=function(a,b){a.data(this.settings.DataAttributes.ImageIsNew,
b)};d.prototype.getImage=function(a){return a.find("[data-"+this.settings.DataAttributes.BulletinAttachedImage+"]")};d.prototype.getTimeSpan=function(a){return a.find("."+this.settings.CssClasses.TimeSpan)};d.prototype.getAuthorContainer=function(a){return a.find("."+this.settings.CssClasses.Author)};d.prototype.hasOembedAttachedOrLoading=function(a,b){a=this.getCurrentBulletinItemOrNew(a);return this.hasVisibleOembedBox(a)||b.isEmbedInProgress(a)};d.prototype.getElementLinkList=function(a){return a.find("[data-"+
this.settings.DataAttributes.ElementLinkList+"]")};d.prototype.getCoursesContainer=function(a){return a.find("."+this.settings.CssClasses.Courses)};d.prototype.countResourcesOnUi=function(a){return this.getElementLinkList(this.getCurrentBulletinItemOrNew(a)).find("li").filter(":visible").length};d.setTabindexToHiddenElements=function(a,b,c){var g=0<b.length?b.get(0).getBoundingClientRect().top:0;a.find(c).each(function(a,c){a=c.getBoundingClientRect().top;g<a&&b.is(":visible")?$(c).attr("tabindex",
"-1"):$(c).removeAttr("tabindex")})};d.prototype.initSelectors=function(){this.selectors={applyEditAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionApplyEditValue+'"]',addResourceAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionAddResourceValue+'"]',cancelEditAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionCancelEditValue+
'"]',bulletinItem:"[data-"+this.settings.DataAttributes.BulletinId+"]",mediaAppendTarget:"[data-"+this.settings.DataAttributes.MediaAppendTarget+"]",addImageButton:"."+this.settings.CssClasses.AddImageButton,addImageButtonFileInput:"."+this.settings.CssClasses.AddImageButtonFileInput,lightBulletinActionDropDownItem:"[data-"+this.settings.SingleItemDataDataAttributes.LightBulletinActionDropDownItem+"]"}};d.prototype.initClasses=function(a,b){this.editor=new e.LightBulletinEditor(this);this.watchEmbeds=
new e.LightBulletinWatchEmbeds(a,this);this.imageBox=new e.LightBulletinImageBox(this);this.toggler=new e.LightBulletinToggler(this);this.textExpander=new CCL.TextExpander("LightBulletinTextExpander",this.settings.TextExpanderSettings);this.embedAsynchronousLoader=new e.EmbedAsynchronousLoader({isIosDevice:this.settings.IsIosDevice,cssClasses:{noBorder:this.settings.CssClasses.Border0,ajaxLoader:this.settings.CssClasses.AjaxLoader,oembedError:this.settings.OembedErrorCssClasses.OembedBoxError},selectors:{embedBox:"."+
this.settings.CssClasses.OembedBox+":visible",bulletinItem:this.selectors.bulletinItem},dataAttributes:{embedIframeUrl:this.settings.DataAttributes.EmbedIframeUrl}});this.textValidator=new e.LightBulletinTextValidator(this);this.ajaxClient=new e.LightBulletinAjaxClient(this.settings,b);this.animator=new e.LightBulletinAnimator({animationTimeInMilliseconds:e.LightBulletinConstants.animationTimeInMilliseconds});this.commentToggler=new e.LightBulletinCommentToggler(this);this.elementLinkBuilder=new e.ElementLinkBuilder(this);
this.oembedError=new e.EmbedError(this.settings.OembedErrorCssClasses,this.settings.OembedErrorResources);this.linkParser=new CCL.LinkParser;this.dateTimeSynchronizer=new f.Controls.DateTimeSynchronizer(CCL.SerializableDateTimeConverter.toDateWithSeconds(this.settings.Today));this.singleItemDataManager=new e.LightBulletinSingleItemDataManager(this.settings.SingleItemDataDataAttributes,this.settings.SingleItemDataResources)};return d}();e.LightBulletinUtility=k})(f.LightBulletin||(f.LightBulletin=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.utility=b;this.tryAgainBulletinIds=[];this.watchEmbedsPasteHandler=function(a){c.embedCallbackDebouncer.invokeCallback($(a.currentTarget),e.LightBulletinConstants.watchEmbedsPasteTimeoutInMilliseconds)};this.watchEmbedsKeyUpHandler=function(a){var b=$(a.currentTarget);a.which===CCL.CommonConstants.keyCodes.space||a.which===CCL.CommonConstants.keyCodes.enter?c.embedCallbackDebouncer.invokeCallback(b,0):c.embedCallbackDebouncer.invokeCallback(b,
e.LightBulletinConstants.watchEmbedsKeyUpTimeoutInMilliseconds)};this.embedCallbackDebouncer=new CCL.CallbackDebouncer(a)}d.prototype.switchWatchEmbedsInBulletinItem=function(a,b){b?this.watchEmbedsInBulletinItem(a):this.stopWatchEmbedsInBulletinItem(a)};d.prototype.watchEmbedsInBulletinItem=function(a){a=this.utility.editor.getBulletinEditor(a);this.watchEmbeds(a)};d.prototype.watchEmbeds=function(a){a&&(this.stopWatchEmbeds(a),a.on("paste",this.watchEmbedsPasteHandler).keyup(this.watchEmbedsKeyUpHandler))};
d.prototype.stopWatchEmbedsInBulletinItem=function(a){a=this.utility.editor.getBulletinEditor(a);this.stopWatchEmbeds(a)};d.prototype.stopWatchEmbeds=function(a){a.off("paste",this.watchEmbedsPasteHandler).off("keyup",this.watchEmbedsKeyUpHandler)};d.prototype.shouldAppendOembedError=function(a){var b=a.oembedPlaceHolder;if(this.utility.oembedError.hasOembedError(a.oembedPlaceHolder))return!1;a=this.utility.findBulletinItemByChild(b);var c=this.utility.getBulletinId(a);return-1===this.tryAgainBulletinIds.indexOf(c)&&
(this.utility.isAddMode(a)||b.data(this.utility.settings.DataAttributes.OembedIsNew))?(b.remove(),!1):0>=this.utility.countResourcesOnUi(a)};d.prototype.appendOembedError=function(a){var b=this,c=a.oembedPlaceHolder,g=this.utility.findBulletinItemByChild(c),d=this.utility.getBulletinId(g),e=this.tryAgainBulletinIds.indexOf(d);-1!==e&&(c.data(this.utility.settings.DataAttributes.OembedIsNew,!1),this.tryAgainBulletinIds.splice(e,1));c.append(this.utility.oembedError.generateOembedError(a,this.utility.embedAsynchronousLoader,
function(){b.tryAgainBulletinIds.push(d);var c=a.oembedPlaceHolder.outerHeight();b.utility.toggler.toggleOembedEditClasses(g,{isViewMode:b.utility.isViewMode(g),isEmbedInProgress:!0});c-=a.oembedPlaceHolder.outerHeight();b.utility.linkParser.removeFromSkipUrl(a.originalEmbedCode);return c},function(){b.utility.isViewMode(g)||b.utility.validateBulletinAndToggleControls(g)}));c.removeClass(this.utility.settings.CssClasses.OembedBoxLoading)};return d}();e.LightBulletinWatchEmbeds=f})(f.LightBulletin||
(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.controls=a;this.settings=c;this.modalDialog=window[this.dialogId];this.controls.OkButton.click(function(a){a.preventDefault();b.currentStrategy.persistDialogState()})}Object.defineProperty(a.prototype,"dialogId",{get:function(){return this.controls.Container.prop("id")},enumerable:!0,configurable:!0});a.prototype.openDialog=function(a){this.currentStrategy=a.strategy;this.modalDialog.openDialog(!1);this.modalDialog.setPreferredSize(this.settings.PreferredWidth,
this.settings.PreferredHeight);this.currentStrategy.loadDialogState(this.controls,a.strategicData)};return a}();e.ScheduleDialogManager=d})(e.ScheduleDialog||(e.ScheduleDialog={}))})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.settings=a;this.textExpander=b}d.prototype.renderShowMoreLink=function(a,b,c){var g=this;void 0===c&&(c=function(){});a.each(function(a,d){a=$(d);g.textExpander.renderShowMoreTextSection(g.findClickablePlaceholder(a),g.findCollapsibleTextContainer(a),g.findContent(a),b,c)})};d.prototype.renderShowMoreLinkOnEmbedResize=function(a){a=a.closest("[data-"+this.settings.DataAttributes.BulletinId+"]");0===a.find("."+this.settings.CssClasses.EditorTextarea).length&&
this.renderShowMoreIfNeeded(a,function(){})};d.prototype.renderShowMoreWithImagesHack=function(a,b,c,g){var d=this;a.find(b).one("load",function(a){return d.renderShowMoreIfNeeded($(a.currentTarget).closest(c),g)});this.renderShowMoreLink(a,!1,g)};d.prototype.findClickablePlaceholder=function(a){return this.findByDataAttribute(a,this.settings.DataAttributes.ClickablePlaceholder)};d.prototype.findCollapsibleTextContainer=function(a){return this.findByDataAttribute(a,this.settings.DataAttributes.CollapsibleTextContainer)};
d.prototype.renderShowMoreIfNeeded=function(a,b){var c=this.findClickablePlaceholder(a);c.is(":visible")&&!this.textExpander.isCollapsed(c)&&this.textExpander.hasEnoughHeightForRenderingShowMore(this.findContent(a))||this.renderShowMoreLink(a,!1,b)};d.prototype.findContent=function(a){return this.findByDataAttribute(a,this.settings.DataAttributes.Content)};d.prototype.findByDataAttribute=function(a,b){return a.find("[data-"+b+"]")};return d}();e.ShowMoreLinkRenderer=f})(f.LightBulletin||(f.LightBulletin=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.utility=a;this.settings=a.settings;this.modernInput=new CCL.ModernInput(this.settings.ModernInputCssClasses,this.settings.ModernInputDataAttributes)}d.prototype.validateEditorTextMaxLength=function(a,b){a=a.length;var c=a<=this.settings.TextMaxLength;this.modernInput.toggleTextError(b,this.createTextTooLongMessage(a),!c);return c};d.prototype.validateBulletin=function(a,b){var c=this.utility.embedAsynchronousLoader.isEmbedInProgress(b);a=
this.checkNotEmpty(a.val());var g=this.utility.hasVisibleOembedBox(b),d=this.utility.countResourcesOnUi(b),f=e.lightBulletinContentBlockInstance.isMultiCourseLightBulletin(b);return{canBePosted:!c&&(a||g),passedEmptyTextValidation:a||g&&!c,isEmbedInProgress:c,hasVisibleOembedBox:g,maxCountOfAddedElementsReached:d===e.LightBulletinConstants.maxCountOfAddedElements,hasAttachedElementLinks:0<d,hasVisibleImage:this.utility.hasVisibleImage(b),isMultiCourseLightBulletin:f}};d.prototype.toggleNoTextYetErrorMessage=
function(a,b){this.modernInput.toggleTextError(a,this.settings.Resources.NoTextYetError,!b.passedEmptyTextValidation)};d.prototype.checkNotEmpty=function(a){return 0<$.trim(a).length};d.prototype.createTextTooLongMessage=function(a){return CCL.CommonFunctions.formatString(this.settings.Resources.TextTooLongError,this.settings.TextMaxLength,a)};return d}();e.LightBulletinTextValidator=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(d){function a(a,c){d.call(this,a.Urls.CheckSession,a.Resources.AnErrorOccurred,c);this.settings=a}__extends(a,d);a.prototype.page=function(a,c,g){return $.ajax({type:"GET",url:this.settings.Urls.Page,data:{courseId:this.settings.CourseId,boundaryLightBulletinId:a,boundaryLightBulletinActiveFromTicks:c,displayMode:g}})};a.prototype.createLightBulletin=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.CreateLightBulletin,data:{inputData:a},
dataType:"html"})};a.prototype.updateLightBulletin=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.UpdateLightBulletin,data:{inputData:a},dataType:"json"})};a.prototype.getSchedule=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetSchedule,data:{lightBulletinId:a},dataType:"json"})};a.prototype.getCurrentDateTime=function(){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetCurrentDateTime,dataType:"json"})};a.prototype.getTimeSpan=
function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetTimeSpan,data:{schedule:a},dataType:"html"})};a.prototype.updateSchedule=function(a,c,g){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.UpdateSchedule,data:{lightBulletinId:a,schedule:c,bulletinsDisplayMode:g},dataType:"html"})};a.prototype.deleteLightBulletinPermanently=function(a,c){return CCL.CommonFunctions.safeAjax({type:"DELETE",url:c?this.settings.Urls.DeleteLightBulletinFromAllCoursesPermanently:
this.settings.Urls.DeleteLightBulletinPermanently,data:{bulletinId:a},dataType:"json"})};a.prototype.setBulletinCommentsAvailability=function(a,c){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.SetBulletinCommentsAvailability,data:{bulletinId:a,disableComments:c},dataType:"json"})};a.prototype.toggleLightBulletinSubscriptionForPerson=function(a,c){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.ToggleLightBulletinSubscriptionForPerson,data:{lightBulletinId:a,
subscribe:c},dataType:"json"})};a.prototype.embed=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.Embed,data:{embedUrl:a},dataType:"html"})};a.prototype.elementLinkItemsContent=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.ElementLinkItemsContent,data:{elementIds:a},dataType:"html"})};a.prototype.getBulletinElementLinksAnnouncementCompleted=function(a){return $.get(this.settings.Urls.IsBulletinElementLinksAnnouncementCompletedUrl+"?courseId="+
a)};a.prototype.uploadImage=function(a,c,g){return $.ajax({type:"PUT",url:this.settings.Urls.UploadImage+"?courseId="+a+"&lightBulletinId="+c,contentType:!1,processData:!1,dataType:"html",data:g})};a.prototype.callInsertOrUpdatePersonSettingService=function(a,c){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.InsertOrUpdateSetting,data:{name:a,value:c}})};return a}(f.CommonAjaxClient);e.LightBulletinAjaxClient=k})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){var f=function(){function d(){}d.listenToEmbedSizePostmessages=function(a,b,c,g,d){CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentSize,function(e){var f=a.find("#"+e.oembedPlaceHolderId),h=f.hasClass(b)?f:f.find("."+b);e.height&&(h.css("height",e.height),c.renderShowMoreLinkOnEmbedResize(f),g.removeAjaxLoader(f.parent()),d&&d(f))})};return d}();e.EmbedResizer=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b){var c=this;this.controls=a;this.settings=b;this.pendingEmbedProcessManager=new e.PendingEmbedProcessManager;this.embedBufferMap=new Map;this.renderShowMoreCallbackDebouncer=new CCL.CallbackDebouncer(function(a){return c.renderShowMoreInAddMode(a)});this.uploadImagePromiseQueue=new CCL.PromiseQueue;this.maskNavigationBarMessage=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.maskNavigationBar);this.unmaskNavigationBarMessage=
new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.unmaskNavigationBar);this.expandContentIframeMessage=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame);this.collapseContentIframeMessage=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame);this.afterAddingComment=function(a){a=a.userData.sourceId;var b=c.utility.getBulletinById(a);c.singleItemDataManager.subscribeToCommentsIfNeeded(b,
a)};this.lightBulletinMenuClicked=function(a){var b=c.singleItemDataManager.getLightBulletinActionDropDownItem(a),g=c.utility.getBulletinById(b.LightBulletinId);switch(b.ActionType){case e.LightBulletinDropDownMenuActionType.Edit:c.appendBulletinEditor(c.editor.createBulletinEditor(g));c.toggleViewEditMode(g,!1);break;case e.LightBulletinDropDownMenuActionType.SetCommentsAvailability:var d=!c.singleItemDataManager.getSingleItemData(g).DisableComments;c.ajaxClient.setBulletinCommentsAvailability(b.LightBulletinId,
d).done(function(b){e.GenericResponseHandler.handle(b,function(){var b=c.singleItemDataManager.refreshSingleItemData(g,function(a){return a.DisableComments=d});c.commentToggler.togglePossibilityToAddComments(b,a,c.settings.AllowedToCommentAnnouncements)},function(){b.Code===e.GenericResponseCode.LightBulletinNotFound&&c.utility.removeBulletin(g)})}).fail(c.ajaxClient.handleAjaxError);c.resetFocusOnCurrentItem(g);break;case e.LightBulletinDropDownMenuActionType.ScheduleBulletin:e.ScheduleDialog.ScheduleDialogManager.instance.openDialog({strategy:c.ajaxStorageStrategy,
strategicData:{lightBulletinId:b.LightBulletinId,bulletinsDisplayMode:c.activationFilterCurrentValue,onSuccess:function(a){a=$(a);a.hasClass(c.settings.CssClasses.TimeSpan)?c.utility.getTimeSpan(g).replaceWith(a):(c.utility.removeBulletin(g),c.showInformationFeedback(a,c.settings.Resources.BulletinHasBeenEditedButDoesNotMatchFilter))}}});c.resetFocusOnCurrentItem(g);break;case e.LightBulletinDropDownMenuActionType.Delete:var f=void 0,k=c.utility.getCoursesContainer(g).find("li").length;f=1<k?c.settings.Resources.DeleteGroupConfirmationText.replace("{0}",
k.toString()):c.settings.Resources.DeleteConfirmationText;var n=[];n.push(new CCL.ConfirmButtonMetaData(0===k?c.settings.Resources.Delete:c.settings.Resources.DeleteFromThisCourse,c.settings.CssClasses.DeleteButton,"confirm_delete"));1<k&&n.push(new CCL.ConfirmButtonMetaData(c.settings.Resources.DeleteFromAllCourses,c.settings.CssClasses.DeleteButton,"confirm_delete_from_all"));n.push(new CCL.ConfirmButtonMetaData(c.settings.Resources.Cancel,"","confirm_cancel"));c.toggleDeleteConfirmationAdditionalStyles(!0);
CCL.CommonFunctions.jAjaxMultiButtonConfirm(f,c.settings.Resources.DeleteBulletin,n,function(a){c.toggleDeleteConfirmationAdditionalStyles(!1);!a||"confirm_delete"!==a.customId&&"confirm_delete_from_all"!==a.customId||(c.ajaxClient.deleteLightBulletinPermanently(b.LightBulletinId,"confirm_delete_from_all"===a.customId).done(function(a){return e.GenericResponseHandler.handle(a,function(){return c.utility.removeBulletin(g)},function(){a.Code===e.GenericResponseCode.LightBulletinNotFound&&c.utility.removeBulletin(g)})}).fail(c.ajaxClient.handleAjaxError),
c.setFocusOnPreviousItem(g))});break;case e.LightBulletinDropDownMenuActionType.ToggleSubscription:var q=c.singleItemDataManager.getSingleItemData(g).SubscriptionStatus!==e.PersonSubscriptionStatus.Subscribed;c.ajaxClient.toggleLightBulletinSubscriptionForPerson(b.LightBulletinId,q).done(function(b){return e.GenericResponseHandler.handle(b,function(){return c.singleItemDataManager.updateSubscriptionStatus(g,a,q)},function(){b.Code===e.GenericResponseCode.LightBulletinNotFound&&c.utility.removeBulletin(g)})}).fail(c.ajaxClient.handleAjaxError);
c.resetFocusOnCurrentItem(g)}};this.toggleMobileMode=function(a){CCL.CommonFunctions.makePostMessageCall(window.parent,a?c.expandContentIframeMessage:c.collapseContentIframeMessage);IframeResizer.reportSetIframeDefaultHeight()};this.onDeleteImageButtonClick=function(a){a=$(a.target);var b=c.utility.getCurrentBulletinItemOrNew(c.utility.findBulletinItemByChild(a));c.utility.imageBox.hideOrRemoveImageBox(a.closest("."+c.settings.CssClasses.ImageBox));c.utility.imageBox.clearAddImageButtonFileInputValue(b);
c.focusOnTextArea(b);c.utility.validateBulletinAndToggleControls(b)};this.checkInputForEmbedUrl=function(a){c.watchEmbeds.stopWatchEmbeds(a);var b=c.utility.findBulletinItemByChild(a),g=c.utility.getCurrentBulletinItemOrNew(b),d=c.utility.isAddMode(b)?a.closest(c.selectors.mediaAppendTarget):b.find(c.selectors.mediaAppendTarget);if(!c.utility.hasVisibleOembedBox(d)&&0===c.utility.countResourcesOnUi(b)){var f=c.utility.linkParser.getFirstLink(a.val());if(f&&f.length<=c.settings.EmbedUrlMaxLength){c.toggler.toggleBulletinAttachmentButtons(b,
!1);c.toggler.toggleAddEditButton(b,!1);c.utility.imageBox.removeImageError(g);var k=c.embedAsynchronousLoader.createAjaxLoader();d.append(k);var n=c.pendingEmbedProcessManager.createProcess(c.ajaxClient.embed(f));k.data(e.LightBulletinConstants.dataAttributeNames.pendingProcessId,n.processId);n.ajaxRequest.done(function(a){a=$(a);d.append(a);a=c.embedAsynchronousLoader.findIframeHolders(a);var b=c.embedAsynchronousLoader.createIframe(c.embedAsynchronousLoader.getEmbedIframeUrl(a),!0);a.append(b);
a.data(e.LightBulletinConstants.dataAttributeNames.loadedProcessId,n.processId);c.pendingEmbedProcessManager.clearProcessAjaxRequest(n)}).fail(function(h){k.remove();n.pendingStatus!==e.PendingProcessStatus.Aborted&&(c.pendingEmbedProcessManager.setProcessFailed(n),c.ajaxClient.handleAjaxError(h),c.watchEmbeds.watchEmbeds(a),c.watchEmbeds.shouldAppendOembedError({originalEmbedCode:f,oembedPlaceHolder:d})&&c.watchEmbeds.appendOembedError({originalEmbedCode:f,oembedPlaceHolder:d}),c.toggler.toggleOembedEditClasses(g,
{isViewMode:!1,isEmbedInProgress:!0}),c.utility.validateBulletinAndToggleControls(b))})}else c.watchEmbeds.watchEmbeds(a)}};e.lightBulletinContentBlockInstance=this;this.utility=new e.LightBulletinUtility(a,b,this.checkInputForEmbedUrl,function(){return c.formCheckBeforeUnload.DetachHandler()});this.watchEmbeds=this.utility.watchEmbeds;this.selectors=this.utility.selectors;this.editor=this.utility.editor;this.toggler=this.utility.toggler;this.embedAsynchronousLoader=this.utility.embedAsynchronousLoader;
this.textValidator=this.utility.textValidator;this.commentToggler=this.utility.commentToggler;this.ajaxClient=this.utility.ajaxClient;this.elementLinkBuilder=this.utility.elementLinkBuilder;this.singleItemDataManager=this.utility.singleItemDataManager;if(this.settings.CanAddNewBulletins||this.settings.HasOwnBulletin)this.scheduleDialogInputValidator=new e.ScheduleDialogInputValidator(this.utility),this.temporaryStorageStrategy=new e.ScheduleDialogTemporaryStorageStrategy(this.utility,this.scheduleDialogInputValidator),
this.ajaxStorageStrategy=new e.ScheduleDialogAjaxStorageStrategy(this.utility,this.scheduleDialogInputValidator);this.boundaryLightBulletinId=this.settings.InitialPageData.BoundaryLightBulletinId;this.boundaryLightBulletinActiveFromTicks=this.settings.InitialPageData.BoundaryLightBulletinActiveFromTicks;this.activationFilterCurrentValue=this.settings.BulletinsDisplayMode;this.setupFormCheckBeforeUnload();this.setupControls();this.setupControlsEvents();this.setupEventListeners();this.setupGhostBulletin()}
d.prototype.isMultiCourseLightBulletin=function(a){return 0<this.utility.getBulletinId(a)?this.singleItemDataManager.getSingleItemData(a).IsMultiCourseLightBulletin:this.postedToCoursesInNewBulletin&&0<this.postedToCoursesInNewBulletin.length};d.prototype.onActivationFilterChanged=function(a){this.activationFilterCurrentValue=parseInt(a,10);this.ajaxClient.callInsertOrUpdatePersonSettingService(this.settings.BulletinsContentBlockDisplayModePersonSettingName,a).done(WidgetLayout._reloadWindow)};d.prototype.setFocusOnPreviousItem=
function(a){var b=$(this.controls.Container).children();a=b.index(a.parent().first());0<a&&a--;$(b[a]).find(".itsl-light-bulletins-person-name > a").first().focus()};d.prototype.resetFocusOnCurrentItem=function(a){$(a).find(".itsl-light-bulletins-person-name > a").first().focus()};d.prototype.toggleDeleteConfirmationAdditionalStyles=function(a){this.adjustDialogPositionOnIosDevice(a);CCL.CommonFunctions.isPhoneScreenSize()?this.toggleMobileMode(a):CCL.CommonFunctions.makePostMessageCall(window.parent,
a?this.maskNavigationBarMessage:this.unmaskNavigationBarMessage);$.alerts.dialogClass=a?this.settings.DeleteConfirmationStyle.DialogCssClass:""};d.prototype.adjustDialogPositionOnIosDevice=function(a){CCL.CommonFunctions.isIosDevice()&&$("body").toggleClass(this.settings.CssClasses.BodyIosPositioningFix,a)};d.prototype.focusOnTextArea=function(a){this.utility.editor.getBulletinEditor(a).focus()};d.prototype.uploadImage=function(a){var b=this,c=$(a.target).closest(this.utility.selectors.addImageButton);
if(!c.prop("disabled")){var g=f.UploadFileHelper.getFormDataWithAttachedFilesAndFileSizes(a.target).formData;if(g){var d=this.utility.findBulletinItemByChild(c),e=this.utility.isAddMode(d)?c.closest(this.selectors.mediaAppendTarget):d.find(this.selectors.mediaAppendTarget),l=this.utility.getCurrentBulletinItemOrNew(d);this.utility.imageBox.hideOrRemoveImageBoxFromContainer(e);this.utility.imageBox.removeImageError(e);this.watchEmbeds.stopWatchEmbedsInBulletinItem(d);this.toggler.toggleResourceButton(d,
!1);this.toggler.toggleAddImageButton(d,!1);e.append(this.embedAsynchronousLoader.createAjaxLoader());this.uploadImagePromiseQueue.enqueue(function(){return b.ajaxClient.uploadImage(b.settings.CourseId,b.utility.getBulletinId(d),g).always(function(){b.editor.getBulletinEditor(d).focus();b.embedAsynchronousLoader.removeAjaxLoader(e)}).done(function(a){b.utility.isViewMode(l)||b.utility.hasVisibleImage(l)||(e.append($(a)),b.utility.validateBulletinAndToggleControls(d),b.utility.imageBox.applyNewImageLoadingComplete(e),
0<b.utility.getImageError(l).length&&b.utility.imageBox.clearAddImageButtonFileInputValue(l))}).fail(function(a){b.utility.validateBulletinAndToggleControls(d);b.utility.imageBox.clearAddImageButtonFileInputValue(l);b.ajaxClient.handleAjaxError(a)})})}}};d.prototype.setupEventListeners=function(){this.listenToEmbedPostmessages();this.listenToEmbedSizePostmessages()};d.prototype.setupControls=function(){var a=this;this.loadEmbedContent(this.controls.Container);this.setupShowMoreLink();this.utility.linkifyTextNodes(this.controls.Container);
this.settings.CanAddNewBulletins&&this.setupEditorAndApplyButton({editor:this.controls.NewBulletinText,applyButton:this.controls.PostNewBulletin},function(){return a.createLightBulletin()},function(){return a.resetUnsavedTextInAddMode()});this.commentToggler.resetCommentsDisabledForNewBulletins();this.controls.NewBulletinItem.length&&this.utility.validateBulletinAndToggleControls(this.controls.NewBulletinItem)};d.prototype.setupFormCheckBeforeUnload=function(){var a=this;if(this.settings.CanAddNewBulletins){CCL.DialogWhiteList.allowDialogWithId(f.ElementLinkDialog.elementLinkDialogManagerInstance.getDialogId());
CCL.DialogWhiteList.allowDialogWithId(e.ScheduleDialog.ScheduleDialogManager.instance.dialogId);CCL.DialogWhiteList.allowDialogWithId(e.AddToOtherCoursesDialog.instance.dialogId);var b={enabled:!0,clearStateCallback:function(){a.resetUnsavedTextInAddMode();a.utility.imageBox.resetUnsavedImage(a.controls.NewBulletinItem);a.resetUnsavedEmbed(a.controls.NewBulletinItem,0,{preserveAjaxLoader:!1});a.elementLinkBuilder.resetUnsavedElementLinks(0,a.controls.NewBulletinItem);a.utility.validateBulletinAndToggleControls(a.controls.NewBulletinItem);
a.textValidator.validateEditorTextMaxLength("",a.controls.NewBulletinItem);a.controls.Container.find(a.selectors.bulletinItem).each(function(b,g){b=$(g);a.utility.isViewMode(b)||a.cancelEditMode(a.editor.getBulletinEditorInstance(b))})}}}else b={enabled:!1,clearStateCallback:function(){}};this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.controls.Container.closest("form"),this.settings.Resources.FormBeforeUnloadWarning,{callback:function(){return a.isAddingEditingBulletinsNotFinished()},
whiteList:b})};d.prototype.setupShowMoreLink=function(){var a=this;this.showMoreRenderer=new e.ShowMoreLinkRenderer(this.settings.ShowMoreLinkRendererSettings,this.utility.textExpander);this.renderShowMoreWithImagesHack(this.controls.Container.find(this.selectors.bulletinItem));this.controls.Container.find(this.selectors.bulletinItem).each(function(b,c){b=$(c);e.LightBulletinUtility.setTabindexToHiddenElements(b,a.showMoreRenderer.findClickablePlaceholder(b),"."+a.settings.CssClasses.ElementLink)})};
d.prototype.renderShowMoreWithImagesHack=function(a){var b=this;this.showMoreRenderer.renderShowMoreWithImagesHack(a,"[data-"+this.settings.DataAttributes.BulletinAttachedImage+"]",this.utility.selectors.bulletinItem,function(a,g){e.LightBulletinUtility.setTabindexToHiddenElements(a,g,"."+b.settings.CssClasses.ElementLink)})};d.prototype.loadEmbedContent=function(a){this.embedAsynchronousLoader.appendIframeHolders(a);this.embedAsynchronousLoader.loadEmbedContentAsync()};d.prototype.setupControlsEvents=
function(){var a=this;this.controls.ShowMoreLink.click(function(b){a.controls.ShowMoreLink.hide();a.ajaxClient.page(a.boundaryLightBulletinId,a.boundaryLightBulletinActiveFromTicks,a.settings.BulletinsDisplayMode).done(function(b){var c=void 0;b=0<$.trim(b).length?(c=$(b)).filter("[data-"+a.settings.DataAttributes.PageData+"]"):$();if(0<b.length&&c){var d=b.data(a.settings.DataAttributes.PageData);a.utility.linkifyTextNodes(c);a.controls.Container.append(c);b.remove();a.renderShowMoreWithImagesHack(c.find(a.selectors.bulletinItem));
a.boundaryLightBulletinId=d.BoundaryLightBulletinId;a.boundaryLightBulletinActiveFromTicks=d.BoundaryLightBulletinActiveFromTicks;a.controls.ShowMoreLink.toggle(d.NeedToShowMore);a.loadEmbedContent(c)}}).fail(a.ajaxClient.handleAjaxError);b.preventDefault()});this.controls.Container.on("click","."+this.settings.CssClasses.OembedDelete,function(b){return a.lightBulletinDeleteEmbedClicked(b)});this.controls.Container.on("click",this.selectors.addResourceAction,function(b){b=$(b.target);if(!b.closest(a.selectors.addResourceAction).prop("disabled")){var c=
a.utility.findBulletinItemByChild(b),g=a.utility.getCurrentBulletinItemOrNew(c);b=function(){a.watchEmbeds.stopWatchEmbedsInBulletinItem(c);a.toggler.toggleAddImageButton(c,!1);a.toggler.toggleResourceButton(c,!0);var b=a.utility.getVisibleOembedBox(g);a.embedAsynchronousLoader.removeAjaxLoader(b.closest(a.selectors.mediaAppendTarget));a.removeOembedBox(b,c);a.utility.imageBox.removeImageError(g)};var d=function(){a.watchEmbeds.watchEmbedsInBulletinItem(c);a.toggler.toggleAddImageButton(c,!0)};if(!a.utility.hasVisibleOembedBox(g))a.elementLinkBuilder.onResourceButtonClick(a.utility.getBulletinId(c),
g,d,b,function(){a.utility.validateBulletinAndToggleControls(c)})}});this.controls.Container.on("click","a."+this.settings.CssClasses.ElementLinkDelete,function(b){b=$(b.currentTarget).closest("."+a.settings.CssClasses.ElementLinkListItem);var c=a.utility.findBulletinItemByChild(b);a.elementLinkBuilder.onDetachResourceButtonClick(a.utility.getBulletinId(c),c,b,function(){a.focusOnTextArea(c);a.utility.validateBulletinAndToggleControls(c)})});this.controls.Container.on("click","."+this.settings.CssClasses.ImageDelete,
this.onDeleteImageButtonClick);this.controls.Container.on("click",this.utility.selectors.addImageButtonFileInput,function(b){var c=a.utility.getCurrentBulletinItemOrNew(a.utility.findBulletinItemByChild($(b.target)));a.utility.hasVisibleImage(c)&&!confirm(a.settings.Resources.ReloadImageConfirmation)&&b.preventDefault()});this.controls.Container.on("change",this.utility.selectors.addImageButtonFileInput,function(b){return a.uploadImage(b)});this.controls.Container.on("keyup",this.utility.selectors.addImageButton,
function(b){b.which===CCL.CommonConstants.keyCodes.enter&&a.clickOnFileInputInsideAddImageButton($(b.target))});this.controls.Container.on("click",this.utility.selectors.addImageButton,function(b){return a.clickOnFileInputInsideAddImageButton($(b.target))});this.utility.controls.AddMenu.Menu.on(this.utility.settings.IsIosDevice?"touchstart":"click","a, button",function(b){b.preventDefault();b=b.currentTarget;switch(b){case a.utility.controls.AddMenu.ToggleCommentsOptionButton.get(0):a.commentToggler.areCommentsDisabledForNewBulletins=
!a.commentToggler.areCommentsDisabledForNewBulletins;break;case a.utility.controls.AddMenu.ScheduleOptionButton.get(0):e.ScheduleDialog.ScheduleDialogManager.instance.openDialog({strategy:a.temporaryStorageStrategy,strategicData:{onSuccess:function(b){a.utility.getTimeSpan(a.utility.controls.NewBulletinItem).remove();a.utility.getAuthorContainer(a.utility.controls.NewBulletinItem).append($(b))}}});break;case a.utility.controls.AddMenu.AddToOtherCoursesButton.get(0):b=$(b);if(b.prop("disabled"))return;
var c=a.utility.findBulletinItemByChild(b),g=a.utility.getCurrentBulletinItemOrNew(c);e.AddToOtherCoursesDialog.instance.openDialog(a.postedToCoursesInNewBulletin,function(){a.setPostedToCourses(g,e.addToOtherCoursesDialogClientInstance.selectedCourses);a.utility.validateBulletinAndToggleControls(c)})}a.resetFocusOnCurrentItem(a.utility.controls.NewBulletinItem)});this.singleItemDataManager.registerDropDownMenuClickHandler(this.utility.settings.IsIosDevice,this.lightBulletinMenuClicked)};d.prototype.clickOnFileInputInsideAddImageButton=
function(a){a.prop("disabled")||a.find(this.utility.selectors.addImageButtonFileInput).click()};d.prototype.setPostedToCourses=function(a,b){this.postedToCoursesInNewBulletin=b;a=this.utility.getCoursesContainer(a);a.empty();if(b&&0<b.length){var c=$('<ul class="'+this.settings.CssClasses.CoursesList+'"></ul>');c.append("<li>"+this.settings.CourseTitle+"</li>");b.map(function(a){return a.Title}).sort(function(a,b){a=a?a.toLowerCase():"";b=b?b.toLocaleLowerCase():"";return a<b?-1:a>b?1:0}).forEach(function(a){c.append("<li>"+
CCL.CommonFunctions.htmlEncode(a)+"</li>")});a.append(c)}this.utility.controls.AddMenu.AddToOtherCoursesSpan.text(this.postedToCoursesInNewBulletin&&0<this.postedToCoursesInNewBulletin.length?this.utility.settings.Resources.EditListOfCourses:this.utility.settings.Resources.AddToOtherCourses)};d.prototype.listenToEmbedPostmessages=function(){var a=this;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentData,function(b){var c=a.controls.Container.find("#"+
b.oembedPlaceHolderId),g=a.utility.findBulletinItemByChild(c),d={originalEmbedCode:b.originalEmbedCode,oembedPlaceHolder:c},f=a.embedAsynchronousLoader.findIframeHolders(c),l=f.data(e.LightBulletinConstants.dataAttributeNames.loadedProcessId),k=a.pendingEmbedProcessManager.getProcessById(l);b.isPlainLink||0<a.utility.countResourcesOnUi(g)||c.data(a.settings.DataAttributes.OembedIsNew)&&a.utility.isViewMode(g)||k&&k.pendingStatus===e.PendingProcessStatus.Aborted?(a.controls.Container.removeClass(a.settings.CssClasses.OembedBoxLoading),
a.embedAsynchronousLoader.removeAjaxLoader(c.closest(a.selectors.mediaAppendTarget)),c.removeClass(a.settings.CssClasses.OembedContent),b.isPlainLink&&a.utility.linkParser.skipUrl(b.originalEmbedCode),a.watchEmbeds.shouldAppendOembedError(d)?(a.embedBufferMap.set(a.utility.getBulletinId(g),d),a.watchEmbeds.appendOembedError(d),a.showMoreRenderer.renderShowMoreLink(g,!1)):c.remove(),l&&(a.pendingEmbedProcessManager.removeProcessById(l),f.removeData(e.LightBulletinConstants.dataAttributeNames.loadedProcessId))):
(a.embedBufferMap.set(a.utility.getBulletinId(g),d),c.removeClass(a.settings.CssClasses.OembedBoxLoading),c.data(a.settings.DataAttributes.OembedIsNew)&&(a.embedAsynchronousLoader.removeAjaxLoader(c.closest(a.selectors.mediaAppendTarget)),c.find("."+a.settings.CssClasses.OembedBoxHeader).show()),a.toggler.toggleOembedEditClasses(g,{isViewMode:a.utility.isViewMode(g),isEmbedInProgress:!1}));a.utility.validateBulletinAndToggleControls(g)})};d.prototype.listenToEmbedSizePostmessages=function(){var a=
this;e.EmbedResizer.listenToEmbedSizePostmessages(this.controls.Container,this.settings.CssClasses.OembedContent,this.showMoreRenderer,this.embedAsynchronousLoader,function(b){var c=a.utility.findBulletinItemByChild(b);a.utility.isViewMode(c)||a.utility.validateBulletinAndToggleControls(c);b=a.embedAsynchronousLoader.findIframeHolders(b);if(c=b.data(e.LightBulletinConstants.dataAttributeNames.loadedProcessId))a.pendingEmbedProcessManager.removeProcessById(c),b.removeData(e.LightBulletinConstants.dataAttributeNames.loadedProcessId)})};
d.prototype.lightBulletinDeleteEmbedClicked=function(a){var b=$(a.target);a=this.utility.findBulletinItemByChild(b);b=b.closest("."+this.settings.CssClasses.OembedBox+":visible");this.removeOembedBox(b,a,b.data(this.settings.DataAttributes.OembedIsNew));this.focusOnTextArea(a);this.utility.validateBulletinAndToggleControls(a)};d.prototype.toggleViewEditMode=function(a,b){var c=a.find("[data-"+this.settings.DataAttributes.Text+"]"),g=this.showMoreRenderer.findClickablePlaceholder(a);b||this.utility.textExpander.expand(this.showMoreRenderer.findCollapsibleTextContainer(a),
g);c.toggle(b&&0<c.html().length);g.toggle(b);e.LightBulletinUtility.setTabindexToHiddenElements(a,g,"."+this.settings.CssClasses.ElementLink);a.find("."+this.settings.CssClasses.ListItemAction).toggle(b);this.toggler.toggleOembedEditClasses(a,{isViewMode:b,isEmbedInProgress:this.embedAsynchronousLoader.isEmbedInProgress(a)});b||this.utility.validateBulletinAndToggleControls(a);a.find("."+this.settings.CssClasses.ElementLinkDelete).toggle(!b);a.find("."+this.utility.settings.CssClasses.ImageBoxHeader).toggle(!b);
a.find("."+this.settings.CssClasses.ImageBox).toggleClass(this.settings.CssClasses.ImageBoxEditMode,!b)};d.prototype.isAddingEditingBulletinsNotFinished=function(){return this.isPostingNewBulletin()||0<this.controls.NewBulletinItem.find("li[data-"+this.settings.DataAttributes.ElementLinkElementId+"]").length||this.utility.imageBox.addImageButtonFileInputHasValue(this.controls.NewBulletinItem)||0<this.controls.Container.find(this.selectors.applyEditAction).length};d.prototype.isPostingNewBulletin=
function(){return this.settings.CanAddNewBulletins&&(!this.controls.PostNewBulletin.prop("disabled")||this.textValidator.checkNotEmpty(this.controls.NewBulletinText.val()))};d.prototype.createLightBulletin=function(){var a=this,b=this.controls.NewBulletinText.val(),c=this.embedBufferMap.get(0);c=c?c.originalEmbedCode:void 0;this.removeOembedBox(this.utility.getOembedBox(this.controls.NewBulletinItem),this.controls.NewBulletinItem);var g=this.elementLinkBuilder.getElementIdsForBulletin(0),d=this.postedToCoursesInNewBulletin?
this.postedToCoursesInNewBulletin.map(function(a){return a.CourseId}):[];b={CourseId:this.settings.CourseId,AdditionalCourseIds:d,Text:b,EmbedUrl:c,DisableComments:this.commentToggler.areCommentsDisabledForNewBulletins,ElementIdsToAttach:g.elementsToAttach,UploadResult:this.utility.imageBox.getParsedUploadResult(this.controls.NewBulletinItem),Schedule:{ActiveFrom:this.temporaryStorageStrategy.activeFrom,ActiveTo:this.temporaryStorageStrategy.activeTo},BulletinsDisplayMode:this.activationFilterCurrentValue};
this.controls.PostNewBulletin.prop("disabled",!0);this.resetUnsavedTextInAddMode();this.ajaxClient.createLightBulletin(b).done(function(b){if(b){var c=$(b);if(c.is(":visible")){a.utility.controls.GhostArrow.parent().remove();var g=$("<li style='display:none;'>"+b+"</li>").addClass(a.settings.CssClasses.ListItem).addClass(a.settings.CssClasses.PositionRelative);a.utility.linkifyTextNodes(g);a.controls.NewBulletinItem.after(g);a.utility.animator.animateShow(g);a.renderShowMoreInAddMode(g);a.utility.getImage(g).one("load",
function(){a.renderShowMoreInAddMode(g);a.renderShowMoreCallbackDebouncer.invokeCallback(g,e.LightBulletinConstants.renderShowMoreDelayInMilliseconds)}).each(function(){this.complete&&$(this).load()});b=a.embedAsynchronousLoader.findIframeHolders(g);0<b.length&&(c=a.embedAsynchronousLoader.createAjaxLoader(),g.find(a.selectors.mediaAppendTarget).append(c),b.append(a.embedAsynchronousLoader.createIframe(a.embedAsynchronousLoader.getEmbedIframeUrl(b),!0)))}else a.showInformationFeedback(c,a.settings.Resources.BulletinHasBeenCreatedButDoesNotMatchFilter)}a.elementLinkBuilder.cleanAppendData(0,
void 0);a.temporaryStorageStrategy.resetStorage();a.commentToggler.resetCommentsDisabledForNewBulletins();a.toggler.toggleAddBulletinMenu(!1);a.setPostedToCourses(a.controls.NewBulletinItem,[]);e.addToOtherCoursesDialogClientInstance.clear();a.utility.getVisibleImageBox(a.controls.NewBulletinItem).remove();a.utility.imageBox.clearAddImageButtonFileInputValue(a.controls.NewBulletinItem);a.utility.imageBox.removeImageError(a.controls.NewBulletinItem);a.utility.getElementLinkList(a.controls.NewBulletinItem).remove();
a.utility.validateBulletinAndToggleControls(a.controls.NewBulletinItem);a.utility.getTimeSpan(a.controls.NewBulletinItem).remove()}).fail(function(b){a.controls.PostNewBulletin.prop("disabled",!0);a.ajaxClient.handleAjaxError(b)})};d.prototype.showInformationFeedback=function(a,b){var c=this,g=a.data(this.settings.DataAttributes.InformationFeedbackButtonText),d=a.data(this.settings.DataAttributes.ActivationFilterValueToShowBulletin);CCL.InformationFeedback.showFeedbackWithextraButton(this.controls.InformationFeedbackMainContainer,
b,g,function(){CCL.InformationFeedback.hideFeedback(c.controls.InformationFeedbackMainContainer);c.onActivationFilterChanged(d)})};d.prototype.renderShowMoreInAddMode=function(a){var b=this;this.showMoreRenderer.renderShowMoreLink(a,!0,function(a,g){e.LightBulletinUtility.setTabindexToHiddenElements(a,g,"."+b.settings.CssClasses.ElementLink)})};d.prototype.setupEditorAndApplyButton=function(a,b,c){var g=this,d=!0,f=this.utility.getCurrentBulletinItemOrNew(this.utility.findBulletinItemByChild(a.editor)),
l=function(c){d&&!a.applyButton.prop("disabled")&&(c=g.utility.validateBulletinAndToggleControls(f),g.textValidator.toggleNoTextYetErrorMessage(f,c),c.canBePosted?b():a.editor.focus())};f.data(e.LightBulletinEditor.bulletinEditorDataAttribute,a.editor);a.applyButton.click(l);this.editor.makeEditorAutoResizable(a.editor);this.editor.resetEditor(a.editor,!1);a.editor.keyup(function(a){a.which===CCL.CommonConstants.keyCodes.escape?(c(),d=g.textValidator.validateEditorTextMaxLength("",f)):a.ctrlKey&&
a.which===CCL.CommonConstants.keyCodes.enter&&l(a)}).on("input paste remove",function(b){d=g.textValidator.validateEditorTextMaxLength("remove"===b.type?"":a.editor.val(),f);g.utility.isAddMode(f)&&g.utility.validateBulletinAndToggleControls(f)});this.utility.validateBulletinAndToggleControls(f)};d.prototype.appendBulletinEditor=function(a){var b=this,c=a.bulletinItem.find("[data-"+this.settings.DataAttributes.Text+"]"),g=c.attr("data-"+this.settings.DataAttributes.Text);a.editor.val(g);a.bulletinItem.find("[data-"+
this.settings.DataAttributes.BulletinItemEditorTarget+"]").append(a.editor);a.bulletinItem.find("[data-"+this.settings.DataAttributes.BulletinItemEditorButtonsTarget+"]").append(a.editorButtons);a.editor.focus();this.setupEditorAndApplyButton(a,function(){var g=b.embedBufferMap.get(a.bulletinId),d=b.elementLinkBuilder.getElementIdsForBulletin(a.bulletinId);b.ajaxClient.updateLightBulletin({BulletinId:a.bulletinId,Text:a.editor.val(),EmbedUrl:g?g.originalEmbedCode:void 0,ElementIdsToAttach:d.elementsToAttach,
ElementIdsToDetach:d.elementsToDetach,UploadResult:b.utility.imageBox.getParsedUploadResult(a.bulletinItem),DeleteAttachedImage:b.utility.imageBox.getDeleteAttachedImageValue(a.bulletinItem)}).done(function(g){e.GenericResponseHandler.handle(g,function(){b.utility.getHiddenOembedBox(a.bulletinItem).remove();var d=g.ResponseData;b.embedAsynchronousLoader.removeAjaxLoader(a.bulletinItem);a.removeBulletinEditor();c.html(d.OutputText).attr("data-"+b.settings.DataAttributes.Text,d.DataAttributeText);b.utility.getVisibleOembedBox(a.bulletinItem).data(b.settings.DataAttributes.OembedIsNew,
!1);b.showMoreRenderer.renderShowMoreLink(a.bulletinItem,!0,function(a,c){e.LightBulletinUtility.setTabindexToHiddenElements(a,c,"."+b.settings.CssClasses.ElementLink)});b.toggleViewEditMode(a.bulletinItem,!0);b.utility.linkifyNodes(c);b.elementLinkBuilder.cleanAppendData(a.bulletinId,a.bulletinItem);b.utility.imageBox.applyImageEditsIfNeeded(a.bulletinItem,d.LargeImageUrl)},function(){b.cancelEditMode(a);g.Code===e.GenericResponseCode.LightBulletinNotFound&&b.utility.removeBulletin(a.bulletinItem)})}).fail(function(c,
g,d){b.cancelEditMode(a);b.ajaxClient.handleAjaxError(c)})},function(){return b.cancelEditMode(a)});a.cancelButton.click(function(){b.cancelEditMode(a)})};d.prototype.resetUnsavedTextInAddMode=function(){this.editor.resetEditor(this.controls.NewBulletinText.val(""),!0)};d.prototype.cancelEditMode=function(a){var b=this;this.resetUnsavedEmbed(a.bulletinItem,a.bulletinId,{preserveAjaxLoader:!0});this.utility.imageBox.resetUnsavedImage(a.bulletinItem);a.removeBulletinEditor();this.editor.removeBulletinEditorInstanceDataAttribute(a.bulletinItem);
this.toggleViewEditMode(a.bulletinItem,!0);this.showMoreRenderer.renderShowMoreLink(a.bulletinItem,!0,function(a,g){e.LightBulletinUtility.setTabindexToHiddenElements(a,g,"."+b.settings.CssClasses.ElementLink)});this.elementLinkBuilder.resetUnsavedElementLinks(a.bulletinId,a.bulletinItem)};d.prototype.resetUnsavedEmbed=function(a,b,c){var g=this.utility.getVisibleOembedBox(a),d=this.embedAsynchronousLoader.findIframeHolders(g).data(e.LightBulletinConstants.dataAttributeNames.loadedProcessId)||this.embedAsynchronousLoader.findAjaxLoader(a).data(e.LightBulletinConstants.dataAttributeNames.pendingProcessId);
d&&this.pendingEmbedProcessManager.cancelProcess(d);(d=g.data(this.settings.DataAttributes.OembedIsNew))&&this.removeOembedBox(g,a);g=this.utility.getHiddenOembedBox(a);if(0<g.length){g.show();var f=g.data(this.settings.DataAttributes.OembedUrl);this.embedBufferMap.set(b,{oembedPlaceHolder:g,originalEmbedCode:f})}c.preserveAjaxLoader&&!d||this.embedAsynchronousLoader.removeAjaxLoader(a)};d.prototype.removeOembedBox=function(a,b,c){void 0===c&&(c=!0);if(0<a.length){var g=this.embedBufferMap.get(this.utility.getBulletinId(b));
g&&a.data(this.settings.DataAttributes.OembedUrl,g.originalEmbedCode);c?a.remove():a.hide();this.embedBufferMap.delete(this.utility.getBulletinId(b))}};d.prototype.setupOnboardingFeatures=function(){var a=this;this.settings.CanAddNewBulletins&&this.ajaxClient.getBulletinElementLinksAnnouncementCompleted(this.settings.CourseId).done(function(b){b&&a.setupElementLinksAnnouncementContextDialog(b)}).fail(this.ajaxClient.handleAjaxError)};d.prototype.setupGhostBulletin=function(){var a=this;if(this.settings.HasGhostBulletin){var b=
new CCL.CallbackDebouncer(function(){var b=a.controls.GhostArrow;if(0===b.length)$(window).off("resize",c);else{var d=b.next(),e=a.utility.controls.PostNewBulletin;b.css({height:d.position().top-5,width:d.position().top/2,left:e.position().left+e.width()/2});b.show()}});var c=function(){return b.invokeCallback(null,300)};c();$(window).on("resize",c)}};d.prototype.setupElementLinksAnnouncementContextDialog=function(a){var b=this,c=$(this.selectors.addResourceAction);if(c.is(":visible")){c.after(a);
var g="#"+this.utility.settings.ElementLinksAnnouncementContainerClientId,d=new ContextDialog(g,{marginTop:c.height(),marginLeft:(c.width()-420)/2,valign:"bottom",width:420,zIndex:1,blackThemeActivated:!0,closeWithOutsideClick:!1,showHeader:!1,showCloseLink:!1,scrollToLastWindowOnClose:!1,useMobileViewIfNeeded:!1,allowAccessToParentWindow:!1,expandParentFrame:!1});this.controls.Container.on("click",g+","+this.selectors.addResourceAction,function(){$(g).is(":visible")&&d.closeDialog()});var e,f=function(){if(CCL.CommonFunctions.isOnScreen(c,
.5,.5,b.utility.settings.IsIosDevice?window.parent:window)){var a=c.position().left+c.width()/2+10,g=c.position().top+10;d.openDialogAt(a,g,!1);return!0}return!1};if(!(e=f()))$(window).on(this.utility.settings.IsIosDevice?"touchmove":"scroll",function(){e||f()})}else setTimeout(this.setupElementLinksAnnouncementContextDialog,50)};return d}();e.LightBulletinContentBlock=k})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.utility=a}d.prototype.folderContent=function(a){return $.ajax({type:"GET",url:this.utility.settings.Urls.FolderContent,data:a,dataType:"html"})};return d}();e.ElementLinkDialogAjaxClient=f})(f.ElementLinkDialog||(f.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k;(function(a){a[a.Expanded=1]="Expanded";a[a.Collapsed=2]="Collapsed";a[a.Loading=3]="Loading"})(k||(k={}));var d=function(){function a(a,c){var b=this;this.controls=a;this.settings=c;this.inputTypeCheckboxSelector="input:checkbox";this.updateElementStateAndToggleOkButtonEnabled=function(a){var c=$(a.target);a=b.utility.closestElementItem(c);c=b.updateElementState(a,c.is(":checked"));b.controls.OkButton.prop("disabled",!b.currentParams.allowEmptySubmit&&(0===c||c>b.currentParams.maxCountOfAddedElements));
a.find(b.inputTypeCheckboxSelector).first().focus();if(b.currentParams.disallowMultipleSelection){var g=b.utility.getElementId(a);a=b.getCheckedElements();if(1<a.length){var d=[];$.each(a,function(a,b){b!==g&&d.push(b)});a=b.utility.getCheckbox(d[0]);a.prop("checked",!1);a.trigger("change")}}};this.utility=new e.Utility(a,c);this.modalDialog=window[this.getDialogId()];this.ajaxClient=new e.ElementLinkDialogAjaxClient(this.utility);this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.setupListItemFocusedAreaClickHandler();
this.setupOkButtonClickHandler();this.modalDialog.setCustomScripts({afterOpenDialogAjaxDynamicallySuccess:function(){return b.onFolderContentLoaded()},afterCloseDialog:function(){void 0!==b.currentParams.afterCloseDialogCallback&&b.currentParams.afterCloseDialogCallback()}});this.preventExternalFormSubmitAndMakeSaveOnEnterKey()}a.prototype.openDialog=function(a,c){this.currentParams=a;$.extend(c,{elementType:this.currentParams.elementType,showAll:this.currentParams.showAll});this.ajaxParams=c;this.currentParams.openerPage&&
(c.openerPage=this.currentParams.openerPage);this.currentParams.relatedEntityId&&(c.relatedEntityId=this.currentParams.relatedEntityId);this.currentParams.learningObjectiveId&&(c.learningObjectiveId=this.currentParams.learningObjectiveId);this.modalDialog.setAjaxUrl(this.settings.Urls.DialogContent,c,!1);this.modalDialog.setTitle(this.currentParams.header);this.modalDialog.openDialog(!1);this.modalDialog.setPreferredSize(this.settings.PreferredWidth,this.settings.PreferredHeight);a=this.countCheckedElements();
a=void 0!=this.currentParams.maxCountOfAddedElements&&a>this.currentParams.maxCountOfAddedElements?!1:this.currentParams.allowEmptySubmit||0<a&&0<this.countElementsChanged();this.controls.OkButton.prop("disabled",!a)};a.prototype.refreshDialog=function(a){a=void 0===a?{}:a;var b=a.showAll;b=void 0===b?!1:b;a=a.isFilteredByLearningObjectives;this.isFilteredByLearningObjectives=void 0===a?!1:a;this.ajaxParams.showAll=b;this.currentParams.showAll=b;this.modalDialog.setAjaxUrl(this.settings.Urls.DialogContent,
this.ajaxParams,!0)};a.prototype.closeDialog=function(){CssModal.closeDialog()};a.prototype.getDialogId=function(){return this.controls.Container.prop("id")};a.prototype.onFolderContentLoaded=function(){var a=this;this.currentParams.elementStates.forEach(function(b,g){a.checkboxStateMachine.isElementChecked(b)&&(b=a.utility.getCheckbox(g))&&b.length&&b.prop("checked",!0)});this.currentParams.disabledElementIds&&this.currentParams.disabledElementIds.forEach(function(b){(b=a.utility.getCheckbox(b))&&
b.length&&b.prop("disabled",!0)})};a.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.on("click",function(b){b.preventDefault();a.controls.OkButton.is(":visible")&&a.controls.OkButton.is(":enabled")&&(a.currentParams.afterOkClickCallback(a.currentParams.elementStates),CssModal.closeDialog())})};a.prototype.setupListItemFocusedAreaClickHandler=function(){var a=this;this.controls.Container.on((c={},c.change=this.updateElementStateAndToggleOkButtonEnabled,c),this.inputTypeCheckboxSelector);
this.controls.Container.on("click",this.utility.selectors.listItemFocusedArea,function(b){b=$(b.target);var c=a.utility.closestElementItem(b);a.isClickTargetEnabled(b,c)?a.targetIsFolderActionExpand(b)?a.expandOrCollapseFolder(c):a.utility.isListItemFocusedArea(b)&&a.isCheckboxExistAndEnabled(c)&&(b=a.utility.getCheckbox(a.utility.getElementId(c)),b.toggle(!b.is(":checked"))):a.isFolder(c)&&a.expandOrCollapseFolder(c)});this.controls.Container.on("keyup",this.utility.selectors.listItemFocusedArea,
function(b){b.which!==CCL.CommonConstants.keyCodes.space||CCL.CommonFunctions.isFirefox()||(b=$(b.target),a.targetIsFolderActionExpand(b)&&a.expandOrCollapseFolder(a.utility.closestElementItem(b)))});var c};a.prototype.preventExternalFormSubmitAndMakeSaveOnEnterKey=function(){var a=this;this.controls.DialogContent.keypress(function(b){b.which!==CCL.CommonConstants.keyCodes.enter||a.controls.OkButton.is(":focus")||(b.preventDefault(),a.controls.OkButton.click())})};a.prototype.isClickTargetEnabled=
function(a,c){return 0===c.find(this.utility.selectors.elementLinkFolderActionExpand).length||this.targetIsFolderActionExpand(a)||this.currentParams.allowFolderSelection&&(!this.isFilteredByLearningObjectives||this.currentParams.showAll)&&this.isCheckboxExistAndEnabled(c)};a.prototype.targetIsFolderActionExpand=function(a){return a.is(this.utility.selectors.elementLinkFolderActionExpand)||0<a.closest(this.utility.selectors.elementLinkFolderActionExpand).length};a.prototype.isFolder=function(a){return 0<
a.find(this.utility.selectors.elementLinkFolderActionExpand).length};a.prototype.updateElementState=function(a,c){a=this.utility.getElementId(a);var b=this.currentParams.elementStates.get(a)||f.CheckboxStateMachine.State.Empty;c=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(c,b);this.currentParams.elementStates.set(a,c);return this.countCheckedElements()};a.prototype.countElementsChanged=function(){return f.MapUtils.reduce(this.currentParams.elementStates,function(a,c,g){return g===
f.CheckboxStateMachine.State.AttachedByUser||g===f.CheckboxStateMachine.State.DetachedByUser?a+1:a},0)};a.prototype.countCheckedElements=function(){var a=this;return f.MapUtils.reduce(this.currentParams.elementStates,function(b,g,d){return a.checkboxStateMachine.isElementChecked(d)?b+1:b},0)};a.prototype.getCheckedElements=function(){var a=this;return f.MapUtils.reduce(this.currentParams.elementStates,function(b,g,d){a.checkboxStateMachine.isElementChecked(d)&&b.push(g);return b},[])};a.prototype.expandOrCollapseFolder=
function(a){var b=this,g=a.find(this.utility.selectors.elementLinkFolderActionExpand).first(),d=g.data(this.settings.DataAttributes.ElementLinkFolderActionExpand),e=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderAppendTarget)).first();d?d===k.Expanded?this.setFolderState(e,g,k.Collapsed):d===k.Collapsed&&this.setFolderState(e,g,k.Expanded):(this.setFolderState(e,g,k.Loading),this.ajaxClient.folderContent({folderId:this.utility.getElementId(a),elementType:this.currentParams.elementType,
openerPage:this.currentParams.openerPage,relatedEntityId:this.currentParams.relatedEntityId,learningObjectiveId:this.currentParams.learningObjectiveId,showAll:this.currentParams.showAll}).done(function(a){e.append(a);b.setFolderState(e,g,k.Expanded);b.onFolderContentLoaded()}))};a.prototype.isCheckboxExistAndEnabled=function(a){return(a=this.utility.getCheckbox(this.utility.getElementId(a)))&&a.is(":enabled")};a.prototype.setFolderState=function(a,c,g){a.toggle(g===k.Expanded);this.utility.closestListItemFocusedArea(c).find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderTitle)).toggleClass(this.settings.CssClasses.FontBold,
g===k.Expanded);c.data(this.settings.DataAttributes.ElementLinkFolderActionExpand,g);a=c.find("."+this.settings.CssClasses.FolderStateExpanded+",."+this.settings.CssClasses.FolderStateCollapsed);a.toggleClass(this.settings.CssClasses.FolderStateCollapsed,g!==k.Expanded);a.toggleClass(this.settings.CssClasses.FolderStateExpanded,g===k.Expanded);a.closest("."+this.settings.CssClasses.ExpandButton).attr("aria-label",g===k.Expanded?this.settings.Terms.CollapseFolder:this.settings.Terms.ExpandFolder)};
a.prototype.isClosestLabel=function(a){return 0<a.closest("label").length};return a}();e.ElementLinkDialogManager=d})(f.ElementLinkDialog||(f.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){window[a]=this;this.settings=b;this.eventNames=b.EventNames;this.initialize()}d.prototype.initialize=function(){!this.settings.UsesNestedLearningObjectiveSelectorMode&&this.settings.LearningObjectivesEditorClientId&&(this.objectivesEditor=window.parent[this.settings.LearningObjectivesEditorClientId]);var a=this;$(document).on(this.eventNames.EmptyStateChangedEventName,function(b,c){$(a.settings.ClientCssSelectorOfTopWarningFeedbackSelector).toggle(c.isAnyEmpty);
a.objectivesEditor&&a.objectivesEditor.handleCriteriaEmptyStateChangedEvent(c.isAnyEmpty,c.loUpdate)}).on(this.eventNames.DeleteLearningObjectiveEventName,function(b,c){a.settings.UsesNestedLearningObjectiveSelectorMode&&(c.reloadPage?(a.haveChangedLos=!0,a.removeLearningObjective(c.learningObjectiveId),a.updateUrlAndReload()):a.removeLearningObjective(c.learningObjectiveId))}).on(this.eventNames.CriteriaWeightsChangedEventName,function(b,c){a.objectivesEditor?(a.objectivesEditor.updateCriteriaWeights(c.data),
a.objectivesEditor.updateLearningObjectivesCriteriaWeights(c.loCriteriaWeights)):$("#"+a.settings.CriteriaWeightsHiddenClientId).val(JSON.stringify(c.data))});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.submitIframe,function(){var b=$("#"+a.settings.CriteriaWeightsHiddenClientId).val(),c=[];$.each(window[a.settings.LearningObjectivesControlClientId].selectedIds,function(a,b){c.push(parseInt(b))});CCL.CommonFunctions.makePostMessageCall(window.parent,
new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,{loIds:c,criteriaWeights:b}))})};d.prototype.updateUrlAndReload=function(){if(this.haveChangedLos){var a=document.location.href,b=this.getParameterByName(a,"Ids"),c=window[this.settings.LearningObjectivesControlClientId].selectedIds;a=b?a.replace(b[0],b[0][0]+"Ids="+encodeURIComponent(c.join(","))):a+(-1==a.indexOf("?")?"?":"&")+"Ids="+encodeURIComponent(c.join(","));if(b=$("#"+this.settings.CriteriaWeightsHiddenClientId).val())a=
(c=this.getParameterByName(a,"CriteriaWeights"))?a.replace(c[0],c[0][0]+"CriteriaWeights="+encodeURIComponent(b)):a+(-1==a.indexOf("?")?"?":"&")+"CriteriaWeights="+encodeURIComponent(b);b=this.settings.ShowCriteriaWeights?"1":"0";a=(c=this.getParameterByName(a,"ShowCriteriaWeights"))?a.replace(c[0],c[0][0]+"ShowCriteriaWeights="+b):a+(-1==a.indexOf("?")?"?":"&")+"ShowCriteriaWeights="+b;document.location.replace(a)}};d.prototype.addLearningObjectives=function(a){for(var b=[],c=0;c<a.length;c++)b.push(parseInt(a[c]));
window[this.settings.LearningObjectivesControlClientId].setSelectedIds(b,!0);$(document).trigger(this.eventNames.SelectionSavedEventName);window[this.settings.LearningObjectivesControlClientId].showSuccessFeedback();this.haveChangedLos=!0;this.triggerLearningObjectivesDescription()};d.prototype.closeDialogAndRedirect=function(a){var b=window.parent;b.CssModal.closeDialog();b.location=a};d.prototype.removeLearningObjective=function(a){var b=window[this.settings.LearningObjectivesControlClientId].selectedIds;
b.splice(b.indexOf(a.toString()),1);window[this.settings.LearningObjectivesControlClientId].setSelectedIds(b,!0);this.triggerLearningObjectivesDescription()};d.prototype.triggerLearningObjectivesDescription=function(){var a=window[this.settings.LearningObjectivesControlClientId].selectedIds;$("#"+this.settings.AddLearningObjectiveDescriptionClientId).toggle(0==a.length)};d.prototype.getParameterByName=function(a,b){return RegExp("[?&]"+b+"=([^&]*)").exec(a)};return d}();e.ManageMultipleCriteriaPopup=
f})(f.Rubric||(f.Rubric={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function a(b){var c=this;this.showManageRubricModal=function(){$.get(c.settings.WebMethods.GetCriteria).done(function(a){var b=window[c.settings.RubricDialogClientInstanceName],g="&Ids="+a.LoIds.join(","),d="";a.UseAssessmentOrScore&&(d="&ShowCriteriaWeights=True&CriteriaWeights="+JSON.stringify(a.CriteriaWeights));b.setIframeUrl(c.settings.WebMethods.ManageRubricDialogUrl+(g+d));b.openDialog()})};this.updateCriteria=function(a){a=a.extendedData;
if(!a.updateSettings&&void 0!==a.loIds&&void 0!==a.criteriaWeights){var b={};b.LoIds=a.loIds;a.criteriaWeights&&(b.CriteriaWeights=JSON.parse(a.criteriaWeights));CCL.CommonFunctions.safeAjaxPost({url:c.settings.WebMethods.UpdateCriteria,data:b}).done(function(){e.Settings.Manager.getInstance().refreshReadView()})}};this.settings=b;window[a.clientInstanceName]=this;b=$(window);CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.assignmentShowManageRubric,function(){c.showManageRubricModal()});
CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,function(a){c.updateCriteria(a)})}a.clientInstanceName="AssignmentListenerClientInstanceName";return a}();f.AssignmentListener=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){e.makeCopy=function(e){var d=new Map;e.forEach(function(a,b,c){d.set(b,a)});return d};e.reduce=function(e,d,a){var b=a;e.forEach(function(a,g,e){b=d(b,g,a)});return b};e.mapToJsonString=function(e){var d=Object.create(null);e.forEach(function(a,b){return d[b.toString()]=a});return JSON.stringify(d)};e.jsonStringToMap=function(e,d){e=e?JSON.parse(e):{};for(var a=new Map,b=0,c=Object.keys(e);b<c.length;b++){var g=c[b];a.set(d(g),e[g])}return a};e.stringKeyConverter=function(e){return e};
e.numberKeyConverter=function(e){return parseInt(e,10)}})(f.MapUtils||(f.MapUtils={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){this.defaultLabelColor=null;this.animate=!1;e.assessmentLettersInstance=this;this.context=a;if(e.assessmentLettersInstance.context.Settings.IsMentorCanSendReminders)$("#"+e.assessmentLettersInstance.context.Controls.SendReminderButtonId).on("click",this.SendReminder);this.SetTimestamp(e.assessmentLettersInstance.context.Settings.SendDate)}a.prototype.SendReminder=function(){CCL.CommonFunctions.safeAjaxPost({url:e.assessmentLettersInstance.context.WebMethods.SendReminderUrl,
data:{termId:e.assessmentLettersInstance.context.Settings.TermId,organisationId:e.assessmentLettersInstance.context.Settings.OrganisationId}}).done(function(a){e.assessmentLettersInstance.SetTimestamp(a)}).fail(function(a,c,g){CCL.CommonFunctions.alertAjaxError(a,c,g)})};a.prototype.SetTimestamp=function(a){if(null!==a){var b=$("#"+e.assessmentLettersInstance.context.Controls.TimestampLabelId),g=b.text();b.text(CCL.CommonFunctions.formatString(e.assessmentLettersInstance.context.Settings.TimestampText,
a));g&&this.blink(b)}};a.prototype.blink=function(a){this.animate||(this.animate=!0,this.defaultLabelColor||(this.defaultLabelColor=a.css("color")),a.css("color","#F9F5BE"),a.animate({color:this.defaultLabelColor},1E3,function(){e.assessmentLettersInstance.animate=!1}))};return a}();e.TermAssessmentOverview=d})(e.Mentor||(e.Mentor={}))})(f.Assessment||(f.Assessment={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.onboardingControlUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return a}();e.FinalModalLoader=d;d=function(a){function b(b,g){a.call(this,g);this.context=b}__extends(b,a);b.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);
this.initEvents();this.$finalModalOverlayModal.overlayModal("open")};b.prototype.initEvents=function(){var a=this;$(document).on(CCL.OverlayModalEvents.hide,function(b,c){a.onOverlayModalHide(b,c)})};b.prototype.onOverlayModalHide=function(a,b){(b.closeType===CCL.OverlayModalCloseType.CloseButtonClicked||b.closeType===CCL.OverlayModalCloseType.EscapeKeyPressed)&&this.$finalModalOverlayModal.get(0).id===b.activeElement.id&&CCL.OverlayModal.instance&&CCL.OverlayModal.instance.close()};return b}(OnboardingSystem.OnboardingControl);
e.FinalModal=d})(e.Calendar||(e.Calendar={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.onboardingControlUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return a}();e.RecurringEventModalLoader=d;d=function(a){function b(b,g){a.call(this,g);this.context=b}__extends(b,a);b.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this)};
return b}(OnboardingSystem.OnboardingControl);e.RecurringEventModal=d})(e.Calendar||(e.Calendar={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.onboardingControlUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return a}();e.CalendarModalLoader=d;d=function(a){function b(b,g){a.call(this,g);this.context=b}__extends(b,a);b.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);
this.initEvents();this.$welcomeModalOverlayModal.overlayModal("open")};b.prototype.initEvents=function(){var a=this;this.$LetsGoButton.click(function(){a.onLetsGoButtonClick()});this.$NoThanksButton.click(function(){a.onNoThanksButtonClick()});$(document).on(CCL.OverlayModalEvents.hide,function(b,c){a.onOverlayModalHide(b,c)})};b.prototype.hideWelcomeModalAndCompleteFeature=function(a){CCL.CommonFunctions.safeAjax({url:this.context.OnboardingProxyUrl,type:"PUT",headers:(b={},b[this.context.AntiForgerySettings.HeaderName]=
this.context.AntiForgerySettings.HeaderValue,b)});this.raiseEvent(OnboardingSystem.ControlEvents.courseModernExistingWelcomeModalCompleted);var b};b.prototype.onLetsGoButtonClick=function(){CCL.OverlayModal.instance.close();this.hideWelcomeModalAndCompleteFeature(!1)};b.prototype.onNoThanksButtonClick=function(){CCL.OverlayModal.instance.close();this.hideWelcomeModalAndCompleteFeature(!0)};b.prototype.onOverlayModalHide=function(a,b){b.closeType!==CCL.OverlayModalCloseType.CloseButtonClicked&&b.closeType!==
CCL.OverlayModalCloseType.EscapeKeyPressed||this.$welcomeModalOverlayModal.get(0).id!==b.activeElement.id||(this.hideWelcomeModalAndCompleteFeature(!0),CCL.OverlayModal.instance&&CCL.OverlayModal.instance.close())};return b}(OnboardingSystem.OnboardingControl);e.CalendarModal=d})(e.Calendar||(e.Calendar={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.welcomeTopBannerUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.welcomeTopBannerUrl,type:"GET",cache:!1}).done(function(b,g,d){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return a}();e.WelcomeTopBannerLoader=d;d=function(a){function b(b,g){a.call(this,g);this.height=207;this.slideUpduration=1E3;this.context=b}__extends(b,a);b.prototype.init=function(){this.context.Scripts.WelcomeTopBannerDisplayMeasureKpiScript();
OnboardingSystem.onboardingManagerInstance.registerControl(this);this.$whatsNewOverlayModal=$("#"+this.context.Controls.WhatsNewOverlayModal);this.$tellMeMoreButton=$("#"+this.context.Controls.TellMeMoreButton);this.$gotItButton=$("#"+this.context.Controls.GotItButton);this.initEvents()};b.prototype.initEvents=function(){var a=this;this.$tellMeMoreButton.click(function(){a.onTellMeMoreButtonClick()});this.$gotItButton.click(function(){a.onGotItButtonClick()});$(document).on(CCL.OverlayModalEvents.hide,
function(b,c){a.onOverlayModalHide(b,c)})};b.prototype.hideTopBannerAndCompleteFeature=function(){$("#"+this.context.Controls.WelcomeTopBanner).css({"min-height":0,height:this.height}).slideUp(this.slideUpduration);CCL.CommonFunctions.safeAjax({url:this.context.OnboardingProxyUrl,type:"PUT",headers:(a={},a[this.context.AntiForgerySettings.HeaderName]=this.context.AntiForgerySettings.HeaderValue,a)});var a};b.prototype.onTellMeMoreButtonClick=function(){this.context.Scripts.WelcomeTellMeMoreMeasureKpiScript();
this.$whatsNewOverlayModal.overlayModal("open")};b.prototype.onGotItButtonClick=function(){this.context.Scripts.WelcomeGotItMeasureKpiScript();this.hideTopBannerAndCompleteFeature();this.raiseEvent(OnboardingSystem.ControlEvents.dashboardModernExistingWelcomeTopBannerAndModalCompleted)};b.prototype.onOverlayModalHide=function(a,b){this.$whatsNewOverlayModal.get(0).id===b.activeElement.id&&(this.hideTopBannerAndCompleteFeature(),this.raiseEvent(OnboardingSystem.ControlEvents.dashboardModernExistingWelcomeTopBannerAndModalCompleted))};
return b}(OnboardingSystem.OnboardingControl);e.WelcomeTopBanner=d})(e.Dashboard||(e.Dashboard={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.coursesMenuCallToActionUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.coursesMenuCallToActionUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b),a.$targetElement.find(".ccl-context-dialog-arrow").css("left",a.$targetElement.outerWidth()/2))})};return a}();e.CoursesMenuCallToActionLoader=d;d=function(a){function b(b,d){a.call(this,
d);this.context=b}__extends(b,a);b.prototype.onGotItClick=function(){$("."+this.context.Controls.CoursesMenuCallToActionId).hide()};b.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);var a=this,b=$("."+a.context.Controls.CoursesMenuCallToActionId);b.click(function(){return a.onGotItClick()});b.show();this.coursesMenuItemIsVisible()&&CCL.CommonFunctions.safeAjax({url:this.context.OnboardingProxyUrl,type:"PUT",headers:(d={},d[this.context.AntiForgerySettings.HeaderName]=
this.context.AntiForgerySettings.HeaderValue,d)});var d};b.prototype.coursesMenuItemIsVisible=function(){return $(this.context.Controls.CoursesMenuItemSelector).is(":visible")};return b}(OnboardingSystem.OnboardingControl);e.CoursesMenuCallToAction=d})(e.TopMenu||(e.TopMenu={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c,d){this.coursesMenuItemUrl=a;this.$targetElement=c;this.coursesMenuItemPageContext=d}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.coursesMenuItemUrl,type:"GET",cache:!1}).done(function(b,d,e){b&&0!==b.length&&(b=$(b),a.$targetElement.append(b),$(document).trigger("document:coursesMenuItemLoaded",a.coursesMenuItemPageContext))})};return a}();e.CoursesMenuItemLoader=d;d=function(){function a(a){e.coursesMenuItemInstance=
this;this.context=a}a.prototype.init=function(){var a=this;this.$coursesMenuItem=$(this.context.Controls.CoursesMenuItemSelector);this.$coursesMenuItem.one("click touchstart",function(){a.coursesMenuItemOnClick(a)});this.$gotItButton=$("#"+this.context.Controls.GotItButtonId);this.$gotItButton.on("click touchstart",this.gotItButtonOnClick);this.$allCoursesLink=$("."+this.context.Controls.AllCoursesLink);this.$allCoursesLink.on("click touchstart",this.allCoursesLinkClick);this.$coursesMenuItemAnchor=
this.$coursesMenuItem.children("a").first();this.$originalDropDownMenu=this.$coursesMenuItem.children(".ccl-context-dialog.ccl-dropdownmenu").first().detach();this.$onboardingSplash=$("#"+this.context.Controls.SplashPanelIdControl).detach();this.initSplash()};a.prototype.initSplash=function(){this.$coursesMenuItemAnchor.after(this.$onboardingSplash);this.$originalDropDownMenu.detach()};a.prototype.disposeSplash=function(){this.$coursesMenuItemAnchor.after(this.$originalDropDownMenu);this.$onboardingSplash.detach()};
a.prototype.updateOnboardingService=function(a){CCL.CommonFunctions.safeAjax({type:"PUT",url:a,headers:(b={},b[this.context.AntiForgerySettings.HeaderName]=this.context.AntiForgerySettings.HeaderValue,b)});var b};a.prototype.completeSplash=function(){this.updateOnboardingService(this.context.Urls.CompleteSplashFeatureUrl)};a.prototype.coursesMenuItemOnClick=function(a){a.updateOnboardingService(a.context.Urls.CompleteSplashFeatureDisplayedUrl)};a.prototype.gotItButtonOnClick=function(){var a=CCL.CommonFunctions.isMobileDevice()?
"touchstart":"click";e.coursesMenuItemInstance.completeSplash();(new Function(e.coursesMenuItemInstance.context.Functions.HideDropDowns))();e.coursesMenuItemInstance.disposeSplash();e.coursesMenuItemInstance.$coursesMenuItemAnchor.trigger(a);e.coursesMenuItemInstance.$coursesMenuItem.find(".js-titlesFilter").focus()};a.prototype.allCoursesLinkClick=function(){e.coursesMenuItemInstance.completeSplash()};return a}();e.CoursesMenuItem=d;(function(a){function b(b,d){a.call(this,b);this.coursesMenuItem=
d}__extends(b,a);return b})(OnboardingSystem.OnboardingControl)})(e.TopMenu||(e.TopMenu={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.allCoursesUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.allCoursesUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return a}();e.AllCoursesTidyUpFavouriteListLoader=d;d=function(a){function b(b,d){a.call(this,d);this.timeoutForOnboarding=8E3;this.context=b}__extends(b,a);b.prototype.onGotItClick=function(){$("#ctl00_ContentAreaIframe").contents().find("."+
this.context.Controls.AllCoursesTidyUpFavouriteListId).hide();this.isMobile()||CCL.CommonFunctions.safeAjax({url:this.context.OnboardingProxyUrl,type:"PUT",headers:(a={},a[this.context.AntiForgerySettings.HeaderName]=this.context.AntiForgerySettings.HeaderValue,a)});var a};b.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);var a=this;$("#ctl00_ContentAreaIframe").contents().find("."+a.context.Controls.AllCoursesTidyUpFavouriteListId).click(function(){return a.onGotItClick()});
$(setTimeout(function(){a.onGotItClick()},a.timeoutForOnboarding))};b.prototype.isMobile=function(){return CCL.CommonFunctions.checkScreenSize(CCL.CommonConstants.mediaScreenSizes.mobile,!1)};return b}(OnboardingSystem.OnboardingControl);e.AllCoursesTidyUpFavouriteList=d})(e.AllCourses||(e.AllCourses={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d;(function(a){a[a.Welcome=38]="Welcome";a[a.LinkToClassic=39]="LinkToClassic";a[a.Messages=40]="Messages";a[a.Courses=41]="Courses";a[a.MenuMoreButton=42]="MenuMoreButton";a[a.ClassLog=44]="ClassLog"})(d||(d={}));var a=function(){function a(a){this.settings=a;this.dialogsToShow=a.dialogClientIds.filter(function(a){return null!=window[a]}).map(function(a){return window[a]});this.dialogsHandlerMapping={};this.dialogsHandlerMapping[d.LinkToClassic]=this.getOpenCloseMoreMenuOnboardingHandlers(this.settings.classicSkoleIntraMenuItemCssClass);
this.dialogsHandlerMapping[d.Courses]=this.getOpenCloseMoreMenuOnboardingHandlers(this.settings.coursesMenuItemCssClass);this.dialogsHandlerMapping[d.MenuMoreButton]=this.getMoreMenuOnboardingHandlers();this.dialogsHandlerMapping[d.ClassLog]=this.getClassLogOnboardingHandlers(this.settings.classLogMenuItemCssClass)}a.prototype.start=function(){CCL.CommonFunctions.isPhoneScreenSize()||this.showNextDialog()};a.prototype.showNextDialog=function(){var a=this;if(0<this.dialogsToShow.length){var b=this.dialogsToShow[0];
this.dialogsToShow=this.dialogsToShow.slice(1);var d=function(){b.blockHighlightZone=!0;b.openDialog(function(c){return a.dialogCloseHandler(b,c)});a.currentlyOpenedDialog=b};if(0<b.settings.OnboardingFeatureId){var e=this.dialogsHandlerMapping[b.settings.OnboardingFeatureId];e&&"function"===typeof e.beforeOpenHandler?setTimeout(function(){e.beforeOpenHandler();setTimeout(d,200)},100):d()}else d()}};a.prototype.dialogCloseHandler=function(a,b){0<a.settings.OnboardingFeatureId&&(a=this.dialogsHandlerMapping[a.settings.OnboardingFeatureId])&&
"function"===typeof a.afterCloseHandler&&a.afterCloseHandler();this.currentlyOpenedDialog=null;b?this.registerCompletionForAll():this.showNextDialog()};a.prototype.registerCompletionForAll=function(){for(var a=0;a<this.dialogsToShow.length;a++)this.dialogsToShow[a].registerOnboardingCompletion()};a.prototype.getOpenCloseMoreMenuOnboardingHandlers=function(a){return{beforeOpenHandler:this.getCollapseExpandMoreMenuHandler(a,!1),afterCloseHandler:this.getCollapseExpandMoreMenuHandler(a,!0)}};a.prototype.getCollapseExpandMoreMenuHandler=
function(a,b){var c=this;return function(){var d=0<$("."+a).parent("#"+c.settings.moreMainMenuDropdownContainerId).length,g=b?":visible":":not(:visible)";d&&$("#"+c.settings.moreMainMenuDropdownContainerId).is(g)&&$("."+c.settings.menuContainerCssClass+" ."+c.settings.menuMoreButtonCssClass+" > ."+c.settings.menuLinkCssClass).trigger("click")}};a.prototype.getMoreMenuOnboardingHandlers=function(){return{beforeOpenHandler:this.getForceMainMenuWidthHandler(CCL.CommonConstants.mediaScreenSizes.iPadLandscapeMode+
"px",!1),afterCloseHandler:this.getForceMainMenuWidthHandler("auto",!0)}};a.prototype.getForceMainMenuWidthHandler=function(a,b){var c=this;return function(){var d=b?":visible":":not(:visible)";$("."+c.settings.menuContainerCssClass+" ."+c.settings.menuMoreButtonCssClass).is(d)&&($("."+c.settings.menuItemsCssClass).width(a),$(window).trigger("resize"))}};a.prototype.getClassLogOnboardingHandlers=function(a){var b=this;return{beforeOpenHandler:b.getCollapseExpandMoreMenuHandler(a,!1),afterCloseHandler:function(){b.getCollapseExpandMoreMenuHandler(a,
!0)();b.handleClassLogDialogBeingClosed()}}};a.prototype.handleClassLogDialogBeingClosed=function(){if(this.currentlyOpenedDialog&&this.currentlyOpenedDialog.gotItClicked){var a=$(this.settings.classlogMenuLinkSelector)[0];if(a){var b=a.href;(a=$("iframe[name="+a.target+"]")[0])&&b&&(a.src=b)}}};return a}();e.SkoleIntraTopMenuTour=a})(e.SkoleIntra||(e.SkoleIntra={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.context=b;this.controls=a;this.getExternalGrades();$(document).on(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName,function(a,b){return c.pagerEventHandler(b)})}d.prototype.refreshGrid=function(a,b){var c=this;$.post(this.context.WebMethods.GetExternalGradebookContent,{courseId:this.context.CourseId,pageIndex:a,pageSize:b}).done(function(a){null!=a&&(a=$(a),c.controls.Container.replaceWith(a),
c.controls.Container=a,c.getExternalGrades())}).fail(function(a){e.Utils.handleAjaxError(a)})};d.prototype.pagerEventHandler=function(a){a===this.context.Pager.Name&&(a=window[a],this.refreshGrid(a.pageNumber,a.pageSize))};d.prototype.getExternalGrades=function(){var a=this;$.post(this.context.WebMethods.GetExternalGradesForCourse,{courseId:this.context.CourseId}).done(function(b){null!=b&&null!=b.length&&0<b.length?a.fillGrades(b):a.clearGrades()}).fail(function(){a.clearGrades()})};d.prototype.fillGrades=
function(a){var b=this;this.controls.Container.find("[data-"+this.context.DataAttributes.LineItemSourcedId+"]").each(function(c,g){c=$(g);var e=c.data(b.context.DataAttributes.LineItemSourcedId),f=c.data(b.context.DataAttributes.PersonSourcedId),l=d.defaultCellText;$.each(a,function(a,c){if(e===c.LineItemSourcedId&&f===c.PersonSourcedId)return l=b.getCellText(c),!1});c.text(l)})};d.prototype.getCellText=function(a){var b=d.defaultCellText;null!=a.Score&&0<a.Score.length&&(b=a.Score);var c=d.defaultCellText;
null!=a.Scale&&0<a.Scale.length&&(c=a.Scale);return b+" / "+c};d.prototype.clearGrades=function(){this.controls.Container.find("[data-"+this.context.DataAttributes.LineItemSourcedId+"]").empty().text(d.defaultCellText)};d.defaultCellText="-";return d}();e.ExternalGradebook=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.context=a;this.controls=b;this.mappingTypesList.on("change",function(){return c.onMappingTypeChanged()});this.existingAssessmentsList.on("change",function(){return c.onGradeBookItemChanged()});this.existingAssessmentScalesList.on("change",function(){return c.onAssessmentScaleChanged()});this.bindButtonsToEvent()}Object.defineProperty(d.prototype,"mappingTypesList",{get:function(){return this.controls.MappingTypesList},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"existingAssessmentsList",{get:function(){return this.controls.ExistingAssessmentsList},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"existingAssessmentScalesList",{get:function(){return this.controls.ExistingAssessmentScalesList},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"currentButton",{get:function(){return this.controls.SendButton.length?this.controls.SendButton:this.controls.SaveButton},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"settings",{get:function(){return this.context.Settings},enumerable:!0,configurable:!0});d.addOrUpdateDraftItem=function(a){var b=!0;$.each(d.draftItems,function(c,d){if(a.SyncKey.toLowerCase()===d.SyncKey.toLowerCase())return d.GradeType=a.GradeType,d.AssessmentRecordItemId=a.AssessmentRecordItemId,d.AssessmentScaleId=a.AssessmentScaleId,b=!1});b&&d.draftItems.push(a)};d.getDraftItemsBySyncKeys=function(a){var b=[];$.each(a,function(a,g){$.each(d.draftItems,
function(a,c){if(c.SyncKey.toLowerCase()===g.toLowerCase())return b.push(c),!1})});return b};d.prototype.bindButtonsToEvent=function(){var a=this,b=CCL.CommonFunctions.isMobileDevice()?"touchstart":"click";if(!this.controls.SaveButton.is(":disabled"))this.controls.SaveButton.on(b,function(){return a.saveResults()});if(!this.controls.SendButton.is(":disabled"))this.controls.SendButton.on(b,function(){return a.sendResults()})};d.prototype.onMappingTypeChanged=function(){this.setControlAvailability(this.mappingTypesList,
!1);var a=parseInt(this.mappingTypesList.find("option:selected").val(),10);this.mappingTypesList.toggleClass(this.context.CssClasses.DefaultMappingType,a===this.context.Settings.MappingTypeEnum.NotLinked);var b=this.settings.LineItemsSyncKeys;switch(a){case this.context.Settings.MappingTypeEnum.NotLinked:this.hideAndClearAssessmentsDropDownList();this.hideAssessmentScalesDropDownList();this.createDraftVersion(this.context.Settings.MappingTypeEnum.NotLinked,b);break;case this.context.Settings.MappingTypeEnum.OverallAverage:this.hideAndClearAssessmentsDropDownList();
this.setButtonAvailability(!1);if(this.settings.DoesOverallAverageHaveMultipleScales)this.showAssessmentScalesDropDownList();else this.onAssessmentScaleChanged();break;case this.context.Settings.MappingTypeEnum.Assessment:case this.context.Settings.MappingTypeEnum.FinalAssessment:this.hideAssessmentScalesDropDownList();this.setButtonAvailability(!1);this.populateAndShowAssessmentsDropDownList();break;case this.context.Settings.MappingTypeEnum.Manual:this.hideAssessmentScalesDropDownList(),this.hideAndClearAssessmentsDropDownList(),
this.createDraftVersion(this.context.Settings.MappingTypeEnum.Manual,b)}this.setControlAvailability(this.mappingTypesList,!0)};d.prototype.onGradeBookItemChanged=function(){this.setControlAvailability(this.existingAssessmentsList,!1);var a=parseInt(this.existingAssessmentsList.find("option:selected").val(),10);if(a!==this.context.Settings.ExistingAssessmentDefaultValue){this.setControlAvailability(this.mappingTypesList,!1);var b=parseInt(this.mappingTypesList.find("option:selected").val(),10);this.createDraftVersion(b,
this.settings.LineItemsSyncKeys,a);this.setControlAvailability(this.mappingTypesList,!0)}else this.setButtonAvailability(!1);this.setControlAvailability(this.existingAssessmentsList,!0)};d.prototype.hideAndClearAssessmentsDropDownList=function(){this.controls.ExistingAssessmentsList.hide().empty()};d.prototype.populateAndShowAssessmentsDropDownList=function(){this.controls.ExistingAssessmentsList.empty();var a=parseInt(this.controls.MappingTypesList.find("option:selected").val(),10),b={courseId:this.settings.CourseId,
termId:this.settings.TermId};a===this.context.Settings.MappingTypeEnum.Assessment?this.populateGradebookItemsList(this.context.WebMethods.GetNormalAssessments,b):a===this.context.Settings.MappingTypeEnum.FinalAssessment&&this.populateGradebookItemsList(this.context.WebMethods.GetFinalAssessments,b);this.controls.ExistingAssessmentsList.show()};d.prototype.onAssessmentScaleChanged=function(){this.setControlAvailability(this.existingAssessmentScalesList,!1);var a=parseInt(this.existingAssessmentScalesList.find("option:selected").val(),
10);a!==this.context.Settings.AssessmentScaleDefaultValue?(this.setControlAvailability(this.mappingTypesList,!1),this.createDraftVersion(this.context.Settings.MappingTypeEnum.OverallAverage,this.settings.LineItemsSyncKeys,null,a),this.setControlAvailability(this.existingAssessmentScalesList,!0)):this.setButtonAvailability(!1);this.setControlAvailability(this.existingAssessmentScalesList,!0)};d.prototype.showAssessmentScalesDropDownList=function(){this.existingAssessmentScalesList.show()};d.prototype.hideAssessmentScalesDropDownList=
function(){this.existingAssessmentScalesList.hide()};d.prototype.populateGradebookItemsList=function(a,b){var c=this;$.get(a,b).done(function(a){c.controls.ExistingAssessmentsList.append($("<option />").val(c.context.Settings.ExistingAssessmentDefaultValue.toString()).text(c.context.LanguageTerms.ExistingAssessmentDefaultText));$.each(a,function(a,b){c.controls.ExistingAssessmentsList.append($("<option />").val(b.GradeBookItemId.toString()).text(b.Title))})}).fail(function(a){e.Utils.handleAjaxError(a)})};
d.prototype.createDraftVersion=function(a,b,c,g){null==c&&(c=this.context.Settings.ExistingAssessmentDefaultValue);null==g&&(g=this.context.Settings.AssessmentScaleDefaultValue);$.each(b,function(b,e){d.addOrUpdateDraftItem({SyncKey:e,GradeType:a,AssessmentRecordItemId:c,AssessmentScaleId:g})});this.updateGradingPeriodSection();e.LineItemsResults.refreshGrid(this.settings.AggregatedSyncItemId)};d.prototype.setButtonAvailability=function(a){this.setControlAvailability(this.currentButton,a)};d.prototype.setControlAvailability=
function(a,b){b?a.removeAttr("disabled"):a.attr("disabled","disabled")};d.prototype.disableMappingControls=function(){this.setControlAvailability(this.mappingTypesList,!1);this.setControlAvailability(this.existingAssessmentsList,!1);this.setControlAvailability(this.existingAssessmentScalesList,!1);this.currentButton.addClass(this.context.CssClasses.ButtonWithLoader)};d.prototype.enableMappingControls=function(){this.setControlAvailability(this.mappingTypesList,!0);this.setControlAvailability(this.existingAssessmentsList,
!0);this.setControlAvailability(this.existingAssessmentScalesList,!0);this.currentButton.removeClass(this.context.CssClasses.ButtonWithLoader);this.currentButton.blur()};d.prototype.sendResults=function(){this.handleButtonClick(this.context.WebMethods.SendResults,{courseId:this.settings.CourseId,lineItemIds:this.settings.LineItemsSyncKeys})};d.prototype.saveResults=function(){this.handleButtonClick(this.context.WebMethods.SaveResults,{courseId:this.settings.CourseId,termId:this.settings.TermId,draftItems:d.getDraftItemsBySyncKeys(this.settings.LineItemsSyncKeys)})};
d.prototype.handleButtonClick=function(a,b){var c=this;this.currentButton.is(":disabled")||(this.disableMappingControls(),$.post(a,b).done(function(a){var b=c.controls.InformationFeedbackPlaceholder.offset();c.updateGradingPeriodSection();e.LineItemsResults.refreshGrid(c.settings.AggregatedSyncItemId);a&&a.feedbackMessage&&0<a.feedbackMessage.length&&$(document).trigger(e.GradeExport.showFeedbackEventTitle,[a.feedbackMessage,b]);c.enableMappingControls()}).fail(function(a){e.Utils.handleAjaxError(a);
c.enableMappingControls()}))};d.prototype.updateGradingPeriodSection=function(a,b){void 0===a&&(a=!0);void 0===b&&(b=!1);e.GradingPeriod.refreshSection(this.context.Settings.GradingPeriodId,a,b)};d.draftItems=[];return d}();e.AggregatedSyncItem=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(a,b,c,d,e,f,l){this.courseId=a;this.assessmentRecordId=b;this.termId=c;this.gradingPeriodId=d;this.isExpanded=f;this.isSentAreaExpanded=l;this.draftLineItemGradeTypes=e}}(),d=function(){function a(b,c){var d=this;this.context=b;this.controls=c;b=CCL.CommonFunctions.isMobileDevice()?"touchstart":"click";this.controls.GradingPeriodsSectionHeader.on(b,function(){return d.onGradingPeriodsHeaderClick()});this.controls.SentLineItemsSectionHeader.on(b,
function(){return d.onSentLineItemsHeaderClick()});$(document).off(a.getUpdateSectionEventTitle(this.context.Settings.GradingPeriodId));$(document).on(a.getUpdateSectionEventTitle(this.context.Settings.GradingPeriodId),function(a,b,c,g){return d.updateGradingPeriodSection(b,c,g)})}a.prototype.onGradingPeriodsHeaderClick=function(){this.controls.AllLineItemsSection.slideToggle("slow");this.controls.GradingPeriodsSection.toggleClass(this.context.CssClasses.GradingPeriodSectionCollapsedClass);this.controls.GradingPeriodsSectionHeader.toggleClass(this.context.CssClasses.GradingPeriodSectionHeaderCollapsedClass)};
a.prototype.onSentLineItemsHeaderClick=function(){this.controls.SentLineItems.slideToggle("slow");this.controls.SentLineItemsSectionHeader.toggleClass(this.context.CssClasses.SentLineItemsSectionHeaderCollapsedClass)};a.getUpdateSectionEventTitle=function(b){return""+a.updateSectionEventTitle+b};a.refreshSection=function(b,c,d){void 0===c&&(c=!0);void 0===d&&(d=!1);$(document).trigger(a.getUpdateSectionEventTitle(b),[c,d,e.AggregatedSyncItem.draftItems])};a.prototype.updateGradingPeriodSection=function(a,
c,d){var b=this,g=!this.controls.GradingPeriodsSection.hasClass(this.context.CssClasses.GradingPeriodSectionCollapsedClass),l=!this.controls.SentLineItemsSectionHeader.hasClass(this.context.CssClasses.SentLineItemsSectionHeaderCollapsedClass);a=new f(this.context.Settings.CourseId,this.context.Settings.AssessmentRecordId,this.context.Settings.TermId,this.context.Settings.GradingPeriodId,d,g||a,l||c);$.post(this.context.WebMethods.GradingPeriod,a).done(function(a){a&&0!==a.length&&(a=$(a),$(b.controls.GradingPeriodsSection).replaceWith(a),
$(b.controls.GradingPeriodsSection).removeClass(b.context.CssClasses.GradingPeriodSectionCollapsedClass))}).fail(function(a){e.Utils.handleAjaxError(a)})};a.updateSectionEventTitle="GradingPeriod:UpdateGradingPeriodSection";return a}();e.GradingPeriod=d})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(a,c,d,e,f){this.courseId=a;this.personId=c;this.lineItemSyncKey=d;this.scoreListItemExtensionId=e;this.currentScore=f}}(),d=function(){return function(a,c,d,e,f,l){void 0===f&&(f="");void 0===l&&(l="");this.courseId=a;this.assessmentRecordId=c;this.termId=d;this.studentNameSearchText=f;this.selectedAggregatedLineItemId=l;this.draftLineItemGradeTypes=e}}(),a=function(){function a(b,g){var c=this;this.context=g;this.controls=b;this.initSearch();
$(document).off(a.refreshGridEventTitle);$(document).on(a.refreshGridEventTitle,function(a,b){return c.updateLineItemsResultsSection(new d(c.context.Settings.CourseId,c.context.Settings.AssessmentRecordId,c.context.Settings.TermId,e.AggregatedSyncItem.draftItems,"",b))})}a.refreshGrid=function(b){$(document).trigger(a.refreshGridEventTitle,b)};a.prototype.initSearch=function(){var a=this;this.controls.SearchImage.on("click",function(){return a.onSearchStudentClick()});this.controls.SearchInput.on("keydown",
function(b){return a.onSearchInputKeyDown(b)})};a.prototype.onSearchStudentClick=function(){this.searchStudents(this.controls.SearchInput.val())};a.prototype.preventEventPropagation=function(a){a.cancelBubble=!0;a.returnValue=!1;a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation()};a.prototype.onSearchInputKeyDown=function(a){a.keyCode===CCL.CommonConstants.keyCodes.enter&&(this.preventEventPropagation(a),this.searchStudents($(a.target).val()))};a.prototype.searchStudents=function(a){this.updateLineItemsResultsSection(new d(this.context.Settings.CourseId,
this.context.Settings.AssessmentRecordId,this.context.Settings.TermId,e.AggregatedSyncItem.draftItems,a?a:""))};a.prototype.updateLineItemsResultsSection=function(a){var b=this;$.post(this.context.WebMethods.LineItemsResults,a).done(function(c){if(c&&0!==c.length){var d=b.controls.SearchInput.attr("id");c=$(c);b.controls.LineItemsResultsTable.parent().empty().prepend(c);a.studentNameSearchText&&$("#"+d).val(a.studentNameSearchText)}}).fail(function(a){e.Utils.handleAjaxError(a)})};a.prototype.handleAjaxError=
function(a){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&a.responseText&&alert(a.responseText)};a.refreshGridEventTitle="LineItemsResults:refreshGrid";return a}();e.LineItemsResults=a;a=function(){function a(a,b){var c=this;this.lineItemCellSelectionChangedEventName="LineItemResultCell:LineItemCellSelectionChanged";this.controls=a;this.context=b;this.isSelected=!1;a=CCL.CommonFunctions.isMobileDevice();this.controls.LineItemResultCell.on(a?"touchstart":"click",function(){return c.focusCell()});
if(!a)this.controls.LineItemResultCell.on("mouseenter",function(){return c.focusCell()});this.controls.LineItemResultCell.focus(function(){return c.onLineitemResultCellFocus()});this.controls.LineItemResultCell.find("*").addBack().blur(function(){return c.onLineitemResultCellBlur()});$(document).on(this.lineItemCellSelectionChangedEventName,function(a,b){c.isSelected&&b!==c.controls.LineItemResultCell.attr("id")&&c.controls.LineItemResultCell.blur()});this.controls.AssessmentScaleItemsList.on("change",
function(a){return c.onAssessmentScaleItemChanged(a)})}a.prototype.focusCell=function(){this.isSelected||this.controls.LineItemResultCell.focus()};a.prototype.onLineitemResultCellFocus=function(){this.isSelected||($(document).trigger(this.lineItemCellSelectionChangedEventName,this.controls.LineItemResultCell.attr("id")),this.controls.LineItemResultCell.addClass(this.context.CssClasses.SelectedCellCssClass),this.controls.LineItemResultCell.height(this.controls.LineItemResultCell.innerHeight()),this.isSelected=
!0)};a.prototype.onLineitemResultCellBlur=function(){var a=this;setTimeout(function(){var b=$(document.activeElement);b.is(a.controls.LineItemResultCell)||0!==a.controls.LineItemResultCell.has(b).length||(a.controls.LineItemResultCell.removeClass(a.context.CssClasses.SelectedCellCssClass),a.controls.LineItemResultCell.css("height",""),a.isSelected=!1)},0)};a.prototype.onAssessmentScaleItemChanged=function(a){a=$(a.target);a.attr("disabled","disabled");var b=this.controls.AssessmentScaleItemsList.val();
b=new f(this.context.Settings.CourseId,this.context.Settings.PersonId,this.context.Settings.LineItemSyncKey,b,this.context.Settings.CurrentScore);this.setCustomScoreListItemExtensionForPerson(b);a.removeAttr("disabled")};a.prototype.setCustomScoreListItemExtensionForPerson=function(a){var b=this;a=JSON.stringify(a);$.ajax({type:"POST",url:this.context.WebMethods.SetCustomScoreListItemExtensionForPerson,data:a,dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(){b.controls.AssessmentScaleCurrentItemLabel.text(b.controls.AssessmentScaleItemsList.find("option:selected").text())}).fail(function(a){e.Utils.handleAjaxError(a)})};
return a}();e.LineItemResultCell=a})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){}d.handleAjaxError=function(a){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&(null!=a.responseText&&0<a.responseText.length||null!=a.statusText&&0<a.statusText.length)&&alert(null!=a.responseText&&0<a.responseText.length?a.responseText:a.statusText)};return d}();e.Utils=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;window[a]=this;this.settings=b;$(b.AccordionSelector+" "+b.SectionSelector).click(function(a){c.ShowFeedbackItems(a)})}d.prototype.ShowFeedbackItems=function(a){a=$(a.currentTarget);if(!a.data(this.settings.AccordionSectionLoadedDataAttribute)){a.data(this.settings.AccordionSectionLoadedDataAttribute,!0);var b=a.find(this.settings.ContentSelector);a=b.children().first().data(this.settings.CourseIdDataAttribute);$.ajax({type:"GET",
url:this.settings.WebMethod,data:a?{courseId:a,termId:this.settings.TermId,personId:this.settings.PersonId,personCustomerId:this.settings.PersonCustomerId,reportRoleEnumValue:this.settings.ReportRoleEnumValue,readOnly:this.settings.ReadOnly,returnUrl:this.settings.ReturnUrl,linksTarget:this.settings.LinksTarget}:{termId:this.settings.TermId,personId:this.settings.PersonId},success:function(a,d,e){b.empty().append($(a))},error:function(a,d,e){b.empty();CCL.CommonFunctions.alertAjaxError(a,d,e)}})}};
return d}();e.PersonAssessment=f})(f.Person||(f.Person={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.planLoadingProcessId=null;window[a]=this;d.instanceName=a;this.settings=b;this.terms=b.Terms;this.css=b.Css;this.webMethods=b.WebMethods;this.currentDisplayMode=b.CurrentDisplayMode;$("."+this.css.ExpanderLink).click(function(a){c.expanderLinkClick(a)});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.MultipleSwitcher.onClickEventName,function(a){a=parseInt(a.extendedData.Key);a!==c.currentDisplayMode&&(c.currentDisplayMode=
a,c.toggleEnableDisplayModeSwitcher(!1),CCL.CommonFunctions.safeAjaxPost({url:c.webMethods.TogglePlannerDisplayMode,data:{plannerDisplayMode:c.currentDisplayMode}}).done(function(){c.toggleEnableDisplayModeSwitcher(!0);c.refreshExpandedGrids()}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d);c.toggleEnableDisplayModeSwitcher(!0)}))});setTimeout(function(){c.startLoadingMonitor()},100)}d.getInstance=function(){return window[d.instanceName]};d.prototype.openViewCellContentDialog=function(a,
b,c,d,e,f){b=b||window.event;b=b.target||b.srcElement;b&&0<$(b).closest("a,input,button,textarea").length||(b=window[this.settings.ViewHtmlTextCellContentDialog],null!=b&&null!=this.webMethods.GetPlanHtmlTextCellContent&&(b.setAjaxUrl(this.webMethods.GetPlanHtmlTextCellContent,{courseId:c,planId:d,columnId:e,childId:0,filterPersonId:f}),a=$(a).closest("."+this.css.TableCell).children("."+this.css.PlanCellTitle).text(),b.setTitle(a),b.openDialog()))};d.prototype.expanderLinkClick=function(a){a.preventDefault();
a=$(a.currentTarget);var b=a.parent(),c=a.closest("."+this.css.CoursePlansContainer).find("."+this.css.Plans),d=a.data("grid");d=window[d];b.toggleClass(this.css.Expanded);b.hasClass(this.css.Expanded)?(this.refreshPlanGrid(d),a.prop("title",this.terms.CollapseTooltip)):a.prop("title",this.terms.ExpandTooltip);c.slideToggle("fast")};d.prototype.refreshExpandedGrids=function(){var a=this;$("."+this.css.ExpanderLink).each(function(b,c){c=$(c);b=c.parent();c=c.data("grid");c=window[c];c.ajaxSettings.dataSourceWebMethodParams.currentDisplayMode=
a.currentDisplayMode;c.setMode(a.currentDisplayMode===a.settings.DisplayModes.Table?a.css.GridViewModes.TableView:a.css.GridViewModes.DefaultView);b.hasClass(a.css.Expanded)&&a.refreshPlanGrid(c)})};d.prototype.refreshPlanGrid=function(a){if(a.isLoadingInProgress())return!1;this.startLoadingMonitor();a.refresh()};d.prototype.startLoadingMonitor=function(){var a=this;if(null==this.planLoadingProcessId){this.toggleEnableDisplayModeSwitcher(!1);var b=$("."+this.css.ExpanderLink);this.planLoadingProcessId=
setInterval(function(){var c=!0;b.each(function(a,b){a=$(b).data("grid");if(window[a].isLoadingInProgress())return c=!1});c&&(clearTimeout(a.planLoadingProcessId),a.planLoadingProcessId=null,a.toggleEnableDisplayModeSwitcher(!0))},500)}};d.prototype.toggleEnableDisplayModeSwitcher=function(a){window[this.settings.DisplayModeSwitcher].toggleEnableSwitcher(a)};return d}();e.AggregatedPlanner=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(b,d){var c=this;window[b]=this;a.clientInstanceName=b;this.settings=d;this.inlineEditorOptions={multiline:{multiline:!0,autoResize:!0,editFieldCssClass:this.settings.Css.EditModeTextboxMultiline,watermarkCssClass:this.settings.Css.Watermark},singleline:{submitOnEnter:!0,editFieldAutoWidth:!1,editFieldCssClass:this.settings.Css.EditModeTextboxSingleline,watermarkCssClass:this.settings.Css.Watermark,editFieldDisplayInline:!0}};
$(function(){var a={};a[e.PlannerConstants.events.HybridEditorItemInlineModeChanged]=function(a,b){c.onColumnInlineModeChanged(a,b)};a[e.PlannerConstants.events.HybridEditorItemTextUpdated]=function(a,b){c.onColumnTextUpdated(a,b)};a[e.PlannerConstants.events.HybridEditorItemAjaxError]=function(a,b){c.onAjaxError(a,b)};a[e.PlannerConstants.events.HybridEditorItemSaveError]=function(a,b){c.onSaveError(a,b)};$(document).on(a,"div["+e.PlannerConstants.dataAttributes.HybridEditorItem+"]")})}a.prototype.replaceMediaContentWithPlaceholders=
function(){return!1};a.prototype.getSettings=function(a){var b=this.settings.Css.Watermark;switch(a.Type){case e.ClientColumnType.TopicTitle:var c=this.settings.WebMethods.UpdateTopicTitle;var d={courseId:this.settings.CourseId,topicId:a.EntityId};var f="inline";var k=this.settings.Terms.TopicTitleWatermark;b="";break;case e.ClientColumnType.TopicDescription:c=this.settings.WebMethods.UpdateTopicDescription;d={courseId:this.settings.CourseId,topicId:a.EntityId};f="hybrid";k=this.settings.Terms.ClickToAddText;
break;case e.ClientColumnType.PlanDescription:c=this.settings.WebMethods.UpdatePlanDescription;d={courseId:this.settings.CourseId,planId:a.EntityId,replaceElementsWithPlaceholders:a.IsPlanColumn&&this.replaceMediaContentWithPlaceholders()};f="hybrid";k=this.settings.Terms.PlanDescriptionWatermark;break;case e.ClientColumnType.PlanTitle:c=this.settings.WebMethods.UpdatePlanTitle;d={courseId:this.settings.CourseId,planId:a.EntityId};f="inline";k=this.settings.Terms.PlanTitleWatermark;b="";break;case e.ClientColumnType.ClassHours:c=
this.settings.WebMethods.UpdateClassHours;d={courseId:this.settings.CourseId,planId:a.EntityId};f="inline";k="0";b="";break;default:c=this.settings.WebMethods.UpdateCustomColumnContent,f="hybrid",k=this.settings.Terms.ClickToAddText,d={courseId:this.settings.CourseId,columnId:a.ColumnId,entityId:a.EntityId,replaceElementsWithPlaceholders:a.IsPlanColumn&&this.replaceMediaContentWithPlaceholders()}}return{hybridEditorClientId:this.settings.HybridEditorClientId,editModeEnabled:f,webMethodParams:d,saveContentWebUrl:c,
inlineEditorOptions:this.getInlineEditorOptions(a),editorDialogTitle:this.settings.Terms.Edit+" "+a.ColumnTitle,textContainerWatermark:k,textContainerWatermarkCssClass:b}};a.prototype.getInlineEditorOptions=function(b){var c=this.inlineEditorOptions.singleline;this.isMultilineColumn(b.Type)?c=this.inlineEditorOptions.multiline:b.Type===e.ClientColumnType.PlanTitle?c=$.extend({},this.inlineEditorOptions.singleline,a.planTitleMaxLength):b.Type===e.ClientColumnType.ClassHours&&(c=$.extend({},this.inlineEditorOptions.singleline,
a.classHoursMaxLength));return c};a.prototype.isMultilineColumn=function(a){return a===e.ClientColumnType.TopicDescription||a===e.ClientColumnType.PlanDescription||a===e.ClientColumnType.RichText};a.prototype.onColumnInlineModeChanged=function(a,b){a=$("#"+a.target.id);var c=this.getColumnData(a);c&&(b.isEditMode||b.isNewTextSaved||c.Type!==e.ClientColumnType.ClassHours||this.removeErrorControlFromCell(a))};a.prototype.onSaveError=function(a,b){a=$("#"+a.target.id);b=b.errorText;var c=this.getColumnData(a);
c&&b&&b.length&&c.Type===e.ClientColumnType.ClassHours&&!this.getErrorControl(a).length&&(a.append(this.renderErrorControl(b)),a.addClass(this.settings.Css.Error))};a.prototype.onAjaxError=function(a,b){b.xhrObject.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&alert(b.xhrObject.responseText?CCL.CommonFunctions.htmlDecode(b.xhrObject.responseText):this.settings.Terms.ErrorMessage)};a.prototype.onColumnTextUpdated=function(a,b){a=$("#"+a.target.id);var c=this.getColumnData(a);a&&(c&&c.Type===
e.ClientColumnType.ClassHours&&this.removeErrorControlFromCell(a),this.updateNoPrintContent(a,b.html),c.Type===e.ClientColumnType.TopicTitle&&b.customData&&e.PlannerUtility.updateTopicFolderNode(b.customData.folderId,b.customData.folderName),this.measureKpiEditPlan())};a.prototype.removeErrorControlFromCell=function(a){var b=this.getErrorControl(a);b.length&&($(a).removeClass(this.settings.Css.Error),b.remove())};a.prototype.updateNoPrintContent=function(a,b){a.closest("."+this.settings.Css.CellWrapper).toggleClass(this.settings.Css.NoPrint,
0===$.trim(b).length)};a.prototype.getErrorControl=function(a){return $(a).children("div.error")};a.prototype.renderErrorControl=function(a){return"<div class='error'>"+a+"</div>"};a.planTitleMaxLength=255;a.classHoursMaxLength=5;a.hybridEditorItemIdDataAttr="hybrid-editor-item-id";return a}();d.PlannerInlineCellBase=a})(f.InlineCell||(f.InlineCell={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(a){function b(b,c){a.call(this,b,c)}__extends(b,a);b.prototype.getEditorItemSettings=function(b){b=$("#"+b);b=this.getColumnData(b);return a.prototype.getSettings.call(this,b)};b.prototype.measureKpiEditPlan=function(){e.CbPlanner.getInstance().measureEditPlan()};b.prototype.getColumnData=function(a){var b=a.closest("."+this.settings.Css.CbCellContainer),c=a.closest("."+this.settings.Css.CbPlanContainer);a=parseInt(b.data(e.PlannerConstants.dataAttributes.ColumnId),
10);var d=parseInt(b.data(e.PlannerConstants.dataAttributes.ColumnType),10);c=parseInt(c.data(e.PlannerConstants.dataAttributes.PlanId),10);b=b.data(e.PlannerConstants.dataAttributes.ColumnTitle);return{ColumnId:a,Type:d,IsPlanColumn:!0,EntityId:c,ColumnTitle:b}};return b}(d.PlannerInlineCellBase);d.PlannerCBInlineCell=a})(f.InlineCell||(f.InlineCell={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(){function a(a){var b=this;this.settings=a;this.terms=a.Terms;this.css=a.Css;this.contextDialog=new ContextDialog("#"+this.settings.TimeSpanPickerContentPanelId,{title:this.terms.DateContextDialogTitle,footerContent:this.settings.TimeSpanPickerFooterPanelId,setFocus:!1,width:592,zIndex:5});this.closeContextDialog=this.contextDialog.closeDialog;$(function(){b.contextDialog.setCloseFunction(function(a){return b.completeEditPlanDate(a)});
$(document).on("click","."+b.css.EditPlanTimeSpan,function(a){b.contextDialog.mainContainer.is(":visible")||b.editPlanDate(a)});$("#"+b.settings.CloseContextDialogButton).click(function(){return b.contextDialog.closeDialog()})})}a.prototype.editPlanDate=function(a){var b=this,c=$(a.currentTarget),d=this.getDatePicker();this.contextDialog.mainContainer.removeClass(this.css.CellError);this.currentPlanId=this.getCurrentPlanId(c);c=c.parent().find("input:hidden");var e=eval("("+c.val()+")");this.setDefaultDate(d,
c);d.setShowPopUpCallback(function(){b.openContextDialog(a);b.contextDialog.mainContainer.find(":radio:checked:first").focus()});d.showTimeSpan(e,this.currentPlanId)};a.prototype.completeEditPlanDate=function(a){var b=this;if(!a||!$(a.target).parents().andSelf().hasClass("ui-datepicker")){switch(this.getDatePicker().getCurrentMode()){case e.DatePickerMode.TimeSpan:var c=this.updatePlanTimeSpan(this.currentPlanId);break;case e.DatePickerMode.WeekAndDay:c=this.updatePlanWeekAndDay(this.currentPlanId);
break;case e.DatePickerMode.Event:c=this.updatePlanEvents(this.currentPlanId)}c&&c.always(function(){return b.focusOnDateEditAction(b.currentPlanId)})}};a.prototype.closeDatePicker=function(){this.closeContextDialog()};a.prototype.getDatePicker=function(){return window[this.settings.TimeSpanPickerInstanceName]};return a}();a.PlanDateCellBase=b})(d.DateCell||(d.DateCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(a){function b(b){a.call(this,b);this.courseId=b.CourseId;this.$contentBlockContainer=$("#"+b.ContentBlockClientId);this.cbPlanner=e.CbPlanner.getInstance()}__extends(b,a);b.prototype.updatePlanTimeSpan=function(a){var b=this,c=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanTimeSpan,data:{courseId:this.courseId,planId:a,start:c.getStartDate(),stop:c.getStopDate(),filterStartDate:this.cbPlanner.getFilterStartDate(),
filterStopDate:this.cbPlanner.getFilterStopDate()}}).done(function(a){a?b.finalizeUpdateDate(a):c.showErrorMsg(e.DatePickerMode.TimeSpan)}).fail(function(){c.showErrorMsg(e.DatePickerMode.TimeSpan)})};b.prototype.updatePlanWeekAndDay=function(a){var b=this,c=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanWeekAndDay,data:{courseId:this.courseId,planId:a,start:c.getStartWeek(),stop:c.getStopWeek(),filterStartDate:this.cbPlanner.getFilterStartDate(),
filterStopDate:this.cbPlanner.getFilterStopDate()}}).done(function(a){a?b.finalizeUpdateDate(a):c.showErrorMsg(e.DatePickerMode.WeekAndDay)}).fail(function(){c.showErrorMsg(e.DatePickerMode.WeekAndDay)})};b.prototype.updatePlanEvents=function(a){var b=this,c=this.getDatePicker(),d=c.getEvents();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanEvents,data:{courseId:this.courseId,planId:a,activityIds:d,filterStartDate:this.cbPlanner.getFilterStartDate(),filterStopDate:this.cbPlanner.getFilterStopDate()}}).done(function(a){a?
b.finalizeUpdateDate(a):c.showErrorMsg(e.DatePickerMode.Event)}).fail(function(){c.showErrorMsg(e.DatePickerMode.Event)})};b.prototype.setDefaultDate=function(a,b){this.getDatePicker().setDefaultDate(this.cbPlanner.getFilterStartDate())};b.prototype.openContextDialog=function(a){var b=$(a.target).closest("."+this.settings.Css.CellContent);a=b.position();b=b.offset();this.contextDialog.openDialogAt(a.left+b.left+10,a.top+b.top-70,!1)};b.prototype.focusOnDateEditAction=function(a){$("."+this.css.EditPlanTimeSpan).focus()};
b.prototype.updateContent=function(a,b){a=$("."+this.settings.Css.PlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.css.CellContent);var c=a.parent();a.replaceWith(b);this.cbPlanner.toggleTooltipForField(c.find("."+this.css.CellContent),!0,this.settings.Terms.Tooltip)};b.prototype.getCurrentPlanId=function(a){return parseInt(a.closest("."+this.settings.Css.PlanContainer).data(e.PlannerConstants.dataAttributes.PlanId).toString(),10)};b.prototype.finalizeUpdateDate=
function(a){this.closeDatePicker();a.hidePlan?(this.showFeedback(a.message,a.extraButtonText,a.navigationUrl,a.periodStartDate),this.hidePlan(a.planId)):this.updateContent(a.planId,a.dateCell)};b.prototype.showFeedback=function(a,b,c,d){var e=this;CCL.InformationFeedback.showFeedbackWithextraButton(this.$contentBlockContainer,a,b,function(){c?window.location.href=c:d&&e.cbPlanner.changeDatePeriod(d);CCL.InformationFeedback.hideFeedback(e.$contentBlockContainer)})};b.prototype.hidePlan=function(a){1<
$("."+this.settings.Css.PlanContainer).length?$("."+this.settings.Css.PlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).remove():this.cbPlanner.reloadPlans()};return b}(a.PlanDateCellBase);a.PlanCbDateCell=b})(d.DateCell||(d.DateCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(){function a(b,c,d){var e=this;a.clientInstanceName=b;window[b]=this;this.settings=c;this.$plannerContainer=d;$(function(){e.loSelector=window[e.settings.LearningObjectiveSelectorInstanceName];e.attachEvents()})}a.getPlanLearningObjectivesCellInstance=function(){return window[a.clientInstanceName]};a.prototype.updateContent=function(a,b){this.getLearningObjectivesListCell(b).html(a)};a.prototype.updateLearningObjectives=
function(a){var b=this,c=this.currentPlanId;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.AddPlanLearningObjectives,data:{courseId:this.settings.CourseId,learningObjectiveIds:a,planId:c}}).done(function(a){a&&b.updateContent(a.ControlHtml,c)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.removeLOFromPlan=function(a,b,c){a={courseId:this.settings.CourseId,planId:a,learningObjectiveId:b};void 0!=c&&(a.showCollapsedList=c);return CCL.CommonFunctions.safeAjax({type:"DELETE",
url:this.settings.WebMethods.RemovePlanLearningObjective,data:a}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.attachEvents=function(){var a=this;this.$plannerContainer.on("click","."+this.settings.Css.AddLearningObjectives,function(b){a.currentPlanId=a.getCurrentPlanId($(b.currentTarget));a.loSelector.setSelectedIds(a.getLearningObjectiveIds(a.currentPlanId,!1),!0);a.loSelector.openDialog()});$(document).on("click","."+this.settings.Css.RemoveLearningObjective,function(b){b=$(b.currentTarget);
a.removeLearningObjective(b)})};a.prototype.getLearningObjectiveDataAttribute=function(a){return a?e.PlannerConstants.dataAttributes.RepositoryLearningObjectiveId:e.PlannerConstants.dataAttributes.LearningObjectiveId};return a}();a.PlanLearningObjectivesCellBase=b})(d.LearningObjectivesCell||(d.LearningObjectivesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(a){function b(b,c){a.call(this,b,c,e.CbPlanner.getInstance().getContainer())}__extends(b,a);b.prototype.removeLearningObjective=function(b){var c=this,d=this.getCurrentPlanId(b),g=parseInt(b.closest("."+this.settings.Css.LearningObjectivesListItem).data(e.PlannerConstants.dataAttributes.LearningObjectiveId),10);a.prototype.removeLOFromPlan.call(this,d,g).done(function(){b.closest("."+c.settings.Css.LearningObjectivesListItem).remove()})};
b.prototype.getCurrentPlanId=function(a){a=a.closest("."+this.settings.Css.CbPlanContainer);return parseInt(a.data(e.PlannerConstants.dataAttributes.PlanId),10)};b.prototype.getLearningObjectivesListCell=function(a){return $("."+this.settings.Css.CbPlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.settings.Css.AddLearningObjectives).closest("."+this.settings.Css.CbCellContainer)};b.prototype.getLearningObjectiveIds=function(a,b){a=this.getLearningObjectivesListCell(a);
var c=this.getLearningObjectiveDataAttribute(b);b=a.find("."+this.settings.Css.LearningObjectivesListItem+CCL.CommonFunctions.getDataSelector(c));return $.map(b,function(a){return parseInt($(a).data(c),10)})};return b}(a.PlanLearningObjectivesCellBase);a.PlanCbLearningObjectivesCell=b})(d.LearningObjectivesCell||(d.LearningObjectivesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(a,b){this.planId=a;this.columnId=b}}();e.PlanColumnId=f;var d=function(){function a(b,c){var d=this;window[b]=this;a.instanceName=b;this.settings=c;this.events=c.Events;this.css=c.Css;this.webMethods=c.WebMethods;this.terms=c.Terms;this.data=c.DataAttributes;this.currentDisplayMode=c.CurrentDisplayMode;this.kpi=c.Kpi;this.courseId=this.settings.CourseId;this.container=$("#"+c.Controls.ContainerId);this.plannerFilter=$("#"+c.Controls.PlannerFilterId);
this._ajaxLoader=$("#"+c.Controls.AjaxLoader);this._ajaxLoaderOverlay=$("#"+c.Controls.AjaxLoaderOverlay);setTimeout(function(){d.showNoTopicMessageIfNecessary()},0);var f=this;if(this.settings.Events&&this.settings.Events.TimelineControlInitialized&&this.currentDisplayMode===this.settings.DisplayModes.Timeline)$(document).on(this.settings.Events.TimelineControlInitialized,function(){d.toggleEnableDisplayModeSwitcher(!1);d.toggleTimelineMode(!0);d.toggleEnableDisplayModeSwitcher(!0)});CCL.CommonFunctions.attachPostMessageEventListener($(window),
CCL.MultipleSwitcher.onClickEventName,function(a){a=parseInt(a.extendedData.Key);a!==f.currentDisplayMode&&(f.currentDisplayMode=a,null!=f.webMethods&&null!=f.webMethods.Common&&null!=f.webMethods.Common.TogglePlannerDisplayMode?(f.toggleEnableDisplayModeSwitcher(!1),CCL.CommonFunctions.safeAjaxPost({url:f.webMethods.Common.TogglePlannerDisplayMode,data:{courseId:f.settings.CourseId,plannerDisplayMode:f.currentDisplayMode,childId:f.settings.ChildId}}).done(function(){f.toggleEnableDisplayModeSwitcher(!0);
f.changeDisplayMode()}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c);f.toggleEnableDisplayModeSwitcher(!0)})):f.changeDisplayMode())});this.settings.ReadOnlyMode||(CCL.CommonFunctions.attachPostMessageEventListener($(window),e.PlannerConstants.postMessages.SendElementIdToCourseFeature,function(a){e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().refreshResourcesCell(a.relatedEntityId,a.customId,!0)}),$.fn.scrollParent=function(){return $(document)})}
a.prototype.changeDisplayMode=function(){var a=this;this.toggleTimelineMode(this.isTimelineCurrentMode());this.isTimelineCurrentMode()||$.each(e.Cards.TopicCard.getAllTopicCards(),function(b,d){d.changeDisplayMode(a.currentDisplayMode)})};a.getInstance=function(){return window[a.instanceName]};a.prototype.getSetDateDialog=function(){return window[this.settings.Controls.SetDateDialog]};a.prototype.getLibraryBrowserDialog=function(){return window[this.settings.Controls.LibraryBrowserDialog]};a.prototype.getTopicColorPicker=
function(){return window[this.settings.TopicColorPickerInstanceName]};a.prototype.openViewCellContentDialog=function(a,c,d,e){c=c||window.event;c=c.target||c.srcElement;c&&0<$(c).closest("a,input,button,textarea").length||(c=window[this.settings.Controls.ViewHtmlTextCellContentDialog],null!=c&&null!=this.webMethods.Column.GetPlanHtmlTextCellContent&&(c.setAjaxUrl(this.webMethods.Column.GetPlanHtmlTextCellContent,null==this.settings.PublicAccessKey?{courseId:this.settings.CourseId,planId:d,columnId:e,
childId:this.settings.ChildId,filterPersonId:0}:{publicAccessKey:this.settings.PublicAccessKey,planId:d,columnId:e}),a=$(a).closest("."+this.css.TableCell).children("."+this.css.PlanCellTitle).text(),c.setTitle(a),c.openDialog()))};a.prototype.getContainer=function(){return this.container};a.prototype.getPlannerFilter=function(){return this.plannerFilter};a.prototype.getPlannerFeedback=function(){return window[this.settings.Controls.Feedback]};a.prototype.showConfirmDialog=function(a,c,d,e){void 0===
d&&(d="");void 0===e&&(e="");CCL.CommonFunctions.jAjaxConfirm(a,this.terms.ConfirmTitle,""===d?this.terms.Yes:d,""===e?this.terms.No:e,c)};a.prototype.parseDateFromString=function(a){return null!=a?$.datepicker.parseDate(this.settings.DateFormat,a):null};a.prototype.showNoTopicMessageIfNecessary=function(){this.isTimelineCurrentMode()||this.settings.UseTopics&&this.container.find("."+this.css.NoTopicsMessage).toggle(!this.hasTopicsOrPlansWithoutTopic())};a.prototype.togglePlannerSharing=function(){$("#"+
this.settings.Controls.ShareMenuItem).toggle(this.hasTopics());$("#"+this.settings.Controls.StopSharingMenuItem).toggle(this.hasTopics())};a.prototype.measureEditPlan=function(){CCL.CommonFunctions.measureKpi(this.kpi.Url,this.kpi.Section,this.kpi.EditPlanMeasurement,this.kpi.Context)};a.prototype.hasTopicCardContainers=function(a){return this.settings.UseTopics?0<e.Cards.TopicCard.getAllTopicCardContainers(a).length:!1};a.prototype.hasTopics=function(){return this.hasTopicCardContainers(!0)};a.prototype.hasTopicsOrPlansWithoutTopic=
function(){return this.hasTopicCardContainers(!1)};a.prototype.getPlannerCellCssClass=function(){return this.currentDisplayMode===this.settings.DisplayModes.Table?this.css.TableCell:this.css.ListCell};a.prototype.toggleEnableDisplayModeSwitcher=function(a){window[this.settings.Controls.DisplayModeSwitcher].toggleEnableSwitcher(a)};a.prototype.isTimelineCurrentMode=function(){return this.currentDisplayMode===this.settings.DisplayModes.Timeline};a.prototype.getCurrentDisplayMode=function(){return this.currentDisplayMode};
a.prototype.isTableCurrentMode=function(){return this.currentDisplayMode===this.settings.DisplayModes.Table};a.prototype.toggleTimelineMode=function(a){var b=$("#"+this.settings.Controls.GridContainerId);b&&(this.settings.UseTopics?b.toggle(!a):e.Cards.TopicCard.getAllTopicCards()[0].getPlanGrid().getRowsContainer().toggle(!a));(b=e.PlannerTimeline.getInstance())&&b.toggleTimeline(a,this.settings.UseTopics?this.hasTopics():!0);this.disableTopicToolbarActionItems(a)};a.prototype.disableTopicToolbarActionItems=
function(a){if(!this.settings.ReadOnlyMode)if(this.settings.UseTopics){var b=$("#"+this.settings.Controls.AddTopicLink),d=$("#"+this.settings.Controls.ActionLink),f=[];f.push(b);f.push(d);e.Cards.TopicCard.disableMenuItems(f,a,this.settings.Css.DisabledMenuItem,this.settings.Css.DisabledMenuItemContainer,this.settings.Terms.DisableTopicMenuTooltip)}else e.Cards.TopicCard.getAllTopicCards()[0].disablePlanMenu(a)};a.prototype.loadLargePlanTextContent=function(a){var b=this,d=$("."+CCL.CommonFunctions.getDataSelector(this.data.TopicId,
a)).find("."+this.css.HtmlTextContentPlaceHolder);if(0===d.length)this.completeLoadingLargePlanContent(a);else{var e=[];$.each(d,function(a,c){a=$(c);e.push(new f(a.data(b.data.PlanId),a.data(b.data.ColumnId)))});this.processPlanColumnChunks(this.prepareChunks(e)).done(function(){return b.completeLoadingLargePlanContent(a)})}};a.prototype.stopSharingPlanner=function(){var a=this;this.showConfirmDialog(this.settings.Terms.StopSharingPlannerConfirmText,function(b){b&&(a.toggleLoading(!0),CCL.CommonFunctions.safeAjaxPost({url:a.webMethods.ShareablePlanner.StopSharingPlanner,
data:{courseId:a.settings.CourseId,plannerShareableObjectId:a.settings.ShareableObjectId}}).done(function(){window.location=window.location}).fail(function(b,c,d){a.toggleLoading(!1);CCL.CommonFunctions.alertAjaxError(b,c,d)}))})};a.prototype.processPlanColumnChunks=function(a){var b=this,d=a.splice(0,this.settings.ChunkSizeForLoadingLargeText);return 0===d.length?$.when():$.when.apply($,d.map(function(a){return b.getPlanCellsWithLargeTextPromise(a)})).then(function(){b.processPlanColumnChunks(a)})};
a.prototype.prepareChunks=function(a){if(!a||0===a.length)return[];for(var b=[],d=!0;d;)d=a.splice(0,this.settings.ChunkSizeForLoadingLargeText),b.push(d),d=0<a.length;return b};a.prototype.getPlanCellsWithLargeTextPromise=function(a){var b=this,d=[],f=[];a.forEach(function(a){d.push(a.planId);f.push(a.columnId)});return CCL.CommonFunctions.safeAjaxPost({url:this.webMethods.Plan.LoadCellsWithLargeText,data:null==this.settings.PublicAccessKey?{courseId:this.settings.CourseId,planIds:d,columnIds:f,
childId:this.settings.ChildId,currentDisplayMode:this.currentDisplayMode}:{publicAccessKey:this.settings.PublicAccessKey,planIds:d,columnIds:f,currentDisplayMode:this.currentDisplayMode}}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)}).done(function(a){if(a&&($.each(a.cellList,function(a,c){b.getPlanTextContentPlaceHolder(c.PlanId,c.ColumnId).replaceWith(c.Content)}),a.columnDataList)){var c=e.Cells.InlineCell.PlannerInlineCell.getInstance();c&&c.addColumnsToEdit(a.columnDataList)}})};
a.prototype.getPlanTextContentPlaceHolder=function(a,c){return $("."+this.css.HtmlTextContentPlaceHolder+CCL.CommonFunctions.getDataSelector(this.data.PlanId,a)+CCL.CommonFunctions.getDataSelector(this.data.ColumnId,c))};a.prototype.toggleLoading=function(a){this._ajaxLoaderOverlay.toggle(a);this._ajaxLoader.toggle(a)};a.prototype.completeLoadingLargePlanContent=function(a){a=e.Cards.TopicCard.getInstance(a);a.removePlanGridMessage();a.loadingLargePlanContentCompleted=!0};return a}();e.Planner=d})(f.Planner||
(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function a(b){var c=this;this.loadingLargePlanContentCompleted=!0;window[a.getTopicCardInstanceName(b.TopicId)]=this;this._settings=b;var d=e.Planner.getInstance();this._topicId=this._settings.TopicId;d.settings.ReadOnlyMode||(this._termStartDate=d.parseDateFromString(this._settings.TermStartDate),this._termEndDate=d.parseDateFromString(this._settings.TermEndDate));this.hasPlans=this._settings.HasPlans;this.hasConnectedFolder=this._settings.HasConnectedFolder;
$(function(){c._planGrid=window[c._settings.PlanGridInstanceName];c._container=$("#"+c._settings.ContainerId);c._topicExpander=c._container.find("."+a.css.TopicExpander);c._topicCheckBox=$("#"+c._settings.TopicCheckBoxId);c._topicExpanderLink=c._container.find("#"+c._settings.TopicExpanderLinkId);c._topicColorPickerLink=c._container.find("#"+c._settings.TopicColorPickerLinkId);c.attachEvents();c.isTopicExpanded()&&!d.isTimelineCurrentMode()&&$(function(){c.refreshPlanGrid();0<c._settings.PlanIdToScroll&&
(c._planIdToScroll=c._settings.PlanIdToScroll)})})}a.setCommonSettings=function(b){a.planner=e.Planner.getInstance();a.commonSettings=b;a.css=a.commonSettings.Css;a.terms=a.commonSettings.Terms;a.isIos=a.planner.settings.IsIos;a.planner.settings.ReadOnlyMode||a.hideTopicMoveOptionsIfNecessary();null!=b.DisplayModeSwitcher&&(a.planner.settings.Controls.DisplayModeSwitcher=b.DisplayModeSwitcher)};a.getInstance=function(b){return window[a.getTopicCardInstanceName(b)]};a.getInstanceByContainer=function(b){b=
b.data(a.planner.data.TopicId);return window[a.getTopicCardInstanceName(b)]};a.prototype.getColorPickerLink=function(){return this._topicColorPickerLink};a.prototype.getColorSchema=function(){return this._settings.TopicColorSchema};a.prototype.getTopicCardContainer=function(){return this._container};a.topicCardsExist=function(){return null!=a.commonSettings};a.getAllTopicCardContainers=function(b){if(!a.topicCardsExist())return $();var c="";b&&(c="[data-"+a.planner.data.TopicId+"!=0]");return $("."+
a.commonSettings.Css.TopicContainer+c)};a.getAllTopicCards=function(){var b=[];a.getAllTopicCardContainers().each(function(c,d){c=a.getInstanceByContainer($(d));null!=c&&b.push(c)});return b};a.getTopicCardsForTopicIds=function(b){var c=[];null!=b&&0<b.length&&a.getAllTopicCardContainers().each(function(d,e){d=a.getInstanceByContainer($(e));null!=d&&-1<b.indexOf(d._topicId)&&c.push(d)});return c};a.getPlansForAllTopics=function(){return a.topicCardsExist()?$("."+a.css.Plans+" ."+a.css.PlanContainer):
$()};a.getParentTopicCardContainer=function(b){return b.closest("."+a.commonSettings.Css.TopicContainer)};a.getParentTopicCard=function(b){b=a.getParentTopicCardContainer(b);return a.getInstanceByContainer(b)};a.getParentPlanContainer=function(b){return b.closest("."+a.commonSettings.Css.PlanContainer)};a.prototype.getPlanGrid=function(){return this._planGrid};a.prototype.getSelectedPlanIds=function(b){var c=this._planGrid.getSelectedValues();return c.length?c:(b&&(b=e.Planner.getInstance().terms,
CCL.CommonFunctions.jAjaxAlert(a.terms.NothingSelected,b.Alert,b.Ok)),null)};a.prototype.clearPlanSelection=function(){return this._planGrid.toggleSelectAll(!1)};a.clearAllTopicSelection=function(){a.planner.getContainer().find("."+a.css.TopicSelector).each(function(b,c){(b=a.getParentTopicCard($(c)))&&b.isTopicSelected()&&b._topicCheckBox&&(b._topicCheckBox.prop("checked",!1),b.toggleTopicSelection())})};a.getSelectedTopicIds=function(b){var c=[];a.topicCardsExist()&&a.planner.getContainer().find("."+
a.css.TopicSelector).each(function(b,d){(b=a.getParentTopicCard($(d)))&&b.isTopicSelected()&&c.push(b._topicId)});return c.length?c:(b&&(b=e.Planner.getInstance().terms,CCL.CommonFunctions.jAjaxAlert(b.NoTopicsSelected,b.Alert,b.Ok)),null)};a.prototype.showPlanFeedbackMessage=function(a,c){this._planGrid.getFeedback().showMessage(a,c)};a.prototype.appendNewPlan=function(b,c){this._planGrid.removeEmptyText();this._planGrid.getRowsContainer().append(b);a.planner.currentDisplayMode===a.planner.settings.DisplayModes.Table&&
this._planGrid.updateHeaderRowCheckBoxSelection();c&&this.scrollToPlan(c);e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().initDragAndDrop(this._container)};a.prototype.removePlansFromGrid=function(a,c){for(var b in a)a.hasOwnProperty(b)&&this.getPlanContainerById(a[b]).remove();this._planGrid.updateFreezeState();0===this._planGrid.getRowsCount()&&this._planGrid.getRowsContainer().html(c)};a.prototype.getPlanContainerById=function(a){return this._planGrid.getRowById(a)};
a.prototype.sortPlans=function(a){for(var b in a)a.hasOwnProperty(b)&&this._planGrid.getRowsContainer().append(this.getPlanContainerById(a[b]))};a.prototype.refreshPlanGrid=function(b){if(this._planGrid.isLoadingInProgress())return!1;a.startLoadingMonitor();a.planner.settings.ReadOnlyMode||this.disablePlanMenu(!0);this._planGrid.refresh().done(function(){b&&b()})};a.prototype.getTopicExpander=function(){return this._topicExpander};a.prototype.getTopicExpanderLink=function(){return this._topicExpanderLink};
a.prototype.updateTopicExpanderLink=function(a){this._topicExpanderLink.html(a)};a.prototype.toggleTopicSelection=function(){var b=this.isTopicSelected();this._planGrid.toggleSelectAll(b);this._planGrid.toggleDisableAll(b);this.disablePlanMenu(b,a.terms.DisabledMenuItemTooltip);this.toggleDisablePlanActionMenu(b)};a.prototype.isTopicSelected=function(){return this._topicCheckBox?this._topicCheckBox.is(":checked"):!1};a.prototype.getTopicId=function(){return this._topicId};a.prototype.getTopicName=
function(){return this._settings.TopicName};a.prototype.setTopicColorSchema=function(b,c){this._settings.TopicColorSchema=b;this._container.find("."+a.css.TopicColorContainer).removeClass().addClass(a.css.TopicColorContainer).addClass(c)};a.prototype.getLastPlanId=function(){return this._planGrid.getRowPrimaryKeyValueByIndex(this._planGrid.getRowsCount()-1)};a.prototype.getPlanIds=function(){return this._planGrid.getAllValues()};a.prototype.containsPlanElements=function(a){var b=this,d=!1;$.each(a,
function(a,c){return 0<b.getPlanContainerById(c).find(e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getActivityResourceListItemSelector()).length?(d=!0,!1):!0});return d};a.prototype.updatePlanCellsCallback=function(a){if(null!=a){for(var b={needToReloadFolders:!1},d=0;d<a.length;d++)this.refreshCell(a[d],b);a=top;b.needToReloadFolders&&a.reloadFolder&&a.reloadFolder("item0","planner",!0,!0)}};a.prototype.redirectToSharePlans=function(a){a=CCL.CommonFunctions.formatString(this._settings.SharePlansPageUrlTemplate,
a);window.location=a};a.prototype.redirectToShareTopic=function(){var a=CCL.CommonFunctions.formatString(this._settings.ShareTopicPageUrlTemplate,this._topicId);window.location=a};a.setDefaultDate=function(b,c){if(c=a.getInstance(c)){var d=Date.now();c=null!=c._termStartDate&&d<c._termStartDate||null!=c._termEndDate&&d>c._termEndDate?c._termStartDate:null;b.setDefaultDate(void 0!=c?c:null)}};a.prototype.setTermDates=function(a,c){this._termStartDate=a;this._termEndDate=c};a.hideTopicMoveOptionsIfNecessary=
function(){var b=a.getAllTopicCardContainers(!0);0<b.length&&$.each(b,function(c,d){if(d=$(d).find(CCL.CommonFunctions.getDataSelector(a.planner.data.DropDownMenuClientId)).attr("data-"+a.planner.data.DropDownMenuClientId))if(d=$(document).find("#"+d))d.find(CCL.CommonFunctions.getDataSelector(a.planner.data.TopicMoveUpMenu)+","+CCL.CommonFunctions.getDataSelector(a.planner.data.TopicMoveDownMenu)).show(),0===c&&d.find(CCL.CommonFunctions.getDataSelector(a.planner.data.TopicMoveUpMenu)).hide(),c===
b.length-1&&d.find(CCL.CommonFunctions.getDataSelector(a.planner.data.TopicMoveDownMenu)).hide()})};a.prototype.showPlanActionMenu=function(){$("."+a.planner.css.PlanActionMenu).show()};a.prototype.hidePlanMoveOptionsIfNecessary=function(){var b=this._planGrid.getRows();if(0<b.length){$("."+a.planner.css.PlanMoveUpMenuItem+CCL.CommonFunctions.getDataSelector(a.planner.data.TopicId,this._topicId)).show();$("."+a.planner.css.PlanMoveDownMenuItem+CCL.CommonFunctions.getDataSelector(a.planner.data.TopicId,
this._topicId)).show();var c=b.first().data(a.planner.data.GridRowId);$("."+a.planner.css.PlanMoveUpMenuItem+CCL.CommonFunctions.getDataSelector(a.planner.data.PlanId,c)).hide();b=b.last().data(a.planner.data.GridRowId);$("."+a.planner.css.PlanMoveDownMenuItem+CCL.CommonFunctions.getDataSelector(a.planner.data.PlanId,b)).hide()}};a.topicExpanderLinkClick=function(b){b.preventDefault();b=$(b.currentTarget);var c=a.getParentTopicCardContainer(b),d=a.getInstanceByContainer(c);c=c.find("."+a.css.Plans);
var e=d.getTopicExpander(),f=d.getPlanGrid();e.toggleClass(a.css.TopicExpanded);e.hasClass(a.css.TopicExpanded)?(f.getFeedback().hide(),d.refreshPlanGrid(),b.prop("title",a.terms.CollapseTooltip)):b.prop("title",a.terms.ExpandTooltip);c.slideToggle("fast")};a.prototype.scrollToPlan=function(b){var c=this,d=0,e=window,f=!1;a.isIos&&window!==window.top&&(d+=$('iframe[name="mainmenu"]',window.top.document).offset().top,e=window.top,f=!0);$("html, body",e.document).stop().animate({scrollTop:d+this.getPlanContainerById(b).offset().top-
this._planGrid.getToolbarElement().outerHeight()},function(){a.isIos&&c._planGrid.updateFreezeState(f)})};a.prototype.changeDisplayMode=function(b){this.updateGridView(b);b=b!==a.planner.settings.DisplayModes.Timeline;a.planner.settings.UseTopics&&(b=b&&this.isTopicExpanded());b&&this.refreshPlanGrid()};a.disableMenuItems=function(a,c,d,e,f){$.each(a,function(a,b){a=$(b);b=a.parent("li");var g=a.html(),h=a.attr("class");b.children("span."+d).remove();c?(b.addClass(e),a.hide(),b=$("<span>").attr("class",
h).attr("disabled","disabled").addClass(d).html(g),null!=f&&b.prop("title",f),a.after(b)):(b.removeClass(e),a.show())})};a.prototype.disablePlanMenu=function(b,c){var d=this._container.find("."+a.css.PlanGridToolbar).children("."+a.css.PlanGridToolbarItemsLeft).find("."+a.css.IconLink);a.disableMenuItems(d,b,a.css.DisabledMenuItem,a.css.DisabledMenuItemContainer,c)};a.prototype.toggleDisablePlanActionMenu=function(b){var c=this._container.find($("."+a.planner.css.PlanActionMenu));$.each(c,function(c,
d){c=$(d);c.toggleHyperlink(!b);c.prop("title",b?a.terms.DisabledMenuItemTooltip:"")})};a.prototype.removePlanGridMessage=function(){this._planGrid.removeGridMessage()};a.prototype.scrollToSelectedPlanOnLoad=function(b){var c=this;0>=b||setTimeout(function(){c._container.find("."+a.planner.css.HtmlTextCellViewer+" img[height]").each(function(a,b){a=$(b);b=parseInt(a.attr("height"))/parseInt(a.attr("width"));isNaN(b)||a.height()||(a.addClass("temp-height"),a.height(b*a.width()))});c.scrollToPlan(c._settings.PlanIdToScroll);
$(window).one("resize",function(){$(".temp-height").removeClass("temp-height").height("")})},500)};a.getTopicCardInstanceName=function(b){return a.commonSettings.TopicCardInstanceNamePrefix+b};a.prototype.isTopicExpanded=function(){return this._topicExpander.hasClass(a.css.TopicExpanded)};a.prototype.refreshCell=function(a,c){switch(a.ColumnType){case e.ColumnType.Date:this.refreshDateCell(a);break;case e.ColumnType.LearningObjectives:this.refreshPlanLoCell(a);break;case e.ColumnType.Resources:case e.ColumnType.Activities:case e.ColumnType.Elements:this.refreshElementCell(a),
c.needToReloadFolders=!0}};a.prototype.refreshDateCell=function(a){e.Cells.Plan.DateCell.PlanDateCell.getPlanDateCellInstance().updateContent(a.Content,a.PlanId,a.Properties.planActive);a.Properties.expanderText&&this.updateTopicExpanderLink(a.Properties.expanderText)};a.prototype.refreshElementCell=function(a){e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().updateContent(a.Content,a.PlanId,a.ColumnId,!1,!1)};a.prototype.refreshPlanLoCell=function(a){e.Cells.Plan.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance().updateContent(a.Content,
a.PlanId)};a.prototype.attachEvents=function(){var b=this;a.planner.settings.ReadOnlyMode||($(document).on(a.planner.events.PlanActivationChanged,function(a,d){a=d.planActivations;null!=a&&$.each(a,function(a,c){0<b.getPlanContainerById(c.planId).length&&b._planGrid.toggleRowStatus(c.planId,c.planActive)})}),this._planGrid.getGridElement().on(CclResponsiveGrid.LoadingCompletedEventName,function(){b.showPlanActionMenu();b.toggleTopicSelection();b.hidePlanMoveOptionsIfNecessary()}));this._planGrid.getGridElement().on(CclResponsiveGrid.LoadingCompletedEventName,
function(){b.loadLargePlanTextContent();null!=b._planIdToScroll&&(b.scrollToSelectedPlanOnLoad(b._planIdToScroll),b._planIdToScroll=null)});this._topicExpanderLink.click(a.topicExpanderLinkClick);this._topicCheckBox&&this._topicCheckBox.change(function(){return b.toggleTopicSelection()});a.planner.settings.ReadOnlyMode||this._topicColorPickerLink.click(function(){b._container.off(a.planner.events.ColorPickerColorChange);0<b._topicId&&(a.planner.getTopicColorPicker().setupAndOpenTopicColorPicker(b._topicId),
b._container.on(a.planner.events.ColorPickerColorChange,function(c,d){a.planner.getTopicColorPicker().updateTopicColor(b._topicId,d)}))})};a.prototype.loadLargePlanTextContent=function(){0<this._planGrid.totalCount&&(this.loadingLargePlanContentCompleted=!1,this._planGrid.addGridLoadingMessage(),a.planner.loadLargePlanTextContent(this._topicId))};a.prototype.updateGridView=function(b){this._planGrid.ajaxSettings.dataSourceWebMethodParams.currentDisplayMode=b;this._planGrid.setMode(b===a.planner.settings.DisplayModes.Table?
a.planner.css.GridViewModes.TableView:a.planner.css.GridViewModes.DefaultView)};a.startLoadingMonitor=function(){if(null==a.planLoadingProcessId){a.planner.toggleEnableDisplayModeSwitcher(!1);var b=a.getAllTopicCards();a.planLoadingProcessId=setInterval(function(){var c=!0;$.each(b,function(a,b){return b.getPlanGrid().isLoadingInProgress()||!b.loadingLargePlanContentCompleted?c=!1:!0});c&&(clearTimeout(a.planLoadingProcessId),a.planLoadingProcessId=null,a.planner.toggleEnableDisplayModeSwitcher(!0),
a.planner.settings.ReadOnlyMode||e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().initDragAndDrop())},500)}};a.planLoadingProcessId=null;return a}();f.TopicCard=d})(e.Cards||(e.Cards={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(b,d){window[b]=this;a.instanceName=b;this.settings=d;this.css=this.settings.Css;this._planner=e.Planner.getInstance()}a.getInstance=function(){return window[a.instanceName]};a.prototype.togglePlanContentExpanderLink=function(a,b,d){a=$(a);a.hasClass(this.css.ExpanderLinkExpanded)?this.collapsePlanContentItems(a):this.expandPlanContentItems(a,b,d)};a.prototype.collapsePlanContentItems=function(a){var b=a.parent().find("li").toArray();
b.splice(0,this.settings.MaxCountOfPlanContentItemsToDisplay);$.each(b,function(a,b){$(b).hide()});a.children("span").first().text(this.settings.Terms.ShowMore);a.removeClass(this.css.ExpanderLinkExpanded)};a.prototype.expandPlanContentItems=function(a,b,d){a.parent().find("ul").hasClass(this.css.ContentListPartiallyLoaded)?d&&d(a):(b=a.parent().find("li").toArray(),b.splice(0,this.settings.MaxCountOfPlanContentItemsToDisplay),$.each(b,function(a,b){$(b).show()}),a.children("span").first().text(this.settings.Terms.ShowLess),
a.addClass(this.css.ExpanderLinkExpanded))};a.prototype.loadAllPlanElements=function(a,b,e){var c=this;$.get(this.settings.WebMethods.LoadAllPlanElements,$.param(null==this._planner.settings.PublicAccessKey?{courseId:this._planner.settings.CourseId,planId:b,columnId:e,childId:this._planner.settings.ChildId,dashboardHierarchyId:this._planner.settings.DashboardHierarchyId,dashboardName:this._planner.settings.DashboardName}:{publicAccessKey:this._planner.settings.PublicAccessKey,planId:b,columnId:e},
!0)).done(function(g){c._planner.settings.ReadOnlyMode?a.closest("."+c._planner.getPlannerCellCssClass()).html(g.ControlHtml):d.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().updateContent(g.ControlHtml,b,e,!1,!1)}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};a.prototype.loadAllLearningObjectives=function(a,b){var c=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.LoadAllPlanLearningObjectives,data:null==this._planner.settings.PublicAccessKey?
{courseId:this._planner.settings.CourseId,planId:b,childId:this._planner.settings.ChildId}:{publicAccessKey:this._planner.settings.PublicAccessKey,planId:b}}).done(function(e){c._planner.settings.ReadOnlyMode?a.closest("."+c._planner.getPlannerCellCssClass()).html(e.ControlHtml):d.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance().updateContent(e.ControlHtml,b)}).fail(CCL.CommonFunctions.alertAjaxError)};return a}();d.PlanExpandableContentCellCommonLogic=a})(f.Plan||
(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){(function(d){(function(a){var b=function(){function a(a,b,c){this.fileUploadInProgress=!1;this.fakeElementItemId="fakeElementItemId";this.uploadProgressDataAttributeName="upload-in-progress";this.settings=a;this.courseId=b;this.controls=c}a.prototype.attachEvents=function(){var a=this;$(document).on("click","."+this.settings.Css.RemoveFromPlanLink,function(b){b=$(b.currentTarget);a.removeElementFromPlan(b)}).on("click","."+this.settings.Css.AddElementMenuItem+
", ."+this.settings.Css.AddElementShowAllMenuItem,function(b){b=$(b.currentTarget);switch(a.getDataAttributeValueAsNumber(b,e.PlannerConstants.dataAttributes.ElementExternalSource)){case f.AddResourceMenu.ElementExternalSourceType.Library:a.addFromLibrary(b);break;case f.AddResourceMenu.ElementExternalSourceType.Course:a.addFromCourse(b);break;case f.AddResourceMenu.ElementExternalSourceType.Computer:1===a.getDataAttributeValueAsNumber(b,a.uploadProgressDataAttributeName)?CCL.CommonFunctions.jAlertAjaxError(a.settings.Terms.WaitUntilPreviousFileIsUploaded,
"",a.settings.Terms.Ok,!1):a.addFromComputer(b)}CCL.AlternativeChoiceManager.closeOpenedDialog()}).on("click","."+this.settings.Css.AddElementLink,function(b){a.openElementSelector($(b.currentTarget))});this.attachSpecificEvents()};a.prototype.openElementSelector=function(a){var b=this,c=this.getPlanId(a),d=this.getElementType(a),g=this.getColumnId(a),k=this.getFolderId(a);d=this.settings.ElementSelectorClientInstanceNameTemplate.replace("{0}",d.toString());d=window[d];var n=d.getFirstColumn().find("a");
n.each(function(a,d){a=$(d);a.attr("href",b.updateAddLinkUrl(a.attr("href"),c,k))});d.getSecondColumn().find("a").each(function(a,b){$(b).attr("data-"+e.PlannerConstants.dataAttributes.PlanId,c).attr("data-"+e.PlannerConstants.dataAttributes.ColumnId,g).attr("data-"+e.PlannerConstants.dataAttributes.FolderId,k)});var q=d.getSecondColumn().find(CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.ElementExternalSource,f.AddResourceMenu.ElementExternalSourceType.Computer));q.css("opacity",
this.fileUploadInProgress?"0.5":"");q.attr("data-"+this.uploadProgressDataAttributeName,this.fileUploadInProgress?"1":"0");d.openDialog(a,this.getElementDialogOffset());CCL.CommonFunctions.isMobileDevice()||n.first().focus()};a.prototype.deletePlanElement=function(a,b,c){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.DeletePlanElement,data:{courseId:this.courseId,planId:a,elementId:b,deleteFromCourse:c}}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.addFromLibrary=
function(a){var b=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ElementType),c=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId),d=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.FolderId),g=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId);a=this.getLibraryBrowserDialog();b={RelatedEntityId:c,ElementCategory:this.getElementCategoryAsStringByElementType(b),FolderId:d,CustomId:g.toString()};
b.LearningObjectivesIds=this.getLearningObjectiveIds(c,!0);a.browseLibrary(b)};a.prototype.addFromCourse=function(a){var b=this,c=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ElementType),d=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId),g=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId);a={locationId:this.courseId,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};var k=[],n=new Map;this.loadCurrentElementStates(d,
g,n);c={elementStates:n,elementType:c,showAll:!1,header:this.getElementLinkDialogTitle(c),afterOkClickCallback:function(a){a&&(a.forEach(function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.Saved||k.push(b)}),0<k.length&&b.updatePlanElements(d,k,g))},allowFolderSelection:c!==f.ElementLinkDialog.ContentElementType.Activities,openerPage:f.ElementLinkDialog.ElementsPopupOpener.Plan,relatedEntityId:d};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(c,
a)};a.prototype.addFromComputer=function(a){this.currentPlanId=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId);this.currentColumnId=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId);$("#"+Components.ComponentName.localPicker).click()};a.prototype.onFileUploadSuccess=function(a){var b=this;this.fileUploadInProgress&&CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.CreateNewFileForPlan,data:{courseId:this.courseId,planId:this.currentPlanId,
fileName:a.name,fileId:a.id,signedFileId:a.signature}}).done(function(a){a.Success?b.refreshResourcesCell(b.currentPlanId,b.currentColumnId,!0):($("#"+b.fakeElementItemId).remove(),CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,b.settings.Terms.ErrorOccurred,b.settings.Terms.Ok,!1))}).fail(function(){$("#"+b.fakeElementItemId).remove();CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,b.settings.Terms.ErrorOccurred,b.settings.Terms.Ok,!1)}).always(function(){b.fileUploadInProgress=
!1;b.currentColumnId=void 0;b.currentPlanId=void 0})};a.prototype.onFileUploadFailed=function(a,b){var c=this;this.fileUploadInProgress=!1;CCL.CommonFunctions.jAjaxConfirm(b,this.settings.Terms.FailedFileUploadChoiceDialogTitle,this.settings.Terms.FailedFileUploadChoiceDialogUploadNewFile,this.settings.Terms.FailedFileUploadChoiceDialogCancel,function(a){a?$("#"+Components.ComponentName.localPicker).click():(c.currentColumnId=void 0,c.currentPlanId=void 0)});$("#"+this.fakeElementItemId).remove()};
a.prototype.onFileSelected=function(a){this.fileUploadInProgress=!0;a='<li id="'+this.fakeElementItemId+'" class="'+this.settings.Css.ActivityResourceListItem+'">\n    <div class="'+this.settings.Css.FakeElementContainer+'">\n        <i class="'+this.settings.Css.FakeElementTitle+'">'+a[0].name+"</i>\n    </div>\n</li>";this.getActivityResourceList(this.currentPlanId,this.currentColumnId).append($(a));$("#"+this.fakeElementItemId+" ."+this.settings.Css.FakeElementContainer).prepend($(this.controls.LoadingWheel).addClass(""+
this.settings.Css.FakeElementImage))};a.prototype.updatePlanElements=function(a,b,c){var d=this;return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanElements,data:{courseId:this.courseId,planId:a,elementIds:b,columnId:c}}).done(function(){d.refreshResourcesCell(a,c,!0)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getDataAttributeValueAsNumber=function(a,b){return parseInt(a.attr("data-"+b),10)};a.prototype.getElementLinkDialogTitle=function(a){return a===f.ElementLinkDialog.ContentElementType.Activities?
this.settings.Terms.AddActivityModalTitle:this.settings.Terms.AddResourceModalTitle};a.prototype.getElementCategoryAsStringByElementType=function(a){switch(a){case f.ElementLinkDialog.ContentElementType.Resources:return e.ElementCategory[e.ElementCategory.Resource];case f.ElementLinkDialog.ContentElementType.Activities:return e.ElementCategory[e.ElementCategory.Activity]}};a.prototype.loadCurrentElementStates=function(a,b,c){CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetPlanElements,
data:{courseId:this.courseId,planId:a,columnId:b}}).done(function(a){a&&$.each(a.elementIds,function(a,b){c.set(b,f.CheckboxStateMachine.State.Saved)})}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getPlanContainer=function(a){return a.closest("."+this.settings.Css.PlanContainer)};a.prototype.updateAddLinkUrl=function(a,b,c){var d=a.lastIndexOf("?"),e=a.substring(0,d);a=a.substring(d+1).split("&");for(d=0;d<a.length;d++){var g=a[d].substring(0,a[d].indexOf("="));g.toLowerCase()===this.settings.RequestParameters.FolderId.toLowerCase()?
a[d]=g+"="+c:g.toLowerCase()===this.settings.RequestParameters.RelatedEntityId.toLowerCase()&&(a[d]=g+"="+b)}return e+"?"+a.join("&")};a.prototype.getElementType=function(a){return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ElementType)};return a}();a.PlanResourcesCellBase=b})(d.ResourcesCell||(d.ResourcesCell={}))})(k.Plan||(k.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(a){function b(c,d,f){a.call(this,d,d.CourseId,f);window[c]=this;b.instanceName=c;this.attachEvents();this.cbPlanner=e.CbPlanner.getInstance()}__extends(b,a);b.getPlanActivityResourceCellInstance=function(){return window[b.instanceName]};b.onFileUploadSuccess=function(a){b.getPlanActivityResourceCellInstance().onFileUploadSuccess(a)};b.onFileUploadFailed=function(a,c){b.getPlanActivityResourceCellInstance().onFileUploadFailed(a,
c)};b.onFileSelected=function(a){b.getPlanActivityResourceCellInstance().onFileSelected(a)};b.prototype.refreshResourcesCell=function(a,b,c){this.reloadPlanElements(a,b);c&&this.measureKpiEditPlan()};b.prototype.attachSpecificEvents=function(){var a=this;$(document).on("click","."+this.settings.Css.AddHomework,function(b){a.openElementSelector($(b.currentTarget))})};b.prototype.removeElementFromPlan=function(b){var c=this,d=b.closest("."+this.settings.Css.ActivityResourceListItem);b=this.getPlanId(b);
var f=this.getDataAttributeValueAsNumber(d,e.PlannerConstants.dataAttributes.ElementId);a.prototype.deletePlanElement.call(this,b,f,!1).done(function(){d.remove();c.measureKpiEditPlan()})};b.prototype.getLibraryBrowserDialog=function(){return this.cbPlanner.getLibraryBrowserDialog()};b.prototype.getActivityResourceCell=function(a,b){return this.getActivityResourceList(a,b).closest("."+this.settings.Css.CbCellContainer)};b.prototype.getActivityResourceList=function(a,b){return $("."+this.settings.Css.PlanContainer+
CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.settings.Css.ActivityResourceCell)};b.prototype.getLearningObjectiveIds=function(a,b){var c=d.LearningObjectivesCell.PlanLearningObjectivesCellBase.getPlanLearningObjectivesCellInstance();return c?c.getLearningObjectiveIds(a,b):[]};b.prototype.measureKpiEditPlan=function(){this.cbPlanner.measureEditPlan()};b.prototype.reloadPlanElements=function(a,b){var c=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.ReloadPlanElements,
data:{courseId:this.courseId,planId:a,columnId:b}}).done(function(d){c.getActivityResourceCell(a,b).html(d.ControlHtml)}).fail(CCL.CommonFunctions.alertAjaxError)};b.prototype.getPlanId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId)};b.prototype.getColumnId=function(a){return 0};b.prototype.getElementDialogOffset=function(){return-35};b.prototype.getFolderId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,
e.PlannerConstants.dataAttributes.FolderId)};return b}(a.PlanResourcesCellBase);a.PlanCbResourcesCell=b})(d.ResourcesCell||(d.ResourcesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.name=a;this.settings=b;window[this.name]=this;d.instanceName=this.name;this.settings=b;this.$useTopicsCheckbox=$("#"+this.settings.ClientIds.UseTopics);this.topicColumnsGrid=window[this.settings.TopicColumnsGridInstanceName];this.planColumnsGrid=window[this.settings.PlanColumnsGridInstanceName];this.$enableAnonymousAccessCheckbox=$("#"+this.settings.ClientIds.EnableAnonymousAccess);this.$addPlanRichTextColumnLink=$("#"+this.settings.ClientIds.AddPlanColumnLink);
this.countOfPlanRichTextColumns=this.settings.PlanRichColumnsCount;this.deletedTopicColumns=[];this.deletedPlanColumns=[];$(function(){c.toggleTopicSettings();c.togglePublicCopyLink();c.togglePlanDefaultStatusContainer();c.toggleAddPlanRichTextColumnLink();c.toggleElementsColumns();c.disableDragAndDropForColumnsByIds(c.settings.NotReorderableTopicColumnIds,!0);c.disableDragAndDropForColumnsByIds(c.settings.NotReorderablePlanColumnIds,!1);c.attachEvents();c.findRowTeplates()})}d.getInstance=function(){return window[d.instanceName]};
d.prototype.deleteCustomColumn=function(a,b){var c=this;a=$(a);var d=a.closest("."+this.settings.Css.GridRow);a.data(this.settings.DataAttributes.HasData)?this.showConfirmDialog(b?this.settings.Terms.DeleteCustomTopicColumnConfirmText:this.settings.Terms.DeleteCustomPlanColumnConfirmText,function(a){a&&(c.cacheDeletedItem(d,b),d.remove())}):(this.cacheDeletedItem(d,b),d.remove());b||(this.countOfPlanRichTextColumns--,this.toggleAddPlanRichTextColumnLink());return!1};d.prototype.afterOpenCopyPublicLinkDialog=
function(){CCL.CommonFunctions.safeAjaxPost({url:this.settings.MeasureCopyPublicLinkUrl})};d.prototype.save=function(){var a=!0;this.$useTopicsCheckbox.prop("checked")&&(a=this.validateColumnNames(this.topicColumnsGrid,!0));a=this.validateColumnNames(this.planColumnsGrid,a)&&a;if(!a)return event.stopPropagation(),!1;this.collectDataForSaving();return!0};d.prototype.showConfirmDialog=function(a,b){CCL.CommonFunctions.jAjaxConfirm(a,this.settings.Terms.ConfirmTitle,this.settings.Terms.Yes,this.settings.Terms.No,
b)};d.prototype.cacheDeletedItem=function(a,b){var c={};c.Id=a.data(this.settings.DataAttributes.GridRowId);c.IsDeleted=!0;0<c.Id&&(b?this.deletedTopicColumns.push(c):this.deletedPlanColumns.push(c))};d.prototype.addTopicCustomColumn=function(){this.addGridRow(this.topicColumnsGrid,this.$topicColumnTemplate)};d.prototype.addPlanCustomColumn=function(){this.$addPlanRichTextColumnLink.getIfHyperLinkEnabled()&&(this.addGridRow(this.planColumnsGrid,this.$planColumnTemplate),this.countOfPlanRichTextColumns++,
this.toggleAddPlanRichTextColumnLink())};d.prototype.findRowTeplates=function(){this.$topicColumnTemplate=this.topicColumnsGrid.getRowById(this.settings.TemplateColumnId);this.$topicColumnTemplate.detach();this.$planColumnTemplate=this.planColumnsGrid.getRowById(this.settings.TemplateColumnId);this.$planColumnTemplate.detach()};d.prototype.addGridRow=function(a,b){var c=b.clone(!0).data(this.settings.DataAttributes.GridRowId,this.settings.NewColumnId);a.getRowsContainer().append(c);a=b.find(this.settings.ShowOnCoursePageInputSelector);
0<a.length&&(b=CCL.CommonFunctions.formatString(this.settings.ToggleInstanceNameTemplate,a[0].id),a=window[b],b=b+"_clone"+(new Date).getTime(),a.clone(c,b));c.find("input."+this.settings.Css.ColumnTitle).focus()};d.prototype.validateColumnNames=function(a,b){var c=this,d=!0,e;a.getRowsContainer().find("input."+this.settings.Css.ColumnTitle+":visible").each(function(a,b){a=$(b);d=c.validateColumnName(a)&&d;null!=e||d||(e=a)});null!=e&&b&&window.scrollTo(0,e.offset().top);return d};d.prototype.validateColumnName=
function(a){if(0===a.val().trim().length)return a.parent().find("."+this.settings.Css.ErrorContainer).css("visibility","visible"),!1;a.parent().find("."+this.settings.Css.ErrorContainer).css("visibility","");return!0};d.prototype.toggleTopicSettings=function(){var a=this.$useTopicsCheckbox.prop("checked");$("#"+this.settings.ClientIds.TopicsHolder).toggle(a);var b=$("#"+this.settings.ClientIds.CreateFolderForEachNewTopic);a?(b.removeProp("readonly"),b.off("click",this.disabledCheckboxOnClick)):(b.prop("readonly",
"readonly"),b.on("click",this.disabledCheckboxOnClick))};d.prototype.togglePublicCopyLink=function(){var a=this.$enableAnonymousAccessCheckbox.prop("checked");$("#"+this.settings.ClientIds.CopyPublicLink).toggle(a)};d.prototype.togglePlanDefaultStatusContainer=function(){var a=$("#"+this.settings.ClientIds.PlanActivationTypeDropdown).val()===this.settings.PlanActivationTypeManually;$("#"+this.settings.ClientIds.AutoActivationInfoContainer).toggle(!a);$("#"+this.settings.ClientIds.PlanDefaultStatusContainer).toggle(a)};
d.prototype.toggleElementsColumns=function(){for(var a=$("#"+this.settings.ClientIds.ElementColumnsRadioList+" input:checked").val()===this.settings.UseGenericElementsColumn,b=this.planColumnsGrid,c=0;c<this.settings.SeparateElementColumnIds.length;c++)$(b.getRowById(this.settings.SeparateElementColumnIds[c])).toggle(!a);$(b.getRowById(this.settings.GenericElementsColumnId)).toggle(a)};d.prototype.reorderFieldSuccess=function(){$("#"+this.settings.ClientIds.ReorderDataHiddenField).val("true")};d.prototype.collectDataForSaving=
function(){if(this.$useTopicsCheckbox.prop("checked")){var a=$("#"+this.settings.ClientIds.TopicColumnDataHiddenField),b=this.topicColumnsGrid.getRowsContainer().find("."+this.settings.Css.GridRow);this.collectData(a,b,this.deletedTopicColumns)}a=$("#"+this.settings.ClientIds.PlanColumnDataHiddenField);b=this.planColumnsGrid.getRowsContainer().find("."+this.settings.Css.GridRow);this.collectData(a,b,this.deletedPlanColumns)};d.prototype.collectData=function(a,b,c){var d=this,e=[];b.each(function(a,
b){a=$(b);b=a.find("."+d.settings.Css.ColumnTitle);var f=a.find("."+d.settings.Css.ColumnType),g=a.find("."+d.settings.Css.ColumnVisibleFor),h=a.find(d.settings.ShowOnCoursePageInputSelector),m={};m.Id=a.data(d.settings.DataAttributes.GridRowId);m.Title=b.val().trim();m.ColumnType=f.val();m.VisibleFor=g.val();m.ShowOnCoursePage=h.is(":checked");m.IsDeleted=!1;e.push(m);e=e.concat(c)});a.val(JSON.stringify(e))};d.prototype.attachEvents=function(){var a=this;this.$useTopicsCheckbox.on("change",function(){a.toggleTopicSettings()});
this.$enableAnonymousAccessCheckbox.on("change",function(){a.togglePublicCopyLink()});$("#"+this.settings.ClientIds.PlanActivationTypeDropdown).on("change",function(){a.togglePlanDefaultStatusContainer()});this.topicColumnsGrid.getRowsContainer().find("input."+this.settings.Css.ColumnTitle).on("input paste",function(b){b=$(b.currentTarget);a.validateColumnName(b)});this.planColumnsGrid.getRowsContainer().find("input."+this.settings.Css.ColumnTitle).on("input paste",function(b){b=$(b.currentTarget);
a.validateColumnName(b)});$("#"+this.settings.ClientIds.ElementColumnsRadioList).on("change",function(){a.toggleElementsColumns()})};d.prototype.disableDragAndDropForColumnsByIds=function(a,b){b=b?this.topicColumnsGrid:this.planColumnsGrid;for(var c=0;c<a.length;c++)b.getRowById(a[c]).removeClass(this.settings.Css.ReorderableGridRow)};d.prototype.toggleAddPlanRichTextColumnLink=function(){var a=this.countOfPlanRichTextColumns<this.settings.MaxNumberOfRichTextColumnsInPlan;this.$addPlanRichTextColumnLink.toggleHyperlink(a);
a?this.$addPlanRichTextColumnLink.removeAttr("title"):this.$addPlanRichTextColumnLink.attr("title",this.settings.Terms.AddPlanRichTextColumnLinkDisabledTooltip)};d.prototype.disabledCheckboxOnClick=function(){return!1};return d}();e.CustomizePlanner=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.CurrentParameters=d;d=function(){function a(a,c){window[a]=this;this.settings=c;this.$container=$("#"+this.settings.Controls.ContainerId)}a.prototype.clearContainer=function(){this.$container&&(this.$container.find("iframe,object").css("visibility","hidden"),this.$container.html(""))};a.prototype.openDialog=function(a,c,d,e,f){this.currentParameters||(this.currentParameters={});this.currentParameters.EventId=c;this.currentParameters.CourseId=
a;null!=d&&window[this.settings.Controls.DialogTarget].setTitle(d);void 0!=e&&(this.currentParameters.ViewForPersonId=e);void 0!=f&&(this.currentParameters.ChildId=f);this.clearContainer();window[this.settings.Controls.DialogTarget].openDialog()};a.prototype.loadEventPlans=function(){if(this.currentParameters){var a=this.$container;a&&$.ajax({type:"GET",url:this.settings.WebMethods.GetEventPlansXhtml,async:!1,data:{courseId:this.currentParameters.CourseId,eventUniqueId:this.currentParameters.EventId,
childId:null==this.currentParameters.ChildId?0:this.currentParameters.ChildId,viewForPersonId:null==this.currentParameters.ViewForPersonId?0:this.currentParameters.ViewForPersonId,dashboardHierarchyId:this.settings.DashboardHierarchyId}}).done(function(b){return a.html(b.contentHtml)}).fail(function(b){return a.html(b.responseText)})}};a.prototype.togglePlanDetails=function(a,c,d,e,f,l){var b=this,g=this,h=$(a),m=h.parent().find("."+this.settings.CssClasses.PlanContainerCss);a=m.is(":visible");h.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.PlanDetailsExpanderImage)).toggleClass(this.settings.CssClasses.ForwardImage,
a).toggleClass(this.settings.CssClasses.ChevronDownImage,!a);m.data(this.settings.DataAttributes.PlanDetailsContentLoaded)||$.ajax({type:"GET",url:this.settings.WebMethods.GetSinglePlanXhtml,async:!1,data:{courseId:c,planId:d,childId:e,viewForPersonId:f,showFullPlannerLink:l,dashboardHierarchyId:this.settings.DashboardHierarchyId}}).done(function(a){m.html(a.contentHtml);m.data(g.settings.DataAttributes.PlanDetailsContentLoaded,"true")}).fail(function(a){return m.html(a.responseText)});m.slideToggle("fast",
function(){h.prop("title",m.is(":visible")?b.settings.Terms.HideDetails:b.settings.Terms.ViewDetails);m.css("overflow","")})};return a}();e.EventPlansDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function a(b,c){var d=this;window[b]=this;a.instanceName=b;this._settings=c;this._planner=e.Planner.getInstance();$("#"+c.MoveToTopicOkButtonId).click(function(){d.movePlansToTopicOkBtnClick()})}a.getInstance=function(){return window[a.instanceName]};a.prototype.openDialog=function(a,c){void 0===c&&(c=null);var b=e.Cards.TopicCard.getInstance(a);null==c&&(c=b.getSelectedPlanIds(!0));null!=c&&(this.initTopicDropDownListControl(),this._topicId=
a,this._planIds=c,this.reloadTopicList(),this._topicDropDownList.val(a.toString()),0<this._topicDropDownList.children().length&&this.getCssModal().openDialog())};a.prototype.movePlansToTopicOkBtnClick=function(){var a=this,c=this._topicId,d=this._topicDropDownList.val();if(c==d)CssModal.closeDialog();else{var f=e.Cards.TopicCard.getInstance(c),m=e.Cards.TopicCard.getInstance(d),l=f.getPlanGrid(),k=m.getPlanGrid();CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Plan.MovePlansToTopic,
data:{courseId:this._planner.settings.CourseId,srcTopicId:c,dstTopicId:d,planIds:this._planIds,start:this._planner.settings.FilterStartDate,end:this._planner.settings.FilterEndDate,showPlanDates:this._planner.settings.ShowDates}}).done(function(b){l.toggleSelectAll(!1);k.removeEmptyText();var c=!m.hasPlans&&a._planner.currentDisplayMode===a._planner.settings.DisplayModes.Table;f.hasPlans=b.srcTopicHasPlans;m.hasPlans=!0;if(k.getGridElement().is(":visible"))if(c)for(m.refreshPlanGrid(),c=0;c<b.sortedPlanIds.length;c++)l.getRowById(b.sortedPlanIds[c]).remove();
else{c=k.getRowsContainer();for(var d=0;d<b.sortedPlanIds.length;d++)c.append(l.getRowById(b.sortedPlanIds[d]));a._planner.currentDisplayMode===a._planner.settings.DisplayModes.Table&&k.updateHeaderRowCheckBoxSelection();m.isTopicSelected()&&m.toggleTopicSelection()}else for(c=0;c<b.sortedPlanIds.length;c++)l.getRowById(b.sortedPlanIds[c]).remove();0===l.getRowsCount()&&l.getRowsContainer().html(b.emptyGridText);f.updateTopicExpanderLink(b.srcExpanderText);m.updateTopicExpanderLink(b.dstExpanderText);
f.hidePlanMoveOptionsIfNecessary();m.hidePlanMoveOptionsIfNecessary();CssModal.closeDialog()})}};a.prototype.initTopicDropDownListControl=function(){null==this._topicDropDownList&&(this._topicDropDownList=$("#"+this._settings.TopicDropDownListId))};a.prototype.reloadTopicList=function(){var a=this;this._topicDropDownList.empty();e.Cards.TopicCard.getAllTopicCardContainers().each(function(b,d){b=$(d);b=e.Cards.TopicCard.getInstanceByContainer(b);b=$('<option value="'+b.getTopicId()+'"></option>').text(b.getTopicName());
a._topicDropDownList.append(b)})};a.prototype.getCssModal=function(){return window[this._settings.MoveToTopicCssModalId]};return a}();f.PlanMoveToTopicDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d;(function(a){a[a.Initial=0]="Initial";a[a.Progress=1]="Progress";a[a.Error=2]="Error";a[a.Result=3]="Result"})(d||(d={}));var a;(function(a){a[a.CopyPlans=0]="CopyPlans";a[a.CopyTopics=1]="CopyTopics"})(a||(a={}));var b=function(){function b(a,c){this.settings=c;window[a]=this;b.instanceName=a;this.terms=c.Terms;this.css=c.Css;this.controls=c.Controls;this.webMethods=c.WebMethods;this.controlInitialized=!1}b.prototype.open=function(b,c,e,f){if(null!=c){this.initControls();
this.idsToCopy=c();if(b){if(null==this.idsToCopy||!this.idsToCopy.length){CCL.CommonFunctions.jAlertAjaxError(this.terms.NoTopicsSelected,this.terms.Alert,this.terms.Ok,!1);return}this.currentCopyMode=a.CopyTopics;this.$selectCourseLabel.text(this.terms.CopyTopicsToCourse)}else{if(null==this.idsToCopy||!this.idsToCopy.length){CCL.CommonFunctions.jAlertAjaxError(this.terms.NoPlansSelected,this.terms.Alert,this.terms.Ok,!1);return}this.currentCopyMode=a.CopyPlans;this.$selectCourseLabel.text(this.terms.CopyPlansToCourse)}this.clearSelectionCallback=
e;this.topicIdForCopyPlans=f;this.setCopyStage(d.Initial);this.getCssModal().openDialog()}};b.prototype.copy=function(){this.$coursesList.val()?(this.setCopyStage(d.Progress),this.copyInternal(this.currentCopyMode===a.CopyPlans?this.webMethods.CopyPlans:this.webMethods.CopyTopics)):this.$selectCourseErrorContainer.show()};b.prototype.copyInternal=function(a){var b=this,c=0<this.$optionOverwriteAssessmentCriteria.length?this.$optionOverwriteAssessmentCriteria.prop("checked"):!1;CCL.CommonFunctions.safeAjaxPost({url:a,
data:{sourceCourseId:this.settings.CourseId,targetCourseId:parseInt(this.$coursesList.val()),targetTopicId:parseInt(this.$targetCourseTopicsDropdown.val()),clearDates:this.$optionClearDates.prop("checked"),copyResourcesAndActivities:this.$optionCopyResourcesAndActivities.prop("checked"),overwriteAssessmentCriteria:c,elementIds:this.idsToCopy}}).done(function(a){b.$resultMessageHolder.html(a.ResultMessage);b.$resultNotesHolder.hide();0<a.ResultWarningNotes.length&&(b.$resultNotesHolder.show(),b.$resultNotesHolder.find("ol").html(a.ResultWarningNotes).show());
b.setCopyStage(d.Result)}).fail(function(){b.setCopyStage(d.Error)})};b.prototype.updateTopicsDropdown=function(a){var b=this;0!==a&&(this.$targetCourseTopicsDropdown.children().remove(),CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetTopics,data:{courseId:this.settings.CourseId,targetCourseId:a,originalTopicId:this.topicIdForCopyPlans}}).done(function(a){0===a.length&&b.$targetCourseTopicsPanel.hide();var c=b.settings.TopicsDropdownDefaultValue;c=$.grep(a,function(a){return!a.IsNewGroup});
c=b.addItemsToTopicDropdown(c,b.$targetCourseTopicsDropdown);a=$.grep(a,function(a){return a.IsNewGroup});if(a.length){var d=$("<optgroup></optgroup>").attr("label",b.terms.CreateNewTopic);b.addItemsToTopicDropdown(a,d);d.appendTo(b.$targetCourseTopicsDropdown)}b.$targetCourseTopicsDropdown.val(c.toString())}).fail(function(){b.setCopyStage(d.Error)}))};b.prototype.addItemsToTopicDropdown=function(a,b){var c=this.settings.TopicsDropdownDefaultValue;$.each(a,function(a,d){b.append($("<option />").val(d.TopicId.toString()).text(d.Name));
d.Selected&&(c=d.TopicId)});return c};b.prototype.getCssModal=function(){return window[this.settings.CssModalClientInstance]};b.prototype.initControls=function(){var a=this;this.controlInitialized||(this.$selectCourseLabel=$("#"+this.controls.SelectCourseLabel),this.$coursesList=$("#"+this.controls.CoursesList),this.$optionClearDates=$("#"+this.controls.OptionClearDates),this.$optionOverwriteAssessmentCriteria=$("#"+this.controls.OptionOverwriteAssessmentCriteria),this.$optionCopyResourcesAndActivities=
$("#"+this.controls.OptionCopyResourcesAndActivities),this.$resultMessageHolder=$("#"+this.controls.ResultMessageHolder),this.$resultNotesHolder=$("#"+this.controls.ResultNotesHolder),this.$overwriteAssessmentCriteriaPanel=$("#"+this.controls.OverwriteAssessmentCriteriaPanel),this.$dialogCancelButton=$("#"+this.controls.DialogCancelButton),this.$dialogOkButton=$("#"+this.controls.DialogOkButton),this.$dialogCloseButton=$("."+this.css.DialogCloseButton),this.$initialPanel=$("#"+this.controls.InitialPanel),
this.$progressPanel=$("#"+this.controls.ProgressPanel),this.$resultPanel=$("#"+this.controls.ResultPanel),this.$errorPanel=$("#"+this.controls.ErrorPanel),this.$copyOptions=$("#"+this.controls.CopyOptions),this.$targetCourseTopicsPanel=$("#"+this.controls.TargetCourseTopicsPanel),this.$targetCourseTopicsDropdown=$("#"+this.controls.TargetCourseTopicsList),this.$selectCourseErrorContainer=this.$initialPanel.find("."+this.css.CopyError),this.$coursesList.on("change",function(b){a.onCourseListChange(b)}),
this.controlInitialized=!0)};b.prototype.setCopyStage=function(a){switch(a){case d.Initial:this.$coursesList.val(null);this.$optionClearDates.prop("checked",!1);this.$optionCopyResourcesAndActivities.prop("checked",!0);0<this.$overwriteAssessmentCriteriaPanel.length&&(this.$overwriteAssessmentCriteriaPanel.show(),this.setOverwriteAssessmentCriteriaControlsState(e.CopyDialogOverwriteAssessmentCriteriaState.Show,!0));this.$targetCourseTopicsPanel.hide();this.$dialogOkButton.text(this.terms.Copy);this.$copyOptions.hide();
this.$selectCourseErrorContainer.hide();break;case d.Result:null!=this.clearSelectionCallback&&this.clearSelectionCallback();break;case d.Error:this.$dialogOkButton.text(this.terms.Retry)}this.$dialogCloseButton.toggle(a!==d.Progress);this.$dialogCancelButton.toggle(a!==d.Progress).text(a===d.Initial?this.terms.Cancel:this.terms.Close);this.$dialogOkButton.toggle(a===d.Initial||a===d.Error);this.$initialPanel.toggle(a===d.Initial);this.$progressPanel.toggle(a===d.Progress);this.$resultPanel.toggle(a===
d.Result);this.$errorPanel.toggle(a===d.Error)};b.prototype.setOverwriteAssessmentCriteriaControlsState=function(a,b){0<this.$optionOverwriteAssessmentCriteria.length&&(this.$optionOverwriteAssessmentCriteria.prop("disabled",a===e.CopyDialogOverwriteAssessmentCriteriaState.Disable),this.$overwriteAssessmentCriteriaPanel.toggleClass(this.css.Inactive,a===e.CopyDialogOverwriteAssessmentCriteriaState.Disable),this.$overwriteAssessmentCriteriaPanel.find("#"+this.controls.OverwriteAssessmentCriteriaLabel).toggle(a===
e.CopyDialogOverwriteAssessmentCriteriaState.Disable),b&&this.$optionOverwriteAssessmentCriteria.prop("checked",!1))};b.prototype.onCourseListChange=function(b){var c=$(b.currentTarget).val();this.$selectCourseErrorContainer.toggle(!c);this.$copyOptions.toggle(0!==c.length);if(this.currentCopyMode===a.CopyPlans&&0!==c.length){var d=!0;this.settings.CourseIdsNotUsedTopics&&($.each(this.settings.CourseIdsNotUsedTopics,function(a,b){return b===c?d=!1:!0}),this.$targetCourseTopicsPanel.toggle(d));d&&
this.updateTopicsDropdown(c)}0<this.$overwriteAssessmentCriteriaPanel.length&&(this.settings.OverwriteAssessmentCriteriaStateData?(b=parseInt(this.settings.OverwriteAssessmentCriteriaStateData[c]),this.$overwriteAssessmentCriteriaPanel.toggle(b!==e.CopyDialogOverwriteAssessmentCriteriaState.Hide),0<this.$optionOverwriteAssessmentCriteria.length&&this.setOverwriteAssessmentCriteriaControlsState(b,!1)):this.$overwriteAssessmentCriteriaPanel.toggle(c!==this.settings.CourseId))};return b}();e.PlannerCopyDialog=
b})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){window[a]=this;d.instanceName=a;this._settings=b;this._terms=b.Terms;this._planner=e.Planner.getInstance();this._courseId=this._planner.settings.CourseId}d.getInstance=function(){return window[d.instanceName]};d.prototype.addTopic=function(a,b,c,d){CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.AddTopic,data:{courseId:this._courseId,topicName:a,topicColorSchema:b},success:function(a){null!=c&&c();a&&a.refreshUrl&&(window.location.href=
a.refreshUrl)},error:function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c);null!=d&&d()}})};d.prototype.shareTopic=function(a,b){var c=this;if(a){var d=e.Cards.TopicCard.getInstance(a);CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.ShareablePlanner.CheckTopicDataForSharing,data:{courseId:this._courseId,topicId:a,isTopicSharedByAnotherAuthor:b}}).done(function(a){a&&a.conflictMessage?CCL.CommonFunctions.jAjaxAlert(a.conflictMessage,c._planner.terms.Alert,c._planner.terms.Ok):a&&
a.warningMessage?c._planner.showConfirmDialog(a.warningMessage,function(a){a&&d.redirectToShareTopic()}):d.redirectToShareTopic()}).fail(CCL.CommonFunctions.alertAjaxError)}};d.prototype.stopSharingTopic=function(a,b){var c=this;b&&CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.ShareablePlanner.StopSharingTopic,data:{courseId:this._courseId,topicId:b}}).done(function(a){a&&a.message?CCL.CommonFunctions.jAjaxAlert(a.message,c._planner.terms.Alert,c._planner.terms.Ok):window.location=
window.location}).fail(CCL.CommonFunctions.alertAjaxError)};d.prototype.deleteTopic=function(a){this.deleteTopics([a],!1)};d.prototype.deleteTopics=function(a,b){var c=this;void 0===a&&(a=null);void 0===b&&(b=!0);b&&null==a&&(a=e.Cards.TopicCard.getSelectedTopicIds(!0));null!=a&&(b=this.getDeleteTopicsConfirmationMessage(a),this._planner.showConfirmDialog(b,function(b){b&&CCL.CommonFunctions.safeAjaxPost({url:c._planner.webMethods.Topic.DeleteTopics,data:{courseId:c._courseId,topicIds:a}}).done(function(a){0<
a.deletedTopics.length&&($.each(a.deletedTopics,function(a,b){b.topicId&&0<b.topicId&&(e.Cards.TopicCard.getInstance(b.topicId).getTopicCardContainer().remove(),c.updateFilterAfterDeleting(b.topicId));b.folderId&&0<b.folderId&&e.PlannerUtility.deleteTopicFolderNode(b.folderId)}),e.Cards.TopicCard.hideTopicMoveOptionsIfNecessary(),c._planner.showNoTopicMessageIfNecessary(),c.showTopicFeedbackMessage(a.restoreText),c._planner.togglePlannerSharing())}).fail(CCL.CommonFunctions.alertAjaxError)},this._planner.terms.Delete,
this._planner.terms.Cancel))};d.prototype.restoreTopics=function(a){CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.RestoreTopics,data:{courseId:this._courseId,topicIds:a}}).done(function(a){a&&a.refreshUrl&&(window.location.href=a.refreshUrl)}).fail(CCL.CommonFunctions.alertAjaxError)};d.prototype.moveUpTopic=function(a){if(a){var b=e.Cards.TopicCard.getInstance(a).getTopicCardContainer(),c=b.prev();if(c){var d=e.Cards.TopicCard.getInstanceByContainer(c).getTopicId();CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.SwapTopics,
data:{courseId:this._courseId,firstTopicId:a,secondTopicId:d},success:function(a){a&&(b.insertBefore(c),e.Cards.TopicCard.hideTopicMoveOptionsIfNecessary())},error:CCL.CommonFunctions.alertAjaxError})}}};d.prototype.moveDownTopic=function(a){if(a){var b=e.Cards.TopicCard.getInstance(a).getTopicCardContainer(),c=b.next();if(c){var d=e.Cards.TopicCard.getInstanceByContainer(c).getTopicId();CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.SwapTopics,data:{courseId:this._courseId,
firstTopicId:a,secondTopicId:d},success:function(a){a&&(b.insertAfter(c),e.Cards.TopicCard.hideTopicMoveOptionsIfNecessary())},error:CCL.CommonFunctions.alertAjaxError})}}};d.prototype.updateFilterAfterDeleting=function(a){var b=this._planner.getPlannerFilter().find("optgroup[label='Topic']");b.find("option[value='t"+a+"']").remove();0===b.find("option[value^='t']").length&&b.remove()};d.prototype.showTopicFeedbackMessage=function(a){this._planner.getPlannerFeedback().showMessage(CCL.FeedbackType.Information,
a)};d.prototype.getDeleteTopicsConfirmationMessage=function(a){if(null==a||0===a.length)return"";var b=!1;e.Cards.TopicCard.getTopicCardsForTopicIds(a).forEach(function(a){a.hasConnectedFolder&&(b=!0)});a=1<a.length;var c="";return c=b?a?this._terms.DeleteTopicsConnectedToFolderConfirmText:this._terms.DeleteOneTopicConnectedToFolderConfirmText:a?this._terms.DeleteTopicsConfirmText:this._terms.DeleteOneTopicConfirmText};return d}();e.TopicCommonLogic=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(b){var c=this;window[a.instanceName]=this;this.playPlanContentItemIdAttributeName=b;$("body").on("click",CCL.CommonFunctions.getDataSelector(this.playPlanContentItemIdAttributeName),function(a){a.preventDefault();if(a=$(a.currentTarget))if(a=a.data(c.playPlanContentItemIdAttributeName)){var b=a.split("_")[0];e.PlayPlanDialog.getClientInstance().open(b,a)}})}a.getInstance=function(){return window[a.instanceName]};a.instanceName="playPlanDialogOpenerClientInstanceName";
return a}();e.PlayPlanDialogOpener=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(b){var c=this;this.indexDialogWidth=500;this.itemIdDataAttributeName="itemId";this.onEscape=function(a){a.which===CCL.CommonConstants.keyCodes.escape&&(c.indexDialog.isOpened()?c.indexDialog.closeDialog():c.toggleDialog(!1))};this.closeTooltip=function(a){setTimeout(function(){return c.toolTip.closeTooltip()},a)};this.openTooltip=function(a,b,d){setTimeout(function(){c.toolTip.isTooltipOpened()||c.$tooltipContentLabel.html(b);c.toolTip.openTooltip(a,
c.tooltipPositionSettings)},d)};window[a.clientInstanceName]=this;this.settings=b;$(function(){c.$body=$("body");c.$bodyWrapper=$("."+c.settings.CssClasses.BodyWrapper);c.$dialog=$("#"+c.settings.Controls.Dialog);c.$topicColumnNameLabel=$("#"+c.settings.Controls.TopicColumnNameLabel);c.$planColumnNameLabel=$("#"+c.settings.Controls.PlanColumnNameLabel);c.$topicTitleLabel=$("#"+c.settings.Controls.TopicTitleLabel);c.$planTitleLabel=$("#"+c.settings.Controls.PlanTitleLabel);c.$errorLabel=$("#"+c.settings.Controls.ErrorMessageLabel);
c.$frame=$("#"+c.settings.Controls.Frame);c.$loadingIndicator=$("#"+c.settings.Controls.LoadingIndicator);c.$prevButtons=$("."+c.settings.CssClasses.PrevButton);c.$nextButtons=$("."+c.settings.CssClasses.NextButton);c.$indexButtons=$("."+c.settings.CssClasses.IndexButton);c.$indexCancelMobileButton=$("#"+c.settings.Controls.IndexMobileCancelButton);c.$closeButton=$("#"+c.settings.Controls.CloseButton);c.$tooltipContentLabel=$("#"+c.settings.Controls.TooltipContentLabel);c.$indexDialogContainer=$("#"+
c.settings.Controls.IndexContainer);c.focusTracker=new CCL.FocusTracker(c.$dialog);c.$prevButtons.click(function(){return c.goToPreviousItem()});c.$nextButtons.click(function(){return c.goToNextItem()});c.$indexButtons.click(function(){return c.openIndexDialog()});c.$indexCancelMobileButton.click(function(){return c.indexDialog.closeDialog()});c.$closeButton.click(function(){return c.toggleDialog(!1)});c.initTooltip();c.toggleToolTip(c.$indexButtons,c.settings.Terms.ShowAllResources,!0);c.toggleToolTip(c.$closeButton,
c.settings.Terms.CloseThisPlan,!0);c.indexDialog=new ContextDialog(c.$indexDialogContainer,{setFocus:!0,showHeader:!1,showCloseLink:!1,showArrow:!0,expandParentFrame:!1,closeOnEscape:!1,footerContent:c.settings.Controls.IndexMobileCancelContainer,width:c.indexDialogWidth,zIndex:5,marginTop:1,marginLeft:0,align:"right",valign:"bottom",arrowOffset:"manual",arrowLeft:c.indexDialogWidth-c.$indexButtons.outerWidth()/2});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.fullScreenDialogOpening,
function(a,b){c.notifyFullScreenDialog(b)}.bind(c))})}a.getClientInstance=function(){return window[a.clientInstanceName]};a.prototype.open=function(a,c){this.playPlanItems=null;this.disableNavigationButtonsIfNeeds();this.clearContentFrame();this.toggleDialog(!0);this.loadPlanItems(a,c)};a.prototype.notifyFullScreenDialog=function(a){a&&CCL.CommonFunctions.makePostMessageCall(a,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.fullScreenDialogCollapseTitle))};a.prototype.displayOnboardingIfNeeds=
function(){var a=this;this.isNavigationButtonDisabled(this.$nextButtons)||$.get(this.settings.WebMethods.PlayPlanNavigationOnboardingFeatureUrl).done(function(b){b.IsCompleted||(a.openTooltip(a.$nextButtons,a.settings.Terms.GoToNextResource,500),CCL.CommonFunctions.safeAjax({url:a.settings.WebMethods.PlayPlanNavigationOnboardingFeatureUrl,type:"PUT",headers:(c={},c[a.settings.AntiforgerySettings.HeaderName]=a.settings.AntiforgerySettings.HeaderValue,c)}));var c})};a.prototype.adjustDialogPositionOnIosDevice=
function(a){if(CCL.CommonFunctions.isIosDevice()){var b=$(window.top).height()-this.$closeButton.height();this.$bodyWrapper.css("overflow",a?"hidden":"");this.$bodyWrapper.height(a?""+b:"auto")}};a.prototype.toggleDialog=function(a){this.suspendUpdateBreadCrumbsAndNavigation(a);this.toggleEscapeHandler(a);this.adjustDialogPositionOnIosDevice(a);this.$body.css("overflow",a?"hidden":"");this.$dialog.toggle(a);a?(CCL.CommonFunctions.makePostMessageCall(window.top,{messageName:CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame}),
this.suspendExpandCollaplseContentAreaFrame(!0),this.$startLink=$(":focus"),this.$closeButton.focus(),this.focusTracker.startTrackFocus()):(this.clearContentFrame(),this.suspendExpandCollaplseContentAreaFrame(!1),CCL.CommonFunctions.makePostMessageCall(window.top,{messageName:CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame}),this.focusTracker.stopTrackFocus(),this.$startLink.focus());IframeResizer.reportSetIframeDefaultHeight()};a.prototype.toggleEscapeHandler=function(a){if(a)this.$body.on("keyup",
this.onEscape);else this.$body.off("keyup",this.onEscape)};a.prototype.clearContentFrame=function(){this.setFrameUrl("about:blank")};a.prototype.loadPlanItems=function(a,c){var b=this;this.loadPlanItemsInProgress||(this.loadPlanItemsInProgress=!0,this.toggleHeaderLoadingText(!0),this.$errorLabel.hide(),CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.LoadItems,data:{planId:a}}).done(function(a){b.toggleHeaderLoadingText(!1);a&&(a.TopicColumnName&&b.$topicColumnNameLabel.text(a.TopicColumnName+
":"),a.PlanColumnName&&b.$planColumnNameLabel.text(a.PlanColumnName+":"),a.TopicTitle&&b.$topicTitleLabel.text(a.TopicTitle),a.PlanTitle&&b.$planTitleLabel.text(a.PlanTitle),b.$topicColumnNameLabel.toggle(a.UseTopics),b.$topicTitleLabel.toggle(a.UseTopics),b.$planColumnNameLabel.toggle(a.UseTopics),b.playPlanItems=a.Items,b.updateIndexDialogContainer(),b.currentPlanItemIndex=-1,(a=b.playPlanItems.filter(function(a){return a.ItemId===c})[0])?b.loadPlayPlanItem(a):b.navigateToPlayPlanItem(0),b.displayOnboardingIfNeeds())}).fail(function(a){a.status>=
CCL.CommonConstants.httpStatusCodes.badRequest&&(null!=a.responseText&&0<a.responseText.length||null!=a.statusText&&0<a.statusText.length)?b.showErrorMessage(null!=a.responseText&&0<a.responseText.length?a.responseText:a.statusText):b.showUnableToShowPlanErrorMessage()}).always(function(){b.loadPlanItemsInProgress=!1}))};a.prototype.toggleHeaderLoadingText=function(a){a?(this.$topicColumnNameLabel.add(this.$planColumnNameLabel).add(this.$topicTitleLabel).text(""),this.$planTitleLabel.text(this.settings.Terms.Loading)):
this.$planTitleLabel.text("")};a.prototype.loadPlayPlanItem=function(a){a?(this.currentPlanItemIndex=this.playPlanItems.indexOf(a),this.disableNavigationButtonsIfNeeds(),this.markCurrentItemAsSelected(a),this.setFrameUrl(a.ContentUrl)):this.showUnableToShowPlanErrorMessage()};a.prototype.markCurrentItemAsSelected=function(a){this.$indexDialogContainer.find("."+this.settings.CssClasses.IndexItem).removeClass(this.settings.CssClasses.IndexSelectedItem);a=CCL.CommonFunctions.getDataSelector(this.itemIdDataAttributeName,
a.ItemId);this.$indexDialogContainer.find("."+this.settings.CssClasses.IndexItem+a).addClass(this.settings.CssClasses.IndexSelectedItem)};a.prototype.navigateToPlayPlanItem=function(a){this.currentPlanItemIndex!==a&&this.loadPlayPlanItem(this.playPlanItems[a])};a.prototype.goToPreviousItem=function(){this.isNavigationButtonDisabled(this.$prevButtons)||1<=this.currentPlanItemIndex&&this.loadPlayPlanItem(this.playPlanItems[this.currentPlanItemIndex-1])};a.prototype.goToNextItem=function(){this.isNavigationButtonDisabled(this.$nextButtons)||
this.currentPlanItemIndex<this.playPlanItems.length-1&&this.loadPlayPlanItem(this.playPlanItems[this.currentPlanItemIndex+1])};a.prototype.openIndexDialog=function(){if(!this.isNavigationButtonDisabled(this.$indexButtons)){var a=this.$indexButtons.offset().left+this.$indexButtons.outerWidth()-this.indexDialogWidth,c=this.$indexButtons.outerHeight();this.indexDialog.openDialogAt(a,c,!1);this.closeTooltip(0);if(a=this.playPlanItems[this.currentPlanItemIndex-1])a=this.$indexDialogContainer.find("."+
this.settings.CssClasses.IndexItem+CCL.CommonFunctions.getDataSelector(this.itemIdDataAttributeName,a.ItemId)),this.$indexDialogContainer.animate({scrollTop:a.offset().top})}};a.prototype.updateIndexDialogContainer=function(){var a=this;this.$indexDialogContainer.html("");var c=$('<ul class="'+this.settings.CssClasses.IndexList+'"></ul>');$.each(this.playPlanItems,function(b,d){a.renderItem(c,d,b)});c.appendTo(this.$indexDialogContainer)};a.prototype.renderItem=function(a,c,d){var b=this;$("<li data-"+
this.itemIdDataAttributeName+"="+c.ItemId+">").append('<a href="javascript:void(0);">\n                             <img alt="" src="'+c.IconUrl+'" class="'+this.settings.CssClasses.IndexItemIcon+'"/>\n                             <span class="'+this.settings.CssClasses.IndexItemTitle+'">'+c.ItemTitle+"</span>\n                        </a>").addClass(this.settings.CssClasses.IndexItem).appendTo(a).click(function(){b.indexDialog.closeDialog();b.navigateToPlayPlanItem(d)})};a.prototype.showUnableToShowPlanErrorMessage=
function(){this.showErrorMessage(this.settings.Terms.UnableToShowPlan)};a.prototype.showErrorMessage=function(a){this.$errorLabel.text(a);this.$errorLabel.show();this.$loadingIndicator.hide()};a.prototype.disableNavigationButtonsIfNeeds=function(){this.disableNavigationButton(this.$nextButtons,null==this.playPlanItems||this.currentPlanItemIndex===this.playPlanItems.length-1,this.settings.Terms.GoToNextResource);this.disableNavigationButton(this.$prevButtons,null==this.playPlanItems||0===this.currentPlanItemIndex,
this.settings.Terms.GoToPreviousResource);this.disableNavigationButton(this.$indexButtons,null==this.playPlanItems||1===this.playPlanItems.length,this.settings.Terms.ShowAllResources)};a.prototype.disableNavigationButton=function(a,c,d){var b=this.isNavigationButtonDisabled(a)!==c;a.toggleHyperlink(!c);b&&this.toggleToolTip(a,d,!c)};a.prototype.suspendUpdateBreadCrumbsAndNavigation=function(a){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.suspendUpdateBreadCrumbsAndNavigation,
{suspend:a}))};a.prototype.suspendExpandCollaplseContentAreaFrame=function(a){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.suspendExpandCollaplseContentAreaFrame,{suspend:a}))};a.prototype.setFrameUrl=function(a){a?(this.$frame.prop("src",a),this.$loadingIndicator.hide()):(this.$frame.contents().find("html").html(""),this.$loadingIndicator.show())};a.prototype.isNavigationButtonDisabled=function(a){return!a.getIfHyperLinkEnabled()};
a.prototype.initTooltip=function(){this.tooltipPositionSettings={My:"right+23 top",At:"center bottom+10",Arrow:"bottom"};this.$toolTipContainer=$("#"+this.settings.Controls.TooltipContainer);this.toolTip=new CCL.CustomTooltip("playPlanToolTip",{contentContainer:this.$toolTipContainer,zIndex:10},this.settings.CssClasses.CustomTooltipCssClasses);this.$toolTipContainer.show()};a.prototype.toggleToolTip=function(a,c,d){var b=this;if(!CCL.CommonFunctions.isMobileDevice())if(d)a.on("mouseover",function(){b.indexDialog.isOpened()||
b.openTooltip(a,c,0)}).on("mouseleave",function(){return b.closeTooltip(0)});else this.closeTooltip(0),a.off("mouseover mouseleave")};a.clientInstanceName="playPlanDialogClientInstanceName";return a}();e.PlayPlanDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){var d=function(){function a(a,c){this.settings=c;window[a]=this;this.$okButton=$("#"+this.settings.Controls.OkButton);this.$cancelButton=$("#"+this.settings.Controls.CancelButton)}a.prototype.open=function(a,c,d,e){var b=this;null!=a&&(this.updateGridViewCallback=c,this.clearSelectionCallback=d,this.planIdList=a,this.toggleInProcess(!1),this.datePicker=window[this.settings.ClientInstanceNames.TimeSpanPicker],this.setPlanDatesModal=window[this.settings.ClientInstanceNames.SetPlanDatesModal],
this.datePicker.callbacks.onUserSelectionUpdated||(this.datePicker.callbacks.onUserSelectionUpdated=function(){b.setPlanDatesModal.adjustWindowSize()}),this.datePicker.clearData(),this.datePicker.setRecurringMode(this.planIdList),this.datePicker.showCurrentMode(),null!=e&&f.Planner.Cards.TopicCard.setDefaultDate(this.datePicker,e),this.setPlanDatesModal.openDialog())};a.prototype.setPlanDates=function(){this.toggleInProcess(!0);this.datePicker=window[this.settings.ClientInstanceNames.TimeSpanPicker];
if(null!=this.datePicker&&this.datePicker.validateDates())switch(this.datePicker.getCurrentMode()){case e.DatePickerMode.TimeSpan:this.updatePlansTimeSpan();break;case e.DatePickerMode.WeekAndDay:this.updatePlansWeekAndDay();break;case e.DatePickerMode.Event:this.updatePlansEvents()}else this.toggleInProcess(!1)};a.prototype.toggleInProcess=function(a){this.$okButton.toggleClass(this.settings.CssClasses.InProgress,a);a?(this.$okButton.attr("disabled","disabled"),this.$cancelButton.attr("disabled",
"disabled")):(this.$okButton.removeAttr("disabled"),this.$cancelButton.removeAttr("disabled"))};a.prototype.updatePlansTimeSpan=function(){var a=this,c=this.datePicker.getWeekDays();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPlansTimeSpan,data:{courseId:this.settings.CourseId,planIds:this.planIdList,start:this.datePicker.getStartDate(),stop:this.datePicker.getStopDate(),weekNumber:this.datePicker.getWeekNumber(),weekDays:0===c.length?"":JSON.stringify(c),isDateColumnDisplayed:this.settings.IsDateColumnDisplayed}}).done(function(b){a.updateGridViewCallback&&
a.updateGridViewCallback(b);a.clearSelectionCallback&&a.clearSelectionCallback();a.closeDialog()}).fail(function(b,c,d){CCL.CommonFunctions.alertAjaxError(b,c,d);a.toggleInProcess(!1)})};a.prototype.updatePlansWeekAndDay=function(){var a=this,c=this.datePicker.getWeekDays();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPlansWeekAndDay,data:{courseId:this.settings.CourseId,planIds:this.planIdList,start:this.datePicker.getStartWeek(),stop:this.datePicker.getStopWeek(),weekNumber:this.datePicker.getWeekNumber(),
weekDays:0===c.length?"":JSON.stringify(c),isDateColumnDisplayed:this.settings.IsDateColumnDisplayed}}).done(function(b){a.updateGridViewCallback&&a.updateGridViewCallback(b);a.clearSelectionCallback&&a.clearSelectionCallback();a.closeDialog()}).fail(function(b,c,d){CCL.CommonFunctions.alertAjaxError(b,c,d);a.toggleInProcess(!1)})};a.prototype.updatePlansEvents=function(){var a=this,c=this.datePicker.getEvents();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPlansEvents,data:{courseId:this.settings.CourseId,
planIds:this.planIdList,firstPlanEventIds:c,filterStartDate:this.settings.FilterStartDateTime,filterStopDate:this.settings.FilterStopDateTime,isDateColumnDisplayed:this.settings.IsDateColumnDisplayed}}).done(function(b){a.updateGridViewCallback&&a.updateGridViewCallback(b);a.clearSelectionCallback&&a.clearSelectionCallback();a.closeDialog()}).fail(function(){a.datePicker.showErrorMsg(e.DatePickerMode.Event);a.toggleInProcess(!1)})};a.prototype.closeDialog=function(){window.location.href=this.settings.DefaultTarget};
return a}();k.SetPlanDatesDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function a(a,c){var b=this;window[a]=this;this.settings=c;$(function(){b.topicColorPicker=window[b.settings.ColorPickerClientInstanceName];b.planner=e.Planner.getInstance()})}a.prototype.setupAndOpenTopicColorPicker=function(a){a=e.Cards.TopicCard.getInstance(a);this.topicColorPicker.getSelectedColorKey()!==a.getColorSchema()&&(this.topicColorPicker.setPickerLink(a.getColorPickerLink()),this.topicColorPicker.setColor(a.getColorSchema()),this.topicColorPicker.openPopup())};
a.prototype.updateTopicColor=function(a,c){CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Topic.SetTopicColorSchema,data:{courseId:this.planner.settings.CourseId,topicId:a,topicColorSchema:c}}).done(function(b){e.Cards.TopicCard.getInstance(a).setTopicColorSchema(c,b.topicColorSchemaCss)}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};return a}();f.TopicColorPicker=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b){var c=this;this.addingPlanIsInProgress=!1;this.closeTooltip=function(a){setTimeout(function(){return c.toolTip.closeTooltip()},a)};this.openTooltip=function(a,b,d){setTimeout(function(){c.$toolTipContent.html(b);c.toolTip.openTooltip(a,c.tooltipPositionSettings)},d)};window[a]=this;d.clientInstanceName=a;this.settings=b;this.courseId=this.settings.CourseId;this.kpi=this.settings.Kpi;this.$container=$("#"+this.settings.Controls.Container);
this.$addNewPlanLink=$("#"+this.settings.Controls.AddNewPlanLink);this.$addNewPlanLinkContainer=$("#"+this.settings.Controls.AddNewPlanLinkContainer);this.$newPlanToolTipContent=$("#"+this.settings.Controls.NewPlanToolTip);this.$toolTipContent=$("#"+this.settings.Controls.FieldsToolTip);this.initNewPlanToolTip();this.initFieldsToolTip();$(function(){c.datePeriodSelector=window[c.settings.Controls.DatePeriodSelector];$(c.datePeriodSelector).on(f.Controls.DatePeriodSelector.periodChangedEventName,function(a,
b){return c.loadPlans(b.startDate,b.endDate)});c.$container.on("click","."+c.settings.Css.SinglePlanEmptyOverlay,function(){return c.addPlan(!1)});c.$addNewPlanLink.on("click",function(){return c.addPlan(!0)});c.cbExpander=window[c.settings.Controls.Expander];CCL.CommonFunctions.attachPostMessageEventListener($(window),e.PlannerConstants.postMessages.SendElementIdToCourseFeature,function(a){e.Cells.Plan.ResourcesCell.PlanCbResourcesCell.getPlanActivityResourceCellInstance().refreshResourcesCell(a.relatedEntityId,
a.customId,!0)})})}d.getInstance=function(){return window[d.clientInstanceName]};d.prototype.getContainer=function(){return this.$container};d.prototype.getFilterStartDate=function(){return this.datePeriodSelector.getStartDate()};d.prototype.getFilterStopDate=function(){return this.datePeriodSelector.getEndDate()};d.prototype.reloadPlans=function(){this.loadPlans(this.datePeriodSelector.getStartDate(),this.datePeriodSelector.getEndDate())};d.prototype.getLibraryBrowserDialog=function(){return window[this.settings.Controls.LibraryBrowserDialog]};
d.prototype.changeDatePeriod=function(a){this.datePeriodSelector.changeDatePeriod(a)};d.prototype.measureEditPlan=function(){CCL.CommonFunctions.measureKpi(this.kpi.Url,this.kpi.Section,this.kpi.EditPlanMeasurement,this.kpi.Context)};d.prototype.updatePlansFolder=function(a,b){$("."+this.settings.Css.SinglePlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).attr("data-"+e.PlannerConstants.dataAttributes.FolderId,b)};d.prototype.loadPlans=function(a,b){var c=
this;this.datePeriodSelector.toggleNavigationButtons(!1);this.togglePlanTitleToolTip(this.$container,!1);this.$container.append($("<div>").addClass(this.settings.Css.LoadingIndicator));this.cbExpander.renderShowMoreLinkIfNeed(!1);CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.LoadPlans,data:{courseId:this.settings.CourseId,start:a,stop:b}}).done(function(a){c.$container.html(a.html);c.refreshCbExpander(!c.isSelectedWeekNotEmpty());c.renderAddNewPlanLinkIfNeeds();c.disableKeyboardNavigationIfWeekIsEmpty();
c.toggleFieldsToolTip(!0)}).fail(function(a,b,d){c.$container.empty();CCL.CommonFunctions.alertAjaxError(a,b,d)}).always(function(){c.datePeriodSelector.toggleNavigationButtons(!0)})};d.prototype.refreshCbExpander=function(a){this.cbExpander&&this.cbExpander.renderShowMoreLinkIfNeed(a);this.$container.removeClass(this.settings.Css.PlansContainerMinHeight)};d.prototype.addPlan=function(a){var b=this;this.addingPlanIsInProgress||(this.addingPlanIsInProgress=!0,this.toggleFieldsToolTip(!1),CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.AddPlan,
data:{courseId:this.settings.CourseId,start:this.datePeriodSelector.getStartDate(),stop:this.datePeriodSelector.getEndDate()}}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)}).done(function(c){a?(b.$container.append(c.ControlHtml),c=b.$container.find("."+b.settings.Css.SinglePlanContainer).last(),$("html, body",window.document).stop().animate({scrollTop:c.offset().top})):(b.$container.html(c.ControlHtml),b.$container.find("."+b.settings.Css.PlanTitleCell).find("."+b.settings.Css.HtmlTextCellViewer).click(),
b.togglePlanTitleToolTip(b.$container,!0));b.refreshCbExpander(!0);b.renderAddNewPlanLinkIfNeeds()}).always(function(){b.addingPlanIsInProgress=!1}))};d.prototype.renderAddNewPlanLinkIfNeeds=function(){this.$addNewPlanLinkContainer.toggle(this.isSelectedWeekNotEmpty())};d.prototype.isSelectedWeekNotEmpty=function(){return 0<$("."+this.settings.Css.SinglePlanContainer).not("[data-"+e.PlannerConstants.dataAttributes.PlanId+"=0]").length};d.prototype.togglePlanTitleToolTip=function(a,b){a=a.find("."+
this.settings.Css.PlanTitleCell).find("div"+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.HybridEditorItem));0<a.length&&this.showNewPlanToolTip(a,b)};d.prototype.initNewPlanToolTip=function(){this.newPlanToolTip=new CCL.CustomTooltip("newPlanToolTip",{contentContainer:this.$newPlanToolTipContent,zIndex:1},this.settings.Css.CustomTooltipCssClasses);this.$newPlanToolTipContent.show()};d.prototype.initFieldsToolTip=function(){this.toolTip=new CCL.CustomTooltip("fieldsToolTip",
{contentContainer:this.$toolTipContent,zIndex:1},this.settings.Css.CustomTooltipCssClasses);this.tooltipPositionSettings={My:"center bottom",At:"center top-10",Arrow:"top"};this.$toolTipContent.show()};d.prototype.disableKeyboardNavigationIfWeekIsEmpty=function(){var a=$("."+this.settings.Css.SinglePlanEmptyOverlay);0<a.length&&(this.$container.find("*").prop("tabindex","-1"),a.attr("tabindex","0"))};d.prototype.showNewPlanToolTip=function(a,b){var c=this,d,f,m=function(b){clearTimeout(f);clearTimeout(d);
f=setTimeout(function(){c.newPlanToolTip.isTooltipOpened()&&(c.newPlanToolTip.closeTooltip(),a.off(e.PlannerConstants.events.HybridEditorItemInlineModeChanged),c.toggleFieldsToolTip(!0))},b)},l=function(b){clearTimeout(f);clearTimeout(d);d=setTimeout(function(){c.newPlanToolTip.openTooltip(a,{My:"center top",At:"center bottom+10",Arrow:"bottom"});a.on(e.PlannerConstants.events.HybridEditorItemInlineModeChanged,function(a,b){b.isEditMode||m(300)})},b)};b?l(300):m(0)};d.prototype.toggleTooltipForField=
function(a,b,c){var d=this;void 0===c&&(c="");if(!CCL.CommonFunctions.isMobileDevice())if(b)a.on("mouseover",function(b){return d.openTooltip(a,c,0)}).on("mouseleave",function(){return d.closeTooltip(0)});else this.closeTooltip(0),a.off("mouseover mouseleave")};d.prototype.toggleFieldsToolTip=function(a){var b=this;if(!CCL.CommonFunctions.isMobileDevice()){var c=this.$container.find("."+this.settings.Css.PlanTitleCell);c.each(function(a){return b.toggleTooltipForField($(c[a]),!0,b.settings.Terms.PlanTitleCellTooltip)});
var d=this.$container.find("."+this.settings.Css.PlanTopicCell);d.each(function(a){return b.toggleTooltipForField($(d[a]),!0,b.settings.Terms.PlanTopicCellTooltip)});var e=this.$container.find("."+this.settings.Css.PlanDateCell);e.each(function(a){return b.toggleTooltipForField($(e[a]),!0,b.settings.Terms.PlanDateCellTooltip)});var f=this.$container.find("."+this.settings.Css.PlanEmptyThumbnailCell).closest("."+this.settings.Css.PlanThumbnailCell);f.each(function(a){return b.toggleTooltipForField($(f[a]),
!0,b.settings.Terms.PlanThumbnailCellTooltip)})}};return d}();e.CbPlanner=k})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;window[a.ClientInstanceName]=this;this.settings=a;this.folderSelector=window[a.FolderSelectorInstanceName];this.dialog=window[a.DialogInstanceName];this.grid=this.folderSelector.controls.grid;this.tree=this.folderSelector.controls.tree;this.tbody=$("#"+this.settings.LearningObjectiveTableClientId+" > tbody");this.checkBoxClientId=a.LearningObjectiveGridClientId+"_select_new";$(document).keyup(function(a){return b.keyup(a)});$(document).keydown(function(a){return b.keydown(a)});
this.dialog.setAfterOpenDialog(function(){b.dialog.setCloseConfirmation(function(){return!b.isEditorShown})})}d.prototype.showEditor=function(){var a=this,b=function(){a.isEditorShown||(a.initEditor(),a.tbody.prepend(a.editor),$("#"+a.checkBoxClientId).prop("checked",!0).prop("disabled",!0),a.toggleInsertButtons(!1));a.isEditorVisibleOnDisplay()||a.editor.animate({scrollTop:0},250);setTimeout(function(){a.editorInput.focus()},250)};this.folderSelector.selectedId===this.settings.NodeIdCreatedRoot?
b():this.folderSelector.navigateToNode(this.settings.NodeIdCreatedRoot,!1,!0,function(){return b()})};d.prototype.initEditor=function(){var a=this,b=$(this.settings.EditorTemplate),c=b.find("td").first(),d=this.grid.createCheckbox(this.checkBoxClientId);c.append(d);CCL.ModernCheckbox.BuildCheckbox(d,this.grid.cclGridConstants.terms.selectOneRow,!0,!0);this.editorInput=b.find("#"+this.settings.EditorClientId);this.editor=b;this.editorInput.on("blur",function(){return a.createLearningObjective()})};
d.prototype.createLearningObjective=function(){var a=this,b=this.editorInput.val().trim();if(""===b)this.removeEditor();else{this.editor.remove();var c=(new Date).getTime();this.renderGridRow({Id:c.toString(),Title:b});CCL.CommonFunctions.safeAjaxPost({data:{title:this.editorInput.val(),courseId:this.settings.CourseId},url:this.settings.CreateLearningObjectiveUrl}).done(function(b){var d=b.Items[0];a.addToCache(b);if(a.folderSelector.selectedId===a.settings.NodeIdCreatedRoot){if(b=a.tbody.find("#"+
c))b.data("id",d.Id),b.attr("data-id",d.Id);b.find("."+a.folderSelector.settings.cssClasses.itemCell+" > span").text(d.Title);a.grid._addRemoveSelectedValue(d.Id,!0);a.refreshTreeRow()}else a.folderSelector.controls.tree.refresh(a.settings.NodeIdCreatedRoot);a.toggleInsertButtons(!0)}).fail(function(){a.tbody.find("#"+c).remove();a.folderSelector.showErrorFeedback()})}};d.prototype.renderGridRow=function(a){var b=$("<tr id='"+a.Id+"' data-id=''></tr>").addClass(this.grid.cclGridConstants.cssClasses.selectedRow),
c=$("<td></td>").prop("class",this.grid.cclGridConstants.cssClasses.selectColumn),d=this.settings.LearningObjectiveGridClientId+"_select_"+a.Id,e=this.grid.createCheckbox(d);c.append(e);CCL.ModernCheckbox.BuildCheckbox(e,this.grid.cclGridConstants.terms.selectOneRow,!0,!0);b.append(c);c=$("<td></td>").addClass(this.folderSelector.settings.cssClasses.itemCell);a=$("<span class='LearningObjective'></span>").text(a.Title);c.append(a);b.append(c);this.tbody.prepend(b);this.grid.allowSelecting&&(this.initCheckBox(d,
!0),this.grid.addCheckBoxHandler(d))};d.prototype.refreshTreeRow=function(){this.folderSelector.controls.tree&&(this.folderSelector.selectedId=this.folderSelector.rootId,this.folderSelector.controls.tree.refresh(this.folderSelector.selectedId),this.folderSelector.navigateToNode(this.settings.NodeIdCreatedRoot,!1,!1),this.folderSelector.selectedId=this.settings.NodeIdCreatedRoot)};Object.defineProperty(d.prototype,"isEditorShown",{get:function(){return 1===this.tbody.find("#"+this.settings.EditorClientId).length},
enumerable:!0,configurable:!0});d.prototype.addToCache=function(a){var b=this.folderSelector.getCachedFolderData(this.settings.NodeIdCreatedRoot);if(null!=a.Folders)for(var c=b.folders,d=a.Folders.length,e=0;e<d;e++){var f=a.Folders[e];c.splice(0,0,{id:f.Id,title:f.Title,description:f.Description,cssClass:f.CssClass,isFolder:f.IsFolder,selectedByDefault:f.SelectedByDefault,setRootAsParent:f.SetRootAsParent})}c=b.items.pages[1];if(null!=a.Items)for(d=a.Items.length,e=0;e<d;e++)f=a.Items[e],c.splice(0,
0,{id:f.Id,title:f.Title,description:f.Description,cssClass:f.CssClass,isFolder:f.IsFolder,selectable:f.Selectable,selectedByDefault:!1});b.virtualItemCount++;this.folderSelector.cache[this.settings.NodeIdCreatedRoot]=b};d.prototype.isEditorVisibleOnDisplay=function(){var a=$(window).scrollTop(),b=a+$(window).height(),c=this.editorInput.offset().top;return c+this.editorInput.height()<=b&&c>=a};d.prototype.keyup=function(a){this.isEditorShown&&a.which===CCL.CommonConstants.keyCodes.escape&&(this.removeEditor(),
event.preventDefault())};d.prototype.keydown=function(a){this.isEditorShown&&a.which===CCL.CommonConstants.keyCodes.enter&&(this.createLearningObjective(),event.preventDefault())};d.prototype.toggleInsertButtons=function(a){this.folderSelector.toggleSelectButtons(a)};d.prototype.removeEditor=function(){this.editor.remove();this.toggleInsertButtons(this.grid.getSelectedIds()&&0!==this.grid.getSelectedIds().length)};d.prototype.initCheckBox=function(a,b){$("#"+a).prop("checked",b)};return d}();e.LearningObjectiveInlineEditor=
f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){window[d.clientInstanceName]=this;this.settings=a}d.getInstance=function(){return window[d.clientInstanceName]};d.prototype.updateLearningObjectiveDataSource=function(a){return this.updateLearningObjectivesDataSource([a])};d.prototype.updateLearningObjectivesDataSource=function(a){var b=this;return CCL.CommonFunctions.safeAjaxPost({url:this.settings.GetLearningObjectivesTooltipDataWebMethod,data:{learningObjectiveIds:a}}).done(function(a){$.each(a,
function(a,c){window[b.settings.TooltipDataSourceMethods.AddToDataSource](a,c.title,c.description,c.path)})}).fail(CCL.CommonFunctions.alertAjaxError)};d.clientInstanceName="PlannerLearningObjectiveToolTipManagerClientInstanceName";return d}();e.PlannerLearningObjectiveToolTipManager=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){window[a]=this;d.dataAttributes=b.DataAttributes;d.events=b.Events;d.postMessages=b.PostMessages}return d}();e.PlannerConstants=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){window[a]=this;d.instanceName=a;this._planner=e.Planner.getInstance()}d.getInstance=function(){return window[d.instanceName]};d.prototype.printTopics=function(){var a=this,b=e.Cards.TopicCard.getSelectedTopicIds(!0);null!=b&&(e.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),b.forEach(function(b){a.prepareTopicForPrint(b)}),window.print())};d.prototype.printPlans=function(a){(a=a.getTopicId())?(e.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),
this.prepareTopicForPrint(a)):this._planner.settings.UseTopics?(e.Cards.TopicCard.getAllTopicCardContainers().removeClass(this._planner.css.NoPrint),e.Cards.TopicCard.getPlansForAllTopics().removeClass(this._planner.css.NoPrint)):this.prepareAllPlansForPrint();window.print()};d.prototype.prepareAllPlansForPrint=function(){var a=this;e.Cards.TopicCard.getAllTopicCardContainers().each(function(b,c){c=e.Cards.TopicCard.getInstanceByContainer($(c)).getPlanGrid();b=c.getSelectedRows();c=c.getRows();0<
b.length?(c.addClass(a._planner.css.NoPrint),b.removeClass(a._planner.css.NoPrint)):c.removeClass(a._planner.css.NoPrint)})};d.prototype.prepareTopicForPrint=function(a){var b=e.Cards.TopicCard.getInstance(a);a=b.getTopicCardContainer();var c=b.getPlanGrid();b=c.getRows();c=c.getSelectedRows();a.removeClass(this._planner.css.NoPrint);0<c.length?(b.addClass(this._planner.css.NoPrint),c.removeClass(this._planner.css.NoPrint)):b.removeClass(this._planner.css.NoPrint)};d.prototype.printPlanner=function(a){null==
a?this._planner.settings.UseTopics?(e.Cards.TopicCard.getAllTopicCardContainers().removeClass(this._planner.css.NoPrint),e.Cards.TopicCard.getPlansForAllTopics().removeClass(this._planner.css.NoPrint)):this.prepareAllPlansForPrint():(e.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),this.prepareTopicForPrint(a));window.print()};return d}();e.PlannerPrint=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f;(function(a){a[a.NotLoaded=0]="NotLoaded";a[a.Loading=1]="Loading";a[a.Loaded=2]="Loaded"})(f||(f={}));var d=function(){return function(a,b,c){function d(a){var b=-a.width()/2;a=a.height();l.openDialogAt(b,a,!0);$(window.top).trigger($.Event("QuickAddMenuShow"))}var e=f.NotLoaded,m=$("<div class='ccl-context-dialog-content-container'></div>").hide();a.parent().append(m);var l=new ContextDialog(m,{showHeader:!1,showCloseLink:!1,useMobileViewIfNeeded:!1,valign:"bottom",
marginTop:12,marginBottom:0,marginLeft:0,marginRight:10,cssClass:c,toggleElement:a,noTitle:!0}),k=l.closeDialog;l.setCloseFunction(function(a){k(a);$(window.top).trigger($.Event("QuickAddMenuHide"))});window.addEventListener("orientationchange",function(a){return l.closeDialog(a)});m.click(function(){return l.closeDialog()});a.click(function(a){l.isOpened()?l.closeDialog():e===f.Loaded?d($(a.currentTarget)):e===f.NotLoaded&&(e=f.Loading,$.get(b,function(b){b&&(m.append(b),d($(a.currentTarget)));e=
f.Loaded}).fail(function(){return e=f.NotLoaded}))})}}();e.QuickAddMenu=d})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){(function(d){var a=function(){function a(a,b){var c=this;this.settings=b;window[a]=this;this.courseId=b.CourseId;$(function(){$("body").on("keyup","."+c.settings.Css.ImageUploaderContainer,function(a){var b=$(a.target);a.which===CCL.CommonConstants.keyCodes.enter&&b.getIfHyperLinkEnabled()&&b.find("input").click();a.preventDefault()}).on("change","."+c.settings.Css.ImageUploaderContainer,function(a){return c.uploadImage(a)}).on("click","."+c.settings.Css.DeleteButton,
function(a){return c.deleteImage(a)})})}a.prototype.uploadImage=function(a){var b=this,c=$(a.target),d=c.closest("."+this.settings.Css.CellContainer);this.hideImageLoadingError(d);a=a.target;c=parseInt(c.closest("."+this.settings.Css.PlanContainer).data(e.PlannerConstants.dataAttributes.PlanId),10);var l=f.UploadFileHelper.getFormDataWithAttachedFilesAndFileSizes(a);if(a=l.formData)if(l.fileSizes[0]>this.settings.MaxImageSizeInBytes)this.showImageLoadingError(d,this.settings.Terms.MaximumFileSizeForUpload);
else{var k=this.showLoading(d);e.CbPlanner.getInstance()&&e.CbPlanner.getInstance().toggleTooltipForField(d,!1);c=this.settings.WebMethods.UploadImage.replace("{courseId}",this.settings.CourseId.toString()).replace("{planId}",c.toString());$.ajax({type:"POST",url:c,contentType:!1,processData:!1,dataType:"json",data:a}).done(function(a){a.success?d.replaceWith(a.content):(b.toggleAddImage(d,!0),b.showImageLoadingError(d,a.errorMessage))}).fail(function(){CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,
b.settings.Terms.ErrorMessage,b.settings.Terms.Ok,!1)}).always(function(){return b.hideLoading(d,k)})}};a.prototype.deleteImage=function(a){var b=this;a=$(a.target);var c=a.closest("."+this.settings.Css.CellContainer);a=parseInt(a.closest("."+this.settings.Css.PlanContainer).data(e.PlannerConstants.dataAttributes.PlanId),10);CCL.CommonFunctions.safeAjax({type:"DELETE",url:this.settings.WebMethods.DeletePlanThumbnail,data:{courseId:this.settings.CourseId,planId:a}}).done(function(a){var d=c.parent();
c.replaceWith(a.controlHtml);e.CbPlanner.getInstance()&&e.CbPlanner.getInstance().toggleTooltipForField(d.find("."+b.settings.Css.CellContainer),!0,b.settings.Terms.AddImageTooltip)})};a.prototype.showLoading=function(a){var b=a.css("position");a.css("position","relative").append($('<div class="'+this.settings.Css.AjaxLoader+'"></div>'));this.toggleAddImage(a,!1);return b};a.prototype.hideLoading=function(a,b){a.css("position",b);a.find("."+this.settings.Css.AjaxLoader).replaceWith("")};a.prototype.showImageLoadingError=
function(a,b){b=$('<div class="'+this.settings.Css.ImageErrorMessage+'">'+b+"</div>");a.append(b)};a.prototype.hideImageLoadingError=function(a){a.find("."+this.settings.Css.ImageErrorMessage).replaceWith("")};a.prototype.toggleAddImage=function(a,b){a.find("."+this.settings.Css.AddImage).toggle(b)};return a}();d.PlanThumbnailCell=a})(k.Plan||(k.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){function d(a){var b=window.top;return window!=b?$("#item"+a,b.document):null}e.deleteTopicFolderNode=function(a){a&&(a=d(a))&&a.remove()};e.updateTopicFolderNode=function(a,b){a&&(a=d(a))&&(b=document.createTextNode(b),a.children("a:first").contents().filter(function(){return 3===this.nodeType}).replaceWith(b))}})(e.PlannerUtility||(e.PlannerUtility={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.topicsAutocomplete=function(a,b){c.topicsAutocompleteRequest&&c.topicsAutocompleteRequest.abort&&c.topicsAutocompleteRequest.abort();c.topicsAutocompleteRequest=CCL.CommonFunctions.safeAjaxPost({url:c.settings.WebMethods.FindTopics,data:{courseId:c.courseId,searchText:a.term}}).done(function(a){a.length?b($.map(a,function(a){return{label:a.Name,value:a.TopicId,metadata:a}})):b([{label:"",value:""}])}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,
b,c)}).always(function(){c.topicsAutocompleteRequest=void 0})};this.onTopicSelect=function(a,b){c.selectedTopic=b.item.metadata;c.$textInput.val(c.selectedTopic.Name);c.$textInput[0].blur();return!1};window[a]=this;this.courseId=b.CourseId;this.$textInput=$("#"+b.InputClientId);this.settings=b;var d=this;this.$textInput.autocomplete({focus:function(a){a.preventDefault()},position:{collision:"none flip",of:this.$textInput},source:this.topicsAutocomplete,select:this.onTopicSelect,delay:this.settings.Autocomplete.Delay,
minLength:this.settings.Autocomplete.MinLength,create:function(){$(this).data("ui-autocomplete")._renderItem=function(a,b){return $("<li>").append(b.metadata?String.format("<span>{0}</span>",CCL.CommonFunctions.htmlEncode(b.metadata.Name)):String.format("<span class='{0}'>{1}</span>",d.settings.Css.NoMatches,d.settings.Terms.NoMatches)).appendTo(a)};$(this).data("ui-autocomplete")._renderMenu=function(a,b){var c=this;$.each(b,function(b,d){c._renderItemData(a,d)});a.hasClass(d.settings.Css.AutocompleteMenu)||
a.addClass(d.settings.Css.AutocompleteMenu)}}});$(function(){b.CurrentTopic&&(c.currentTopic=b.CurrentTopic,c.$textInput.val(c.currentTopic.Name));c.$textInput.blur(function(){return c.onTopicChangeHandler()});c.$textInput.keydown(function(a){return c.keyDown(a)});c.cbPlanner=e.CbPlanner.getInstance()})}d.prototype.getPlanId=function(){var a=this.$textInput.closest("."+this.settings.Css.OnePlanContainer);return parseInt(a.data(e.PlannerConstants.dataAttributes.PlanId),10)};d.prototype.getCurrentTopicId=
function(){return this.currentTopic?this.currentTopic.TopicId:0};d.prototype.getSelectedTopicId=function(){return this.selectedTopic?this.selectedTopic.TopicId:0};d.prototype.checkIfNeedsToUpdateTopic=function(){var a=!0,b=this.$textInput.val().trim();this.currentTopic||this.selectedTopic||""!==b||(a=!1);if(this.getCurrentTopicId()===this.getSelectedTopicId()&&0<this.getCurrentTopicId()||this.currentTopic.Name===b)a=!1;return a};d.prototype.onTopicChangeHandler=function(){var a=this;if(this.checkIfNeedsToUpdateTopic()){var b=
this.getPlanId();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.ConnectPlanToTopic,data:{courseId:this.courseId,topicId:this.getSelectedTopicId(),planId:b,topicName:this.$textInput.val()}}).done(function(c){if(c){var d=c.topicInfo;a.currentTopic&&a.currentTopic.TopicId===d.TopicId||a.$textInput.attr("data-"+a.settings.TopicIdDataAttribute,d.TopicId);a.currentTopic=d;a.selectedTopic=null;a.$textInput.val(a.currentTopic.Name);c.isCurrentTopicRenamed&&(a.updateTopicName(a.currentTopic.TopicId,
a.currentTopic.Name),e.PlannerUtility.updateTopicFolderNode(c.topicConnectedFolderId,d.Name));a.cbPlanner.updatePlansFolder(b,c.topicConnectedFolderId)}}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})}};d.prototype.keyDown=function(a){a.which===CCL.CommonConstants.keyCodes.enter&&(a.preventDefault(),this.$textInput[0].blur());a.which===CCL.CommonConstants.keyCodes.escape&&(a.preventDefault(),this.selectedTopic=null,this.currentTopic&&this.$textInput.val(this.currentTopic.Name))};
d.prototype.updateTopicName=function(a,b){a=$("."+this.settings.Css.PlansContainer).find("."+this.settings.Css.TopicNameInput+CCL.CommonFunctions.getDataSelector(this.settings.TopicIdDataAttribute,a));$.each(a,function(a,d){$(d).val(b)})};return d}();e.TopicSelector=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,a,b){var c=this;this.sortDirection="DESC";this.refreshGrid=function(a,b){CCL.CommonFunctions.safeAjaxPost({url:c.context.WebMethods.LearnerLetters,data:{PersonId:c.context.PersonId,PageIndex:a-1,PageSize:b,SortDirection:c.sortDirection,SortColumn:c.sortColumn}}).done(function(a){null!=a&&(c.letters(a),c.updateScrollBarYHandler())})};this.pagerEventHandler=function(a){a===c.context.Pager.Name&&(a=window[a],c.refreshGrid(a.pageNumber,a.pageSize))};
this.changeSortColumn=function(a){c.sortColumn===a?c.sortDirection="DESC"===c.sortDirection?"ASC":"DESC":c.sortColumn=a;a=window[c.context.Pager.Name];c.refreshGrid(a.pageNumber,a.pageSize)};this.getCourseTitle=function(a){return a?a:c.context.LanguageTerms.All};this.openLetterLink=function(a){window.open(a,"_blank")};this.openProfile=function(a,b){a===c.context.PersonId?$("li[data-tab='about']").find("a").trigger("click"):document.showProfileCard?document.showProfileCard(a):window.raw_popup(b,"",
"resizable,scrollbars,height=500,width=750")};this.updateScrollBarYHandler=function(){c.lettersTabPage.perfectScrollbar("update");return!0};this.context=d;this.letters=ko.observableArray(a);this.sortColumn=d.Sort.CreatedDateColumnSortName;this.lettersTabPage=b;$(document).off(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName);$(document).on(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName,function(a,b){return c.pagerEventHandler(b)});
document.profileCardScope.isWindowLoading=!1;$(".c-modal__mask").on("click",document.profileCardScope.closeProfileCardWindow);b.perfectScrollbar({suppressScrollX:!0});this.updateScrollBarYHandler();$(window).on("resize",this.updateScrollBarYHandler);d=$(".c-profileCard[data-personid='"+d.PersonId+"']");ko.utils.domNodeDisposal.addDisposeCallback(d[0],function(){$(window).off("resize",this.updateScrollBarYHandler)})}}();e.ProfileLetters=f})(f.ProfileCard||(f.ProfileCard={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){var k=function(d){function a(a){var b=this;d.call(this,a.Urls.CheckSession,a.Resources.AnErrorOccurred);this.settings=a;this.toggleLightBulletinSubscriptionForPerson=function(a,c){return $.ajax({type:"PUT",url:b.settings.Urls.ToggleLightBulletinSubscriptionForPerson,data:{lightBulletinId:a,subscribe:c},dataType:"json"})};this.getStreamList=function(a,c){return $.ajax({type:"GET",url:b.settings.Urls.GetStreamList,data:{boundaryNotificationActiveFromTicks:a,boundaryNotificationId:c}})}}__extends(a,
d);return a}(f.CommonAjaxClient);e.StreamAjaxClient=k})(f.Stream||(f.Stream={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=f.LightBulletin.LightBulletinUtility,d=function(){function a(a,c){var b=this;this.controls=a;this.settings=c;this.numberOfRepeatsOfCheckingLastItemForIos=12;this.intervalBeforeCheckForLoading=250;this.minVisiblePartOfLastItemToLoadMore=.5;this.afterAddingComment=function(a){a=a.userData.sourceId;var c=b.getBulletinById(a);b.lightBulletinSingleItemDataManager.subscribeToCommentsIfNeeded(c,a)};this.lightBulletinMenuClicked=function(a){var c=b.lightBulletinSingleItemDataManager.getLightBulletinActionDropDownItem(a),
d=b.getBulletinById(c.LightBulletinId);if(c.ActionType===f.LightBulletin.LightBulletinDropDownMenuActionType.ToggleSubscription){var e=b.lightBulletinSingleItemDataManager.getSingleItemData(d).SubscriptionStatus!==f.LightBulletin.PersonSubscriptionStatus.Subscribed;b.ajaxClient.toggleLightBulletinSubscriptionForPerson(c.LightBulletinId,e).done(function(c){return f.LightBulletin.GenericResponseHandler.handle(c,function(){return b.lightBulletinSingleItemDataManager.updateSubscriptionStatus(d,a,e)})}).fail(b.ajaxClient.handleAjaxError);
b.resetFocusOnCurrentItem(d)}};this.resetLastItem=function(){b.lastItem.removeAttr("data-"+b.settings.DataAttributes.BoundaryNotificationActiveFromTicks).removeAttr("data-"+b.settings.DataAttributes.BoundaryNotificationId);b.lastItem=$()};this.getCurrentLastItem=function(){return b.controls.ItemsContainer.find("[data-"+b.settings.DataAttributes.BoundaryNotificationActiveFromTicks+"]")};this.isAllItemsLoaded=function(){return 0===b.lastItem.length};this.lightBulletinContentNodeSelector="[data-"+this.settings.DataAttributes.LightBulletinId+
"]";e.StreamContentBlockInstance=this;this.lastItem=this.getCurrentLastItem();this.isFirstCallLazy=!0;this.oembedError=new f.LightBulletin.EmbedError(this.settings.OembedErrorCssClasses,this.settings.OembedErrorResources);this.linkifyTextNodes(this.controls.ItemsContainer);this.isIosDevice=CCL.CommonFunctions.isIosDevice();this.textExpander=new CCL.TextExpander("LightBulletinTextExpander",this.settings.TextExpanderSettings);this.lightBulletinShowMoreLinkRenderer=new f.LightBulletin.ShowMoreLinkRenderer(this.settings.ShowMoreLinkRendererSettings,
this.textExpander);this.lightBulletinEmbedAsynchronousLoader=new f.LightBulletin.EmbedAsynchronousLoader({isIosDevice:this.isIosDevice,cssClasses:{noBorder:this.settings.CssClasses.Border0,ajaxLoader:this.settings.CssClasses.AjaxLoader,oembedError:this.settings.OembedErrorCssClasses.OembedBoxError},selectors:{embedBox:"."+this.settings.CssClasses.OembedBox,bulletinItem:this.lightBulletinContentNodeSelector},dataAttributes:{embedIframeUrl:this.settings.DataAttributes.EmbedIframeUrl}});this.lightBulletinSingleItemDataManager=
new f.LightBulletin.LightBulletinSingleItemDataManager(this.settings.LightBulletinSingleDataDataAttributes,this.settings.LightBulletinSingleItemDataResources);this.ajaxClient=new e.StreamAjaxClient(this.settings);this.listenToEmbedPostmessages();this.isAllItemsLoaded()||(this.isMobile()||this.loadIfReachedLastItem(!1,0),$(window).on(this.isIosDevice?"touchmove":"scroll",function(){b.isMobile()||b.loadIfReachedLastItem(!1,b.isIosDevice?b.numberOfRepeatsOfCheckingLastItemForIos:0)}),this.controls.ShowMoreLink.click(function(a){b.controls.ShowMoreLink.hide();
b.loadIfReachedLastItem(!0,0);a.preventDefault()}));f.LightBulletin.EmbedResizer.listenToEmbedSizePostmessages(this.controls.ItemsContainer,this.settings.CssClasses.OembedContent,this.lightBulletinShowMoreLinkRenderer,this.lightBulletinEmbedAsynchronousLoader);this.renderShowMoreInLightBulletins(this.controls.ItemsContainer.find(this.lightBulletinContentNodeSelector));this.lightBulletinEmbedAsynchronousLoader.appendIframeHolders(this.controls.ItemsContainer);this.lightBulletinEmbedAsynchronousLoader.loadEmbedContentAsync();
this.lightBulletinSingleItemDataManager.registerDropDownMenuClickHandler(this.isIosDevice,this.lightBulletinMenuClicked)}a.prototype.resetFocusOnCurrentItem=function(a){$(a).parent().find(".itsl-cb-stream-item-header > a").first().focus()};a.prototype.loadIfReachedLastItem=function(a,c){var b=this;if(this.isAllItemsLoaded()||!a&&!CCL.CommonFunctions.isOnScreen(this.lastItem,this.minVisiblePartOfLastItemToLoadMore,this.minVisiblePartOfLastItemToLoadMore,this.isIosDevice?window.parent:window))0<c&&
setTimeout(function(){b.loadIfReachedLastItem(a,c-1)},this.intervalBeforeCheckForLoading);else{var d=this.lastItem.attr("data-"+this.settings.DataAttributes.BoundaryNotificationActiveFromTicks),e=this.lastItem.attr("data-"+this.settings.DataAttributes.BoundaryNotificationId);this.resetLastItem();this.ajaxClient.getStreamList(d,e).done(function(a){a&&(a=$(a),b.controls.ItemsContainer.append(a),b.linkifyTextNodes(a),b.renderShowMoreInLightBulletins(b.controls.ItemsContainer.find(b.lightBulletinContentNodeSelector)),
b.isFirstCallLazy&&($.ajax(b.settings.Urls.MeasureLazyLoading),b.isFirstCallLazy=!1),b.lightBulletinEmbedAsynchronousLoader.appendIframeHolders(a));b.lastItem=b.getCurrentLastItem();b.isAllItemsLoaded()||b.controls.ShowMoreLink.show()}).fail(CCL.CommonFunctions.alertAjaxError)}};a.prototype.renderShowMoreInLightBulletins=function(a){var b=this;a.each(function(a,c){a=$(c);k.setTabindexToHiddenElements(a,b.lightBulletinShowMoreLinkRenderer.findClickablePlaceholder(a),"."+b.settings.CssClasses.ElementLink)});
this.lightBulletinShowMoreLinkRenderer.renderShowMoreWithImagesHack(a,"[data-"+this.settings.DataAttributes.AttachedImage+"]",this.lightBulletinContentNodeSelector,function(a,c){k.setTabindexToHiddenElements(a,c,"."+b.settings.CssClasses.ElementLink)})};a.prototype.linkifyTextNodes=function(a){f.LightBulletin.LightBulletinLinkifyWrapper.linkifyNodes(a.find("[data-"+this.settings.DataAttributes.LightBulletinContent+"]"))};a.prototype.isMobile=function(){return CCL.CommonFunctions.checkScreenSize(CCL.CommonConstants.mediaScreenSizes.mobile,
!1)};a.prototype.getBulletinById=function(a){return this.controls.ItemsContainer.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.LightBulletinId,a))};a.prototype.listenToEmbedPostmessages=function(){var a=this;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentData,function(b){var c=a.controls.ItemsContainer.find("#"+b.oembedPlaceHolderId);a.lightBulletinEmbedAsynchronousLoader.removeAjaxLoader(c);a.controls.ItemsContainer.removeClass(a.settings.CssClasses.AjaxLoader);
b.isPlainLink&&!a.oembedError.hasOembedError(c)&&(c.append(a.oembedError.generateOembedError({originalEmbedCode:b.originalEmbedCode,oembedPlaceHolder:c},a.lightBulletinEmbedAsynchronousLoader)),a.lightBulletinShowMoreLinkRenderer.renderShowMoreLink(c.closest(a.lightBulletinContentNodeSelector),!1))})};return a}();e.StreamContentBlock=d})(f.Stream||(f.Stream={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this._templates={};window[a]=this;d.instanceName=a;this._settings=b;this.css=b.Css;this.webMethods=b.WebMethods;a=$("#"+this._settings.Controls.PlanTemplateId).html();var e=$("#"+this._settings.Controls.TopicTemplateId).html();this._templates[this._settings.Controls.PlanTemplateId]=Handlebars.compile(a);this._templates[this._settings.Controls.TopicTemplateId]=Handlebars.compile(e);this._container=$("."+b.Css.Container);setTimeout(function(){c.initTimeline()},
100);this._planContextDialog=new ContextDialog("#"+this._settings.Controls.PlanContextDialogId,{valign:"bottom",width:500,zIndex:2,closeButtonTooltip:b.Terms.Close})}d.getInstance=function(){return window[d.instanceName]};d.prototype.getContainer=function(){return this._container};d.prototype.isEmpty=function(){return this._settings.UseTopics?0===this._topics.length:0===this._plans.length};d.prototype.refresh=function(){return this._settings.UseTopics?this.loadTopics():this.loadTopicPlans()};d.prototype.toggleTimeline=
function(a,b){var c=this;this.getContainer().hide();a?($("#"+this._settings.Controls.LoadingLabelId).show(),this.refresh().done(function(){return c.showEmptyMessageIfNecessary()})):b&&this.toggleEmptyMessage(!1);$("#"+this._settings.Controls.LoadingLabelId).hide()};d.prototype.showEmptyMessageIfNecessary=function(){this.toggleEmptyMessage(this.isPlannerTimelineEmpty());this.getContainer().toggle(!this.isPlannerTimelineEmpty())};d.prototype.toggleEmptyMessage=function(a){var b=this._container.parent().find("."+
this._settings.Css.NoTopicsMessage);b&&b.toggle(a)};d.prototype.isPlannerTimelineEmpty=function(){return this._settings.UseTopics&&0===this._topics.length||!this._settings.UseTopics&&0===this._plans.length};d.prototype.initTimeline=function(){var a=this;this._timeline=new vis.Timeline(this._container[0],null,{margin:{item:{vertical:25,horizontal:5E3}},selectable:!1,locale:this._settings.Language,order:function(b,c){return a.orderTimelineItems(b,c)},template:function(b){return(0,a._templates[b.template])(b)},
zoomMin:432E6,zoomMax:321408E5,maxHeight:500});this._timeline.on("click",function(b){a._planContextDialog.isOpened()&&a._planContextDialog.closeDialog();a.expandCollapseTimelineItem(b)});$(document).trigger(this._settings.Events.TimelineControlInitialized)};d.prototype.expandCollapseTimelineItem=function(a){if(null!=a.item&&!$(a.event.target).hasClass(this.css.ItemTitle)){var b=a.item.split("#");if(1===b.length){var c=this.getTopicItem(a.item);b=this._timeline.itemSet.itemFromTarget(a.event).dom.box;
$(b).toggleClass(this.css.TopicArrowCollapsed,null!=c.Plans);$(b).toggleClass(this.css.TopicArrowExpanded,null==c.Plans);$(b).attr("title",this._settings.Terms.HidePlans);null!=c.Plans?(this.removeItemsFromTopicTimeline(c),$(b).attr("title",this._settings.Terms.ShowPlans)):this.loadTopicPlans(a.item)}else c=b[1],(b=this.getPlanItem(a.item,b[0]))&&this.openDialogAndLoadPlanContents(c,b.Content,a)}};d.prototype.openDialogAndLoadPlanContents=function(a,b,c){var d=this;this._planContextDialog.setTitle(b);
this._planContextDialog.openDialog(c.event.srcEvent);this._planContextDialog.setContent(this._settings.Terms.Loading);CCL.CommonFunctions.safeAjaxPost({url:this._settings.WebMethods.GetSinglePlanForPlannerXhtml,data:{planId:a,courseId:this._settings.CourseId,childId:this._settings.ChildId,dashboardHierarchyId:this._settings.DashboardHierarchyId}}).done(function(a){return d._planContextDialog.setContent(a.contentHtml)})};d.prototype.refreshTimeline=function(){var a=this,b=[],c=[];this._settings.UseTopics?
$.each(this._topics,function(d,e){b.push(a.getTimelineItem(e,!1,e.Id,e.ColorSchemaClass));c.push({id:e.Id,content:"",order:e.Order});null!=e.Plans&&$.each(e.Plans,function(c,d){b.push(a.getTimelineItem(d,!0,e.Id,d.Active?e.ColorSchemaClass:a._settings.Css.InactivePlan))})}):$.each(this._plans,function(d,e){b.push(a.getTimelineItem(e,!0,e.Id,e.Active?a._settings.Css.DefaultColorSchemaClass:a._settings.Css.InactivePlan));c.push({id:e.Id,content:"",order:e.Order})});0<b.length&&this._timeline.setData({groups:c,
items:b})};d.prototype.setViewOptions=function(a,b,c,d){this._timeline.setOptions({start:a,end:b,min:c,max:d})};d.prototype.addItemsToTopicTimeline=function(a){var b=this;$.each(a.Plans,function(c,d){b._timeline.itemsData.add(b.getTimelineItem(d,!0,a.Id,d.Active?a.ColorSchemaClass:b._settings.Css.InactivePlan))})};d.prototype.removeItemsFromTopicTimeline=function(a){if(null!=a.Plans){var b=[];$.each(a.Plans,function(a,d){b.push(d.Id)});this._timeline.itemsData.remove(b);a.Plans=null}};d.prototype.loadTopics=
function(){var a=this;return CCL.CommonFunctions.safeAjaxPost({url:this._settings.WebMethods.GetTopicsForPlannerTimeline,data:{courseId:this._settings.CourseId,start:this._settings.FilterStartDate,end:this._settings.FilterEndDate,childId:this._settings.ChildId,topicId:this._settings.FilteredTopicId,termId:this._settings.FilteredTermId}}).done(function(b){b&&b.topics&&(a.setViewOptions(b.initialStart,b.initialEnd,b.minStart,b.maxEnd),a._topics=b.topics,a.refreshTimeline())}).fail(function(){return CCL.CommonFunctions.alertAjaxError})};
d.prototype.loadTopicPlans=function(a){var b=this;void 0===a&&(a="");return CCL.CommonFunctions.safeAjaxPost({url:this._settings.WebMethods.GetPlansForPlannerTimeline,data:{courseId:this._settings.CourseId,topicIdString:a,start:this._settings.FilterStartDate,end:this._settings.FilterEndDate,childId:this._settings.ChildId}}).done(function(c){if(c&&c.plans)if(b._settings.UseTopics){var d=b.getTopicItem(a);d.Plans=c.plans;b.addItemsToTopicTimeline(d);c.topicStartDate&&c.topicStopDate&&(d.Start=c.topicStartDate,
d.End=c.topicStopDate,b._timeline.itemsData.update(b.getTimelineItem(d,!1,d.Id,d.ColorSchemaClass)))}else b.setViewOptions(c.initialStart,c.initialEnd,c.minStart,c.maxEnd),b._plans=c.plans,b.refreshTimeline()}).fail(function(){return CCL.CommonFunctions.alertAjaxError})};d.prototype.getTopicItem=function(a){return this.getItem(this._topics,a)};d.prototype.getPlanItem=function(a,b){void 0===b&&(b=null);b=null!=b&&this._settings.UseTopics?this.getTopicItem(b).Plans:this._plans;return this.getItem(b,
a)};d.prototype.getItem=function(a,b){var c=null;$.each(a,function(a,d){return d.Id===b?(c=d,!1):!0});return c};d.prototype.getTimelineItem=function(a,b,c,d){var e=this.isTopicExpanded(a,b)?this._settings.Css.TopicArrowExpanded:this._settings.Css.TopicArrowCollapsed;return{id:a.Id,content:a.Content,start:a.Start,end:a.End,className:b?d+" "+this._settings.Css.Plan:d+" "+e,group:c,subgroup:b?a.Order:0,template:b?this._settings.Controls.PlanTemplateId:this._settings.Controls.TopicTemplateId,custom:b?
a.ElementsCount:null,active:a.Active,title:b?this._settings.Terms.OpenPlanDetails:this.isTopicExpanded(a,b)?this._settings.Terms.HidePlans:this._settings.Terms.ShowPlans}};d.prototype.isTopicExpanded=function(a,b){return!b&&null!=a.Plans};d.prototype.orderTimelineItems=function(a,b){return b.subgroup-a.subgroup};d.prototype.parseDateFromString=function(a){return null!=a?$.datepicker.parseDate(this._settings.DateTimeFormat,a):null};return d}();e.PlannerTimeline=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.dataAttributes=a;this.resources=b}d.prototype.getLightBulletinActionDropDownItem=function(a){return a.data(this.dataAttributes.LightBulletinActionDropDownItem)};d.prototype.getSingleItemData=function(a){return a.data(this.dataAttributes.LightBulletinSingleItemData)};d.prototype.updateSingleItemData=function(a,b){a.data(this.dataAttributes.LightBulletinSingleItemData,b)};d.prototype.refreshSingleItemData=function(a,b){var c=this.getSingleItemData(a);
b(c);this.updateSingleItemData(a,c);return c};d.prototype.getToggleSubscriptionLink=function(a){return $(CCL.CommonFunctions.getDataSelector(this.dataAttributes.LightBulletinActionDropDownItemToggleSubscriptionLink,a))};d.prototype.updateSubscriptionStatus=function(a,b,c){this.refreshSingleItemData(a,function(a){return a.SubscriptionStatus=c?e.PersonSubscriptionStatus.Subscribed:e.PersonSubscriptionStatus.UnsubscribedManually});b.text(c?this.resources.TurnOffNotifications:this.resources.TurnOnNotifications)};
d.prototype.registerDropDownMenuClickHandler=function(a,b){$(document).on(a?"touchstart":"click",CCL.CommonFunctions.getDataSelector(this.dataAttributes.LightBulletinActionDropDownItem),function(a){a.preventDefault();b($(a.currentTarget))})};d.prototype.subscribeToCommentsIfNeeded=function(a,b){this.getSingleItemData(a).SubscriptionStatus===e.PersonSubscriptionStatus.WasNotSubscribed&&this.updateSubscriptionStatus(a,this.getToggleSubscriptionLink(b),!0)};return d}();e.LightBulletinSingleItemDataManager=
f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(a,b,c,d){var e=this;this.$itemSelector=a;this.idDataAttribute=b;this.selectAllItemId=c;this.languageTerms=d;this.hasItems=function(){return 0<e.getAllItems().length};this.getItemId=function(a){a=e.getItemIdByDataAttribute(e.getItem(a));return e.areAllItemsSelected(a)?null:a};this.setDefaultItemText=function(a){a=e.getItem(a);var b=e.getItemIdByDataAttribute(a);a=e.areAllItemsSelected(b)?e.languageTerms.All+" "+e.languageTerms.Items.toLowerCase():
a.text();e.$itemSelector.text(a)};this.getAllItems=function(){return e.$itemSelector.parent().find("[data-"+e.idDataAttribute+"]")};this.isItem=function(a){return null!=a.closest("[data-"+e.idDataAttribute+"]")};this.getItem=function(a){return a.closest("[data-"+e.idDataAttribute+"]")};this.getItemIdByDataAttribute=function(a){return a.data(e.idDataAttribute)};this.areAllItemsSelected=function(a){return a===e.selectAllItemId}}}(),d=function(){function a(b,c,d){var e=this;this.settings=c;this.controls=
d;this.initPerfectScrollbar=function(){e.controls.MenuContainer.perfectScrollbar({suppressScrollX:!0});$(window).on("resize",e.updateScrollBarYHandler)};this.updateScrollBarYHandler=function(){e.controls.MenuContainer.perfectScrollbar("update")};this.onItemClickHandler=function(b){var c=e.itemSelectorManagerManager.getItemId($(b.target));void 0!==c&&(e.selectedItemId=c,e.itemSelectorManagerManager.setDefaultItemText($(b.target)),e.controls.ItemSelector.trigger(a.itemSelectorOnChangeEventName,e))};
window[b]=this;this.itemSelectorManagerManager=new f(this.controls.ItemSelector,this.settings.DataAttributes.ItemId,this.settings.SelectAllItemId,this.settings.LanguageTerms);this.initPerfectScrollbar();this.controls.ItemSelector.parent().on("focusin",function(){e.controls.ItemSelector.addClass(e.settings.CssClasses.MenuIsActive)});this.controls.ItemSelector.parent().on("focusout",function(){e.controls.ItemSelector.removeClass(e.settings.CssClasses.MenuIsActive)});this.controls.ItemSelector.on("keyup",
function(a){a.which===CCL.CommonConstants.keyCodes.enter&&e.controls.ItemSelector.trigger("click")});this.controls.MenuContainer.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onItemClickHandler);this.itemSelectorManagerManager.getAllItems().on("keyup",function(a){a.which===CCL.CommonConstants.keyCodes.enter&&(e.onItemClickHandler(a),e.controls.MenuContainer.trigger("click"))})}Object.defineProperty(a.prototype,"hasItems",{get:function(){return this.itemSelectorManagerManager.hasItems()},
enumerable:!0,configurable:!0});a.itemSelectorOnChangeEventName="itemSelector:onchange";return a}();e.ItemSelector=d})(f.ItemSelector||(f.ItemSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.settings=a;this.modalDialog=window[this.settings.ContainerId]}d.prototype.openDialog=function(a,b){this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,b,!1);this.modalDialog.setTitle(a.header);$("#"+this.settings.HeaderId).text(a.assessmentName);this.modalDialog.openDialog(!1)};return d}();e.TermAssessmentDialogManager=f})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function a(b,d){var c=this;this.serviceUrls=b;this.model=d;this.getAssessments=function(){var a={supervisorType:c.model.supervisorType,courseId:c.model.courseId,termId:c.model.termId(),categoryIds:c.model.categoryIds()};a=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.Assessments,data:a,dataType:"json"});a.done(function(a){c.model.addAssessments(a)});return a};this.getAssessmentPersonResults=function(){var b={supervisorType:c.model.supervisorType,courseId:c.model.courseId,
assessmentIds:c.model.assessments().map(function(a){return a.id}),paging:{pageIndex:c.model.assessmentPersonResultsCurrentPage,pageSize:a.pageSize},sortDescending:c.model.sortDescending};b=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.AssessmentPersonResults,data:b,dataType:"json"});b.done(function(a){c.model.addAssessmentPersonResults(a)});return b}}a.pageSize=50;return a}(),d=function(){function a(a){var b=this;this.settings=a;this.isScrollingInProgress=!1;this.assessmentPersonResultsCurrentPage=
0;this.sortDescending=!1;this.initialise=function(){b.areAssessmentsBeingLoaded(!0);b.dataFetcher.getAssessments()};this.addAssessments=function(a){a&&(a=a.map(function(a){return{id:a.Id,title:a.Title}}),[].push.apply(b.assessments(),a),b.assessments.valueHasMutated());b.areAssessmentsBeingLoaded(!1);b.fetchAssessmentPersonResultsData(b.resetAssessmentRecordScroll)};this.addAssessmentPersonResults=function(a){if(a){var c=a.map(function(a){return{personId:a.PersonId,fullName:a.FullName,pictureUrl:a.PictureUrl,
fallbackProfileUrl:a.FallbackProfileUrl,fallbackPictureUrl:a.FallbackPictureUrl,tooltipText:a.TooltipText,results:a.Results.map(function(a){return{gradebookItemId:a.GradebookItemId,score:a.Score?a.Score:"-",hasComment:a.HasComment}})}});[].push.apply(b.assessmentPersonResults(),c);b.assessmentPersonResults.valueHasMutated()}0===b.assessmentPersonResultsCurrentPage?b.areAssessmentsPersonResultsBeingLoaded(!1):b.isAssessmentsPersonResultsPageBeingLoaded(!1);(!a||0===a.length||a.length<k.pageSize)&&
b.areAllAssessmentPersonResultsRetreived(!0);b.assessmentPersonResultsCurrentPage++;b.$assessmentColumnsContainer.perfectScrollbar("update")};this.openProfileCard=function(a){document.showProfileCard?document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,"","resizable,scrollbars,height=500,width=750")};this.sortByName=function(){b.sortDescending=!b.sortDescending;b.isScrolledToTheBottom(!1);b.fetchAssessmentPersonResultsData(b.resetAssessmentRecordScroll)};this.fetchAssessmentsData=
function(){b.cancelDataFetching();b.areAssessmentsBeingLoaded(!0);b.assessments([]);b.clearAssessmentPersonResultsData();b.fetchAssessmentsCallbackDebouncer.invokeCallback({},200)};this.clearAssessmentPersonResultsData=function(){b.areAssessmentsPersonResultsBeingLoaded(!0);b.assessmentPersonResults([]);b.isAssessmentsPersonResultsPageBeingLoaded(!1);b.areAllAssessmentPersonResultsRetreived(!1);b.assessmentPersonResultsCurrentPage=0;b.isScrolledToTheBottom(!1);b.resultsScrollLeft=0;b.resultsScrollTop=
0};this.fetchAssessmentPersonResultsData=function(a){void 0===a&&(a=null);b.cancelDataFetching();b.clearAssessmentPersonResultsData();b.fetchAssessmentPersonResultsCallbackDebouncer.invokeCallback(a,200)};this.fetchAssessmentPersonResultsPage=function(){b.isAssessmentsPersonResultsPageBeingLoaded(!0);b.fetchAssessmentPersonResultsCallbackDebouncer.invokeCallback(null,200)};this.cancelDataFetching=function(){null!=b.fetchAssessmentPersonResultsPromise&&b.fetchAssessmentPersonResultsPromise.readyState!==
b.fetchAssessmentPersonResultsPromise.DONE&&b.fetchAssessmentPersonResultsPromise.abort();null!=b.fetchAssessmentsPromise&&b.fetchAssessmentsPromise.readyState!==b.fetchAssessmentsPromise.DONE&&b.fetchAssessmentsPromise.abort()};this.onAssessmentResultsScrollHandler=function(){if(!b.isScrollingInProgress){b.isScrollingInProgress=!0;var a=b.$assessmentColumnsContainer.scrollLeft();a!==b.resultsScrollLeft&&(b.resultsScrollLeft=a,$("."+b.settings.CssClasses.AssessmentHeaders).scrollLeft(b.resultsScrollLeft));
a=b.$assessmentColumnsContainer.scrollTop();a!==b.resultsScrollTop&&(b.fetchAssessmentPersonResultsPageOnScrollHandler(a),b.resultsScrollTop=a,$("."+b.settings.CssClasses.StudentsColumn).scrollTop(b.resultsScrollTop),Math.ceil(b.$assessmentColumnsContainer[0].scrollHeight-b.$assessmentColumnsContainer[0].scrollTop)===b.$assessmentColumnsContainer[0].clientHeight&&b.isScrolledToTheBottom(!0));b.isScrollingInProgress=!1}};this.resetAssessmentRecordScroll=function(){b.$assessmentColumnsContainer.scrollTop(0);
b.$studentsColumn.scrollTop(0)};this.fetchAssessmentPersonResultsPageOnScrollHandler=function(a){!b.areAssessmentsPersonResultsBeingLoaded()&&!b.areAllAssessmentPersonResultsRetreived()&&a>b.resultsScrollTop&&(a=$("."+b.settings.CssClasses.AssessmentColumnsContainer+" > ."+b.settings.CssClasses.AssessmentColumn).first().children(),a=a.eq(a.length-k.pageSize/2),CCL.CommonFunctions.isOnScreen(a,.5,.5)&&b.fetchAssessmentPersonResultsPage())};this.initialiseTermFilter=function(){b.$termFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,
b.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,c){b.termId(c.selectedItemId);b.fetchAssessmentsData()};this.initialiseCategoryFilter=function(){b.$categoryFilter.on(f.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,b.onCategoryFilterItemClickHandler)};this.onCategoryFilterItemClickHandler=function(a,c){b.categoryIds(c.selectedItemIds);b.fetchAssessmentsData()};this.dataFetcher=new k(this.settings.ServiceUrls,this);this.fetchAssessmentsCallbackDebouncer=
new CCL.CallbackDebouncer(function(){b.fetchAssessmentsPromise=b.dataFetcher.getAssessments()});this.fetchAssessmentPersonResultsCallbackDebouncer=new CCL.CallbackDebouncer(function(a){b.fetchAssessmentPersonResultsPromise=b.dataFetcher.getAssessmentPersonResults();a&&b.fetchAssessmentPersonResultsPromise.done(function(){return a()})});this.termId=ko.observable(null);this.categoryIds=ko.observableArray([]);this.areAssessmentsBeingLoaded=ko.observable(!0);this.assessments=ko.observableArray([]);this.areAssessmentsPersonResultsBeingLoaded=
ko.observable(!0);this.isAssessmentsPersonResultsPageBeingLoaded=ko.observable(!1);this.areAllAssessmentPersonResultsRetreived=ko.observable(!1);this.assessmentPersonResults=ko.observableArray([]);this.persons=ko.computed(function(){return b.assessmentPersonResults().map(function(a){return a})});this.resultsScrollLeft=this.$assessmentColumnsContainer.scrollLeft();this.resultsScrollTop=this.$assessmentColumnsContainer.scrollTop();this.initialiseTermFilter();this.initialiseCategoryFilter();this.isScrolledToTheBottom=
ko.observable(!1)}Object.defineProperty(a.prototype,"$assessmentColumnsContainer",{get:function(){return $("."+this.settings.CssClasses.AssessmentColumnsContainer)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$studentsColumn",{get:function(){return $("."+this.settings.CssClasses.StudentsColumn)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$termFilter",{get:function(){return $("#"+this.settings.ClientIds.TermFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"$categoryFilter",{get:function(){return $("#"+this.settings.ClientIds.CategoryFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"supervisorType",{get:function(){return this.settings.SupervisorType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"courseId",{get:function(){return this.settings.CourseId},enumerable:!0,configurable:!0});return a}();e.AssessmentRecordViewModel=d;var a=function(){function a(a){var b=this;this.settings=a;this.preventFromDropDownMenuFromClosing=
function(a){$(a.target).is(b.$container.children().first())&&a.stopPropagation()};var c=new f.KnockoutCustomBindingsManager;c.registerSafeImgBinding();c.registerPerfectScrollBarBinding();this.model=new d(a);ko.applyBindings(this.model,this.$container[0]);this.model.initialise();this.$container.on("click",this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){b.$container.off("click",b.preventFromDropDownMenuFromClosing)})}Object.defineProperty(a.prototype,
"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});return a}();e.AssessmentRecord=a})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function a(b,d){var c=this;this.serviceUrls=b;this.model=d;this.getDataForOrganisation=function(){var a={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId()};a=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.Filters,data:a,dataType:"html"});a.done(function(a){c.model.updateOrganisation(a)});return a};this.getCourses=function(){var b={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId(),termId:c.model.termId(),
paging:{pageIndex:c.model.coursesCurrentPage,pageSize:a.coursesPageSize}};b=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.Courses,data:b,dataType:"json"});b.done(function(a){c.model.addCourses(a);c.model.areCoursesBeingLoaded(!1)});return b};this.getTermAssessments=function(){if(!c.model.currentCourse())return null;var a={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId(),termId:c.model.termId(),courseId:c.model.currentCourse().id,hierarchyIds:c.model.hierarchyIds()};
a=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.TermAssessments,data:a,dataType:"json"});a.done(function(a){a&&c.model.addTermAssessments(a);c.model.areCourseTermAssessmentsBeingLoaded(!1)});return a};this.getTermAssessmentPersonResults=function(){if(!c.model.currentCourse())return null;var b={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId(),termId:c.model.termId(),courseId:c.model.currentCourse().id,hierarchyIds:c.model.hierarchyIds(),finalAssessmentIds:c.model.termAssessments().map(function(a){return a.id}),
paging:{pageIndex:c.model.termAssessmentPersonResultsCurrentPage,pageSize:a.termAssessmentPersonResultsPageSize},sortDescending:c.model.sortDescending};b=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.TermAssessmentPersonResults,data:b,dataType:"json"});b.done(function(a){c.model.addTermAssessmentPersonResults(a);c.model.areCourseTermAssessmentsResultsBeingLoaded(!1)});return b}}a.coursesPageSize=10;a.termAssessmentPersonResultsPageSize=50;return a}(),d=function(){function a(a){var b=this;this.settings=
a;this.isResultsHorisontalScrollInProgress=!1;this.termAssessmentPersonResultsCurrentPage=this.coursesCurrentPage=0;this.sortDescending=!1;this.updateOrganisation=function(a){$("."+b.settings.CssClasses.FiltersContainer).replaceWith($(a));b.initialiseFilters();b.fetchCoursesData()};this.addCourses=function(a){var c=0===b.coursesCurrentPage,d=a.map(function(a,d){return{id:a.Id,title:a.Title,isSelected:c?0===d:!1,assessmentRecordTooltip:b.getAssessmentRecordTooltip(a.Title)}});[].push.apply(b.courses(),
d);b.courses.valueHasMutated();b.coursesCount(b.courses().length);c?(b.areCoursesBeingLoaded(!1),b.enableHierarchyFilter(),0<b.coursesCount()&&b.selectCourse(b.courses()[0])):b.isCoursesPageBeingLoaded(!1);(0===a.length||a.length<k.coursesPageSize)&&b.areAllCoursesRetreived(!0);b.coursesCurrentPage++};this.selectCourse=function(a){b.currentCourse(a);b.fetchTermAssessmentsData();$(window).scrollTop(0)};this.openAssessmentRecord=function(a){window.location.href=b.settings.ServiceUrls.AssessmentRecord+
"?courseId="+a.id+"&supervisorType="+b.settings.SupervisorType};this.selectStudent=function(a){b.currentStudent(a)};this.clearStudent=function(){b.currentStudent(null)};this.addTermAssessments=function(a){a=a.map(function(a){return{id:a.Id,title:a.Title}});[].push.apply(b.termAssessments(),a);b.termAssessments.valueHasMutated();b.termAssessmentsCount(b.termAssessments().length);b.fetchTermAssessmentPersonResultsData()};this.addTermAssessmentPersonResults=function(a){if(a){var c=a.map(function(a){return{personId:a.PersonId,
fullName:a.FullName,pictureUrl:a.PictureUrl,fallbackProfileUrl:a.FallbackProfileUrl,fallbackPictureUrl:a.FallbackPictureUrl,tooltipText:a.TooltipText,results:a.Results.map(function(a){return{gradebookItemId:a.GradebookItemId,score:a.Score,hasComment:a.HasComment}})}});[].push.apply(b.termAssessmentPersonResults(),c);b.termAssessmentPersonResults.valueHasMutated();b.termAssessmentPersonResultsCount(b.termAssessmentPersonResults().length)}0===b.termAssessmentPersonResultsCurrentPage?b.areCourseTermAssessmentsResultsBeingLoaded(!1):
b.isTermAssessmentPersonResultsPageBeingLoaded(!1);(!a||0===a.length||a.length<k.termAssessmentPersonResultsPageSize)&&b.areAllTermAssessmentPersonResultsRetreived(!0);b.termAssessmentPersonResultsCurrentPage++};this.openProfileCard=function(a){document.showProfileCard?document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,"","resizable,scrollbars,height=500,width=750")};this.sortByName=function(){b.sortDescending=!b.sortDescending;b.fetchTermAssessmentPersonResultsData();$(window).scrollTop(0)};
this.showMoreCourses=function(){b.fetchCoursesPage()};this.showMoreResults=function(){b.fetchTermAssessmentPersonResultsPage()};this.scrollResultsContainer=function(){b.scrollHorisontaly($("."+b.settings.CssClasses.ResultsFixedHeadersWrapper),$("."+b.settings.CssClasses.ResultsContainer))};this.scrollResultsFixedHeader=function(){b.scrollHorisontaly($("."+b.settings.CssClasses.ResultsContainer),$("."+b.settings.CssClasses.ResultsFixedHeadersWrapper))};this.ajustResultsFixedHeaderPosition=function(){b.onResultsFixedHeaderPositionChangeHandler()};
this.scrollHorisontaly=function(a,c){b.isResultsHorisontalScrollInProgress||(b.isResultsHorisontalScrollInProgress=!0,c.scrollLeft(a.scrollLeft()),b.isResultsHorisontalScrollInProgress=!1)};this.isScrolledIntoView=function(a){return a.offset().top>=$(window).scrollTop()};this.onResultsFixedHeaderPositionChangeHandler=function(){var a=$("."+b.settings.CssClasses.StudentHeader);if(0<a.length){var c=CCL.CommonFunctions.isElementFullyShownInWindow(a),d=$("."+b.settings.CssClasses.ResultsContainer),e=
CCL.CommonFunctions.isElementFullyShownInWindow(d),f=$("."+b.settings.CssClasses.StudentFixedHeader),g=$("."+b.settings.CssClasses.ResultsFixedHeadersWrapper);if(c&&e)f.css({display:"none"}),g.css({display:"none"});else{c=c||b.isScrolledIntoView(d)?a.offset().top-$(window).scrollTop():0;f.css({display:"block",position:"fixed",top:c,height:a.outerHeight(!0),width:a.outerWidth(!0)});g.css({display:"block",position:"fixed",top:c,left:a.offset().left+a.outerWidth(!0),height:a.outerHeight(!0),width:d.outerWidth(!0)});
g.perfectScrollbar("update");$("."+b.settings.CssClasses.ResultsFixedHeadersContainer).css({display:"flex",width:d[0].scrollWidth});a=$("."+b.settings.CssClasses.ResultsFixedHeader);var k=$("."+b.settings.CssClasses.ResultsHeader);a.each(function(a,b){$(b).css({width:k.eq(a).outerWidth(!0)})})}}};this.openAssessmentDialog=function(a,c){var d=e.termAssessmentDialogManagerInstance;if(d){var f=ko.utils.arrayFirst(b.termAssessments(),function(a){return a.id===c}),g=ko.utils.arrayFirst(b.termAssessmentPersonResults(),
function(b){return b.personId===a});d.openDialog({header:g.fullName,assessmentName:f.title},{personId:a,gradebookItemId:c,supervisorType:b.settings.SupervisorType})}};this.openAssessmentDialogForCurrentStudent=function(a,c){b.openAssessmentDialog(a().personId,c)};this.getPersonGradebookItemResult=function(a,c){var d=ko.utils.arrayFirst(b.termAssessmentPersonResults(),function(b){return b.personId===a().personId});return ko.utils.arrayFirst(d.results,function(a){return a.gradebookItemId===c})};this.initialiseFilters=
function(){b.initialiseOrganisationFilter();b.initialiseTermFilter();b.initialiseHierarchyFilter()};this.disableFilters=function(){b.$organisationFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$organisationFilter.prop("disabled",!0);b.$termFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$termFilter.prop("disabled",!0);b.disableHierarchyFilter()};this.disableHierarchyFilter=function(){b.$hierarchyFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$hierarchyFilter.prop("disabled",
!0)};this.enableHierarchyFilter=function(){window[b.settings.ClientIds.HierarchyFilter].hasItems&&(b.$hierarchyFilter.removeClass(b.settings.CssClasses.FilterDisabled),b.$hierarchyFilter.removeProp("disabled"))};this.initialiseOrganisationFilter=function(){b.$organisationFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,b.onOrganisationFilterClickHandler)};this.onOrganisationFilterClickHandler=function(a,c){b.organisationId(c.selectedItemId);b.fetchOrganisationData()};this.initialiseTermFilter=
function(){b.$termFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,b.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,c){b.termId(c.selectedItemId);b.fetchCoursesData()};this.initialiseHierarchyFilter=function(){b.$hierarchyFilter.on(f.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,b.onHierarchyFilterItemClickHandler)};this.onHierarchyFilterItemClickHandler=function(a,c){b.hierarchyIds(c.selectedItemIds);b.fetchTermAssessmentPersonResultsData()};
this.fetchOrganisationData=function(){b.clearFilters();b.clearCoursesData();b.cancelDataFetching();b.disableFilters();b.fetchFiltersCallbackDebouncer.invokeCallback({},200)};this.fetchCoursesData=function(){b.clearCoursesData();b.clearTermAssessmentsData();b.cancelDataFetching();b.disableHierarchyFilter();b.fetchCoursesCallbackDebouncer.invokeCallback({},200)};this.fetchCoursesPage=function(){b.isCoursesPageBeingLoaded(!0);b.fetchCoursesCallbackDebouncer.invokeCallback({},200)};this.fetchTermAssessmentsData=
function(){b.clearTermAssessmentsData();b.clearTermAssessmentPersonResultsData();b.cancelDataFetching();b.fetchTermAssessmentsCallbackDebouncer.invokeCallback({},200)};this.fetchTermAssessmentPersonResultsData=function(){b.clearTermAssessmentPersonResultsData();b.cancelDataFetching();b.fetchTermAssessmentPersonResultsCallbackDebouncer.invokeCallback({},200)};this.onFetchTermAssessmentPersonResultsPageHandler=function(a){if(!b.areCourseTermAssessmentsResultsBeingLoaded()&&!b.areAllTermAssessmentPersonResultsRetreived()&&
!b.isStudentSelectedInMobile()){a=$(a.target).scrollTop();if(a>b.termAssessmentPersonResultsListScrollTop){var c=$("."+b.settings.CssClasses.MobileStudentContainer).is(":visible")?$("."+b.settings.CssClasses.MobileStudentContainer).children():$("."+b.settings.CssClasses.StudentsContainer).children();c=c.eq(c.length-k.termAssessmentPersonResultsPageSize/2);CCL.CommonFunctions.isOnScreen(c,.5,.5)&&b.fetchTermAssessmentPersonResultsPage()}b.termAssessmentPersonResultsListScrollTop=a}};this.fetchTermAssessmentPersonResultsPage=
function(){b.isTermAssessmentPersonResultsPageBeingLoaded(!0);b.fetchTermAssessmentPersonResultsCallbackDebouncer.invokeCallback({},200)};this.cancelDataFetching=function(){null!=b.fetchFiltersPromise&&b.fetchFiltersPromise.readyState!==b.fetchFiltersPromise.DONE&&b.fetchFiltersPromise.abort();null!=b.fetchCoursesPromise&&b.fetchCoursesPromise.readyState!==b.fetchCoursesPromise.DONE&&b.fetchCoursesPromise.abort();null!=b.fetchTermAssessmentsPromise&&b.fetchTermAssessmentsPromise.readyState!==b.fetchTermAssessmentsPromise.DONE&&
b.fetchTermAssessmentsPromise.abort();null!=b.fetchTermAssessmentPersonResultsPromise&&b.fetchTermAssessmentPersonResultsPromise.readyState!==b.fetchTermAssessmentPersonResultsPromise.DONE&&b.fetchTermAssessmentPersonResultsPromise.abort()};this.clearFilters=function(){b.termId(null);b.hierarchyIds([])};this.clearCoursesData=function(){b.courses([]);b.coursesCount(b.courses().length);b.areCoursesBeingLoaded(!0);b.isCoursesPageBeingLoaded(!1);b.currentCourse(null);b.areAllCoursesRetreived(!1);b.coursesCurrentPage=
0;b.clearTermAssessmentsData();b.clearTermAssessmentPersonResultsData()};this.clearTermAssessmentsData=function(){b.termAssessments([]);b.termAssessmentsCount(b.termAssessments().length);b.areCourseTermAssessmentsBeingLoaded(!0)};this.clearTermAssessmentPersonResultsData=function(){b.termAssessmentPersonResults([]);b.termAssessmentPersonResultsCount(b.termAssessmentPersonResults().length);b.areCourseTermAssessmentsResultsBeingLoaded(!0);b.isTermAssessmentPersonResultsPageBeingLoaded(!1);b.currentStudent(null);
b.areAllTermAssessmentPersonResultsRetreived(!1);b.termAssessmentPersonResultsCurrentPage=0;b.ajustResultsFixedHeaderPosition()};this.getAssessmentRecordTooltip=function(a){a=CCL.CommonFunctions.htmlEncode(a);return CCL.CommonFunctions.formatString(b.settings.LanguageTerms.AssessmentRecordTooltip,a)};this.dataFetcher=new k(this.settings.ServiceUrls,this);this.fetchCoursesCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchCoursesPromise=b.dataFetcher.getCourses()});this.fetchFiltersCallbackDebouncer=
new CCL.CallbackDebouncer(function(){b.fetchFiltersPromise=b.dataFetcher.getDataForOrganisation()});this.fetchTermAssessmentsCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchTermAssessmentsPromise=b.dataFetcher.getTermAssessments()});this.fetchTermAssessmentPersonResultsCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchTermAssessmentPersonResultsPromise=b.dataFetcher.getTermAssessmentPersonResults()});this.organisationId=ko.observable(this.settings.OrganisationId);this.termId=
ko.observable(0===this.settings.TermId?null:this.settings.TermId);this.currentCourse=ko.observable(null);this.hierarchyIds=ko.observableArray(this.settings.HierarchyIds);this.currentCourseTitle=ko.pureComputed(function(){var a="";null!=b.currentCourse()&&(a=b.currentCourse().title);return a});this.areCoursesInitiated=ko.observable(!1);this.areCoursesBeingLoaded=ko.observable(!0);this.isCoursesPageBeingLoaded=ko.observable(!1);this.areCourseTermAssessmentsBeingLoaded=ko.observable(!0);this.areCourseTermAssessmentsResultsBeingLoaded=
ko.observable(!0);this.isTermAssessmentPersonResultsPageBeingLoaded=ko.observable(!1);this.courses=ko.observableArray([]);this.coursesCount=ko.observable(0);this.areAllCoursesRetreived=ko.observable(!1);this.termAssessments=ko.observableArray([]);this.termAssessmentsCount=ko.observable(0);this.termAssessmentPersonResults=ko.observableArray([]);this.termAssessmentPersonResultsCount=ko.observable(0);this.areAllTermAssessmentPersonResultsRetreived=ko.observable(!1);this.persons=ko.computed(function(){return b.termAssessmentPersonResults().map(function(a){return a})});
this.currentStudent=ko.observable(null);this.isStudentSelectedInMobile=ko.computed(function(){return b.currentStudent()&&CCL.CommonFunctions.isMobileDevice()});this.initialiseFilters();this.termAssessmentPersonResultsListScrollTop=$(window).scrollTop();$(window).on("resize scroll touchmove",this.onResultsFixedHeaderPositionChangeHandler);$(window).on("scroll touchmove",this.onFetchTermAssessmentPersonResultsPageHandler)}Object.defineProperty(a.prototype,"$organisationFilter",{get:function(){return $("#"+
this.settings.ClientIds.OrganisationFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$termFilter",{get:function(){return $("#"+this.settings.ClientIds.TermFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$hierarchyFilter",{get:function(){return $("#"+this.settings.ClientIds.HierarchyFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"supervisorType",{get:function(){return this.settings.SupervisorType},enumerable:!0,configurable:!0});
return a}();e.TermAssessmentsViewModel=d;var a=function(){function a(a){var b=this;this.settings=a;this.preventFromDropDownMenuFromClosing=function(a){$(a.target).is(b.$container.children().first())&&a.stopPropagation()};a=new f.KnockoutCustomBindingsManager;a.registerSafeImgBinding();a.registerPerfectScrollBarBinding();this.model=new d(this.settings);ko.applyBindings(this.model,this.$container[0]);this.model.dataFetcher.getCourses().done(function(){b.model.areCoursesInitiated(!0)});this.$container.on("click",
this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){b.$container.off("click",b.preventFromDropDownMenuFromClosing)})}Object.defineProperty(a.prototype,"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});return a}();e.TermAssessments=a})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){var b=this;this.context=a;$("#"+this.context.Controls.DeleteButtonId).on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",function(){return b.deleteSelectedTerms()})}a.prototype.deleteSelectedTerms=function(){var a=this,c=window[this.context.Controls.DataGridName],d=c.GetSelectedValues(),e=[];d&&0<d.length&&(e=d.substr(0,d.length-1).split(","));if(!c.GetNumberOfSelectedRows())return jAlert(this.context.Settings.PleaseMakeSelectionMessage),
!1;c=this.context.Settings.DeleteWarningMessage.replace(/#NumberOfSelectedRows/g,c.GetNumberOfSelectedRows());for(var f in e)if(e.hasOwnProperty(f)&&-1!==this.context.TermIdsUsedInGradebook.indexOf(e[f])){c=this.context.Settings.DeleteWarningMessageWithExistTermInGradebook;break}$.alerts.okButton=this.context.Settings.YesButtonText;$.alerts.cancelButton=this.context.Settings.NotButtonText;jConfirm(c,this.context.Settings.WarningDialogTitle,function(b){b&&__doPostBack("__Page",a.context.Settings.PostBackArgumentDelete)});
return!1};return a}();e.TermManagement=d})(e.TermManagement||(e.TermManagement={}))})(f.Terms||(f.Terms={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,a){var b=[],c=d.ArrowButton.find("img"),e=new DivToggler({divId:a.ClientIds.TopMenuArea,isCollapsed:!a.TopmenuExpanded,afterToggle:function(){e.settings.isCollapsed?(c.removeClass(a.CssClasses.ArrowUp).addClass(a.CssClasses.ArrowDown),d.ArrowButton.prop("title",a.Terms.ClickToMaximise)):(c.removeClass(a.CssClasses.ArrowDown).addClass(a.CssClasses.ArrowUp),d.ArrowButton.prop("title",a.Terms.ClickToMinimise))},changeDivVisibility:!0}),f=new DivToggler({divId:a.ClientIds.BottomNavigationBarWrapper,
isCollapsed:!1,changeDivVisibility:!0}),m=$(window);e.initialize();d.ArrowButton.click(function(){e.toggleDiv(function(){CCL.CommonFunctions.safeAjax({type:"PUT",url:a.Urls.ToggleTopMenuState,data:{show:!e.settings.isCollapsed}})});window[a.SetIframeDefaultHeightFunctionName]()});b.push(e);f.initialize();b.push(f);a.ClientIds.TopNavigationContainer&&b.push(new DivToggler({divId:a.ClientIds.TopNavigationContainer,isCollapsed:!1,changeDivVisibility:!0}));if(a.UseLeftmenuToggler){var l=function(b,c,
e){d.LeftMenuToggler.prop("title",b?a.Terms.OpenMenu:a.Terms.HideMenu).toggleClass(c,!b).toggleClass(e,b)},k=new DivToggler({divId:a.ClientIds.LeftArea,isCollapsed:!a.LeftMenuExpanded,changeDivVisibility:!1,afterToggle:function(){var b=k.settings.isCollapsed,c=a.CssClasses.DesktopLefttoggleExpand,e=a.CssClasses.DesktopLefttoggleCollapse,f=a.CssClasses.DesktopLeftmenuHidden;d.LeftArea.toggleClass(a.CssClasses.DesktopLeftmenuVisible,!b).toggleClass(f,b);l(b,c,e)}}),p=new LeftMenu;p.settings={treeMenuClientID:a.ClientIds.TreeMenu,
contentAreaIframeClientID:a.ClientIds.ContentAreaIframe,arrowButtonClientID:d.ArrowButton.prop("id")};p.initialize();var n=new DivToggler({divId:a.ClientIds.LeftArea,isCollapsed:!0,changeDivVisibility:!1,afterToggle:function(){var b=n.settings.isCollapsed,c=a.CssClasses.MobileLeftmenuHidden;d.LeftArea.toggleClass(a.CssClasses.MobileLeftmenuVisible,!b).toggleClass(c,b);l(n.settings.isCollapsed,a.CssClasses.MobileLefttoggleExpand,a.CssClasses.MobileLefttoggleCollapse);n.settings.isCollapsed||(b=CCL.CommonFunctions.calculateRightAndBottomOffset(d.MenuIframe),
p.recalculateHeight(IframeResizer.getIframeDefaultWidthAndHeight(m,d.MenuIframe,b).height),a.IsIosDevice&&p.forceRefreshOnIos())}});d.LeftMenuToggler.click(function(){p.isDesktopMode()?k.toggleDiv(function(){CCL.CommonFunctions.safeAjax({type:"PUT",url:a.Urls.ToggleLeftMenuState,data:{show:!k.settings.isCollapsed}})}):n.toggleDiv()});d.MainSidebar.on("click","a",function(){var a=$(this).attr("href");"#"===a||0===a.toLowerCase().indexOf("javascript:")||p.isDesktopMode()||n.toggleDiv()});n.initialize();
b.push(n);k.initialize();b.push(k)}window.divTogglers=b;CCL.CommonFunctions.attachPostMessageEventListener(m,[CCL.CommonWindowMessages.MessageNames.disableFullScreen,CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame,CCL.CommonWindowMessages.MessageNames.enableFullScreen,CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame],function(a,b){if(!window.top[CCL.CommonWindowMessages.MessageNames.suspendExpandCollaplseContentAreaFrame]){var c;if(a.messageName===CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame||
a.messageName===CCL.CommonWindowMessages.MessageNames.disableFullScreen){$(window.top.divTogglers).each(function(){this.settings.isCollapsed||this.expandDiv()});var e=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.contentAreaFrameHasCollapsed);var f=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.collapseExtensionIframe)}else a.messageName!==CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame&&!CCL.CommonWindowMessages.MessageNames.enableFullScreen||
window.top.isProfileCardOpened||($(window.top.divTogglers).each(function(){var a=this.settings.isCollapsed;this.collapseDiv();this.settings.isCollapsed=a}),e=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.contentAreaFrameHasExpanded),f=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.expandExtensionIframe));(c=1===d.MenuIframe.length?d.MenuIframe.get(0).contentWindow:void 0)&&CCL.CommonFunctions.makePostMessageCall(c,f);CCL.CommonFunctions.makePostMessageCall(b,
e)}});CCL.CommonFunctions.attachPostMessageEventListener(m,CCL.CommonWindowMessages.MessageNames.collapseLeftMenu,function(){k.collapseDiv()});CCL.CommonFunctions.attachPostMessageEventListener(m,CCL.CommonWindowMessages.MessageNames.toggleBreadcrumbs,function(b,c){b.extendedData?$("."+a.CssClasses.BreadcrumbsContainer).parent().slideDown(0):$("."+a.CssClasses.BreadcrumbsContainer).parent().slideUp(0)})}}();e.BottomNavigationBar=f})(f.TopMenu||(f.TopMenu={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){e.GradeExportInstance=this;this.controls=a;this.context=b;this.init()}d.prototype.dismissSyncItemNotifications=function(){$.post(this.context.WebMethods.CancelSyncItemNotification,{courseId:this.context.Settings.CourseId}).fail(function(a){e.Utils.handleAjaxError(a)})};d.prototype.init=function(){var a=this;jQuery.alerts.okButton=this.context.LanguageTerms.Ok;jQuery.alerts.cancelButton=this.context.LanguageTerms.Cancel;$(document).on(d.showFeedbackEventTitle,
function(b,c,d){return a.showFeedback(c,d)})};d.prototype.showFeedback=function(a,b){var c=this;this.changeFeedbackContainer(b);null!=a&&CCL.InformationFeedback.showFeedbackWithextraButton(this.controls.Container,a,this.context.LanguageTerms.GotIt,function(){c.closeFeedback()})};d.prototype.changeFeedbackContainer=function(a){null!=a&&$(document).find("."+CCL.CommonCssClasses.InformationFeedback.Container).css("top",a.top+20)};d.prototype.closeFeedback=function(){CCL.InformationFeedback.hideFeedback(this.controls.Container)};
d.showFeedbackEventTitle="LineItemsTransfer:showFeedback";return d}();e.GradeExport=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.toggleValidator=ValidatorEnable;this.self=this;e.AddAssessmentInstance=this;this.context=a;this.window=$(window);var c=this;jQuery.alerts.okButton=this.context.LanguageTerms.Ok;jQuery.alerts.cancelButton=this.context.LanguageTerms.Cancel;this.initialDefaultScore=1===this.context.Controls.DefaultScore.length?this.context.Controls.DefaultScore.val():"";this.initialDefaultAssessmentItemId=1===this.context.Controls.DefaultAssessmentItemId.length?
this.context.Controls.DefaultAssessmentItemId.val():"";this.context.Controls.OkButton.click(function(){return b.approveChanges(b)});this.secondSectionSeparator=this.context.Controls.WhereCountSection.parent().find("div."+this.context.CssClasses.FormSectionSeparator).last();this.toggleCustomExistingSections(this);this.context.Controls.CustomRadioButton.click(function(){b.toggleCustomExistingSections(b)});this.context.Controls.ExistingAssessment.click(function(){b.toggleCustomExistingSections(b)});
this.toggleFinalAssessmentCheckbox();this.context.Controls.AddDefaultAssessmentCheckBox.click(function(){b.toggleDefaultAssessmentControls(b)});this.context.Controls.DefaultAssessmentItemList.change(function(){b.saveDefaultAssessmentItemListSelection(b)});this.context.Controls.RetrieveLearningObjectivesFromPlannerButton.click(function(){b.retrieveLearningObjectivesFromPlanner(b)});$(document).on(c.context.Settings.LearningObjectiveItemsChangedClientEventName,function(a,b){c.refreshAssessmentTypeList(c,
a,b)});1===this.context.Controls.AssessmentScaleList.length&&(this.context.Controls.AssessmentScaleList.change(function(){c.toggleWeightPanelAccordingToAssessmentScale(this.value);c.toggleMaxScorePanelAccordingToAssessmentScale();c.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale()}),this.toggleWeightPanelAccordingToAssessmentScale(this.context.Controls.AssessmentScaleList.val()))}d.prototype.toggleCustomExistingSections=function(a){var b=a.context.Controls.CustomRadioButton.prop("checked");
a.toggle(a.context.Controls.ExistingSection,!b);a.toggle(a.context.Controls.CustomSection,b);a.toggle(a.context.Controls.AssessmentScaleListHolder,b);a.context.Controls.AssessmentScaleName.toggle(!b||0===a.context.Controls.AssessmentScaleList.length);a.toggle(a.context.Controls.EditableMaxScoreHolder,b);a.context.Controls.MaxScoreLabel.toggle(!b||0===a.context.Controls.MaxScore.length);a.context.Settings.UseTerms&&(0<a.context.Settings.SelectedTermId&&a.toggle(a.context.Controls.FinalAssessmentPanel,
b),a.context.Controls.FinalAssessmentCheckbox.prop("checked")&&a.toggleFinalAssessmentSettings(b),0<a.context.Settings.SelectedTermId&&a.toggleWhereOrHowSection(a.context.Controls.WhereCountSection,b||a.context.Controls.CategoryListPanel.is(":visible")));a.context.Settings.UseTerms&&0!==a.context.Settings.SelectedTermId||a.context.Controls.CustomRadioButton.prop("disabled")&&b||a.toggleBottomWarningMessageForElement(a);a.toggleWeightPanelAccordingToAssessmentScale(null);a.toggleMaxScorePanelAccordingToAssessmentScale();
a.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale();a.toggleIsManualAssessmentVisible()};d.prototype.toggleIsManualAssessmentVisible=function(){var a=this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&this.context.Controls.FinalAssessmentCheckbox.prop("checked")||!this.context.Controls.CustomRadioButton.prop("checked");this.toggle(this.context.Controls.IsManualAssessmentVisibleTogglePanel,!a)};d.prototype.toggleFinalAssessmentCheckbox=function(){this.toggleFinalAssessmentSettings(this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&
this.context.Controls.FinalAssessmentCheckbox.prop("checked"))};d.prototype.toggleFinalAssessmentSettings=function(a){this.toggleIsManualAssessmentVisible();this.toggle(this.context.Controls.CategoryListPanel,!a);this.context.Settings.UseTerms&&0<this.context.Settings.SelectedTermId&&this.toggleWhereOrHowSection(this.context.Controls.HowAssessSection,!a);this.toggleWeightPanelAccordingToAssessmentScale(null);this.toggleMaxScorePanelAccordingToAssessmentScale()};d.prototype.toggleWhereOrHowSection=
function(a,b){a.is(":visible")&&b||(this.toggle(a,b),this.secondSectionSeparator.toggle(this.context.Controls.HowAssessSection.is(":visible")&&b))};d.prototype.toggleWeightPanelAccordingToAssessmentScale=function(a){1===this.context.Controls.WeightPanel.length&&this.toggle(this.context.Controls.WeightPanel,(!this.context.Controls.FinalAssessmentCheckbox.is(":visible")||!this.context.Controls.FinalAssessmentCheckbox.prop("checked"))&&(1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.is(":visible")?
this.isAssessmentScaleSupportWeighting(a||this.context.Controls.AssessmentScaleList.val()):this.context.Settings.IsAssessmentScaleOfTheColumnSupportWeighting))};d.prototype.toggleMaxScorePanelAccordingToAssessmentScale=function(){1===this.context.Controls.MaxScorePanel.length&&this.toggle(this.context.Controls.MaxScorePanel,1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.is(":visible")?this.isAssessmentScaleSupportScore():this.context.Settings.IsAssessmentScaleOfTheColumnSupportScore)};
d.prototype.saveDefaultAssessmentItemListSelection=function(a){a.context.Controls.DefaultAssessmentItemId.val(a.context.Controls.DefaultAssessmentItemList.val())};d.prototype.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale=function(){1===this.context.Controls.AddDefaultAssessmentPanel.length&&(this.isAssessmentScaleSelected()||this.isAssessmentScaleSupportScore()?this.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("disabled"):(this.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("checked"),
this.context.Controls.AddDefaultAssessmentCheckBox.prop("disabled","disabled")),this.toggleDefaultAssessmentControls(this))};d.prototype.toggleDefaultAssessmentControls=function(a){var b=a.context.Controls.CustomRadioButton.prop("checked")&&!a.usedFinalAssessmentOption(),c=!1,d=!1;b?(c=a.context.Controls.AddDefaultAssessmentCheckBox.prop("checked"),d=a.isAssessmentScaleSupportScore(),c&&!d&&$.getJSON(a.context.WebMethods.GetAssessmentItems,{assessmentId:this.getAssessmentId(),courseId:this.context.Settings.CourseId}).done(function(b){a.context.Controls.DefaultAssessmentItemList.empty();
for(var c=0,d=b.length;c<d;c+=1){var e=b[c];a.context.Controls.DefaultAssessmentItemList.append('<option value="'+e.AssessmentItemId+'">'+e.Title+"</option>")}""!==a.context.Controls.DefaultAssessmentItemId.val()&&a.context.Controls.DefaultAssessmentItemList.val(a.context.Controls.DefaultAssessmentItemId.val())}).fail(function(a){return CCL.CommonFunctions.alertAjaxError(a,null,null)})):(a.context.Controls.DefaultAssessmentItemList.empty(),a.context.Controls.DefaultAssessmentItemId.val(""),a.context.Controls.DefaultScore.val(""),
a.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("checked"));a.toggle(a.context.Controls.AddDefaultAssessmentPanel,b);a.toggle(a.context.Controls.DefaultAssessmentItemListPanel,b&&c&&!d);a.toggle(a.context.Controls.DefaultScorePanel,b&&c&&d)};d.prototype.isAssessmentScaleSupportWeighting=function(a){return parseInt(a.split(":")[1])===this.context.Settings.AssessmentTotalsAverage};d.prototype.isAssessmentScaleSupportScore=function(){return 1===this.context.Controls.AssessmentScaleList.length&&
parseInt(this.context.Controls.AssessmentScaleList.val().split(":")[0])===this.context.Settings.ScoreItemValue||0===this.context.Controls.AssessmentScaleList.length&&this.context.Settings.IsAssessmentScaleOfTheColumnSupportScore};d.prototype.toggleBottomWarningMessageForElement=function(a){if(window[a.context.Settings.BottomMessageClientInstanceName]){var b=!a.context.Controls.CustomRadioButton.prop("checked")&&a.context.Settings.IsAssessmentScaleOfTheColumnSupportScore;window[a.context.Settings.BottomMessageClientInstanceName].self.context.Controls.container.toggle(b);
b&&(a.context.Controls.FinalAssessmentCheckbox.prop("checked",!1),a.toggleFinalAssessmentCheckbox());a.context.Controls.FinalAssessmentCheckbox.prop("disabled",b)}};d.prototype.usedFinalAssessmentOption=function(){return 1===this.context.Controls.FinalAssessmentCheckbox.length&&this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&this.context.Controls.FinalAssessmentCheckbox.prop("checked")};d.prototype.isAssessmentScaleSelected=function(){return null!=this.getAssessmentId()};d.prototype.getAssessmentId=
function(){return 1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.val()!==this.context.Settings.NotSelectedAssessmentScaleValue?parseInt(this.context.Controls.AssessmentScaleList.val().split(":")[0]):0===this.context.Controls.AssessmentScaleList.length&&0<this.context.Settings.SelectedAssessmentId?this.context.Settings.SelectedAssessmentId:null};d.prototype.toggle=function(a,b){var c=this;if(1===a.length){var d=function(a,b){for(var d=0,e=a.length;d<
e;d++)c.toggleValidator(a[d],b)};a.toggle(b);a.hasClass(this.context.CssClasses.FormContainer)?a.find('input:not([type="hidden"]), select, textarea').each(function(a,b){d($(b).nextAll("span[id$=Validator]").toArray(),$(b).is(":visible"))}):d(a.nextAll("span[id$=Validator]").toArray(),b)}};d.prototype.approveChanges=function(a){return a.confirmationDefaultAssessmentEditRequired()?(jConfirm(a.context.Controls.AddDefaultAssessmentCheckBox.prop("checked")?a.context.LanguageTerms.DefaultAssessmentChaingingConfirmMessage:
a.context.LanguageTerms.DefaultAssessmentTurningOffConfirmMessage,a.context.LanguageTerms.PleaseConfirm,function(b){if(b)if(a.pageIsValid())a.context.Functions.SuccessSubmit();else return!1;return!0}),!1):!0};d.prototype.confirmationDefaultAssessmentEditRequired=function(){if(!this.context.Settings.IsEditModeAndCustomAssessment)return!1;var a=1===this.context.Controls.AddDefaultAssessmentCheckBox.length&&this.context.Controls.AddDefaultAssessmentCheckBox.prop("checked");return this.context.Settings.UseDefaultAssessment&&
!a||this.context.Settings.UseDefaultAssessment&&a&&(1===this.context.Controls.DefaultScore.length&&this.context.Controls.DefaultScore.val()!==this.initialDefaultScore||1===this.context.Controls.DefaultAssessmentItemId.length&&this.context.Controls.DefaultAssessmentItemId.val()!==this.initialDefaultAssessmentItemId)};d.prototype.pageIsValid=function(){return Page_ClientValidate&&"function"===typeof Page_ClientValidate?(Page_ClientValidate(),Page_IsValid):!0};d.prototype.retrieveLearningObjectivesFromPlanner=
function(a){a.context.Controls.OkButton.attr("disabled","disabled");a.context.Controls.RetrieveLearningObjectivesFromPlannerButton.addClass(a.context.CssClasses.ButtonInProgerssClass).attr("disabled","disabled");CCL.CommonFunctions.safeAjaxPost({data:{termId:a.context.Settings.TermId,courseId:a.context.Settings.CourseId},dataType:"json",url:a.context.WebMethods.GetLearningObjectivesFromPlanner}).done(function(b){b.Success||alert(b.Message);b=$.unique((b.LearningObjectiveIds?b.LearningObjectiveIds:
[]).concat(window[a.context.Controls.LearningObjectivesEditorKey].getObjectiveIdsArray()));window[a.context.Controls.LearningObjectivesEditorKey].addLearningObjectives(b)}).fail(function(a){CCL.CommonFunctions.alertAjaxError(a,null,null)}).always(function(){a.context.Controls.OkButton.removeAttr("disabled");a.context.Controls.RetrieveLearningObjectivesFromPlannerButton.removeClass(a.context.CssClasses.ButtonInProgerssClass).removeAttr("disabled")})};d.prototype.refreshAssessmentTypeList=function(a,
b,c){a.context.Controls.AssessmentTypeListPanel.find("["+a.context.Settings.IncludeLearningObjectivesAttribute+"='False']").toggle(!(0<c.length))};return d}();e.AddAssessment=f})(f.AssessmentRecord||(f.AssessmentRecord={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.settings=a;this.controls=b;this.document=$(document);window[this.settings.ClientInstanceName]=this;this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.controls.form,this.settings.Terms.BeforeUnloadWarningMessage,{cancelButtonId:this.settings.ClientIds.CancelButton});this.controls.usePlagiarismCheckBox.click(function(a){c.controls.plagiarismInfoMessage.toggle()});this.controls.useAnonymousSubmissionCheckBox.click(function(a){c.controls.anonymousSubmissionInfoMessage.toggle()});
this.settings.ConnectAssessmentCriteriaToScale&&this.controls.assessmentDropDown.change(function(){c.toggleCriteriaWeights(!1)})}d.prototype.toggleCriteriaWeights=function(a){var b=this.controls.assessmentDropDown.find("option:selected").val();this.document.trigger(this.settings.LearningObjectivesEditorToggleCriteriaWeightsVisibilityMethodName,{show:!a&&b!==this.settings.AssessmentScaleControlDoNotUseAssessmentValue})};return d}();e.AddEditLearningToolElement=f})(f.LearningToolElement||(f.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){this.settings=a;this.document=$(document);window[this.settings.ClientInstanceName]=this}a.prototype.checkIfTransitionAllowed=function(a,c){var b=[];this.settings.AllowedTypeTransitions.forEach(function(c){c.Type==a&&(b=c.AllowedChildrenTypes)});return 0<b.length&&-1<$.inArray(c,b)};a.prototype.extractType=function(a){var b=this.settings.NodeNamePrefix,d=a.indexOf(b);if(0>d)return"";var e=a.indexOf(" ",d);0>e&&(e=a.length-1);return a.substring(d+
b.length,e)};a.prototype.findParentWithType=function(a,c,d){c=this.settings.NodeNamePrefix+c;if(d&&$(a).hasClass(c))return a;a=$(a).parents("."+c);return 0<a.length?a.get(0):null};a.prototype.moveNode=function(a,c,d,e,f){var b=this,g=$("#"+a);c=$("#"+d);var h=$("#"+e),m={};m[this.settings.RequestItems.RepositoryTreeEntityClientIdToMove]=a;m[this.settings.RequestItems.RepositoryTreeEntityToMoveType]=this.extractType(g.attr("class"));m[this.settings.RequestItems.NewParentRepositoryTreeEntityClientId]=
d;m[this.settings.RequestItems.NewParentRepositoryTreeEntityType]=this.extractType(c.attr("class"));m[this.settings.RequestItems.RelativeRepositoryTreeEntityClientId]=e;m[this.settings.RequestItems.RelativeRepositoryTreeEntityType]=this.extractType(h.attr("class"));m[this.settings.RequestItems.RelativeMovePosition]=f;m[this.settings.RequestItems.HierarchyId]=this.settings.HierarchyId;m[this.settings.RequestItems.CountryCode]=this.settings.CountryCode;CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.MoveUrl,
data:m}).done(function(){g.children("a").first().effect("highlight",{},2500)}).fail(function(){jAlert(b.settings.Terms.TreeMenuErrorWhileMoving,b.settings.Terms.Error,function(){location.reload()})})};a.prototype.beforeMove=function(a){if(this.extractType(a.o[0].className)===this.settings.TreeTypeDescriptor){a=a.np[0];var b=this.extractType(a.className)===this.settings.TreeTypeCriterion;return b&&$(a).find("li."+this.settings.NodeNamePrefix+this.settings.TreeTypeDescriptor).length>=this.settings.MaxNumberOfAchievementLevels?
(jAlert(this.settings.Terms.YouCannotAddMoreThanXDescriptors),!1):b}return!0};a.prototype.checkOnMove=function(a){if(a.np[0]!=a.op[0]){var b=this.extractType(a.np[0].className),d=this.extractType(a.o[0].className);if(!b||!d||!this.checkIfTransitionAllowed(b,d)||this.findParentWithType(a.np[0],this.settings.TreeTypeSubject,!0)!=this.findParentWithType(a.o[0],this.settings.TreeTypeSubject,!1))return!1}return!0};return a}();e.LearningObjectiveRepository=d})(e.LearningObjectiveRepository||(e.LearningObjectiveRepository=
{}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.checkAsyncTaskStatusTimeoutMilliseconds=5E3;this.selectedPersonIds=[];e.AssessmentLettersInstance=this;this.settings=a;this.controls=b;this.letterGroupGridRowsContainer=this.controls.letterGroupGridInstance.getRowsContainer();this.letterGroupGridRows=this.controls.letterGroupGridInstance.getRows();this.letterGroupGridRowsContainer.on("click",CCL.CommonFunctions.formatString(".{0}",this.settings.CssClasses.LetterGroupDownloadLink),
function(){CCL.CommonFunctions.safeAjaxPost({url:c.settings.ServiceUrlsModel.AddKpiOnDownloadLetterGroupPdf,data:{isViewerRoleHeadteacher:c.settings.IsViewerRoleHeadteacher}}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})});this.controls.createLetterGroupButton.click(this.openCreateLetterGroupPopup);this.scheduleCheckExportToPdfAsyncTaskStatus();this.scheduleCheckLettersGeneratedAsyncTaskStatus();this.settings.IsScrollToGroupLettersFeedbackControlNeeded&&this.scrollToGroupLettersFeedback()}
d.prototype.openViewRecipientsDialog=function(a,b,c){a=window[e.AssessmentLettersInstance.settings.ClientInstanceNames.ViewRecipientsDialogInstance];c=CCL.CommonFunctions.formatString(e.AssessmentLettersInstance.settings.LanguageTerms.RecipientsFor,c);a.setTitle(c);a.setAjaxUrl(e.AssessmentLettersInstance.settings.ServiceUrlsModel.GetLetterGroupRecipients,{letterGroupId:b,isViewerRoleHeadteacher:e.AssessmentLettersInstance.settings.IsViewerRoleHeadteacher},!1);a.openDialog(!1)};d.prototype.publishLetterGroupAction=
function(a,b,c){var d=this,e={letterGroupId:b,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher};$.alerts.okButton=this.settings.LanguageTerms.Yes;$.alerts.cancelButton=this.settings.LanguageTerms.No;jConfirm(this.settings.LanguageTerms.PublishLetterGroupConfirmationMessage,this.settings.LanguageTerms.PleaseConfirm,function(a){a&&d.postJsonToService(d.settings.ServiceUrlsModel.PublishLetterGroup,e).done(function(a){window.location=window.location})})};d.prototype.deleteLetterGroupAction=
function(a){$.alerts.okButton=this.settings.LanguageTerms.Yes;$.alerts.cancelButton=this.settings.LanguageTerms.No;jConfirm(this.settings.LanguageTerms.DeleteLetterGroupConfirmationMessage,this.settings.LanguageTerms.PleaseConfirm,function(b){b&&a()})};d.prototype.exportToPdfLetterGroupAction=function(a,b){$(a).attr("disabled")||b()};d.prototype.openCreateLetterGroupPopup=function(){var a=window[e.AssessmentLettersInstance.settings.ClientInstanceNames.CreateLetterPopupInstance],b=[],c=e.AssessmentLettersInstance.controls.learnersGridInstance.GetSelectedValues();
c&&0<c.length&&(b=c.substr(0,c.length-1).split(","));0===b.length?jAlert(e.AssessmentLettersInstance.settings.LanguageTerms.SelectAtLeastOneLearner,e.AssessmentLettersInstance.settings.LanguageTerms.AlertTitle,null):0===$(b).not(e.AssessmentLettersInstance.selectedPersonIds).length&&0===$(e.AssessmentLettersInstance.selectedPersonIds).not(b).length?a.openDialog():CCL.CommonFunctions.safeAjaxPost({url:e.AssessmentLettersInstance.settings.ServiceUrlsModel.GetCreateLetterGroupPopupTitle,data:{personIds:b,
termName:e.AssessmentLettersInstance.settings.TermName,isViewerRoleHeadteacher:e.AssessmentLettersInstance.settings.IsViewerRoleHeadteacher}}).done(function(c){e.AssessmentLettersInstance.selectedPersonIds=b;a.setAboutHtml(c);a.openDialog()}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};d.prototype.scheduleCheckExportToPdfAsyncTaskStatus=function(){var a=this;setTimeout(function(){a.checkExportToPdfAsyncTaskStatus()},this.checkAsyncTaskStatusTimeoutMilliseconds)};d.prototype.checkExportToPdfAsyncTaskStatus=
function(){var a=this,b=[];this.controls.letterGroupGridInstance.getRows().each(function(a,d){b.push($(d).data("id"))});0<b.length&&CCL.CommonFunctions.safeAjaxPost({url:this.settings.ServiceUrlsModel.GetLetterGroupsFeedback,data:{letterGroupIds:b,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}}).done(function(c){var d=window[a.settings.ClientInstanceNames.GroupLettersTasksStatusFeedbackInstance];c=$(c);var e=c.attr(a.settings.DataAttributes.FeedbackProgress);e!==a.settings.DataAttributes.FeedbackProgressValueWait&&
e!==a.settings.DataAttributes.FeedbackProgressValueOk&&e!==a.settings.DataAttributes.FeedbackProgressValueError||d.showMessage(e===a.settings.DataAttributes.FeedbackProgressValueError?CCL.FeedbackType.Error:CCL.FeedbackType.Information,c.html());e!==a.settings.DataAttributes.FeedbackProgressValueOk&&e!==a.settings.DataAttributes.FeedbackProgressValueError||a.deleteLetterGroupAsyncTaskExportAsPdf();e===a.settings.DataAttributes.FeedbackProgressValueOk&&a.injectLetterGroupDownloadLinks(b);a.scheduleCheckExportToPdfAsyncTaskStatus()}).fail(function(a,
b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};d.prototype.scheduleCheckLettersGeneratedAsyncTaskStatus=function(){var a=this;0<this.letterGroupGridRowsContainer.find(CCL.CommonFunctions.formatString(".{0}",this.settings.CssClasses.LetterGroupGeneratingInProgress)).length&&setInterval(function(){a.checkLettersGeneratedAsyncTaskStatus()},this.checkAsyncTaskStatusTimeoutMilliseconds)};d.prototype.checkLettersGeneratedAsyncTaskStatus=function(){var a=this,b=[];this.controls.letterGroupGridInstance.getRows().each(function(c,
d){0<$(d).find(CCL.CommonFunctions.formatString(".{0}",a.settings.CssClasses.LetterGroupGeneratingInProgress)).length&&b.push($(d).data("id"))});0<b.length&&this.postJsonToService(this.settings.ServiceUrlsModel.GetGenerateLettersJobStatus,{letterGroupIds:b,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}).done(function(a){var b=!1;a.forEach(function(a){a.IsLetterGroupBusy||(b=!0)});b&&(window.location=window.location)})};d.prototype.publishLetterGroups=function(a,b){this.postJsonToService(this.settings.ServiceUrlsModel.PublishLetterGroup,
{letterGroupIds:a,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}).done(function(){b()})};d.prototype.deleteLetterGroupAsyncTaskExportAsPdf=function(){this.postJsonToService(this.settings.ServiceUrlsModel.DeleteLetterGroupAsyncTaskExportAsPdf,{isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher})};d.prototype.injectLetterGroupDownloadLinks=function(a){var b=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.ServiceUrlsModel.GetLetterGroupDownloadLinks,data:{letterGroupIds:a,
isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}}).done(function(a){$(a).children().each(function(a,c){a=$(c);c=b.letterGroupGridRowsContainer.find(CCL.CommonFunctions.formatString("[{0}='{1}'] ",b.settings.DataAttributes.LetterGroupDownloadLink,a.attr(b.settings.DataAttributes.LetterGroupDownloadLink)));0<c.length&&c.replaceWith(a)})}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};d.prototype.postJsonToService=function(a,b){return CCL.CommonFunctions.safeAjaxPost({dataType:"JSON",
url:a,data:b}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};d.prototype.scrollToGroupLettersFeedback=function(){$("html, body").animate({scrollTop:this.controls.groupLettersGridLabel.offset().top},1E3)};return d}();e.AssessmentLetters=f})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(){function a(a,b){this.PlanId=a;this.ColumnId=b}a.distinctArray=function(a){return a.reduce(function(a,b){0===a.filter(function(a){return b.PlanId===a.PlanId&&b.ColumnId===a.ColumnId}).length&&a.push(b);return a},[])};return a}();a.PlannerCell=b;var c=function(a){function c(b,f,g){a.call(this,f,e.Planner.getInstance().settings.CourseId,g);this._planElementMovingDisabled=!1;window[b]=this;c.instanceName=b;this._css=f.Css;
this._terms=f.Terms;this._elementColumnIds=f.ElementColumnIds;this._planner=e.Planner.getInstance();this._activateElementsByPlan=this._planner.settings.ActivateElementsByPlan;this._planExpandableContentCellCommonLogic=d.PlanExpandableContentCellCommonLogic.getInstance();b=top;this._activateElementsByPlan&&b.reloadFolder&&b.reloadFolder("item0","planner",!0);this.attachEvents()}__extends(c,a);c.prototype.refreshResourcesCell=function(a,b,c){this.refreshActivityResourceCell(a,b,!0,!0,!1);c&&this.measureKpiEditPlan()};
c.getPlanActivityResourceCellInstance=function(){return window[c.instanceName]};c.onFileUploadSuccess=function(a){c.getPlanActivityResourceCellInstance().onFileUploadSuccess(a)};c.onFileUploadFailed=function(a,b){c.getPlanActivityResourceCellInstance().onFileUploadFailed(a,b)};c.onFileSelected=function(a){c.getPlanActivityResourceCellInstance().onFileSelected(a)};c.getActivityResourceListItemSelector=function(){return"."+c.getPlanActivityResourceCellInstance()._css.ActivityResourceListItem};c.prototype.refreshActivityResourceCell=
function(a,b,c,d,e){void 0===d&&(d=!0);this.reloadPlanElements(a,b,d,c,e)};c.prototype.updateContent=function(a,b,c,d,f){var g=this;b=this.getActivityResourceCell(b,c);b.html(a);a=top;d&&a.reloadFolder&&a.reloadFolder("item0","planner",f,!0);if(this._activateElementsByPlan){d=b.find("."+this._css.ActivityResourceListItem);var h=this._planner.getContainer();0<d.length&&d.each(function(a,b){var c=$(b);a=c.find("."+g._css.ActivityResourceListItemLink).first();b=c.data(g._planner.data.ElementId);void 0==
b||0>=a.length||(a=h.find("."+g._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(g._planner.data.ElementId,b)),0<a.length&&a.each(function(){var a=$(this),b=c.clone();a.replaceWith(b)}))})}this.initDragAndDrop(e.Cards.TopicCard.getParentTopicCardContainer(b))};c.prototype.initDragAndDrop=function(a){var b=this;null==a&&(a=e.Cards.TopicCard.getAllTopicCardContainers());a.each(function(a,c){var d=$(c);b._elementColumnIds.forEach(function(a){a=d.find("."+b._css.ActivityResourceCell+
CCL.CommonFunctions.getDataSelector(b._planner.data.ColumnId,a)+" > ul");b.setDragAndDrop(a)})})};c.prototype.reloadPlanElements=function(a,b,c,d,e){var f=this;this._planElementMovingDisabled=!0;void 0==e&&(e=!this.getActivityResourceCell(a,b).find("."+this._planExpandableContentCellCommonLogic.css.ExpanderLink).hasClass(this._planExpandableContentCellCommonLogic.css.ExpanderLinkExpanded));CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.ReloadPlanElements,data:{courseId:this.courseId,
planId:a,columnId:b,showCollapsedList:e}}).done(function(e){f.updateContent(e.ControlHtml,a,b,c,d);f._planElementMovingDisabled=!1}).fail(function(){return f._planElementMovingDisabled=!1})};c.prototype.removeElementFromPlan=function(b){var c=this,d=this.getDataAttributeValueAsNumber(b,e.PlannerConstants.dataAttributes.ElementId),f=this.getDataAttributeValueAsNumber(b,e.PlannerConstants.dataAttributes.PlanId),g=this.getDataAttributeValueAsNumber(b,e.PlannerConstants.dataAttributes.ColumnId);a.prototype.deletePlanElement.call(this,
f,d,!1).done(function(){c.refreshActivityResourceCell(f,g,!1,!1);c.measureKpiEditPlan()})};c.prototype.deleteElementFromCourse=function(c){var d=this,f=this.getDataAttributeValueAsNumber(c,e.PlannerConstants.dataAttributes.ElementId);c=this.getDataAttributeValueAsNumber(c,e.PlannerConstants.dataAttributes.PlanId);a.prototype.deletePlanElement.call(this,c,f,!0).done(function(){var a=top;a.reloadFolder&&a.reloadFolder("item0","planner");a=d.findCellsToRefresh(f);b.distinctArray(a).forEach(function(a){d.refreshActivityResourceCell(a.PlanId,
a.ColumnId,!1,!1)});d.measureKpiEditPlan()})};c.prototype.getActivityResourceCell=function(a,b){return $("."+this._css.ActivityResourceCell+CCL.CommonFunctions.getDataSelector(this._planner.data.PlanId,a)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,b)).closest("."+this._planner.getPlannerCellCssClass())};c.prototype.getActivityResourceList=function(a,b){return this.getActivityResourceCell(a,b).find("ul")};c.prototype.findCellsToRefresh=function(a){var c=this,d=[];this._planner.getContainer().find("."+
this._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(this._planner.data.ElementId,a)).each(function(a,e){e=$(e);a=e.data(c._planner.data.PlanId);e=e.data(c._planner.data.ColumnId);d.push(new b(a,e))});this.getChildElementIds(a).forEach(function(a){d=$.merge(d,c.findCellsToRefresh(a))});return d};c.prototype.getChildElementIds=function(a){var b=this,c=[];this._planner.getContainer().find("."+this._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(this._planner.data.ParentFolderId,
a)).each(function(a,d){a=$(d).data(b._planner.data.ElementId);-1===c.indexOf(a)&&c.push(a)});return c};c.prototype.swapPlanElements=function(a,b,c,d){var e=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SwapPlanElements,data:{courseId:this.courseId,firstElementId:b,secondElementId:c,planId:a,columnId:d}}).done(function(){e.reloadPlanElements(a,d,!1,!1)})};c.prototype.movePlanElement=function(a,b,c,d,e){var f=this;this._planElementMovingDisabled=!0;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.MovePlanElement,
data:{courseId:this.courseId,sourcePlanId:a,targetPlanId:b,elementId:c,columnId:d,elementIds:e}}).done(function(){a!==b&&(f.refreshActivityResourceCell(a,d,!1),f.refreshActivityResourceCell(b,d,f._planner.settings.ActivateElementsByPlan));f._planElementMovingDisabled=!1}).fail(function(){f.refreshActivityResourceCell(a,d,!1);a!==b&&f.refreshActivityResourceCell(b,d,!1);f._planElementMovingDisabled=!1})};c.prototype.moveElementToPlan=function(a,b,c,d){var e=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.MoveElementToPlan,
data:{courseId:this.courseId,elementId:c,sourcePlanId:a,targetPlanId:b,columnId:d}}).done(function(c){c.Success&&(e.refreshActivityResourceCell(a,d,!1),e.refreshActivityResourceCell(b,d,e._planner.settings.ActivateElementsByPlan))})};c.prototype.getPrevElementId=function(a,b,c){var d=this,e=null,f=this.getActivityResourceCell(a,c).find("."+this._css.ActivityResourceListItem);$.each(f,function(a,c){c=$(c);var g=f.eq(a-1);c.data(d._planner.data.ElementId)==b&&0<a&&(e=g.data(d._planner.data.ElementId))});
return e};c.prototype.getNextElementId=function(a,b,c){var d=this,e=null,f=this.getActivityResourceCell(a,c).find("."+this._css.ActivityResourceListItem);$.each(f,function(a,c){c=$(c);var g=f.eq(a+1);c.data(d._planner.data.ElementId)==b&&a<f.length-1&&(e=g.data(d._planner.data.ElementId))});return e};c.prototype.getNextPlanId=function(a,b){var c=null,d=e.Cards.TopicCard.getParentTopicCard(this.getActivityResourceCell(a,b)).getPlanIds();$.each(d,function(b,e){if(e===a)return b<d.length-1&&(c=d[b+1]),
!1});return c};c.prototype.getPrevPlanId=function(a,b){var c=null,d=e.Cards.TopicCard.getParentTopicCard(this.getActivityResourceCell(a,b)).getPlanIds();$.each(d,function(b,e){if(e===a)return 0<b&&(c=d[b-1]),!1});return c};c.prototype.updateMoveOptions=function(a,b){if(a.length){var c=a.data(this._planner.data.ElementId),d=a.data(this._planner.data.ColumnId);a=a.data(this._planner.data.PlanId);var e="data-"+this._planner.data.PlanId,f=this.getActionLink(this._css.MoveUpResourceLink,c,d,b),g=this.getActionLink(this._css.MoveDownResourceLink,
c,d,b),h=this.getActionLink(this._css.MoveResourceToPrevPlanLink,c,d,b),k=this.getActionLink(this._css.MoveResourceToNextPlanLink,c,d,b),m=this.getActionLink(this._css.RemoveFromPlanLink,c,d,b);b=this.getActionLink(this._css.DeleteFromCourseLink,c,d,b);f.attr(e,a);g.attr(e,a);h.attr(e,a);k.attr(e,a);m.attr(e,a);b.attr(e,a)}};c.prototype.hideMoveOptionsIfNecessary=function(a){if(a.length){var b=a.siblings("."+this._css.ActivityResourceListItem),c=b.data(this._planner.data.ElementId);a=b.data(this._planner.data.ColumnId);
var d=b.data(this._planner.data.PlanId),e=this.getActionLink(this._css.MoveUpResourceLink,c,a,d).closest("li"),f=this.getActionLink(this._css.MoveDownResourceLink,c,a,d).closest("li"),g=this.getActionLink(this._css.MoveResourceToPrevPlanLink,c,a,d).closest("li");b=this.getActionLink(this._css.MoveResourceToNextPlanLink,c,a,d).closest("li");var h=this.getPrevElementId(d,c,a);e.toggle(null!=h);c=this.getNextElementId(d,c,a);f.toggle(null!=c);c=this.getPrevPlanId(d,a);g.toggle(null!=c);a=this.getNextPlanId(d,
a);b.toggle(null!=a)}};c.prototype.getActionLink=function(a,b,c,d){return $("."+a+CCL.CommonFunctions.getDataSelector(this._planner.data.ElementId,b)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,c)+CCL.CommonFunctions.getDataSelector(this._planner.data.PlanId,d))};c.prototype.setDragAndDrop=function(a){var b=this;a.each(function(c,d){c=$(d);if(null!=c.sortable("instance"))return c.sortable("option","connectWith",a),!0;c.sortable({connectWith:a,axis:"y",scroll:!0,scrollSensitivity:50,
scrollSpeed:10,handle:"."+b._planner.css.ReorderDragHandler,cursor:"move",dropOnEmpty:!0,items:"."+b.settings.Css.ElementListItem,containment:e.Cards.TopicCard.getParentTopicCard(c).getPlanGrid().getRowsContainer()});c.on("sortstart",function(a,b){b.item.data("oldIndexValue",b.item.index())});c.on("sortreceive",function(a,c){var d=$(c.item).find("."+b._css.ActivityResourceListItem),e=d.data(b._planner.data.ElementId);b._planElementMovingDisabled?c.sender.sortable("cancel"):$(a.target).find("."+b._css.ActivityResourceListItem).each(function(a,
f){if(f==d[0])return!0;if($(f).data(b._planner.data.ElementId)==e)return c.sender.sortable("cancel"),!1})});c.on("sortstop",function(a,c){var d=parseInt(c.item.index(),10),f=parseInt(c.item.data("oldIndexValue"),10),g=$(c.item),h=g.find("."+b._css.ActivityResourceListItem),k=h.data(b._planner.data.PlanId),m=h.data(b._planner.data.ColumnId),l=h.data(b._planner.data.ElementId),r=e.Cards.TopicCard.getParentPlanContainer(h).data(b._planner.data.GridRowId);if(k!==r||f!==d){var p=[];g.parent().find("."+
b._css.ActivityResourceListItem).each(function(a,c){a=$(c);m===a.data(b._planner.data.ColumnId)&&(a=a.data(b._planner.data.ElementId),p.push(a))});b._planElementMovingDisabled?(a=null!=c.sender?c.sender:$(a.currentTarget),null!=a&&a.sortable("cancel")):(b.movePlanElement(k,r,l,m,p),h.attr("data-"+b._planner.data.PlanId,r),h.data(b._planner.data.PlanId,r),b.updateMoveOptions(h,k))}})})};c.prototype.getLearningObjectiveIds=function(a,b){var c=d.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance();
return c?c.getLearningObjectiveIds(a,b):[]};c.prototype.measureKpiEditPlan=function(){this._planner.measureEditPlan()};c.prototype.attachSpecificEvents=function(){var a=this;$(document).on("click","."+this._css.DeleteFromCourseLink,function(b){var c=$(b.currentTarget);CCL.CommonFunctions.jAjaxConfirm(a._terms.DeleteFromCourseConfirmation,a._planner.terms.ConfirmTitle,a._planner.terms.Yes,a._planner.terms.No,function(b){b&&a.deleteElementFromCourse(c)})}).on("click","."+this._css.MoveUpResourceLink,
function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var e=a.getPrevElementId(b,c,d);e&&a.swapPlanElements(b,c,e,d)}).on("click","."+this._css.MoveDownResourceLink,function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=
a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var e=a.getNextElementId(b,c,d);e&&a.swapPlanElements(b,c,e,d)}).on("click","."+this._css.MoveResourceToNextPlanLink,function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var e=a.getNextPlanId(c,d);e&&a.moveElementToPlan(c,e,b,d)}).on("click","."+this._css.MoveResourceToPrevPlanLink,
function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var e=a.getPrevPlanId(c,d);e&&a.moveElementToPlan(c,e,b,d)}).on("click","."+this._css.ActionLink,function(b){a.hideMoveOptionsIfNecessary($(b.currentTarget))}).on(this._planner.events.PlanActivityResourceCellOutdated,function(b,c){null!=c&&a._elementColumnIds.forEach(function(b){a.refreshActivityResourceCell(c.planId,
b,!1,a._activateElementsByPlan)})})};c.prototype.getLibraryBrowserDialog=function(){return this._planner.getLibraryBrowserDialog()};c.prototype.getPlanId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.GridRowId)};c.prototype.getColumnId=function(a){a=a.closest("."+this._planner.getPlannerCellCssClass()).find("."+this.settings.Css.ActivityResourceCell);return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId)};
c.prototype.getElementDialogOffset=function(){return-15};c.prototype.getFolderId=function(a){return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.FolderId)};return c}(a.PlanResourcesCellBase);a.PlanActivityResourceCell=c})(d.ResourcesCell||(d.ResourcesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(a){function b(c,d){var f=this;a.call(this,d);window[c]=this;b.instanceName=c;this.planner=e.Planner.getInstance();this.courseId=this.planner.settings.CourseId;this.showDates=this.planner.settings.ShowDates;this.startDate=this.planner.settings.FilterStartDate;this.endDate=this.planner.settings.FilterEndDate;$(function(){f.attachEvents()})}__extends(b,a);b.getPlanDateCellInstance=function(){return window[b.instanceName]};
b.prototype.updateContent=function(a,b,c){this.getDateCell(b).replaceWith(a);a=[{planId:b,planActive:c}];$(document).trigger(e.PlannerConstants.events.PlanActivationChanged,{planActivations:a})};b.prototype.updatePlanTimeSpan=function(a){var b=this,c=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanTimeSpan,data:{courseId:this.courseId,planId:a,start:c.getStartDate(),stop:c.getStopDate(),showPlanDates:this.showDates}}).done(function(a){if(a){b.closeDatePicker();
b.refreshDatesCell(a);var d=e.Cards.TopicCard.getInstance(a.topicId);d&&d.updateTopicExpanderLink(a.expanderText)}else c.showErrorMsg(e.DatePickerMode.TimeSpan)}).fail(function(){c.showErrorMsg(e.DatePickerMode.TimeSpan)})};b.prototype.updatePlanWeekAndDay=function(a){var b=this,c=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanWeekAndDay,data:{courseId:this.courseId,planId:a,start:c.getStartWeek(),stop:c.getStopWeek(),showPlanDates:this.showDates}}).done(function(a){if(a){b.closeDatePicker();
b.refreshDatesCell(a);var d=e.Cards.TopicCard.getInstance(a.topicId);d&&d.updateTopicExpanderLink(a.expanderText)}else c.showErrorMsg(e.DatePickerMode.WeekAndDay)}).fail(function(){c.showErrorMsg(e.DatePickerMode.WeekAndDay)})};b.prototype.updatePlanEvents=function(a){var b=this,c=this.getDatePicker(),d=c.getEvents();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanEvents,data:{courseId:this.courseId,planId:a,activityIds:d,filterStartDate:this.startDate,filterStopDate:this.endDate,
showPlanDates:this.showDates}}).done(function(a){if(a){b.closeDatePicker();b.refreshDatesCell(a);var d=e.Cards.TopicCard.getInstance(a.topicId);d&&d.updateTopicExpanderLink(a.expanderText)}else c.showErrorMsg(e.DatePickerMode.Event)}).fail(function(){c.showErrorMsg(e.DatePickerMode.Event)})};b.prototype.setDefaultDate=function(a,b){b=b.data(e.PlannerConstants.dataAttributes.TopicId);e.Cards.TopicCard.setDefaultDate(a,b)};b.prototype.getCurrentPlanId=function(a){a=a.parent().find("input:hidden");return parseInt(a.data(e.PlannerConstants.dataAttributes.PlanId).toString(),
10)};b.prototype.openContextDialog=function(a){this.contextDialog.openDialog(a)};b.prototype.focusOnDateEditAction=function(a){this.getDateCell(a).find(CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanCellAction)).focus()};b.prototype.refreshDatesCell=function(a){this.updateContent(a.dateCell,a.planId,a.planActive);this.planner.settings.ActivateElementsByPlan&&$(document).trigger(e.PlannerConstants.events.PlanActivityResourceCellOutdated,{planId:a.planId})};b.prototype.getDateCell=
function(a){return $("."+this.css.CellContent+" input:hidden"+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).closest("."+this.css.CellContent)};b.prototype.attachEvents=function(){var a=this;$(document).on(e.PlannerConstants.events.PlanDateCellChange,function(b,c){void 0!=c.dateCellObject&&a.refreshDatesCell(c.dateCellObject)});$(document).on(e.PlannerConstants.events.PlanDateCellsChanged,function(b,c){void 0!=c.dateCellObjects&&$.each(c.dateCellObjects,function(b,
c){a.getDateCell(c.PlanId).replaceWith(c.Content)})})};return b}(a.PlanDateCellBase);a.PlanDateCell=b})(d.DateCell||(d.DateCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(a){function b(b,c){a.call(this,b,c,e.Planner.getInstance().getContainer())}__extends(b,a);b.prototype.removeLearningObjective=function(b){var c=this,d=b.data(e.PlannerConstants.dataAttributes.PlanId);b=b.data(e.PlannerConstants.dataAttributes.LearningObjectiveId);var f=!this.getLearningObjectivesListCell(d).find("."+this.settings.Css.ExpanderLink).hasClass(this.settings.Css.ExpanderLinkExpanded);a.prototype.removeLOFromPlan.call(this,
d,b,f).done(function(a){c.updateContent(a.ControlHtml,d)})};b.prototype.getCurrentPlanId=function(a){return a.data(e.PlannerConstants.dataAttributes.PlanId)};b.prototype.getLearningObjectivesListCell=function(a){return $("."+this.settings.Css.LearningObjectivesList+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).closest("."+e.Planner.getInstance().getPlannerCellCssClass())};b.prototype.getLearningObjectiveIds=function(a,b){void 0===b&&(b=!1);var c=this.getLearningObjectivesListCell(a),
d=this.getLearningObjectiveDataAttribute(b);a=c.find(CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)+CCL.CommonFunctions.getDataSelector(d));var f=[];0<a.length&&$.each(a,function(a,b){a=$(b);$.isNumeric(a.data(d))&&(a=parseInt(a.data(d).toString(),10),-1===$.inArray(a,f)&&f.push(a))});return f};return b}(a.PlanLearningObjectivesCellBase);a.PlanLearningObjectivesCell=b})(d.LearningObjectivesCell||(d.LearningObjectivesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells=
{}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){e[e.RichText=0]="RichText";e[e.Theme=1]="Theme";e[e.Lesson=3]="Lesson";e[e.LessonDescription=4]="LessonDescription";e[e.Date=5]="Date";e[e.ClassHours=6]="ClassHours";e[e.LearningObjectives=7]="LearningObjectives";e[e.Resources=8]="Resources";e[e.Activities=9]="Activities";e[e.Term=10]="Term";e[e.Rubric=11]="Rubric";e[e.Elements=12]="Elements"})(e.ColumnType||(e.ColumnType={}));(function(e){e[e.Resource=0]="Resource";e[e.Activity=1]="Activity";e[e.LearningObjectiveAssessmentSupported=
2]="LearningObjectiveAssessmentSupported"})(e.ElementCategory||(e.ElementCategory={}));(function(e){e[e.TimeSpan=0]="TimeSpan";e[e.WeekAndDay=1]="WeekAndDay";e[e.Event=2]="Event"})(e.DatePickerMode||(e.DatePickerMode={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){window[a]=this;d.instanceName=a;this.terms=b;this.planner=e.Planner.getInstance();this.courseId=this.planner.settings.CourseId;this.startDate=this.planner.settings.FilterStartDate;this.endDate=this.planner.settings.FilterEndDate;this.showPlanDates=this.planner.settings.ShowDates;this.useTopics=this.planner.settings.UseTopics;this.addingPlanInProgress=!1}d.getInstance=function(){return window[d.instanceName]};d.prototype.addPlan=function(a){var b=
this;if(!this.addingPlanInProgress){this.addingPlanInProgress=!0;this.planner.toggleEnableDisplayModeSwitcher(!1);var c=e.Cards.TopicCard.getInstance(a),d=c.getLastPlanId();d||(d=0);CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.AddPlan,data:{courseId:this.courseId,topicId:a,start:this.startDate,end:this.endDate,insertAfterPlanId:d,showPlanDates:this.showPlanDates,currentDisplayMode:this.planner.currentDisplayMode},success:function(a){b.useTopics&&(c.getTopicExpanderLink().html(a.topicExpanderText),
c.hasPlans=a.hasPlans);c.appendNewPlan(a.planRow,a.planId);c.showPlanActionMenu();c.hidePlanMoveOptionsIfNecessary();b.planner.toggleEnableDisplayModeSwitcher(!0);b.addingPlanInProgress=!1},error:function(a,c,d){CCL.CommonFunctions.alertAjaxError(a,c,d);b.planner.toggleEnableDisplayModeSwitcher(!0);b.addingPlanInProgress=!1}})}};d.prototype.removePlan=function(a,b){this.removePlans(a,[b],!1)};d.prototype.removePlans=function(a,b,c){var d=this;void 0===b&&(b=null);void 0===c&&(c=!0);var f=e.Cards.TopicCard.getInstance(a);
c&&null==b&&(b=f.getSelectedPlanIds(!0));null!=b&&this.planner.showConfirmDialog(c?this.terms.DeletePlansConfirmation:this.terms.DeletePlanConfirmation,function(e){e&&CCL.CommonFunctions.safeAjaxPost({url:d.planner.webMethods.Plan.RemovePlans,traditional:!0,data:{courseId:d.courseId,topicId:a,planIds:b,updatePlanCount:d.useTopics,start:d.startDate,end:d.endDate,showPlanDates:d.showPlanDates,isBulkAction:c},success:function(a){d.useTopics&&(f.getTopicExpanderLink().html(a.topicExpanderText),f.hasPlans=
a.hasPlans);f.showPlanFeedbackMessage(CCL.FeedbackType.Information,a.restoreText);f.clearPlanSelection();f.removePlansFromGrid(b,a.emptyGridText);f.hidePlanMoveOptionsIfNecessary()},error:CCL.CommonFunctions.alertAjaxError})},this.planner.terms.Delete,this.planner.terms.Cancel)};d.prototype.restorePlans=function(a,b){var c=this,d=e.Cards.TopicCard.getInstance(a);CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.RestorePlans,traditional:!0,data:{courseId:this.courseId,topicId:a,planIds:b,
start:this.startDate,end:this.endDate,updatePlanCount:this.useTopics,showPlanDates:this.showPlanDates},success:function(a){c.useTopics&&(d.getTopicExpanderLink().html(a.topicExpanderText),d.hasPlans=a.hasPlans);d.refreshPlanGrid(function(){a.restoreText&&d.showPlanFeedbackMessage(CCL.FeedbackType.Information,a.restoreText)})},error:CCL.CommonFunctions.alertAjaxError})};d.prototype.togglePlanStatus=function(a,b,c){this.togglePlansStatus(a,c,[b],!1)};d.prototype.togglePlansStatus=function(a,b,c,d){var f=
this;void 0===c&&(c=null);void 0===d&&(d=!0);var g=e.Cards.TopicCard.getInstance(a);d&&null==c&&(c=g.getSelectedPlanIds(!0));if(null!=c){var k=function(a){CCL.CommonFunctions.safeAjaxPost({url:f.planner.webMethods.Plan.TogglePlansStatus,traditional:!0,data:{courseId:f.courseId,planIds:c,activate:b,showPlanDates:f.showPlanDates,toggleElementsActivation:a,isBulkAction:d},success:function(a){1===c.length?g.showPlanFeedbackMessage(CCL.FeedbackType.Information,b?f.terms.PlanActivated:f.terms.PlanDeactivated):
g.showPlanFeedbackMessage(CCL.FeedbackType.Information,b?f.terms.PlansActivated:f.terms.PlansDeactivated);d&&g.clearPlanSelection();$.each(a,function(a,b){$(document).trigger(f.planner.events.PlanDateCellChange,{dateCellObject:b,planContainer:g.getPlanContainerById(b.planId)})})},error:CCL.CommonFunctions.alertAjaxError})};!b&&this.planner.settings.ActivateElementsByPlan&&g.containsPlanElements(c)?this.planner.showConfirmDialog(d?this.terms.PlansDeactivatedWithElementsWarning:this.terms.PlanDeactivatedWithElementsWarning,
function(a){k(a)}):k(!0)}};d.prototype.notifyAboutChanges=function(a){null!=a&&CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.NotifyAboutChanges,data:{courseId:this.courseId,planId:a},success:function(){},error:CCL.CommonFunctions.alertAjaxError})};d.prototype.movePlan=function(a,b,c){this.movePlans(a,c,[b])};d.prototype.movePlans=function(a,b,c){void 0===c&&(c=null);var d=e.Cards.TopicCard.getInstance(a);null==c&&(c=d.getSelectedPlanIds(!0));null!=c&&(c.length>=d.getPlanGrid().getRowsCount()||
CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.MovePlans,traditional:!0,data:{courseId:this.courseId,topicId:a,planIds:c,moveUp:b,start:this.startDate,end:this.endDate},success:function(a){d.sortPlans(a.sortedPlanIds);d.hidePlanMoveOptionsIfNecessary()},error:CCL.CommonFunctions.alertAjaxError}))};d.prototype.setPlanDates=function(a){var b=e.Cards.TopicCard.getInstance(a),c=b.getSelectedPlanIds(!0);null!=c&&this.planner.getSetDateDialog().open(c,function(a){b.updatePlanCellsCallback(a)},
function(){b.clearPlanSelection()},a)};d.prototype.sharePlans=function(a){var b=this,c=e.Cards.TopicCard.getInstance(a),d=c.getSelectedPlanIds(!0);null!=d&&CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.ShareablePlanner.CheckPlanDataForSharing,data:{courseId:this.courseId,planIds:d}}).done(function(a){a&&a.conflictMessage?CCL.CommonFunctions.jAjaxAlert(a.conflictMessage,b.planner.terms.Alert,b.planner.terms.Ok):a&&a.warningMessage?b.planner.showConfirmDialog(a.warningMessage,function(a){a&&
c.redirectToSharePlans(d)}):c.redirectToSharePlans(d)}).fail(CCL.CommonFunctions.alertAjaxError)};d.prototype.stopSharingPlan=function(a,b,c){var d=this,f=e.Cards.TopicCard.getInstance(b);CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.ShareablePlanner.StopSharingPlans,data:{courseId:this.courseId,planIds:[c]}}).done(function(){d.planner.settings.UseTopics&&f&&f.clearPlanSelection();$(a).parent().hide()}).fail(CCL.CommonFunctions.alertAjaxError)};return d}();e.PlanCommonLogic=f})(f.Planner||
(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(a){function b(b,c,d){var e=this;a.call(this,b,c);$(function(){e.columnsData=[];e.addColumnsToEdit(d)})}__extends(b,a);b.getInstance=function(){return window[d.PlannerInlineCellBase.clientInstanceName]};b.prototype.addColumnsToEdit=function(a){var c=this;$.each(a,function(a,d){c.columnsData[d.HybridEditorItemId]=d;(a=$("div["+e.PlannerConstants.dataAttributes.HybridEditorItem+"][id *= "+d.HybridEditorItemId+"]"))&&a.data(b.hybridEditorItemIdDataAttr,
d.HybridEditorItemId)})};b.prototype.getEditorItemSettings=function(b){return(b=this.columnsData[b])?a.prototype.getSettings.call(this,b):{}};b.prototype.measureKpiEditPlan=function(){e.Planner.getInstance().measureEditPlan()};b.prototype.getColumnData=function(a){return this.columnsData[a.data(b.hybridEditorItemIdDataAttr).toString()]};b.prototype.replaceMediaContentWithPlaceholders=function(){return e.Planner.getInstance().isTableCurrentMode()};return b}(d.PlannerInlineCellBase);d.PlannerInlineCell=
a})(f.InlineCell||(f.InlineCell={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function a(a,c){var b=this;this.focusTitle=function(){b.$topicTitle.select()};window[a]=this;this.settings=c;this.planner=e.Planner.getInstance();this.$topicTitle=$("#"+this.settings.Controls.TopicTitleId);this.$errorMessage=$("#"+this.settings.Controls.ErrorMessageId);this.$saveButton=$("#"+this.settings.Controls.SaveButtonId);this.attachEventHandlers()}a.prototype.open=function(){var a=this,c=this.getDialog(),d=this.getColorPicker();this.clearForm();
CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetRandomColorSchemeForNewTopic+"/"+this.planner.settings.CourseId}).done(function(a){d.setColor(a.topicColorSchema)}).fail(function(){d.setColor(a.settings.TopicDefaultColorSchema)});c.openDialog()};a.prototype.getColorPicker=function(){return window[this.settings.Controls.ColorPickerId]};a.prototype.attachEventHandlers=function(){var a=this;this.$saveButton.click(function(){return a.validateAndSave()});this.$topicTitle.keypress(function(b){return 13===
b.keyCode?(a.validateAndSave(),!1):!0})};a.prototype.clearForm=function(){this.$errorMessage.hide();this.$saveButton.toggleHyperlink(!0)};a.prototype.validateAndSave=function(){if(this.$saveButton.getIfHyperLinkEnabled()){var a=$.trim(this.$topicTitle.val());if(0<a.length){var c=this.getColorPicker().getSelectedColorKey();this.addTopic(a,c)}else this.$errorMessage.show()}};a.prototype.addTopic=function(a,c){var b=this;this.$saveButton.toggleHyperlink(!1);e.TopicCommonLogic.getInstance().addTopic(a,
c,CssModal.closeDialog,function(){b.$saveButton.toggleHyperlink(!0)})};a.prototype.getDialog=function(){return window[this.settings.TopicAddDialogInstance]};return a}();f.TopicAddDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(b,d){window[b]=this;a.instanceName=b;this._settings=d;this._css=d.Css;this._planner=e.Planner.getInstance();this._courseId=this._planner.settings.CourseId;this._currentColumnId=this._currentTopicId=0;this.attachEvents()}a.getTopicLearningObjectivesCellInstance=function(){return window[a.instanceName]};a.prototype.updateLearningObjectives=function(a){var b=this,c=this._currentTopicId,d=this._currentColumnId;CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.LearningObjective.AddTopicLearningObjectives,
data:{courseId:this._courseId,learningObjectiveIds:a,topicId:c,columnId:d}}).done(function(a){b.getLearningObjectivesListCell(c,d).html(a.contentHtml)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getLearningObjectivesListCell=function(a,b){return $("."+this._css.CardCell+CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,a)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,b)).parent()};a.prototype.getLearningObjectiveIds=function(a,b,d){var c=this;a=a.find(""+
CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,b)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,d)+CCL.CommonFunctions.getDataSelector(this._planner.data.LearningObjectiveId));var e=[];0<a.size()&&$.each(a,function(a,b){a=$(b);$.isNumeric(a.data(c._planner.data.LearningObjectiveId))&&e.push(parseInt(a.data(c._planner.data.LearningObjectiveId)))});return e};a.prototype.removeLearningObjective=function(a,b,d){var c=this;CCL.CommonFunctions.safeAjax({type:"DELETE",url:this._planner.webMethods.LearningObjective.RemoveTopicLearningObjective,
data:{courseId:this._courseId,topicId:a,learningObjectiveId:d,columnId:b}}).done(function(d){c.getLearningObjectivesListCell(a,b).html(d.contentHtml)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.attachEvents=function(){var a=this;this._planner.getContainer().on("click","."+this._css.AddLearningObjectives,function(b){a._currentTopicId=$(b.currentTarget).data(a._planner.data.TopicId);a._currentColumnId=$(b.currentTarget).data(a._planner.data.ColumnId);b=window[a._settings.LearningObjectiveSelector];
b.setSelectedIds(a.getLearningObjectiveIds(a.getLearningObjectivesListCell(a._currentTopicId,a._currentColumnId),a._currentTopicId,a._currentColumnId),!0);b.openDialog()});$(document).on("click","."+this._css.RemoveLearningObjective,function(b){b=$(b.currentTarget);a.removeLearningObjective(b.data(a._planner.data.TopicId),b.data(a._planner.data.ColumnId),b.data(a._planner.data.LearningObjectiveId))})};return a}();d.TopicLearningObjectivesCell=a})(f.Topic||(f.Topic={}))})(e.Cells||(e.Cells={}))})(f.Planner||
(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(b,d){window[b]=this;a.instanceName=b;this._settings=d;this._css=d.Css;this._terms=d.Terms;this._planner=e.Planner.getInstance();this._courseId=this._planner.settings.CourseId;this._contextDialog=new ContextDialog($("#"+d.TermEditorId),{title:this._terms.TermContextDialogTitle,footerContent:d.TermEditorFooterId,setFocus:!1,width:"auto",zIndex:1});$.each($("."+this._css.TermRadioButton),function(a,b){$(b).find(":radio").attr("name",
"TermGroup")});this.attachEvents()}a.getTopicTermCellInstance=function(){return window[a.instanceName]};a.prototype.editTerm=function(a,b,d,e){this._currentTopicId=d;this._activeContainer=b.parent();this._contextDialog.openDialog(a);null!=e?$("."+this._css.TermRadioButton+CCL.CommonFunctions.getDataSelector(this._planner.data.CourseTermId,e)).find(":radio").attr("checked","checked").focus():($("."+this._css.TermRadioButton).find(":radio:checked").removeAttr("checked").blur(),$("."+this._css.TermRadioButton+
":first").find(":radio").focus())};a.prototype.attachEvents=function(){var a=this;this._contextDialog.setBeforeCloseDialog(function(){a.beforeCloseClontextDialog()});this._planner.getContainer().on("click","."+this._css.EditTermLink,function(b){var c=$(b.currentTarget),d=c.data(a._planner.data.TopicId),e=c.data(a._planner.data.CourseTermId);!a._contextDialog.mainContainer.is(":visible")&&0<d&&a.editTerm(b,c,d,e)});$("#"+this._settings.SaveTermButtonId).on("click",function(){a._contextDialog.closeDialog()});
$("#"+this._settings.ClearTermLinkId).on("click",function(){$("."+a._css.TermRadioButton).find(":radio:checked").removeAttr("checked")})};a.prototype.beforeCloseClontextDialog=function(){var a=this,b=$("."+this._css.EditTermLink+CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,this._currentTopicId)).data(this._planner.data.CourseTermId),d=$("."+this._css.TermRadioButton).has(":radio:checked").data(this._planner.data.CourseTermId);b!==d&&CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.TopicTerm.UpdateTopicTerm,
data:{courseId:this._courseId,topicId:this._currentTopicId,courseTermId:void 0!==d?d:0,start:this._planner.settings.FilterStartDate,stop:this._planner.settings.FilterEndDate}}).done(function(b){if(b){a._activeContainer.replaceWith(b.termCell);$(document).trigger(a._planner.events.PlanDateCellsChanged,{dateCellObjects:b.dateCells});var c=e.Cards.TopicCard.getInstance(a._currentTopicId);c&&c.setTermDates(a._planner.parseDateFromString(b.termStartDate),a._planner.parseDateFromString(b.termStopDate))}})};
return a}();d.TopicTermCell=a})(f.Topic||(f.Topic={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){e.mentorFeedbackOverviewInstance=this;this.context=a;this.$window=$(window);this.setMentorFeedbackSelectorAction();this.setCompleteButtonAction();this.setUndoButtonAction();this.context.Settings.IsToolbarButtonsAvailable?(this.setfeedbackSetupAction(),this.setMultipleAssessAction()):(window[this.context.Controls.PersonGrid].disableToolbarItem($("#"+this.context.Controls.FeedbackSetupButtonId)),window[this.context.Controls.PersonGrid].disableToolbarItem($("#"+
this.context.Controls.AssessMultipleButtonId)));a=$("."+this.context.CssClasses.HybridEditorItemCss);this.bindToEditorItemEvents(a);window[this.context.Controls.PersonGrid].toggleSelectAll(!1)}d.prototype.onSetFeedbackColumnValueError=function(a,b){b=b.xhrObject.status;CCL.CommonFunctions.jAlertAjaxError(409===b?this.context.LanguageTerms.AlertMessage:this.context.LanguageTerms.AlertStoringProblem,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,409===b);a.stopPropagation()};d.prototype.bindToEditorItemEvents=
function(a){var b=this;a.on(this.context.Events.HybridEditorItemAjaxError,function(a,d){b.onSetFeedbackColumnValueError(a,d)}).on(this.context.Events.HybridEditorItemSaveError,function(a,d){b.onSetFeedbackColumnValueError(a,d)})};d.prototype.checkLogAvailability=function(a){var b=window[e.mentorFeedbackOverviewInstance.context.Controls.PersonGrid].getRowById(a);b=$("."+e.mentorFeedbackOverviewInstance.context.CssClasses.MentorFeedbackSelectorCss,b).attr(e.mentorFeedbackOverviewInstance.context.Settings.MentorFeedbackIdAttribute);
e.mentorFeedbackOverviewInstance.safeAjaxPostHandler(e.mentorFeedbackOverviewInstance.context.WebMethods.LogAvailability,{mentorFeedbackId:b},function(b){e.mentorFeedbackOverviewInstance.toggleLogLink(b.available,a)})};d.prototype.setfeedbackSetupAction=function(){var a=this;$("#"+this.context.Controls.FeedbackSetupButtonId).click(function(){return a.isAnyStudentSelected(function(b){for(var c,d="",e=0;e<b.length;e++){var f=a.getLearnerMentorFeedbackId(b[e]);if(0===e)c=f;else if(c!==f){d=a.context.LanguageTerms.DifferentMfConfirmation;
break}}var k=a.context.Urls.FeedbackSetupDialogUrl+"&"+a.context.Settings.PersonIdAttribute+"="+b.join(",");""!==d?jConfirm(d,a.context.LanguageTerms.PleaseConfirm,function(b){b&&a.openDialog(k,a.context.Controls.FeedbackSetupDialog)}):a.openDialog(k,a.context.Controls.FeedbackSetupDialog)})})};d.prototype.setMultipleAssessAction=function(){var a=this;$("#"+this.context.Controls.AssessMultipleButtonId).click(function(){return a.isAnyStudentSelected(function(b){for(var c=0,d=a.context.LanguageTerms.WarningNoMfSelected,
e=0;e<b.length;e++){var f=a.getLearnerMentorFeedbackId(b[e]);if(0!==f){if(0!==c&&c!==f){d=a.context.LanguageTerms.WarningDifferentMfSelected;break}c=f;d=""}}""!==d?jAlert(d,a.context.LanguageTerms.AlertTitle,null):(b=a.context.Urls.AssessMultipleDialogUrl+"&"+a.context.Settings.TermAssessmentAttributeId+"="+c+"&"+a.context.Settings.PersonIdAttribute+"="+b.join(","),a.openDialog(b,a.context.Controls.AssesMultipleDialog))})})};d.prototype.openDialog=function(a,b){window[b].setIframeUrl(a);window[b].openDialog()};
d.prototype.isAnyStudentSelected=function(a){var b=window[this.context.Controls.PersonGrid].getSelectedValues();0===b.length?jAlert(this.context.LanguageTerms.AlertNoPersonSelected,this.context.LanguageTerms.AlertTitle,null):a(b)};d.prototype.getLearnerMentorFeedbackId=function(a){return+$("select["+this.context.Settings.LearnerIdAttribute+"='"+a+"']").val()};d.prototype.setCompleteButtonAction=function(){var a=this;$("#"+this.context.Controls.CompleteTermButtonId).click(function(){jConfirm(a.context.LanguageTerms.CompleteTermWarning,
a.context.LanguageTerms.PleaseConfirm,function(b){b&&a.safeAjaxPostHandler(a.context.WebMethods.CompleteTerm,{organizationId:a.context.Settings.OrganizationId,termId:a.context.Settings.TermId},function(){$("#"+a.context.Controls.CompleteContainer).hide();$("#"+a.context.Controls.UndoContainer).show()})})})};d.prototype.setUndoButtonAction=function(){var a=this;$("#"+this.context.Controls.UndoCompleteTermButtonId).click(function(){a.safeAjaxPostHandler(a.context.WebMethods.UndoCompleteTerm,{organizationId:a.context.Settings.OrganizationId,
termId:a.context.Settings.TermId},function(){$("#"+a.context.Controls.UndoContainer).hide();$("#"+a.context.Controls.CompleteContainer).show()})})};d.prototype.ajaxHandler=function(a,b,c){var d=this;this.errorRised=!1;$.ajax({type:"POST",url:a,dataType:"json",data:b,success:c,error:function(a){return d.ajaxErrorHandler(a)}})};d.prototype.safeAjaxPostHandler=function(a,b,c){var d=this;this.errorRised=!1;CCL.CommonFunctions.safeAjaxPost({url:a,dataType:"json",data:b,success:c,error:function(a){return d.ajaxErrorHandler(a)}})};
d.prototype.ajaxErrorHandler=function(a){this.errorRised||(this.errorRised=!0,409===a.status?CCL.CommonFunctions.jAlertAjaxError(this.context.LanguageTerms.AlertMessage,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,!0):0===a.status?CCL.CommonFunctions.jAlertAjaxError(this.context.LanguageTerms.AlertStoringProblem,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,!1):CCL.CommonFunctions.alertAjaxError(a,null,null))};d.prototype.setMentorFeedbackSelectorAction=
function(){var a=this;$("."+this.context.CssClasses.MentorFeedbackSelectorCss).focus(function(b){return a.feedbackSetupPreviousValue=$(b.target).val()}).change(function(b){var c=$(b.target).attr(a.context.Settings.LearnerIdAttribute);$.getJSON(a.context.WebMethods.IsMentorFeedbackValuesExist,{learnerId:c,organisationId:a.context.Settings.OrganizationId,hierarchyId:a.context.Settings.HierarchyId,termId:a.context.Settings.TermId},function(c){c.result?jConfirm(a.context.LanguageTerms.ChangeFeedbackSetupWarning,
a.context.LanguageTerms.PleaseConfirm,function(c){c?a.changeMentorSetup(b):$(b.target).val(a.feedbackSetupPreviousValue)}):a.changeMentorSetup(b)})})};d.prototype.changeMentorSetup=function(a){var b=this,c=$(a.target),d=c.attr(this.context.Settings.LearnerIdAttribute),e=$("."+d),f=c.val();this.toggleLogLink(!1,d);if(f===this.context.Settings.DefaultMentorFeedbackSelectorValue)a=c.attr(this.context.Settings.MentorFeedbackIdAttribute),this.safeAjaxPostHandler(this.context.WebMethods.RemoveFeedbackSetup,
{mentorFeedbackId:a,learnerId:d,organisationId:this.context.Settings.OrganizationId,hierarchyId:this.context.Settings.HierarchyId},function(){e.addClass(b.context.CssClasses.HiddenCss);$("."+b.context.CssClasses.CommentLabelCss,e).text("");for(var a=$("."+b.context.CssClasses.HybridEditorItemCss,e),d=0;d<a.length;d++){var f=$(a[d]);f.hybridEditorItem().hybridEditorItem("resetValue");f.hybridEditorItem().hybridEditorItem("setToolTip","");var g=f.hybridEditorItem().hybridEditorItem("option","webMethodParams");
g.mentorFeedbackId="";g.columnId="";f.hybridEditorItem().hybridEditorItem("option","webMethodParams",g)}$("."+b.context.CssClasses.CommentPanelCss,e).addClass(b.context.CssClasses.HiddenCss);c.attr(b.context.Settings.MentorFeedbackIdAttribute,"")});else{var k=c.attr(this.context.Settings.LearnerNameAttribute);this.safeAjaxPostHandler(this.context.WebMethods.SetFeedbackSetup,{organisationId:this.context.Settings.OrganizationId,hierarchyId:this.context.Settings.HierarchyId,learnerId:d,termAssessmentId:f},
function(a){c.attr(b.context.Settings.MentorFeedbackIdAttribute,a.mentorFeedbackId);e.removeClass(b.context.CssClasses.HiddenCss);var g=b.context.TermAssessmentCustomColumns[f],h=$("."+b.context.CssClasses.CommentLabelCss,e),m=$("."+b.context.CssClasses.HybridEditorItemCss,e),l=$("."+b.context.CssClasses.CommentPanelCss,e);b.setUrlToLogLink(a.mentorFeedbackId,d);for(var r,t,u=0;u<g.length;u++)$(h[u]).text(g[u].Name),t=$(m[u]),t.hybridEditorItem().hybridEditorItem("resetValue"),t.hybridEditorItem().hybridEditorItem("setToolTip",
g[u].ToolTip+" "+k),r=t.hybridEditorItem().hybridEditorItem("option","webMethodParams"),r.mentorFeedbackId=a.mentorFeedbackId,r.columnId=String(g[u].CustomColumnId),t.hybridEditorItem().hybridEditorItem("option","webMethodParams",r),$(l[u]).removeClass(b.context.CssClasses.HiddenCss);if(g.length<h.length)for(a=h.length,g=g.length;g<a;g++)$(h[g]).text(""),t=$(m[g]),t.hybridEditorItem().hybridEditorItem("resetValue"),t.hybridEditorItem().hybridEditorItem("setToolTip",""),r=t.hybridEditorItem().hybridEditorItem("option",
"webMethodParams"),r.mentorFeedbackId="",r.columnId="",t.hybridEditorItem().hybridEditorItem("option","webMethodParams",r),$(l[g]).addClass(b.context.CssClasses.HiddenCss)})}};d.prototype.setUrlToLogLink=function(a,b){var c=window[this.context.Controls.PersonGrid].getRowById(b);$("."+this.context.CssClasses.LogLinkCss,c).attr("href",this.context.Urls.LogLink+"?"+this.context.Settings.PersonIdAttribute+"="+b+"&"+this.context.Settings.SupervisorTypeRequestItem+"="+this.context.Settings.SupervisorType+
"&"+this.context.Settings.MentorFeedbackIdRequestItem+"="+a)};d.prototype.toggleLogLink=function(a,b){var c=window[this.context.Controls.PersonGrid].getRowById(b);b=$("."+this.context.CssClasses.LogLinkCss,c);c=$("."+this.context.CssClasses.NoLogLabelCss,c);a?(b.removeClass(this.context.CssClasses.HiddenCss),c.addClass(this.context.CssClasses.HiddenCss)):(b.addClass(this.context.CssClasses.HiddenCss),c.removeClass(this.context.CssClasses.HiddenCss))};return d}();e.MentorFeedbackOverview=f})(f.Mentor||
(f.Mentor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){e.mentorFeedbackAssessMultipleInstance=this;this.context=a;this.window=$(window);this.setOkClickEvent()}d.prototype.setOkClickEvent=function(){var a=this;$("#"+this.context.Settings.OkClientId).click(function(){for(var b="",c=$('[id*="CustomColumnValue"]'),d=0;d<c.length;d++){var e=$(c[d]);e.val().trim()&&(e=e.attr("data-cc-id"),-1<a.context.Settings.FilledCustomColumns.indexOf(e)&&(b=a.context.Settings.TermCommentWarning))}""!==b?jConfirm(b,
a.context.Settings.TermPleaseConfirm,function(b){b&&a.context.Functions.OkPostbackScript()}):a.context.Functions.OkPostbackScript()})};return d}();e.MentorFeedbackAssessMultiple=f})(f.Mentor||(f.Mentor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(a){a[a.Expanded=1]="Expanded";a[a.Collapsed=2]="Collapsed";a[a.Loading=3]="Loading"})(e.FolderExpandState||(e.FolderExpandState={}));var k=e.FolderExpandState,d=function(){function a(a,c,d){var b=this;this.settings=c;this.controls=d;this.inputTypeCheckboxSelector="input:checkbox";this.stateChangedHandler=function(a){var c=$(a.target);a=b.closestItem(c);c=b.updateItemState(a,c.is(":checked"));a.find(b.inputTypeCheckboxSelector).first().focus();b.controls.Container.trigger(b.settings.StateChangedEventName,
c)};window[a]=this;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.setupListItemFocusedAreaClickHandler()}Object.defineProperty(a.prototype,"itemSelector",{get:function(){return CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"listItemFocusedAreaSelector",{get:function(){return"."+this.settings.CssClasses.ListItemFocusedArea},enumerable:!0,configurable:!0});a.prototype.init=function(a){this.initParameters=
a};a.prototype.expandFolder=function(a){var b=this,d=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).first(),e=d.data(this.settings.DataAttributes.FolderActionExpand),f=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderAppendTarget)).first();e?this.setFolderState(f,d,k.Expanded):(this.setFolderState(f,d,k.Loading),a={folderId:this.getItemId(a)},this.getFolderContent(a).done(function(a){f.append(a);b.setFolderState(f,d,k.Expanded);
b.onFolderContentLoaded()}))};a.prototype.onFolderContentLoaded=function(){var a=this;this.initParameters.itemStates.forEach(function(b,d){a.checkboxStateMachine.isElementChecked(b)&&(b=a.getCheckbox(d))&&0<b.length&&b.prop("checked",!0)});this.initParameters.disabledItemIds&&this.initParameters.disabledItemIds.forEach(function(b){(b=a.getCheckbox(b))&&b.prop("disabled",!0)})};a.prototype.countItemsChanged=function(){return f.MapUtils.reduce(this.initParameters.itemStates,function(a,c,d){return d===
f.CheckboxStateMachine.State.AttachedByUser||d===f.CheckboxStateMachine.State.DetachedByUser?a+1:a},0)};a.prototype.countCheckedItems=function(){var a=this;return f.MapUtils.reduce(this.initParameters.itemStates,function(b,d,e){return a.checkboxStateMachine.isElementChecked(e)?b+1:b},0)};a.prototype.setupListItemFocusedAreaClickHandler=function(){var a=this;this.controls.Container.on((c={},c.change=this.stateChangedHandler,c),this.inputTypeCheckboxSelector);this.controls.Container.on("click",this.listItemFocusedAreaSelector,
function(b){b=$(b.target);var c=a.closestItem(b);a.isClickTargetEnabled(b,c)&&(a.targetIsFolderActionExpand(b)?a.expandOrCollapseFolder(c):a.isListItemFocusedArea(b)&&(b=a.getCheckbox(a.getItemId(c)),b.prop("checked",!b.is(":checked")).change()))});this.controls.Container.on("keyup",this.listItemFocusedAreaSelector,function(b){b.which===CCL.CommonConstants.keyCodes.space&&(b=$(b.target),a.targetIsFolderActionExpand(b)&&a.expandOrCollapseFolder(a.closestItem(b)))});var c};a.prototype.isClickTargetEnabled=
function(a,c){return 0>=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).length||this.initParameters.allowFolderSelection&&this.isCheckboxExistAndEnabled(c)};a.prototype.targetIsFolderActionExpand=function(a){return a.is(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand))||0<a.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).length};a.prototype.updateItemState=function(a,c){a=
this.getItemId(a);var b=this.initParameters.itemStates.get(a)||f.CheckboxStateMachine.State.Empty;c=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(c,b);this.initParameters.itemStates.set(a,c);return this.countCheckedItems()};a.prototype.expandOrCollapseFolder=function(a){var b=this,d=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).first(),e=d.data(this.settings.DataAttributes.FolderActionExpand),f=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderAppendTarget)).first();
e?e===k.Expanded?this.setFolderState(f,d,k.Collapsed):e===k.Collapsed&&this.setFolderState(f,d,k.Expanded):(this.setFolderState(f,d,k.Loading),a={folderId:this.getItemId(a)},this.getFolderContent(a).done(function(a){f.append(a);b.setFolderState(f,d,k.Expanded);b.onFolderContentLoaded()}))};a.prototype.isCheckboxExistAndEnabled=function(a){return(a=this.getCheckbox(this.getItemId(a)))&&0<a.length&&a.is(":enabled")};a.prototype.setFolderState=function(a,c,d){a.toggle(d===k.Expanded);this.closestListItemFocusedArea(c).find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderTitle)).toggleClass(this.settings.CssClasses.FontBold,
d===k.Expanded);c.data(this.settings.DataAttributes.FolderActionExpand,d);a=c.find("."+this.settings.CssClasses.FolderStateExpanded+",."+this.settings.CssClasses.FolderStateCollapsed);a.toggleClass(this.settings.CssClasses.FolderStateCollapsed,d!==k.Expanded);a.toggleClass(this.settings.CssClasses.FolderStateExpanded,d===k.Expanded)};a.prototype.isClosestLabel=function(a){return 0<a.closest("label").length};a.prototype.getFolderContent=function(a){return $.ajax({type:"GET",url:this.settings.Urls.FolderContent,
data:a,dataType:"html"})};a.prototype.isListItemFocusedArea=function(a){return a.is(this.listItemFocusedAreaSelector)};a.prototype.closestListItemFocusedArea=function(a){return a.closest(this.listItemFocusedAreaSelector)};a.prototype.closestItem=function(a){return a.closest(this.itemSelector)};a.prototype.getItemId=function(a){return a.data(this.settings.DataAttributes.ItemId)};a.prototype.getCheckbox=function(a){return $("#"+this.controls.CheckboxItemPrefix+a)};return a}();e.TreeViewSelector=d})(f.TreeViewSelector||
(f.TreeViewSelector={}))})(ItslearningWeb||(ItslearningWeb={}));(function(f){(function(e){e.getFormDataWithAttachedFilesAndFileSizes=function(e){e=e.files;var d=[];if(0<e.length&&FormData){for(var a=new FormData,b=0;b<e.length;b++)0<e[b].size&&(a.append("file"+b,e[b]),d.push(e[b].size));return{formData:a,fileSizes:d}}}})(f.UploadFileHelper||(f.UploadFileHelper={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){this.timeout=500}}();e.IframeLoadingIndicatorSettings=f;f=function(){function d(a){var b=this;this.settings=a;this.showAfterDelay=!0;this.loadingIndicator=$("#"+this.settings.loadingIndicatorClientId);$(window).load(function(){$("#"+b.settings.iframeClientId).ready(function(){b.hideIndicator()})});$(document).on("cssmodal:show",function(){b.hideIndicator()});setTimeout(function(){b.showAfterDelay&&b.loadingIndicator.show()},this.settings.timeout)}
d.prototype.hideIndicator=function(){if(null!=this.settings.onHideCallback)this.settings.onHideCallback();this.showAfterDelay=!1;this.loadingIndicator.hide()};return d}();e.IframeLoadingIndicator=f})(f.ViewLearningToolElement||(f.ViewLearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(){var a=this;this.featureDialogMap={};this.antiForgerySettings={};this.dispatch=function(b){switch(b.type){case CCL.Onboarding.Extensions.MessageType.CompleteFeature:a.completeFeatures(b.features);break;case CCL.Onboarding.Extensions.MessageType.TriggerOnboardingFeature:a.triggerFeature(b.featureId);break;case CCL.Onboarding.Extensions.MessageType.HideOverlay:a.hideOverlay();break;case CCL.Onboarding.Extensions.MessageType.ShowOverlay:a.showOverlay();
break;case CCL.Onboarding.Extensions.MessageType.RequestFeatureState:a.requestFeatureState(b.featureId).done(function(c,d,e){d=a.extensionIframe.get(0).contentWindow;e=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionOnboarding);var f={featureId:b.featureId,type:CCL.Onboarding.Extensions.MessageType.ReceiveFeatureState};$.extend(f,c);CCL.CommonFunctions.makePostMessageCallWithData(d,e,f)})}};this.triggerFeature=function(b){b&&a.requestFeatureState(b).done(function(c,
d,e){c.IsCompleted?a.triggerFeature(a.featureDialogMap[b].nextFeatureId):(c=window[a.featureDialogMap[b].dialogClientId],c.blockHighlightZone=!0,c.openDialog(function(c){c?a.completeFeatures([a.featureDialogMap[b].featuresForComplete]):a.triggerFeature(a.featureDialogMap[b].nextFeatureId)}))})};this.completeFeatures=function(b){for(var c=0;c<b.length;c++){var d=b[c];d&&CCL.CommonFunctions.safeAjax({url:a.onboardingServiceUrl.replace("{featureId}",d),type:"PUT",headers:(e={},e[a.antiForgerySettings.headerName]=
a.antiForgerySettings.headerValue,e)})}var e}}a.prototype.init=function(a,c,d){this.pageOptions=d;this.onboardingServiceUrl=a;this.extensionIframe=c;this.antiForgerySettings=this.pageOptions.antiForgerySettings;this.featureDialogMap[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentLearningToolOptions]={dialogClientId:d.optionsOnboradingClientId,nextFeatureId:CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders,featuresForComplete:[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders]};
this.featureDialogMap[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders]={dialogClientId:d.pageFunctionsClientId};CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.extensionOnboarding,this.dispatch)};a.prototype.showOverlay=function(){this.extensionIframe.css("position","relative");this.extensionIframe.css("z-index","1000");$("<div></div>").appendTo(document.body).addClass(this.pageOptions.cssClasses.onboardingDialogMask).css({opacity:"0",
filter:"alpha(opacity=0)","z-index":997}).fadeTo(0,1)};a.prototype.hideOverlay=function(){this.extensionIframe.css("position","");this.extensionIframe.css("z-index","");$("."+this.pageOptions.cssClasses.onboardingDialogMask).remove()};a.prototype.requestFeatureState=function(a){return $.ajax({url:this.onboardingServiceUrl.replace("{featureId}",a),type:"GET"})};return a}();e.PostMessageDispatcher=d})(e.ViewLearningToolElement||(e.ViewLearningToolElement={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){var e;(function(d){d[d.Stopped=0]="Stopped";d[d.RecordingStarted=1]="RecordingStarted";d[d.PreviewSeeked=2]="PreviewSeeked";d[d.PreviewStarted=3]="PreviewStarted";d[d.PreviewPaused=4]="PreviewPaused";d[d.Closing=5]="Closing"})(e||(e={}));var k=function(){function d(a,b){this.wasInterrupted=!1;this.previewChromeAudioPauseIntervalMs=this.previewChromeAudioPauseTimeMs=this.previewChromeAudioStartTimeMs=this.recordingChromeStartTimeMs=this.recordingVideoPreInterval=this.currentRecordDuration=0;
window[a]=this;this.settings=b;this.eventNames=b.EventNames;this.initialize()}d.prototype.initialize=function(){var a=this;this.settings.IsVideo?(this.video=document.getElementById(this.settings.VideoId),this.video.muted=!0,this.video.onended=function(){a.onPlaybackEnded()},window.isChrome&&(this.audio=document.getElementById(this.settings.AudioId),this.audio.muted=!0),this.constraints={audio:!0,video:{mandatory:{maxWidth:this.video.clientWidth,maxHeight:this.video.clientHeight,minWidth:this.video.clientWidth,
minHeight:this.video.clientHeight}}},this.settings.RequestMediaResourcesOnLoad&&this.showVideoFrame()):(this.audio=document.getElementById(this.settings.AudioId),this.audio.muted=!0,this.audio.onended=function(){a.onPlaybackEnded()},this.constraints={audio:!0,video:!1},this.settings.RequestMediaResourcesOnLoad&&!this.audioStream&&navigator.getUserMedia(this.constraints,function(b){window.isChrome&&(b=new window.MediaStream(b.getAudioTracks()));a.audioStream=b},function(){a.showAlert(a.settings.AccessDeniedErrorMessage)}));
this.currentState=e.Stopped};d.prototype.startRecording=function(){var a=this;this.settings.IsVideo?(this.video.onended=function(){a.onPlaybackEnded()},this.startRecordingVideo()):(this.audio.onended=function(){a.onPlaybackEnded()},this.startRecordingAudio());this.currentState=e.RecordingStarted};d.prototype.stopRecording=function(){this.settings.IsVideo?this.stopRecordingVideo():this.stopRecordingAudio()};d.prototype.getCurrentTime=function(){return this.currentState===e.Stopped?0:window.isChrome?
this.getChromeCurrentTime():this.settings.IsVideo?this.video.currentTime-this.recordingVideoPreInterval:this.audio.currentTime};d.prototype.getChromeCurrentTime=function(){return this.settings.IsVideo?this.video.currentTime-this.recordingVideoPreInterval:(this.currentState===e.RecordingStarted?(new Date).getTime()-this.recordingChromeStartTimeMs:this.currentState===e.PreviewPaused?this.previewChromeAudioPauseTimeMs-this.previewChromeAudioStartTimeMs-this.previewChromeAudioPauseIntervalMs:(new Date).getTime()-
this.previewChromeAudioStartTimeMs-this.previewChromeAudioPauseIntervalMs)/1E3};d.prototype.getDuration=function(){return this.currentRecordDuration};d.prototype.preparePreview=function(){this.settings.IsVideo?this.prepareVideoPreview():this.prepareAudioPreview()};d.prototype.prepareVideoPreview=function(){var a=this;window.isChrome&&this.audioUrl&&(this.audio.pause(),this.audio.currentTime=0,this.audio.src=this.audioUrl,this.audio.load());$(this.video).one("loadeddata",function(){a.video.duration&&
Infinity!==a.video.duration&&(a.currentRecordDuration=a.video.duration);a.recordingVideoPreInterval=0;$(document).trigger(a.eventNames.PreviewPreparedEventName)});$(this.video).one("error",function(){0===a.getCurrentTime()&&$(document).trigger(a.eventNames.PreviewPreparedFailedEventName)});this.video.src=this.videoUrl;this.video.load()};d.prototype.prepareAudioPreview=function(){var a=this;$(this.audio).one("loadeddata",function(){a.audio.duration&&Infinity!==a.audio.duration&&(a.currentRecordDuration=
a.audio.duration);$(document).trigger(a.eventNames.PreviewPreparedEventName)});this.audio.src=this.audioUrl;this.audio.load()};d.prototype.previewRecord=function(){this.currentState!==e.PreviewSeeked&&this.reloadPlayer();this.settings.IsVideo?(this.video.muted=!1,window.isChrome&&this.audioUrl&&(this.audio.muted=!1,this.audio.play()),this.video.play()):(this.audio.muted=!1,this.audio.play(),0===this.previewChromeAudioStartTimeMs&&(this.previewChromeAudioStartTimeMs=(new Date).getTime()));this.currentState=
e.PreviewStarted};d.prototype.reloadPlayer=function(){this.settings.IsVideo?this.supportsSeek()?this.seek(0):(this.video.load(),window.isChrome&&this.audioUrl&&this.audio.load()):this.supportsSeek()?this.seek(0):this.audio.load()};d.prototype.pauseResumePreview=function(a){this.settings.IsVideo?this.pauseResumeRecordingVideo(a):this.pauseResumePreviewAudio(a);this.currentState=a?e.PreviewPaused:e.PreviewStarted};d.prototype.pauseResumeRecordingVideo=function(a){a?(this.video.pause(),window.isChrome&&
this.audioUrl&&this.audio.pause()):(this.video.play(),window.isChrome&&this.audio.play())};d.prototype.pauseResumePreviewAudio=function(a){a?(this.audio.pause(),this.previewChromeAudioPauseTimeMs=(new Date).getTime()):(this.audio.play(),this.previewChromeAudioPauseIntervalMs+=(new Date).getTime()-this.previewChromeAudioPauseTimeMs)};d.prototype.deleteRecord=function(){this.settings.IsVideo?(window.isChrome&&this.audioUrl&&(this.audio.pause(),this.audio.src="",this.audio.muted=!0,this.audio.load()),
this.video.onended=null,this.video.pause(),this.video.muted=!0,this.video.src="",this.video.load(),this.showVideoFrame()):(this.audio.onended=null,this.audio.pause(),this.audio.muted=!0,this.audio.src="",this.audio.load());this.previewChromeAudioPauseIntervalMs=this.previewChromeAudioPauseTimeMs=this.previewChromeAudioStartTimeMs=this.recordingChromeStartTimeMs=this.recordingVideoPreInterval=this.currentRecordDuration=0;this.currentState=e.Stopped};d.prototype.closeRecordingSession=function(){var a=
this.currentState;this.currentState=e.Closing;a===e.RecordingStarted&&this.stopRecording();this.video&&this.video.pause();this.audio&&this.audio.pause();window.isChrome?(this.videoStream&&(0<this.videoStream.getVideoTracks().length&&this.videoStream.getVideoTracks()[0].stop(),0<this.videoStream.getAudioTracks().length&&this.videoStream.getAudioTracks()[0].stop()),this.audioStream&&0<this.audioStream.getAudioTracks().length&&this.audioStream.getAudioTracks()[0].stop()):(this.audioStream&&this.audioStream.stop(),
this.videoStream&&this.videoStream.stop());this.wasInterrupted&&(this.audioStream=this.videoStream=null,this.wasInterrupted=!1);this.currentState=e.Stopped};d.prototype.uploadRecord=function(a,b){try{b={Name:b};b.IsVideo=this.settings.IsVideo;var c=new FormData;if(window.isChrome&&this.settings.IsVideo&&this.audioUrl){var d=this.recorderAudio.getBlob(),e=this.recorderVideo.getBlob();c.append("file",d,"audio.wav");c.append("file",e,"video.webm");b.Type="WebRtcChrome";b.MimeType=d.type+","+e.type}else{var f=
this.settings.IsVideo?this.recorderVideo.getBlob():this.recorderAudio.getBlob();c.append("file",f,this.settings.IsVideo?"video.webm":window.isChrome?"audio.wav":"audio.ogg");b.Type="WebRtc";b.MimeType=f.type}a=0<a.indexOf("?")?a+"&"+$.param(b):a+"?"+$.param(b);var k=this;$.ajax(a,{type:"POST",contentType:!1,processData:!1,async:!0,data:c,dataType:"json",timeout:36E5,success:function(a){try{"none"===a.data.ErrorCode.toLowerCase()?$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,[a.data.FileName,
""]):$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,["",a.data.ErrorCode])}catch(p){$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,["",""])}},error:function(){$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,["",""])}})}catch(r){$(document).trigger(this.eventNames.RecordingUploadCompletedEventName,["",""])}};d.prototype.seek=function(a){this.settings.IsVideo?(this.video.currentTime=a,window.isChrome&&this.audioUrl&&(this.audio.currentTime=
a)):(this.audio.currentTime=a,window.isChrome&&(this.previewChromeAudioStartTimeMs=this.currentState===e.PreviewPaused?this.previewChromeAudioPauseTimeMs-1E3*a:(new Date).getTime()-1E3*a,this.previewChromeAudioPauseIntervalMs=0));this.currentState===e.Stopped&&(this.currentState=e.PreviewSeeked)};d.prototype.supportsSeek=function(){var a=this.settings.IsVideo?this.video:this.audio;return a&&0<a.seekable.length};d.prototype.showVideoFrame=function(a){var b=this;void 0===a&&(a=!1);if(this.videoStream){if(this.isVideoAvailable(this.videoStream)&&
(this.video.src=URL.createObjectURL(this.videoStream),this.video.load(),this.video.play(),a))this.onUserMediaVideo(this,this.videoStream)}else{var c=this;navigator.getUserMedia(this.constraints,function(c){if(b.isVideoAvailable(c)&&(b.videoStream=c,b.video.src=URL.createObjectURL(b.videoStream),b.video.load(),b.video.play(),a))b.onUserMediaVideo(b,b.videoStream)},function(){c.showAlert(c.settings.AccessDeniedErrorMessage)})}};d.prototype.isVideoAvailable=function(a){var b=this;return 0===a.getVideoTracks().length?
(this.showConfirmAudioSwitch(this.settings.ChangeToAudioRecorderMessage,function(c){c?(b.video.style.display="none",b.settings.IsVideo=!1,b.audioStream=window.isChrome?new window.MediaStream(a.getAudioTracks()):a,b.initialize(),$(document).trigger(b.eventNames.SwitchToAudioRecorderEventName)):(b.closeRecordingSession(),$(document).trigger(b.eventNames.SwitchToUploadTabEventName))}),!1):!0};d.prototype.showConfirmAudioSwitch=function(a,b){var c=this.settings.UploadFileButtonText.replace(/(["])/g,"&quot;");
window.top.jConfirm?(window.top.$.alerts.cancelButton=c,window.top.jConfirm(a,"",b)):($.alerts.cancelButton=c,jConfirm(a,"",b))};d.prototype.onPlaybackEnded=function(){this.isPreview()?this.currentState!==e.Closing&&(this.currentState=e.Stopped,this.previewChromeAudioPauseIntervalMs=this.previewChromeAudioPauseTimeMs=this.previewChromeAudioStartTimeMs=0,$(document).trigger(this.eventNames.RecordingPlaybackEndedEventName)):(this.wasInterrupted=!0,$(document).trigger(this.eventNames.RecordingInteruptedEventName))};
d.prototype.startRecordingVideo=function(){var a=this;if(this.videoStream)this.onUserMediaVideo(this,this.videoStream);else{var b=this;navigator.getUserMedia(this.constraints,function(a){b.videoStream=a;b.showVideoFrame(!0)},function(){a.showAlert(b.settings.AccessDeniedErrorMessage)})}};d.prototype.onUserMediaVideo=function(a,b){if(b.getAudioTracks()&&0!==b.getAudioTracks().length)this.onUserMediaVideoAndAudio(a,b);else this.onUserMediaVideoNoAudio(a,b)};d.prototype.onUserMediaVideoAndAudio=function(a,
b){a.video.muted=!0;var c={type:"video",video:a.video,width:a.video.clientWidth,height:a.video.clientHeight,canvas:{width:a.video.clientWidth,height:a.video.clientHeight},disableLogs:a.settings.DisableLogs,frameInterval:30,recorderType:null};window.isChrome?(a.recorderAudio=RecordRTC(b,{type:"audio",numberOfAudioChannels:1,disableLogs:a.settings.DisableLogs,onAudioProcessStarted:function(){a.recordingVideoPreInterval=a.video.currentTime;$(document).trigger(a.eventNames.HasUserMediaAccessEventName);
a.video.play();a.recorderVideo.startRecording()}}),a.recorderVideo=RecordRTC(b,c),a.recorderAudio.startRecording()):(a.recorderVideo=RecordRTC(b,c),a.recordingVideoPreInterval=a.video.currentTime,$(document).trigger(a.eventNames.HasUserMediaAccessEventName),a.video.play(),a.recorderVideo.startRecording());a.currentState=e.RecordingStarted};d.prototype.onUserMediaVideoNoAudio=function(a,b){a.video.muted=!0;a.recorderVideo=RecordRTC(b,{type:"video",video:a.video,width:a.video.clientWidth,height:a.video.clientHeight,
canvas:{width:a.video.clientWidth,height:a.video.clientHeight},disableLogs:a.settings.DisableLogs,frameInterval:30,recorderType:null});a.recordingVideoPreInterval=a.video.currentTime;$(document).trigger(a.eventNames.HasUserMediaAccessEventName);a.video.play();a.recorderVideo.startRecording();a.currentState=e.RecordingStarted};d.prototype.startRecordingAudio=function(){var a=this,b=this;if(b.audioStream)b.onUserMediaAudio(b,b.audioStream);else navigator.getUserMedia(b.constraints,function(a){window.isChrome&&
(a=new window.MediaStream(a.getAudioTracks()));b.audioStream=a;b.onUserMediaAudio(b,b.audioStream)},function(){a.showAlert(b.settings.AccessDeniedErrorMessage)});window.isAudio=!0};d.prototype.onUserMediaAudio=function(a,b){$(document).trigger(a.eventNames.HasUserMediaAccessEventName);a.recorderAudio=RecordRTC(b,{type:"audio",numberOfAudioChannels:1,disableLogs:a.settings.DisableLogs});a.audio.src=URL.createObjectURL(a.audioStream);a.audio.muted=!0;a.audio.play();a.recordingChromeStartTimeMs=(new Date).getTime();
a.recorderAudio.startRecording();a.currentState=e.RecordingStarted};d.prototype.stopRecordingAudio=function(){var a=this;a.recorderAudio&&(window.isChrome||a.recorderAudio.resumeRecording(),a.recorderAudio.stopRecording(function(b){a.audio.pause();a.currentRecordDuration=a.getCurrentTime();a.audioUrl=b;a.currentState=e.Stopped;a.triggerStoppedEvent()}))};d.prototype.stopRecordingVideo=function(){this.recorderAudio?this.stopVideoAndAudioRecorders():this.stopVideoNoAudioRecorders()};d.prototype.stopVideoAndAudioRecorders=
function(){var a=this;this.recorderAudio&&this.recorderVideo&&this.recorderVideo.stopRecording(function(b){a.video.pause();a.currentRecordDuration=a.getCurrentTime();a.recorderAudio.stopRecording(function(c){a.videoUrl=b;a.audioUrl=c;a.currentState=e.Stopped;a.triggerStoppedEvent()})})};d.prototype.stopVideoNoAudioRecorders=function(){if(this.recorderVideo){window.isChrome||this.recorderVideo.resumeRecording();var a=this;a.recorderVideo.stopRecording(function(b){a.video.pause();a.currentRecordDuration=
a.getCurrentTime();a.videoUrl=b;a.currentState=e.Stopped;a.triggerStoppedEvent()})}};d.prototype.triggerStoppedEvent=function(){this.currentState!==e.Closing&&$(document).trigger(this.eventNames.RecordingStoppedEventName)};d.prototype.isPreview=function(){return this.currentState===e.PreviewStarted||this.currentState===e.PreviewSeeked||this.currentState===e.PreviewPaused};d.prototype.showAlert=function(a){window.top.jAlert?window.top.jAlert(a,"",null):jAlert(a,"",null)};return d}();f.WebRtcRecorder=
k})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b){var c=this;window[a]=this;this.settings=b;$(function(){CCL.CommonFunctions.attachPostMessageEventListener($(window),c.settings.SendElementIdToCourseFeature,function(a){c.elementList.addElement(a.elementId).done(function(){return c.refreshLeftMenu(a.folderId,a.elementId,a.notFocusingOnElement)})});c.elementList=window[c.settings.ClientInstanceNames.ElementListClient];c.feedback=window[c.settings.ClientInstanceNames.Feedback];c.$titleTextBox=
$("#"+c.settings.Controls.TitleTextBox);c.$saveButton=$("#"+c.settings.Controls.SaveButton);c.$learningObjectiveSelector=$("#"+c.settings.Controls.LearningObjectiveSelector);c.$saveButton.click(function(){var a=""!==c.$titleTextBox.val();a||(c.feedback.showMessage(CCL.FeedbackType.Error,c.settings.Terms.ValidationError),$("html, body").animate({scrollTop:0}));return a});$("."+c.settings.Css.AddLinkCss).click(function(a){return c.onAddLinkClick($(a.currentTarget))})})}d.prototype.addElement=function(a,
b,c,d){this.elementList.addElementItem(a,b,c,d)};d.prototype.removeElement=function(a){this.elementList.deleteElement(a)};d.prototype.refreshLeftMenu=function(a,b,c){var d=top;d&&d.reloadFolder&&(d.reloadFolder(),d.reloadFolder("item"+a,"item"+b),d.notFocusingOnElement=c)};d.prototype.onAddLinkClick=function(a){var b=this,c=parseInt(a.data(this.settings.DataAttributes.ElementType),10);if(parseInt(a.data(this.settings.DataAttributes.ElementExternalSource),10)===f.AddResourceMenu.ElementExternalSourceType.Course){a=
{locationId:this.settings.CourseId,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};var d=this.elementList.getElementIds(),e=new Map;$.each(d,function(a,b){e.set(b,f.CheckboxStateMachine.State.Saved)});d=c===f.ElementLinkDialog.ContentElementType.Resources?this.settings.Terms.AddResource:this.settings.Terms.AddActivity;c={elementStates:f.MapUtils.makeCopy(e),elementType:c,showAll:!1,header:d,learningObjectiveId:this.$learningObjectiveSelector.val(),allowFolderSelection:!1,openerPage:f.ElementLinkDialog.ElementsPopupOpener.WorkingPortfolioTask,
afterOkClickCallback:function(a){var c=[],d=[];a&&a.forEach(function(a,b){a===f.CheckboxStateMachine.State.AttachedByUser||a===f.CheckboxStateMachine.State.Saved?c.push(b):a===f.CheckboxStateMachine.State.DetachedByUser&&d.push(b)});b.elementList.deleteElements(d);b.elementList.addElements(c)}};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(c,a)}};return d}();e.AddEditTask=k})(f.WorkingPortfolio||(f.WorkingPortfolio={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b,c){this.settings=b;this.getSelectedIds=c;window[a]=this}d.prototype.transferToPortfolio=function(a){if(null!=this.getSelectedIds){var b=this.getSelectedIds();0===b.length?CCL.CommonFunctions.jAlertAjaxError(this.settings.Terms.NoElementsSelected,this.settings.Terms.Alert,this.settings.Terms.Ok,!1):(a=""+this.settings.TransferPageUrlConstantPart+("&"+this.getTransferLocationRequestItem(a))+("&"+this.settings.RequestItems.ElementIds+"="+b.join()),
window.location.href=a)}};d.prototype.getTransferLocationRequestItem=function(a){var b=a.startsWith(this.settings.Prefixes.CourseIdPrefix),c=b?this.settings.RequestItems.CourseId:this.settings.RequestItems.PortfolioId;a=parseInt(a.substring((b?this.settings.Prefixes.CourseIdPrefix:this.settings.Prefixes.PortfolioIdPrefix).length),10);return c+"="+a};return d}();e.WorkingPortfolio=f})(f.WorkingPortfolio||(f.WorkingPortfolio={}))})(ItslearningWeb||(ItslearningWeb={}));

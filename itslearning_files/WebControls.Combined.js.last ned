function GridColumn(b,a,c,d,e,g,f){this.dataField=b;this.sortField=a;this.sortDescendingByDefault=e;this.headerHtml=c;this.width=d;this.title=g;this.visibleAlways=f}
function AjaxGrid(b){window[b]=this;this.name=b;this.dataSourceWebMethodUrl=this.sortingDirection=this.filteringPreference=this.sortingProperty=this.mainColumn=this.pageNumber=this.pageSize=null;this.dataSourceWebMethodParams={};this.pagerInstanceName=this.columnChooserClientID=this.columnChooserDialogName=this.gridClientID=null;this.allowSelecting=!1;this.allowColumnChoosing=!0;this.preferenceCategoryName=this.columnOrderHiddenClientID=this.filteringHiddenClientID=this.sortingHiddenClientID=this.pageSizeHiddenClientID=
this.pageNumberHiddenClientID=this.selectingHiddenClientID=this.dataKeyName=null;this.visibleColumns=[];this.columns=[];this.totalCount=0;this.allowRowExpanding=this.keepSelection=!0;this.emptyTableText=this.expandedRowButtonTitle=null;this.removeDomOnCollapse=!1;this.accordionDataSourceUrl=null;this.useFullPostback=!1;this.saveToPreferencesWebMethodUrl=null;this._getColumnsCount=function(){return this.visibleColumns.length+(this.allowColumnChoosing?1:0)+(this.allowSelecting?1:0)};this._saveToPreferences=
function(a,c,d,b){this.saveToPreferencesWebMethodUrl&&CCL.CommonFunctions.safeAjaxPost({url:this.saveToPreferencesWebMethodUrl,data:{category:a,name:c,value:d}}).done(b)};this._getInvisibleColumns=function(){for(var a=[],c=0;c<this.columns.length;c++)this.visibleColumns.contains(this.columns[c].dataField)||a.push(this.columns[c].dataField);return a};this._applySelectedRowClass=function(a,c){c?addClassName(a,"il-grid-selectedrow"):removeClassName(a,"il-grid-selectedrow")};this._addRemoveSelectedValue=
function(a,c){c?CommonScripts.addIdToHidden(this.selectingHiddenClientID,a):CommonScripts.removeIdFromHidden(this.selectingHiddenClientID,a)};this.toggleSelect=function(a){this._applySelectedRowClass(a.parentNode.parentNode,a.checked);var c=!0,d=this;$("tr td.il-grid-selectcolumn input:checkbox").each(function(){this.checked||(c&=0);d._addRemoveSelectedValue(this.value,this.checked)});$("tr th.il-grid-selectcolumn input:checkbox").prop("checked",c)};this.toggleSelectAll=function(a){var c=this;$("tr td.il-grid-selectcolumn input:checkbox:enabled").each(function(){this.checked=
a.checked;c._applySelectedRowClass(this.parentNode.parentNode,a.checked);c._addRemoveSelectedValue(this.value,this.checked)})};this.restoreState=function(){var a=document.getElementById(this.sortingHiddenClientID).value.split(":");this.pageSize=document.getElementById(this.pageSizeHiddenClientID).value;this.pageNumber=document.getElementById(this.pageNumberHiddenClientID).value;this.sortingProperty=a[0];this.sortingDirection=a[1];this.filteringPreference=document.getElementById(this.filteringHiddenClientID).value;
this.visibleColumns=document.getElementById(this.columnOrderHiddenClientID).value.split(",")};this.saveState=function(){document.getElementById(this.sortingHiddenClientID).value=this.sortingProperty+":"+this.sortingDirection;document.getElementById(this.pageSizeHiddenClientID).value=this.pageSize;document.getElementById(this.pageNumberHiddenClientID).value=this.pageNumber;document.getElementById(this.columnOrderHiddenClientID).value=this.visibleColumns.toString();document.getElementById(this.filteringHiddenClientID).value=
this.filteringPreference};this._getParams=function(){var a={},c;for(c in this.dataSourceWebMethodParams)a[c]=this.dataSourceWebMethodParams[c];return a};this.refresh=function(){this.saveState();if(this.dataSourceWebMethodUrl){var a=this,c="",d="";this.sortingProperty&&(c=this.sortingProperty+":"+this.sortingDirection,this.columns.findBySortField(this.sortingProperty).dataField!=this.mainColumn&&(c+=","+this.columns.findByDataField(this.mainColumn).sortField+":asc"));this.filteringPreference&&(d=this.filteringPreference);
c=$.extend({pageNumber:this.pageNumber,pageSize:this.pageSize,sort:c,filter:d},this._getParams());CCL.CommonFunctions.safeAjaxPost({url:this.dataSourceWebMethodUrl,data:c,dataType:"xml"}).done(function(c){a.render(c)})}else __doPostBack("","")};this.sort=function(a){this.sortingDirection=this.sortingProperty==a?"asc"==this.sortingDirection?"desc":"asc":this.columns.findBySortField(a).sortDescendingByDefault?"desc":"asc";this.sortingProperty=a;this.goToPage(1);a=this.sortingProperty+":"+this.sortingDirection;
this.columns.findByDataField(this.mainColumn).sortField==this.sortingProperty&&"asc"==this.sortingDirection&&(a=null);this._saveToPreferences(this.preferenceCategoryName,GridConstants.preferenceKeys.sorting,a)};this.filter=function(a){this.filteringPreference!=a&&(this.filteringPreference=a,this.goToPage(1),this._saveToPreferences(this.preferenceCategoryName,GridConstants.preferenceKeys.filtering,a))};this.goToPage=function(a){this.keepSelection||a==this.pageNumber||(document.getElementById(this.selectingHiddenClientID).value=
"");this.pageNumber=a;this.refresh()};this.changePageSize=function(a){this.pageSize=a;this.goToPage(1);this._saveToPreferences(this.preferenceCategoryName,GridConstants.preferenceKeys.pagesize,a)};this._getPageHref=function(a){return"javascript:"+this.name+".goToPage("+a+");"};this._addPager=function(a){var c=$("<td></td>").attr("class","il-grid-pager").attr("colSpan",this._getColumnsCount()),d=window[this.pagerInstanceName];d.totalCount=this.totalCount;d.pageSize=this.pageSize;d.pageNumber=this.pageNumber;
d.createIn(c);a.append($("<tr></tr>").append(c))};this._addHeader=function(a){var c=$("<tr></tr>"),d=this;if(this.allowSelecting){var b=$("<th></th>").attr("scope","col").attr("class","il-grid-selectcolumn");b.append($("<input type='checkbox'/>").attr("id",d.name+"_select").on("click",function(){d.toggleSelectAll(this)}));b.append($("<label class='h-hidden'</label>").attr("for",d.name+"_select").text(GridConstants.terms.selectAllRows));c.append(b)}for(var g=0;g<this.visibleColumns.length;g++){var f=
this.columns.findByDataField(this.visibleColumns[g]);b=$("<th></th>").attr("scope","col");if(f.sortField){var h=$("<a></a>").attr("href","javascript:"+this.name+".sort('"+f.sortField+"');").attr("title",f.title),k=$("<span></span>").attr("class","th-text").html(f.headerHtml),l=$("<span></span>").attr("class","th-icon");if(this.sortingProperty==f.sortField){b.attr("class","th-selected");var m=this.gridSortingarrowIconCssClass;"asc"!=this.sortingDirection&&(m+=" "+this.gridSortingarrowDescIconCssClass);
l.append($("<img />").attr("class",m).attr("src",GridConstants.onePixelImageUrl))}else b.attr("class","th-sortable");h.append(l).append(k);b.append(h)}else b.html(f.headerHtml);f.width&&b.css("width",f.width+"px");b.appendTo(c)}this.allowColumnChoosing&&(b=$("<a class='il-grid-columnchooserlink'></a>").attr("href","#"+this.columnChooserDialogName).attr("title",GridConstants.terms.columnChooserToolTip),b.append($("<img />").attr("src",GridConstants.onePixelImageUrl).attr("alt",GridConstants.terms.columnChooserToolTip).attr("class",
this.gridColumnchooserlinkImage)),$("<th></th>").attr("class","il-grid-columnchoosercolumn").append(b).appendTo(c));a.append(c)};this.getSelectedValues=function(){var a=$("#"+this.selectingHiddenClientID).val();return 0==a.length?[]:a.slice(0,a.length-1).split(",")};this.clearSelection=function(){$("#"+this.selectingHiddenClientID).val("")};this.clear=function(){this.totalCount=0;this._addHeader($("#"+this.gridClientID+" > thead").empty());this._addPager($("#"+this.gridClientID+" > tfoot").empty());
var a=$("#"+this.gridClientID+" > tbody");a.empty();var c=this._getColumnsCount();this._addRowWithText(a,this.emptyTableText,c,"il-grid-emptytablecell");this._addEmptyRows(a,GridConstants.minRowCount-1,c);$("tr:nth-child(even)",a).addClass("il-grid-alternaterow")};this.render=function(a){this.totalCount=$("VirtualCount",a).text();var c=this.getSelectedValues();this._addHeader($("#"+this.gridClientID+" > thead").empty());this._addPager($("#"+this.gridClientID+" > tfoot").empty());var d=$("#"+this.gridClientID+
" > tbody");d.empty();var b=this;a=$(":first-child > Items > *",a);var g=0<a.length;a.each(function(){var a=$("<tr></tr>"),e=$(b.dataKeyName,this).text(),f=$(GridConstants.rowTooltipTextProperty,this);0<f.length&&a.attr("title",f.text());b.allowRowExpanding&&(a.css("cursor","pointer"),a.on("click",function(a){b.expandCollapseRow(this,a,e);return!0}));b.allowSelecting&&(f=c.contains(e),g&=f,a.append($("<td></td>").attr("class","il-grid-selectcolumn").append($("<input type='checkbox'/>").attr("id",
b.name+"_select_"+e).attr("value",e).prop("checked",f).prop("defaultChecked",f).on("click",function(){b.toggleSelect(this)})).append($("<label class='h-hidden'</label>").attr("for",b.name+"_select_"+e).text(GridConstants.terms.selectOneRow+" "+$(GridConstants.selectLabelTextProperty,this).text()))),f&&a.addClass("il-grid-selectedrow"));for(f=0;f<b.visibleColumns.length;f++){var m=$(b.visibleColumns[f],this);b.columns.findByDataField(b.visibleColumns[f]);$("<td></td>").html(m.text()).appendTo(a)}b.allowColumnChoosing&&
a.append($("<td></td>"));d.append(a)});b.allowSelecting&&$("thead tr th.il-grid-selectcolumn input:checkbox").prop("checked",g);if(a.length<GridConstants.minRowCount){var f=this._getColumnsCount();0==a.length&&this._addRowWithText(d,this.emptyTableText,f,"il-grid-emptytablecell");this._addEmptyRows(d,GridConstants.minRowCount-Math.max(a.length,1),f)}$("tr:nth-child(even)",d).addClass("il-grid-alternaterow")};this._addRowWithText=function(a,c,b,e){a.append($("<tr></tr>").append($("<td></td>").attr("class",
e).attr("colSpan",b).html(c)))};this._addEmptyRows=function(a,c,b){for(var d=0;d<c;d++)this._addRowWithText(a,"&nbsp;",b,"")};this.createColumnChooser=function(){this.allowColumnChoosing&&$("#"+this.columnChooserClientID).sortable({opacity:.8,placeholder:"il-column-chooser-empty",tolerance:"pointer",activeclass:"il-column-chooser-active",hoverclass:"il-column-chooser-hover"})};this.showColumnChooser=function(){var a=$("#"+this.columnChooserClientID);a.empty();for(var c=this.visibleColumns.concat(this._getInvisibleColumns()),
b=0;b<c.length;b++){var e=this.columns.findByDataField(c[b]),g=this.visibleColumns.contains(e.dataField)||e.visibleAlways;e=$("<li class='il-column-chooser'/>").append($("<input type='checkbox'/>").val(e.dataField).attr("id",this.name+"_"+e.dataField+"_chk").prop("checked",g).prop("defaultChecked",g).prop("disabled",e.visibleAlways)).append($("<label></label>").attr("for",this.name+"_"+e.dataField+"_chk").html(e.headerHtml));a.append(e)}(a=a.find("input:not(:disabled):first"))&&a.focus()};this.updateColumnsList=
function(){var a=[];$(":checkbox","#"+this.columnChooserClientID).each(function(){$(this).prop("checked")&&a.push($(this).val())});0==a.length&&a.push(this.mainColumn);if(!a.isEqual(this.visibleColumns)){this.visibleColumns=a;this.visibleColumns.contains(this.columns.findBySortField(this.sortingProperty).dataField)?this.refresh():this.sort(this.columns.findByDataField(this.visibleColumns[0]).sortField);var c=null;a.isEqual(this.defaultColumnOrder)||(c=this.visibleColumns.toString());this._saveToPreferences(this.preferenceCategoryName,
GridConstants.preferenceKeys.columnOrder,c)}return!0};this.addSingleColumn=function(a,c,b){var d=this.columns.findByDataField(a);return this.visibleColumns.contains(d.dataField)?!1:(this.visibleColumns.push(a),c&&(this.sortingProperty=d.sortField,this.sortingDirection=b,this.sort(d.sortField)),this.refresh(),this._saveToPreferences(this.preferenceCategoryName,GridConstants.preferenceKeys.columnOrder,this.visibleColumns.toString()),!0)};this._collapseAll=function(){var a=$("#"+this.gridClientID+" > tbody > tr.il-grid-accordion-row");
a.hide();this.removeDomOnCollapse&&a.remove()};this.expandCollapseRow=function(a,c,b){c=c?c:window.event;if(!c||"A"!=(c.srcElement||c.target).parentNode.tagName)if($(a).next().hasClass("il-grid-accordion-row"))d=$(a).next(),d.is(":hidden")?(this._collapseAll(),d.show(),d.removeAttr("style")):(d.hide(),this.removeDomOnCollapse&&d.remove());else{this._collapseAll();var d=$("<tr class='il-grid-accordion-row'></tr>").hide(),g=$("<td></td>").attr("colSpan",this._getColumnsCount());c=0<this.accordionDataSourceUrl.indexOf("?")?
"&":"?";$.get(this.accordionDataSourceUrl+c+this.accordionDataSourceUrlParameterName+"="+encodeURIComponent(b),{},function(a){g.html(a);d.show();d.removeAttr("style")},"html");d.append(g);$(a).after(d)}};this.getRow=function(a){return $("#"+this.gridClientID+" > tbody").find("tr:has(td:first input[value='"+a+"']:checkbox)")}}Array.prototype.findByDataField=function(b){for(x in this)if(this[x].dataField==b)return this[x];return null};
Array.prototype.findBySortField=function(b){for(x in this)if(this[x].sortField==b)return this[x];return null};
function CommentModuleManagerWrapper(b){window[b]=this;var a;this.initialize=function(c){a=c};this.showOrHideCommentsClick=function(c,b){if(b=b.getCommentModuleObject())b.isVisible()?(b.hide(),c.text(0<b.getCommentsCount()?a.strings.showComments:a.strings.addComment)):(1===c.data("commentsLoaded")?b.show():(b.loadAndShow(),c.data("commentsLoaded",1)),c.text(a.strings.hideComments));return!1};this.addComment=function(b,d,e,g,f,h,k){$.ajax({type:"POST",datatype:"json",url:a.urls.addComment,data:{shareableObjectId:d.ShareableObjectId,
userId:d.UserId,text:e,lastVisibleCommentId:g}}).done(function(a){h(b,a)}).fail(function(){k(b)})};this.editComment=function(b,d,e,g,f,h,k){$.ajax({type:"POST",datatype:"json",url:a.urls.editComment,data:{commentId:e,text:g}}).done(function(a){h(b,a)}).fail(function(a){k(b,e,a)})};this.deleteComment=function(b,d,e,g,f){$.ajax({type:"POST",datatype:"json",url:a.urls.deleteComment,data:{commentId:e}}).done(function(a){g(b,e,a)}).fail(function(a){f(b,e,a)})};this.loadOld=function(b,d,e,g,f,h,k,l){$.ajax({type:"GET",
datatype:"json",url:a.urls.getOld,data:{shareableObjectId:d.ShareableObjectId,userId:d.UserId,count:g}}).done(function(a){k(b,a)}).fail(function(a){l(b,a)})};return this}
var CommonScripts={addIdToHidden:function(b,a){if(b&&a){b=document.getElementById(b);for(var c=b.value.split(","),d=!1,e=0;e<c.length;e++)if(a==c[e]){d=!0;break}d||(b.value+=a+",")}},removeIdFromHidden:function(b,a){if(b&&a&&(b=document.getElementById(b))&&b.value){for(var c=b.value.split(","),d="",e=0;e<c.length;e++)a!=c[e]&&0<c[e].length&&(d+=c[e]+",");b.value=d}},isFunction:function(b){var a=!1;try{a="function"==typeof eval(b)}catch(c){}return a},makeDelegate:function(b,a){var c=function(){c.Method.call(c.Object)};
c.Object=b;c.Method=a;return c},createHandler:function(b,a){return function(){return a.apply(b,arguments)}},addEventHandler:function(b,a,c){document.addEventListener?b.addEventListener(a,c,!1):document.attachEvent&&b.attachEvent("on"+a,c)},setFocusTo:function(b,a){b&&(b.setSelectionRange?(b.focus(),a=a?b.value.length:0,b.setSelectionRange(a,a)):b.createTextRange&&(b=b.createTextRange(),a&&b.collapse(!1),b.select()))},showAlert:function(b){alert($("<div/>").html(b).text())},jQueryWebServiceErrorHelper:function(b,
a,c){b.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&b.responseText&&CommonScripts.showAlert(b.responseText)},isIe:function(b){var a=$.browser;return a.msie&&parseInt(a.version)==b},getParamsQueryString:function(b){var a=[],c=0,d;for(d in b)0<c&&(a[c++]="&"),a[c++]=d,a[c++]="=",a[c++]=encodeURIComponent(b[d]);return a.join("")},setFocusToEnd:function(b){CommonScripts.setFocusTo(b,!0)}};Array.prototype.contains=function(b){for(x in this)if(this[x]==b)return!0;return!1};
Array.prototype.isEqual=function(b){if(this.length!=b.length)return!1;for(var a=0;a<b.length;a++)if(this[a].compare&&!this[a].compare(b[a])||this[a]!==b[a])return!1;return!0};function addClassName(b,a){removeClassName(b,a);b.className=trim(b.className+" "+a)}function removeClassName(b,a){b.className=trim(b.className.replace(a,""))}function trim(b){return b.replace(/^\s+|\s+$/,"")}
function SubmitWithEnter(b){if(window.event)var a=window.event.keyCode;else b&&(a=b.which);if(a===CommonConstants.keyCodes.enter)for(b=document.getElementsByTagName("input"),a=0;a<b.length;a++)if("submit"==b[a].type&&!b[a].disabled)return b[a].click(),!1;return!0}
function DropDownEditor(b){window[b]=this;var a=this;a.firstLoad=function(){a.settings.webMethodParamsQueryString=CommonScripts.getParamsQueryString(a.settings.updateItemWebMethodParams);a.controls.dropDown.on("change",function(b){a.updateValue()}).on("blur",function(b){a.blur()}).find("option[value='"+a.settings.separatorValue+"']").prop("disabled",!0);a.controls.dropDown.show()};a.titleClick=function(){a.controls.dropDown.show();a.controls.dropDown.focus()};a.updateValue=function(){var b=a.controls.dropDown.val();
b!=a.settings.separatorValue?$.ajax({type:"POST",url:a.settings.updateItemWebMethodUrl,data:a.settings.valueParameterName+"="+encodeURIComponent(b)+"&"+a.settings.webMethodParamsQueryString,contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(c,e){a.valueUpdated(b)},error:function(b,c,g){CommonScripts.jQueryWebServiceErrorHelper(b,c,g);a.rollback()}}):a.rollback()};a.valueUpdated=function(b){a.controls.currentValueHidden.val(b);a.goToViewMode(b,!0);a.afterUpdateClientScriptFunction&&
a.afterUpdateClientScriptFunction(b)};a.goToViewMode=function(b,d){a.controls.dropDown.find("option:selected").text()};a.rollback=function(){var b=a.controls.currentValueHidden.val();a.controls.dropDown.val(b);a.goToViewMode(b)};a.blur=function(){a.goToViewMode(a.controls.dropDown.val())}}
function EmbeddedFeedback(b){window[b]=this;var a=this;a.showMessage=function(b,d){var c=a.controls;c.container.show().prop("className",a.settings.cssClasses[b]);c.messageTextContainer.text(d);c.icon.prop("className",a.settings.iconCssClasses[b]);a.hideUndo()};a.hide=function(){a.controls.container.hide();if(a.functions.onClose)a.functions.onClose()};a.hideUndo=function(){a.controls.undoLink.hide()}}
function GridSearcherInstance(b){window[b]=this;var a=this;a.firstLoad=function(){a.isEmpty=a.settings.isEmpty;a.controls.searchInput.focus(function(){a.onFocus()}).keyup(function(b){return a.onKeyUp(b)}).keypress(function(b){return a.onKeyPress(b)}).blur(function(){a.onBlur()});a.refresh()};a.onFocus=function(){a.isEmpty&&(a.isEmpty=!1,a.refresh(!0))};a.onBlur=function(){if(0===a.controls.searchInput.val().length)a.isEmpty=!0,a.refresh(),a.filter("");else{var b=a.settings.preferenceWithoutValue+
a.controls.searchInput.val();a.filter(b)}};a.onKeyUp=function(b){if(a.isEmpty)return a.isEmpty=!1,a.refresh(!0),!0;if(b.which===CommonConstants.keyCodes.enter)return b=a.settings.preferenceWithoutValue+a.controls.searchInput.val(),a.filter(b),!1};a.onKeyPress=function(a){return a.which!==CommonConstants.keyCodes.enter};a.defineState=function(){a.isEmpty||0!==a.controls.searchInput.val().length||(a.isEmpty=!0)};a.refresh=function(b){a.isEmpty?(a.controls.searchInput.addClass("il-toolbar-searcher-input-emptystate"),
a.controls.searchInput.val(a.settings.searchText)):(b&&a.controls.searchInput.val(""),a.controls.searchInput.removeClass("il-toolbar-searcher-input-emptystate"))}}
function MultipleItemsSelector(b){window[b]=this;var a=this,c;a.name=b;a.firstLoad=function(){var b=a.controls.idsHidden.val();a.settings.selectedIds=b?$.parseJSON(b):[];$.each(a.settings.selectedIds,function(b,d){b=a.findDescriptionById(d);a.addItem(a.addItemWrapper(),b,d)});a.controls.addItemLink.on("click",function(){a.addNewDropDown()});a.controls.allItemsOption.on("click",function(){a.radioChecked(!0)});a.controls.selectedItemsOption.on("click",function(){a.radioChecked(!1)});a.updateAddLink();
b=a.controls.allItemsOption.is(":checked");a.controls.clientInstance.trigger("itemsSelectionChange",[b,a.settings.selectedIds])};a.findDescriptionById=function(b){for(index in a.settings.items)if(a.settings.items[index].value==b)return a.settings.items[index].text;return""};a.getCurrentItemList=function(){return $.grep(a.settings.items,function(b,c){return-1==$.inArray(b.value,a.settings.selectedIds)})};a.fillOptions=function(b){b.find("option").remove();$.each(a.getCurrentItemList(),function(a,c){b.append($("<option></option>").val(c.value).text(c.text))})};
a.radioChecked=function(b){a.controls.selectedItemsSection.toggle(!b);a.controls.clientInstance.trigger("itemsSelectionChange",[b,a.settings.selectedIds])};a.addNewDropDown=function(){var b=$("<select></select>").on("change",function(){a.itemChosen(this)});a.fillOptions(b);b.val(0);a.addItemWrapper().append(b);b.focus()};a.addItemWrapper=function(){c||a.createItemsContainer();return $("<li></li>").appendTo(c)};a.itemChosen=function(b){if(b&&b.selectedIndex){var c=b.options[b.selectedIndex],d=parseInt(c.value);
c=c.text;a.addItem($(b.parentNode),c,d);a.settings.selectedIds.push(d);a.saveIdsToHidden();a.refreshDropdowns();a.updateAddLink()}};a.addItem=function(b,c,g){var d=a.settings.removeItemTerm?a.settings.removeItemTerm.replace("{0}",c):"";b.empty().append($("<span></span>").addClass("il-itemsselector-item-text").text(c)).append($("<a></a>").attr("href","javascript:void(0);").attr("title",d).addClass(a.settings.removeLinkCssClass).on("click",function(){a.removeItem(this,g)}).append($("<img />").attr("src",
a.settings.onePixelTransparentImage).attr("alt",""))).append($("<div></div>").addClass("h-fl-c"));a.refreshRemoveButtons()};a.removeItem=function(b,c){$.each(a.settings.selectedIds,function(b,d){if(d==c)return a.settings.selectedIds.splice(b,1),a.saveIdsToHidden(),a.refreshDropdowns(),!1});(b=b.parentNode)&&b.parentNode&&b.parentNode.removeChild(b);a.refreshRemoveButtons();a.updateAddLink()};a.saveIdsToHidden=function(){a.controls.idsHidden.val(JSON.stringify(a.settings.selectedIds));a.controls.clientInstance.trigger("itemsSelectionChange",
[!1,a.settings.selectedIds])};a.refreshDropdowns=function(){var b=c.find("select");a.fillOptions(b)};a.refreshRemoveButtons=function(){if(a.settings.preventLastItemDeletion){var b=c.find("a");b.toggle(1<b.length)}};a.updateAddLink=function(){a.controls.addItemLink.toggle(a.settings.selectedIds.length<a.settings.items.length-1)};a.createItemsContainer=function(){c=$("<ul></ul>").addClass(a.cssClasses.itemsContainerCssClass).insertBefore(a.controls.addItemLink)}}
function TitleEditorInstance(b){window[b]=this;var a=this,c=!1;a.firstLoad=function(){a.settings.webMethodParamsQueryString=CommonScripts.getParamsQueryString(a.settings.updateTitleWebMethodParams);a.isAjaxModeOff="true"===a.settings.isAjaxModeOff;a.controls.titleInput.on("keyup",function(b){return a.keyUp(b)}).on("keypress",function(b){return a.keyPress(b)}).on("blur",function(){a.blur()}).on("focus",function(){a._hideWatermark()});a.controls.titleInput.val()||a._showWatermark()};a.titleClick=function(){a.controls.titleInput.show();
a._setCursorToEnd()};a.blur=function(){a.controls.titleInput.is(":visible")&&a.updateTitle()};a.keyUp=function(b){b=b?b:window.event;if(b.which===CommonConstants.keyCodes.escape)a._rollback();else if(b.which===CommonConstants.keyCodes.enter&&!b.shiftKey)return a.updateTitle(),!1;return!0};a.keyPress=function(a){a=a?a:window.event;return a.which!==CommonConstants.keyCodes.enter||a.shiftKey};a.updateTitle=function(){var b=c?"":$.trim(a.controls.titleInput.val());/\S/.test(b)||(b="");a.isAjaxModeOff?
b!=a.controls.titleHidden.val()?a._finalUpdate(b):a._rollback():a.settings.updateTitleWebMethodUrl&&b!=a.controls.titleHidden.val()?$.ajax({type:"POST",url:a.settings.updateTitleWebMethodUrl,data:"title="+encodeURIComponent(b)+"&"+a.settings.webMethodParamsQueryString,contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(c,d){a._finalUpdate(b)},error:function(b,c,d){a.controls.errorLabel.text(a.settings.customErrorMessage?a.settings.customErrorMessage:b.responseText?b.responseText:
"").show();a._setCursorToEnd()}}):a._rollback()};a._rollback=function(){a.controls.titleInput.val(a.controls.titleHidden.val());a._goToViewMode()};a._finalUpdate=function(b){a.controls.titleHidden.val(b);a.controls.titleInput.val(b);a._goToViewMode();a.afterUpdateClientScriptFunction&&a.afterUpdateClientScriptFunction(b)};a._goToViewMode=function(){a.controls.errorLabel.hide();a.controls.titleInput.is(":focus")?a.controls.titleInput.setCursorPosition(a.controls.titleInput.val().length):a._showWatermark()};
a._setCursorToEnd=function(){CommonScripts.setFocusToEnd(this.controls.titleInput.get(0))};a._showWatermark=function(){c||a.controls.titleInput.val()||(a.controls.titleInput.val(a.settings.watermarkText),a.controls.titleInput.addClass(a.settings.watermarkCssClass),c=!0)};a._hideWatermark=function(){c&&(a.controls.titleInput.val(""),a.controls.titleInput.removeClass(a.settings.watermarkCssClass),c=!1)}}
var WidgetLayout={currentDocumentWidth:0,isWideLeftFixing:!1,onLoad:function(){WidgetLayout.dynamicContentChanged();$(window).resize(WidgetLayout.dynamicContentChanged)},saveToPreferences:function(){var b=[],a=0;$("."+WidgetLayoutConstants.cssClassSortable).each(function(){$(this).find("li.il-widget").each(function(){b[a++]=$("input:hidden:first",this).val();b[a++]=","});b[a++]=";"});CommonScripts.isFunction(WidgetLayoutConstants.setLayoutFunction)&&WidgetLayoutConstants.setLayoutFunction(b.join(""),
null,CommonScripts.createHandler(this,this._handleError));this.dynamicContentChanged()},registerSortable:function(){$("ul."+WidgetLayoutConstants.cssClassSortable).sortable({placeholder:"il-widget-placeholder",cursor:"move",handle:".il-widget-top",dropOnEmpty:!0,tolerance:"pointer",revert:200,connectWith:["ul."+WidgetLayoutConstants.cssClassSortable],start:function(b,a){$(document).click();if($.browser.msie&&(b=a.item[0])){var c=[];$(b).find("iframe").each(function(){c.push($(this).attr("src"));$(this).attr("src",
"about:blank")});b._originalSrc=c}},beforeStop:function(b,a){if($.browser.msie){var c=a.item[0];if(c&&c._originalSrc){var d=0;$(c).find("iframe").each(function(){$(this).attr("src",c._originalSrc[d]);d++});c._originalSrc=null}}},stop:CommonScripts.createHandler(WidgetLayout,WidgetLayout.saveToPreferences)})},focusChangeLayoutLink:function(){$("ul li a:first, ul li label:first",WidgetLayoutConstants.changeLayoutDialogContainer).focus()},onChangeLayoutSchemeClick:function(b){CommonFunctions.makePostMessageCall(window.top,
new CommonWindowMessages.GenericMessage(CommonWindowMessages.MessageNames.collapseContentAreaFrame));IframeResizer.reportSetIframeDefaultHeight();CommonScripts.isFunction(WidgetLayoutConstants.setSchemeFunction)?WidgetLayoutConstants.setSchemeFunction(b,CommonScripts.createHandler(this,this._reloadWindow),CommonScripts.createHandler(this,this._handleError)):this._reloadWindow()},getWidgetElementsJQuery:function(b){return $("li.il-widget:has(input[value='"+b+"']:hidden)")},getAllWidgetsExceptOne:function(b){return $("li.il-widget:has(input[value!='"+
b+"']:hidden)")},getAllWidgets:function(){return $("li.il-widget")},getCurrentNumberOfWidgets:function(){return WidgetLayout.getAllWidgets().length},getWidgetTitle:function(b){return WidgetLayout.getWidgetElementsJQuery(b).find("div.il-widget-header h2").html()},setWidgetTitle:function(b,a){WidgetLayout.getWidgetElementsJQuery(b).find("div.il-widget-header h2").html(a)},setWidgetMenu:function(b,a){WidgetLayout.getWidgetElementsJQuery(b).find("div.itsl-widget-toolbar-items-right").html(a)},_reloadWindow:function(){window.location=
window.location.href.replace(window.location.hash,"").replace(/#$/,"")},_handleError:function(b,a,c){CommonScripts.jQueryWebServiceErrorHelper(b)},dynamicContentChanged:function(){setTimeout(function(){$(document).trigger("closeColorPicker")})},hideEmbeddedObjects:function(){CommonFunctions.setEmbeddedObjectsVisibility(!1,$("div.il-widget-content"),$("div.il-widget-content .h-userinput"))},showEmbeddedObjects:function(){CommonFunctions.setEmbeddedObjectsVisibility(!0,$("div.il-widget-content"),$("div.il-widget-content .h-userinput"))},
beforeOpenDialog:function(){WidgetLayout.hideEmbeddedObjects()},beforeCloseDialog:function(){WidgetLayout.showEmbeddedObjects()}};
